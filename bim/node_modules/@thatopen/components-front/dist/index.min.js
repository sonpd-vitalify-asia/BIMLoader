var e=Object.defineProperty,t=(t,i,s)=>(((t,i,s)=>{i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[i]=s})(t,"symbol"!=typeof i?i+"":i,s),s);import*as i from"three";import{Vector3 as s,Vector2 as n,Plane as r,Line3 as o,Box3 as a,Mesh as l,Triangle as c,Raycaster as h,Quaternion as d,Euler as u,Matrix4 as f,Sphere as p,Object3D as m,MeshBasicMaterial as I,LineBasicMaterial as E,CylinderGeometry as g,BoxGeometry as C,BufferGeometry as T,Float32BufferAttribute as R,OctahedronGeometry as v,Line as S,SphereGeometry as y,TorusGeometry as w,PlaneGeometry as A,DoubleSide as F,BufferAttribute as O,FrontSide as N,Ray as P,BackSide as x,InstancedBufferGeometry as L,InstancedInterleavedBuffer as b,InterleavedBufferAttribute as M,WireframeGeometry as D,UniformsLib as _,ShaderLib as U,UniformsUtils as B,ShaderMaterial as V,Vector4 as z,MathUtils as k,OrthographicCamera as Y,WebGLRenderTarget as G,HalfFloatType as H,NoBlending as W,Clock as X,Color as Z,LinearFilter as j,NearestFilter as K,DepthTexture as Q,UnsignedIntType as q,DepthFormat as J,DataTexture as $,NoColorSpace as ee,RepeatWrapping as te,WebGLMultipleRenderTargets as ie,RedFormat as se,FloatType as ne,RGBAFormat as re}from"three";import*as oe from"@thatopen/fragments";import{FragmentsGroup as ae,Serializer as le,FragmentMesh as ce}from"@thatopen/fragments";import*as he from"web-ifc";var de=Object.defineProperty,ue=(e,t,i)=>(((e,t,i)=>{t in e?de(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i})(e,"symbol"!=typeof t?t+"":t,i),i);const fe=1.25,pe=65535,me=Math.pow(2,-24),Ie=Symbol("SKIP_GENERATION");function Ee(e){return function(e){return e.index?e.index.count:e.attributes.position.count}(e)/3}function ge(e,t){if(!e.index){const i=e.attributes.position.count,s=function(e,t=ArrayBuffer){return e>65535?new Uint32Array(new t(4*e)):new Uint16Array(new t(2*e))}(i,t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new O(s,1));for(let e=0;e<i;e++)s[e]=e}}function Ce(e){const t=Ee(e),i=e.drawRange,s=i.start/3,n=(i.start+i.count)/3,r=Math.max(0,s),o=Math.min(t,n)-r;return[{offset:Math.floor(r),count:Math.floor(o)}]}function Te(e){if(!e.groups||!e.groups.length)return Ce(e);const t=[],i=new Set,s=e.drawRange,n=s.start/3,r=(s.start+s.count)/3;for(const t of e.groups){const e=t.start/3,s=(t.start+t.count)/3;i.add(Math.max(n,e)),i.add(Math.min(r,s))}const o=Array.from(i.values()).sort(((e,t)=>e-t));for(let e=0;e<o.length-1;e++){const i=o[e],s=o[e+1];t.push({offset:Math.floor(i),count:Math.floor(s-i)})}return t}function Re(e,t,i){return i.min.x=t[e],i.min.y=t[e+1],i.min.z=t[e+2],i.max.x=t[e+3],i.max.y=t[e+4],i.max.z=t[e+5],i}function ve(e){let t=-1,i=-1/0;for(let s=0;s<3;s++){const n=e[s+3]-e[s];n>i&&(i=n,t=s)}return t}function Se(e,t){t.set(e)}function ye(e,t,i){let s,n;for(let r=0;r<3;r++){const o=r+3;s=e[r],n=t[r],i[r]=s<n?s:n,s=e[o],n=t[o],i[o]=s>n?s:n}}function we(e,t,i){for(let s=0;s<3;s++){const n=t[e+2*s],r=t[e+2*s+1],o=n-r,a=n+r;o<i[s]&&(i[s]=o),a>i[s+3]&&(i[s+3]=a)}}function Ae(e){const t=e[3]-e[0],i=e[4]-e[1],s=e[5]-e[2];return 2*(t*i+i*s+s*t)}function Fe(e,t,i,s,n=null){let r=1/0,o=1/0,a=1/0,l=-1/0,c=-1/0,h=-1/0,d=1/0,u=1/0,f=1/0,p=-1/0,m=-1/0,I=-1/0;const E=null!==n;for(let s=6*t,n=6*(t+i);s<n;s+=6){const t=e[s+0],i=e[s+1],n=t-i,g=t+i;n<r&&(r=n),g>l&&(l=g),E&&t<d&&(d=t),E&&t>p&&(p=t);const C=e[s+2],T=e[s+3],R=C-T,v=C+T;R<o&&(o=R),v>c&&(c=v),E&&C<u&&(u=C),E&&C>m&&(m=C);const S=e[s+4],y=e[s+5],w=S-y,A=S+y;w<a&&(a=w),A>h&&(h=A),E&&S<f&&(f=S),E&&S>I&&(I=S)}s[0]=r,s[1]=o,s[2]=a,s[3]=l,s[4]=c,s[5]=h,E&&(n[0]=d,n[1]=u,n[2]=f,n[3]=p,n[4]=m,n[5]=I)}const Oe=32,Ne=(e,t)=>e.candidate-t.candidate,Pe=new Array(Oe).fill().map((()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0}))),xe=new Float32Array(6);class Le{constructor(){}}function be(e,t,i,s,n,r){let o=s,a=s+n-1;const l=r.pos,c=2*r.axis;for(;;){for(;o<=a&&i[6*o+c]<l;)o++;for(;o<=a&&i[6*a+c]>=l;)a--;if(!(o<a))return o;for(let e=0;e<3;e++){let i=t[3*o+e];t[3*o+e]=t[3*a+e],t[3*a+e]=i}for(let e=0;e<6;e++){let t=i[6*o+e];i[6*o+e]=i[6*a+e],i[6*a+e]=t}o++,a--}}function Me(e,t,i,s,n,r){let o=s,a=s+n-1;const l=r.pos,c=2*r.axis;for(;;){for(;o<=a&&i[6*o+c]<l;)o++;for(;o<=a&&i[6*a+c]>=l;)a--;if(!(o<a))return o;{let t=e[o];e[o]=e[a],e[a]=t;for(let e=0;e<6;e++){let t=i[6*o+e];i[6*o+e]=i[6*a+e],i[6*a+e]=t}o++,a--}}}function De(e,t){const i=e.geometry,s=i.index?i.index.array:null,n=t.maxDepth,r=t.verbose,o=t.maxLeafTris,a=t.strategy,l=t.onProgress,c=Ee(i),h=e._indirectBuffer;let d=!1;const u=new Float32Array(6),f=new Float32Array(6),p=function(e,t){!function(e){e[0]=e[1]=e[2]=1/0,e[3]=e[4]=e[5]=-1/0}(t);const i=e.attributes.position,s=e.index?e.index.array:null,n=Ee(e),r=new Float32Array(6*n),o=i.normalized,a=i.array,l=i.offset||0;let c=3;i.isInterleavedBufferAttribute&&(c=i.data.stride);const h=["getX","getY","getZ"];for(let e=0;e<n;e++){const n=3*e,d=6*e;let u=n+0,f=n+1,p=n+2;s&&(u=s[u],f=s[f],p=s[p]),o||(u=u*c+l,f=f*c+l,p=p*c+l);for(let e=0;e<3;e++){let s,n,l;o?(s=i[h[e]](u),n=i[h[e]](f),l=i[h[e]](p)):(s=a[u+e],n=a[f+e],l=a[p+e]);let c=s;n<c&&(c=n),l<c&&(c=l);let m=s;n>m&&(m=n),l>m&&(m=l);const I=(m-c)/2,E=2*e;r[d+E+0]=c+I,r[d+E+1]=I+(Math.abs(c)+I)*me,c<t[e]&&(t[e]=c),m>t[e+3]&&(t[e+3]=m)}}return r}(i,u),m=t.indirect?Me:be,I=[],E=t.indirect?Ce(i):Te(i);if(1===E.length){const e=E[0],t=new Le;t.boundingData=u,function(e,t,i,s){let n=1/0,r=1/0,o=1/0,a=-1/0,l=-1/0,c=-1/0;for(let s=6*t,h=6*(t+i);s<h;s+=6){const t=e[s+0];t<n&&(n=t),t>a&&(a=t);const i=e[s+2];i<r&&(r=i),i>l&&(l=i);const h=e[s+4];h<o&&(o=h),h>c&&(c=h)}s[0]=n,s[1]=r,s[2]=o,s[3]=a,s[4]=l,s[5]=c}(p,e.offset,e.count,f),C(t,e.offset,e.count,f),I.push(t)}else for(let e of E){const t=new Le;t.boundingData=new Float32Array(6),Fe(p,e.offset,e.count,t.boundingData,f),C(t,e.offset,e.count,f),I.push(t)}return I;function g(e){l&&l(e/c)}function C(e,t,l,c=null,u=0){if(!d&&u>=n&&(d=!0,r&&(console.warn(`MeshBVH: Max depth of ${n} reached when generating BVH. Consider increasing maxDepth.`),console.warn(i))),l<=o||u>=n)return g(t+l),e.offset=t,e.count=l,e;const I=function(e,t,i,s,n,r){let o=-1,a=0;if(0===r)o=ve(t),-1!==o&&(a=(t[o]+t[o+3])/2);else if(1===r)o=ve(e),-1!==o&&(a=function(e,t,i,s){let n=0;for(let r=t,o=t+i;r<o;r++)n+=e[6*r+2*s];return n/i}(i,s,n,o));else if(2===r){const r=Ae(e);let l=fe*n;const c=6*s,h=6*(s+n);for(let e=0;e<3;e++){const s=t[e],d=(t[e+3]-s)/Oe;if(n<8){const t=[...Pe];t.length=n;let s=0;for(let n=c;n<h;n+=6,s++){const r=t[s];r.candidate=i[n+2*e],r.count=0;const{bounds:o,leftCacheBounds:a,rightCacheBounds:l}=r;for(let e=0;e<3;e++)l[e]=1/0,l[e+3]=-1/0,a[e]=1/0,a[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0;we(n,i,o)}t.sort(Ne);let d=n;for(let e=0;e<d;e++){const i=t[e];for(;e+1<d&&t[e+1].candidate===i.candidate;)t.splice(e+1,1),d--}for(let s=c;s<h;s+=6){const n=i[s+2*e];for(let e=0;e<d;e++){const r=t[e];n>=r.candidate?we(s,i,r.rightCacheBounds):(we(s,i,r.leftCacheBounds),r.count++)}}for(let i=0;i<d;i++){const s=t[i],c=s.count,h=n-s.count,d=s.leftCacheBounds,u=s.rightCacheBounds;let f=0;0!==c&&(f=Ae(d)/r);let p=0;0!==h&&(p=Ae(u)/r);const m=1+fe*(f*c+p*h);m<l&&(o=e,l=m,a=s.candidate)}}else{for(let e=0;e<Oe;e++){const t=Pe[e];t.count=0,t.candidate=s+d+e*d;const i=t.bounds;for(let e=0;e<3;e++)i[e]=1/0,i[e+3]=-1/0}for(let t=c;t<h;t+=6){let n=~~((i[t+2*e]-s)/d);n>=Oe&&(n=31);const r=Pe[n];r.count++,we(t,i,r.bounds)}const t=Pe[31];Se(t.bounds,t.rightCacheBounds);for(let e=30;e>=0;e--){const t=Pe[e],i=Pe[e+1];ye(t.bounds,i.rightCacheBounds,t.rightCacheBounds)}let u=0;for(let t=0;t<31;t++){const i=Pe[t],s=i.count,c=i.bounds,h=Pe[t+1].rightCacheBounds;0!==s&&(0===u?Se(c,xe):ye(c,xe,xe)),u+=s;let d=0,f=0;0!==u&&(d=Ae(xe)/r);const p=n-u;0!==p&&(f=Ae(h)/r);const m=1+fe*(d*u+f*p);m<l&&(o=e,l=m,a=i.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${r} used.`);return{axis:o,pos:a}}(e.boundingData,c,p,t,l,a);if(-1===I.axis)return g(t+l),e.offset=t,e.count=l,e;const E=m(h,s,p,t,l,I);if(E===t||E===t+l)g(t+l),e.offset=t,e.count=l;else{e.splitAxis=I.axis;const i=new Le,s=t,n=E-t;e.left=i,i.boundingData=new Float32Array(6),Fe(p,s,n,i.boundingData,f),C(i,s,n,f,u+1);const r=new Le,o=E,a=l-n;e.right=r,r.boundingData=new Float32Array(6),Fe(p,o,a,r.boundingData,f),C(r,o,a,f,u+1)}return e}}function _e(e,t){const i=e.geometry;t.indirect&&(e._indirectBuffer=function(e,t){const i=(e.index?e.index.count:e.attributes.position.count)/3,s=i>65536,n=s?4:2,r=t?new SharedArrayBuffer(i*n):new ArrayBuffer(i*n),o=s?new Uint32Array(r):new Uint16Array(r);for(let e=0,t=o.length;e<t;e++)o[e]=e;return o}(i,t.useSharedArrayBuffer),function(e){if(0===e.groups.length)return!1;const t=Ee(e),i=Te(e).sort(((e,t)=>e.offset-t.offset)),s=i[i.length-1];s.count=Math.min(t-s.offset,s.count);let n=0;return i.forEach((({count:e})=>n+=e)),t!==n}(i)&&!t.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),e._indirectBuffer||ge(i,t);const s=De(e,t);let n,r,o;const a=[],l=t.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer;for(let e=0;e<s.length;e++){const t=s[e];const i=new l(32*c(t));n=new Float32Array(i),r=new Uint32Array(i),o=new Uint16Array(i),h(0,t),a.push(i)}return void(e._roots=a);function c(e){return e.count?1:1+c(e.left)+c(e.right)}function h(e,t){const i=e/4,s=e/2,a=!!t.count,l=t.boundingData;for(let e=0;e<6;e++)n[i+e]=l[e];if(a){const n=t.offset,a=t.count;return r[i+6]=n,o[s+14]=a,o[s+15]=pe,e+32}{const s=t.left,n=t.right,o=t.splitAxis;let a;if(a=h(e+32,s),a/4>Math.pow(2,32))throw new Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return r[i+6]=a/4,a=h(a,n),r[i+7]=o,a}}}class Ue{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,t){let i=1/0,s=-1/0;for(let n=0,r=e.length;n<r;n++){const r=e[n][t];i=r<i?r:i,s=r>s?r:s}this.min=i,this.max=s}setFromPoints(e,t){let i=1/0,s=-1/0;for(let n=0,r=t.length;n<r;n++){const r=t[n],o=e.dot(r);i=o<i?o:i,s=o>s?o:s}this.min=i,this.max=s}isSeparated(e){return this.min>e.max||e.min>this.max}}Ue.prototype.setFromBox=function(){const e=new s;return function(t,i){const s=i.min,n=i.max;let r=1/0,o=-1/0;for(let i=0;i<=1;i++)for(let a=0;a<=1;a++)for(let l=0;l<=1;l++){e.x=s.x*i+n.x*(1-i),e.y=s.y*a+n.y*(1-a),e.z=s.z*l+n.z*(1-l);const c=t.dot(e);r=Math.min(c,r),o=Math.max(c,o)}this.min=r,this.max=o}}();const Be=function(){const e=new s,t=new s,i=new s;return function(s,n,r){const o=s.start,a=e,l=n.start,c=t;i.subVectors(o,l),e.subVectors(s.end,s.start),t.subVectors(n.end,n.start);const h=i.dot(c),d=c.dot(a),u=c.dot(c),f=i.dot(a),p=a.dot(a)*u-d*d;let m,I;m=0!==p?(h*d-f*u)/p:0,I=(h+m*d)/u,r.x=m,r.y=I}}(),Ve=function(){const e=new n,t=new s,i=new s;return function(s,n,r,o){Be(s,n,e);let a=e.x,l=e.y;if(a>=0&&a<=1&&l>=0&&l<=1)return s.at(a,r),void n.at(l,o);if(a>=0&&a<=1)return l<0?n.at(0,o):n.at(1,o),void s.closestPointToPoint(o,!0,r);if(l>=0&&l<=1)return a<0?s.at(0,r):s.at(1,r),void n.closestPointToPoint(r,!0,o);{let e,c;e=a<0?s.start:s.end,c=l<0?n.start:n.end;const h=t,d=i;return s.closestPointToPoint(c,!0,t),n.closestPointToPoint(e,!0,i),h.distanceToSquared(c)<=d.distanceToSquared(e)?(r.copy(h),void o.copy(c)):(r.copy(e),void o.copy(d))}}}(),ze=function(){const e=new s,t=new s,i=new r,n=new o;return function(s,r){const{radius:o,center:a}=s,{a:l,b:c,c:h}=r;if(n.start=l,n.end=c,n.closestPointToPoint(a,!0,e).distanceTo(a)<=o||(n.start=l,n.end=h,n.closestPointToPoint(a,!0,e).distanceTo(a)<=o)||(n.start=c,n.end=h,n.closestPointToPoint(a,!0,e).distanceTo(a)<=o))return!0;const d=r.getPlane(i);if(Math.abs(d.distanceToPoint(a))<=o){const e=d.projectPoint(a,t);if(r.containsPoint(e))return!0}return!1}}();function ke(e){return Math.abs(e)<1e-15}class Ye extends c{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=new Array(4).fill().map((()=>new s)),this.satBounds=new Array(4).fill().map((()=>new Ue)),this.points=[this.a,this.b,this.c],this.sphere=new p,this.plane=new r,this.needsUpdate=!0}intersectsSphere(e){return ze(e,this)}update(){const e=this.a,t=this.b,i=this.c,s=this.points,n=this.satAxes,r=this.satBounds,o=n[0],a=r[0];this.getNormal(o),a.setFromPoints(o,s);const l=n[1],c=r[1];l.subVectors(e,t),c.setFromPoints(l,s);const h=n[2],d=r[2];h.subVectors(t,i),d.setFromPoints(h,s);const u=n[3],f=r[3];u.subVectors(i,e),f.setFromPoints(u,s),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}}Ye.prototype.closestPointToSegment=function(){const e=new s,t=new s,i=new o;return function(s,n=null,r=null){const{start:o,end:a}=s,l=this.points;let c,h=1/0;for(let o=0;o<3;o++){const a=(o+1)%3;i.start.copy(l[o]),i.end.copy(l[a]),Ve(i,s,e,t),c=e.distanceToSquared(t),c<h&&(h=c,n&&n.copy(e),r&&r.copy(t))}return this.closestPointToPoint(o,e),c=o.distanceToSquared(e),c<h&&(h=c,n&&n.copy(e),r&&r.copy(o)),this.closestPointToPoint(a,e),c=a.distanceToSquared(e),c<h&&(h=c,n&&n.copy(e),r&&r.copy(a)),Math.sqrt(h)}}(),Ye.prototype.intersectsTriangle=function(){const e=new Ye,t=new Array(3),i=new Array(3),n=new Ue,r=new Ue,a=new s,l=new s,c=new s,h=new s,d=new s,u=new o,f=new o,p=new o,m=new s;function I(e,t,i){const s=e.points;let n=0,r=-1;for(let e=0;e<3;e++){const{start:o,end:a}=u;o.copy(s[e]),a.copy(s[(e+1)%3]),u.delta(l);const c=ke(t.distanceToPoint(o));if(ke(t.normal.dot(l))&&c){i.copy(u),n=2;break}const h=t.intersectLine(u,m);if(!h&&c&&m.copy(o),(h||c)&&!ke(m.distanceTo(a))){if(n<=1)(1===n?i.start:i.end).copy(m),c&&(r=n);else if(n>=2){(1===r?i.start:i.end).copy(m),n=2;break}if(n++,2===n&&-1===r)break}}return n}return function(s,o=null,l=!1){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);const u=this.plane,m=s.plane;if(Math.abs(u.normal.dot(m.normal))>1-1e-10){const e=this.satBounds,c=this.satAxes;i[0]=s.a,i[1]=s.b,i[2]=s.c;for(let t=0;t<4;t++){const s=e[t],r=c[t];if(n.setFromPoints(r,i),s.isSeparated(n))return!1}const h=s.satBounds,d=s.satAxes;t[0]=this.a,t[1]=this.b,t[2]=this.c;for(let e=0;e<4;e++){const i=h[e],s=d[e];if(n.setFromPoints(s,t),i.isSeparated(n))return!1}for(let e=0;e<4;e++){const s=c[e];for(let e=0;e<4;e++){const o=d[e];if(a.crossVectors(s,o),n.setFromPoints(a,t),r.setFromPoints(a,i),n.isSeparated(r))return!1}}return o&&(l||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),o.start.set(0,0,0),o.end.set(0,0,0)),!0}{const e=I(this,m,f);if(1===e&&s.containsPoint(f.end))return o&&(o.start.copy(f.end),o.end.copy(f.end)),!0;if(2!==e)return!1;const t=I(s,u,p);if(1===t&&this.containsPoint(p.end))return o&&(o.start.copy(p.end),o.end.copy(p.end)),!0;if(2!==t)return!1;if(f.delta(c),p.delta(h),c.dot(h)<0){let e=p.start;p.start=p.end,p.end=e}const i=f.start.dot(c),n=f.end.dot(c),r=p.start.dot(c),a=p.end.dot(c);return(i===a||r===n||n<r!==i<a)&&(o&&(d.subVectors(f.start,p.start),d.dot(c)>0?o.start.copy(f.start):o.start.copy(p.start),d.subVectors(f.end,p.end),d.dot(c)<0?o.end.copy(f.end):o.end.copy(p.end)),!0)}}}(),Ye.prototype.distanceToPoint=function(){const e=new s;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),Ye.prototype.distanceToTriangle=function(){const e=new s,t=new s,i=["a","b","c"],n=new o,r=new o;return function(s,o=null,a=null){const l=o||a?n:null;if(this.intersectsTriangle(s,l))return(o||a)&&(o&&l.getCenter(o),a&&l.getCenter(a)),0;let c=1/0;for(let t=0;t<3;t++){let n;const r=i[t],l=s[r];this.closestPointToPoint(l,e),n=l.distanceToSquared(e),n<c&&(c=n,o&&o.copy(e),a&&a.copy(l));const h=this[r];s.closestPointToPoint(h,e),n=h.distanceToSquared(e),n<c&&(c=n,o&&o.copy(h),a&&a.copy(e))}for(let l=0;l<3;l++){const h=i[l],d=i[(l+1)%3];n.set(this[h],this[d]);for(let l=0;l<3;l++){const h=i[l],d=i[(l+1)%3];r.set(s[h],s[d]),Ve(n,r,e,t);const u=e.distanceToSquared(t);u<c&&(c=u,o&&o.copy(e),a&&a.copy(t))}}return Math.sqrt(c)}}();class Ge{constructor(e,t,i){this.isOrientedBox=!0,this.min=new s,this.max=new s,this.matrix=new f,this.invMatrix=new f,this.points=new Array(8).fill().map((()=>new s)),this.satAxes=new Array(3).fill().map((()=>new s)),this.satBounds=new Array(3).fill().map((()=>new Ue)),this.alignedSatBounds=new Array(3).fill().map((()=>new Ue)),this.needsUpdate=!1,e&&this.min.copy(e),t&&this.max.copy(t),i&&this.matrix.copy(i)}set(e,t,i){this.min.copy(e),this.max.copy(t),this.matrix.copy(i),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}}Ge.prototype.update=function(){return function(){const e=this.matrix,t=this.min,i=this.max,s=this.points;for(let n=0;n<=1;n++)for(let r=0;r<=1;r++)for(let o=0;o<=1;o++){const a=s[1*n|2*r|4*o];a.x=n?i.x:t.x,a.y=r?i.y:t.y,a.z=o?i.z:t.z,a.applyMatrix4(e)}const n=this.satBounds,r=this.satAxes,o=s[0];for(let e=0;e<3;e++){const t=r[e],i=n[e],a=s[1<<e];t.subVectors(o,a),i.setFromPoints(t,s)}const a=this.alignedSatBounds;a[0].setFromPointsField(s,"x"),a[1].setFromPointsField(s,"y"),a[2].setFromPointsField(s,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1}}(),Ge.prototype.intersectsBox=function(){const e=new Ue;return function(t){this.needsUpdate&&this.update();const i=t.min,s=t.max,n=this.satBounds,r=this.satAxes,o=this.alignedSatBounds;if(e.min=i.x,e.max=s.x,o[0].isSeparated(e)||(e.min=i.y,e.max=s.y,o[1].isSeparated(e))||(e.min=i.z,e.max=s.z,o[2].isSeparated(e)))return!1;for(let i=0;i<3;i++){const s=r[i],o=n[i];if(e.setFromBox(s,t),o.isSeparated(e))return!1}return!0}}(),Ge.prototype.intersectsTriangle=function(){const e=new Ye,t=new Array(3),i=new Ue,n=new Ue,r=new s;return function(s){this.needsUpdate&&this.update(),s.isExtendedTriangle?s.needsUpdate&&s.update():(e.copy(s),e.update(),s=e);const o=this.satBounds,a=this.satAxes;t[0]=s.a,t[1]=s.b,t[2]=s.c;for(let e=0;e<3;e++){const s=o[e],n=a[e];if(i.setFromPoints(n,t),s.isSeparated(i))return!1}const l=s.satBounds,c=s.satAxes,h=this.points;for(let e=0;e<3;e++){const t=l[e],s=c[e];if(i.setFromPoints(s,h),t.isSeparated(i))return!1}for(let e=0;e<3;e++){const s=a[e];for(let e=0;e<4;e++){const o=c[e];if(r.crossVectors(s,o),i.setFromPoints(r,t),n.setFromPoints(r,h),i.isSeparated(n))return!1}}return!0}}(),Ge.prototype.closestPointToPoint=function(){return function(e,t){return this.needsUpdate&&this.update(),t.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),t}}(),Ge.prototype.distanceToPoint=function(){const e=new s;return function(t){return this.closestPointToPoint(t,e),t.distanceTo(e)}}(),Ge.prototype.distanceToBox=function(){const e=["x","y","z"],t=new Array(12).fill().map((()=>new o)),i=new Array(12).fill().map((()=>new o)),n=new s,r=new s;return function(s,o=0,a=null,l=null){if(this.needsUpdate&&this.update(),this.intersectsBox(s))return(a||l)&&(s.getCenter(r),this.closestPointToPoint(r,n),s.closestPointToPoint(n,r),a&&a.copy(n),l&&l.copy(r)),0;const c=o*o,h=s.min,d=s.max,u=this.points;let f=1/0;for(let e=0;e<8;e++){const t=u[e];r.copy(t).clamp(h,d);const i=t.distanceToSquared(r);if(i<f&&(f=i,a&&a.copy(t),l&&l.copy(r),i<c))return Math.sqrt(i)}let p=0;for(let s=0;s<3;s++)for(let n=0;n<=1;n++)for(let r=0;r<=1;r++){const o=(s+1)%3,a=(s+2)%3,l=1<<s|n<<o|r<<a,c=u[n<<o|r<<a],f=u[l];t[p].set(c,f);const m=e[s],I=e[o],E=e[a],g=i[p],C=g.start,T=g.end;C[m]=h[m],C[I]=n?h[I]:d[I],C[E]=r?h[E]:d[I],T[m]=d[m],T[I]=n?h[I]:d[I],T[E]=r?h[E]:d[I],p++}for(let e=0;e<=1;e++)for(let t=0;t<=1;t++)for(let i=0;i<=1;i++){r.x=e?d.x:h.x,r.y=t?d.y:h.y,r.z=i?d.z:h.z,this.closestPointToPoint(r,n);const s=r.distanceToSquared(n);if(s<f&&(f=s,a&&a.copy(n),l&&l.copy(r),s<c))return Math.sqrt(s)}for(let e=0;e<12;e++){const s=t[e];for(let e=0;e<12;e++){const t=i[e];Ve(s,t,n,r);const o=n.distanceToSquared(r);if(o<f&&(f=o,a&&a.copy(n),l&&l.copy(r),o<c))return Math.sqrt(o)}}return Math.sqrt(f)}}();class He{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){const e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}}class We extends He{constructor(){super((()=>new Ye))}}const Xe=new We;function Ze(e,t){return 65535===t[e+15]}function je(e,t){return t[e+6]}function Ke(e,t){return t[e+14]}function Qe(e){return e+8}function qe(e,t){return t[e+6]}function Je(e,t){return t[e+7]}const $e=new class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;const e=[];let t=null;this.setBuffer=i=>{t&&e.push(t),t=i,this.float32Array=new Float32Array(i),this.uint16Array=new Uint16Array(i),this.uint32Array=new Uint32Array(i)},this.clearBuffer=()=>{t=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}};let et,tt;const it=[],st=new He((()=>new a));function nt(e,t,i,s,n,r){et=st.getPrimitive(),tt=st.getPrimitive(),it.push(et,tt),$e.setBuffer(e._roots[t]);const o=rt(0,e.geometry,i,s,n,r);$e.clearBuffer(),st.releasePrimitive(et),st.releasePrimitive(tt),it.pop(),it.pop();const a=it.length;return a>0&&(tt=it[a-1],et=it[a-2]),o}function rt(e,t,i,s,n=null,r=0,o=0){const{float32Array:a,uint16Array:l,uint32Array:c}=$e;let h=2*e;if(Ze(h,l)){const t=je(e,c),i=Ke(h,l);return Re(e,a,et),s(t,i,!1,o,r+e,et)}{let h=function(e){const{uint16Array:t,uint32Array:i}=$e;let s=2*e;for(;!Ze(s,t);)s=2*(e=Qe(e));return je(e,i)},d=function(e){const{uint16Array:t,uint32Array:i}=$e;let s=2*e;for(;!Ze(s,t);)s=2*(e=qe(e,i));return je(e,i)+Ke(s,t)};const u=Qe(e),f=qe(e,c);let p,m,I,E,g=u,C=f;if(n&&(I=et,E=tt,Re(g,a,I),Re(C,a,E),p=n(I),m=n(E),m<p)){g=f,C=u;const e=p;p=m,m=e,I=E}I||(I=et,Re(g,a,I));const T=i(I,Ze(2*g,l),p,o+1,r+g);let R;if(2===T){const e=h(g);R=s(e,d(g)-e,!0,o+1,r+g,I)}else R=T&&rt(g,t,i,s,n,r,o+1);if(R)return!0;E=tt,Re(C,a,E);const v=i(E,Ze(2*C,l),m,o+1,r+C);let S;if(2===v){const e=h(C);S=s(e,d(C)-e,!0,o+1,r+C,E)}else S=v&&rt(C,t,i,s,n,r,o+1);return!!S}}const ot=new s,at=new s;const lt=new s,ct=new s,ht=new s,dt=new n,ut=new n,ft=new n,pt=new s,mt=new s,It=new s,Et=new s;function gt(e,t,i,r,o,a,l,h,d){lt.fromBufferAttribute(t,a),ct.fromBufferAttribute(t,l),ht.fromBufferAttribute(t,h);const u=function(e,t,i,s,n,r){let o;return o=r===x?e.intersectTriangle(s,i,t,!0,n):e.intersectTriangle(t,i,s,r!==F,n),null===o?null:{distance:e.origin.distanceTo(n),point:n.clone()}}(e,lt,ct,ht,Et,d);if(u){r&&(dt.fromBufferAttribute(r,a),ut.fromBufferAttribute(r,l),ft.fromBufferAttribute(r,h),u.uv=c.getInterpolation(Et,lt,ct,ht,dt,ut,ft,new n)),o&&(dt.fromBufferAttribute(o,a),ut.fromBufferAttribute(o,l),ft.fromBufferAttribute(o,h),u.uv1=c.getInterpolation(Et,lt,ct,ht,dt,ut,ft,new n)),i&&(pt.fromBufferAttribute(i,a),mt.fromBufferAttribute(i,l),It.fromBufferAttribute(i,h),u.normal=c.getInterpolation(Et,lt,ct,ht,pt,mt,It,new s),u.normal.dot(e.direction)>0&&u.normal.multiplyScalar(-1));const t={a:a,b:l,c:h,normal:new s,materialIndex:0};c.getNormal(lt,ct,ht,t.normal),u.face=t,u.faceIndex=a}return u}function Ct(e,t,i,s,n){const r=3*s;let o=r+0,a=r+1,l=r+2;const c=e.index;e.index&&(o=c.getX(o),a=c.getX(a),l=c.getX(l));const{position:h,normal:d,uv:u,uv1:f}=e.attributes,p=gt(i,h,d,u,f,o,a,l,t);return p?(p.faceIndex=s,n&&n.push(p),p):null}function Tt(e,t,i,s){const n=e.a,r=e.b,o=e.c;let a=t,l=t+1,c=t+2;i&&(a=i.getX(a),l=i.getX(l),c=i.getX(c)),n.x=s.getX(a),n.y=s.getY(a),n.z=s.getZ(a),r.x=s.getX(l),r.y=s.getY(l),r.z=s.getZ(l),o.x=s.getX(c),o.y=s.getY(c),o.z=s.getZ(c)}function Rt(e,t,i,s,n,r,o){const{geometry:a}=i,{index:l}=a,c=a.attributes.position;for(let i=e,a=t+e;i<a;i++){let e;if(e=i,Tt(o,3*e,l,c),o.needsUpdate=!0,s(o,e,n,r))return!0}return!1}function vt(e,t=null){t&&Array.isArray(t)&&(t=new Set(t));const i=e.geometry,s=i.index?i.index.array:null,n=i.attributes.position;let r,o,a,l,c=0;const h=e._roots;for(let e=0,t=h.length;e<t;e++)r=h[e],o=new Uint32Array(r),a=new Uint16Array(r),l=new Float32Array(r),d(0,c),c+=r.byteLength;function d(e,i,r=!1){const c=2*e;if(a[c+15]===pe){const t=o[e+6];let i=1/0,r=1/0,h=1/0,d=-1/0,u=-1/0,f=-1/0;for(let e=3*t,o=3*(t+a[c+14]);e<o;e++){let t=s[e];const o=n.getX(t),a=n.getY(t),l=n.getZ(t);o<i&&(i=o),o>d&&(d=o),a<r&&(r=a),a>u&&(u=a),l<h&&(h=l),l>f&&(f=l)}return(l[e+0]!==i||l[e+1]!==r||l[e+2]!==h||l[e+3]!==d||l[e+4]!==u||l[e+5]!==f)&&(l[e+0]=i,l[e+1]=r,l[e+2]=h,l[e+3]=d,l[e+4]=u,l[e+5]=f,!0)}{const s=e+8,n=o[e+6],a=s+i,c=n+i;let h=r,u=!1,f=!1;t?h||(u=t.has(a),f=t.has(c),h=!u&&!f):(u=!0,f=!0);const p=h||f;let m=!1;(h||u)&&(m=d(s,i,h));let I=!1;p&&(I=d(n,i,h));const E=m||I;if(E)for(let t=0;t<3;t++){const i=s+t,r=n+t,o=l[i],a=l[i+3],c=l[r],h=l[r+3];l[e+t]=o<c?o:c,l[e+t+3]=a>h?a:h}return E}}}const St=new a;function yt(e,t,i,s){return Re(e,t,St),i.intersectBox(St,s)}function wt(e,t,i,s,n,r,o){const{geometry:a}=i,{index:l}=a,c=a.attributes.position;for(let a=e,h=t+e;a<h;a++){let e;if(e=i.resolveTriangleIndex(a),Tt(o,3*e,l,c),o.needsUpdate=!0,s(o,e,n,r))return!0}return!1}const At=new s;function Ft(e,t,i,s,n){$e.setBuffer(e._roots[t]),Ot(0,e,i,s,n),$e.clearBuffer()}function Ot(e,t,i,s,n){const{float32Array:r,uint16Array:o,uint32Array:a}=$e,l=2*e;if(Ze(l,o)){!function(e,t,i,s,n,r){const{geometry:o,_indirectBuffer:a}=e;for(let e=s,a=s+n;e<a;e++)Ct(o,t,i,e,r)}(t,i,s,je(e,a),Ke(l,o),n)}else{const o=Qe(e);yt(o,r,s,At)&&Ot(o,t,i,s,n);const l=qe(e,a);yt(l,r,s,At)&&Ot(l,t,i,s,n)}}const Nt=new s,Pt=["x","y","z"];function xt(e,t,i,s){$e.setBuffer(e._roots[t]);const n=Lt(0,e,i,s);return $e.clearBuffer(),n}function Lt(e,t,i,s){const{float32Array:n,uint16Array:r,uint32Array:o}=$e;let a=2*e;if(Ze(a,r)){return function(e,t,i,s,n){const{geometry:r,_indirectBuffer:o}=e;let a=1/0,l=null;for(let e=s,o=s+n;e<o;e++){let s;s=Ct(r,t,i,e),s&&s.distance<a&&(l=s,a=s.distance)}return l}(t,i,s,je(e,o),Ke(a,r))}{const r=Je(e,o),a=Pt[r],l=s.direction[a]>=0;let c,h;l?(c=Qe(e),h=qe(e,o)):(c=qe(e,o),h=Qe(e));const d=yt(c,n,s,Nt)?Lt(c,t,i,s):null;if(d){const e=d.point[a];if(l?e<=n[h+r]:e>=n[h+r+3])return d}const u=yt(h,n,s,Nt)?Lt(h,t,i,s):null;return d&&u?d.distance<=u.distance?d:u:d||u||null}}const bt=new a,Mt=new Ye,Dt=new Ye,_t=new f,Ut=new Ge,Bt=new Ge;function Vt(e,t,i,s){$e.setBuffer(e._roots[t]);const n=zt(0,e,i,s);return $e.clearBuffer(),n}function zt(e,t,i,s,n=null){const{float32Array:r,uint16Array:o,uint32Array:a}=$e;let l=2*e;if(null===n&&(i.boundingBox||i.computeBoundingBox(),Ut.set(i.boundingBox.min,i.boundingBox.max,s),n=Ut),!Ze(l,o)){const o=e+8,l=a[e+6];return Re(o,r,bt),!!(n.intersectsBox(bt)&&zt(o,t,i,s,n)||(Re(l,r,bt),n.intersectsBox(bt)&&zt(l,t,i,s,n)))}{const n=t.geometry,c=n.index,h=n.attributes.position,d=i.index,u=i.attributes.position,f=je(e,a),p=Ke(l,o);if(_t.copy(s).invert(),i.boundsTree)return Re(e,r,Bt),Bt.matrix.copy(_t),Bt.needsUpdate=!0,i.boundsTree.shapecast({intersectsBounds:e=>Bt.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(s),e.b.applyMatrix4(s),e.c.applyMatrix4(s),e.needsUpdate=!0;for(let t=3*f,i=3*(p+f);t<i;t+=3)if(Tt(Dt,t,c,h),Dt.needsUpdate=!0,e.intersectsTriangle(Dt))return!0;return!1}});for(let e=3*f,t=3*(p+f);e<t;e+=3){Tt(Mt,e,c,h),Mt.a.applyMatrix4(_t),Mt.b.applyMatrix4(_t),Mt.c.applyMatrix4(_t),Mt.needsUpdate=!0;for(let e=0,t=d.count;e<t;e+=3)if(Tt(Dt,e,d,u),Dt.needsUpdate=!0,Mt.intersectsTriangle(Dt))return!0}}}const kt=new f,Yt=new Ge,Gt=new Ge,Ht=new s,Wt=new s,Xt=new s,Zt=new s;function jt(e,t,i,s={},n={},r=0,o=1/0){t.boundingBox||t.computeBoundingBox(),Yt.set(t.boundingBox.min,t.boundingBox.max,i),Yt.needsUpdate=!0;const a=e.geometry,l=a.attributes.position,c=a.index,h=t.attributes.position,d=t.index,u=Xe.getPrimitive(),f=Xe.getPrimitive();let p=Ht,m=Wt,I=null,E=null;n&&(I=Xt,E=Zt);let g=1/0,C=null,T=null;return kt.copy(i).invert(),Gt.matrix.copy(kt),e.shapecast({boundsTraverseOrder:e=>Yt.distanceToBox(e),intersectsBounds:(e,t,i)=>i<g&&i<o&&(t&&(Gt.min.copy(e.min),Gt.max.copy(e.max),Gt.needsUpdate=!0),!0),intersectsRange:(e,s)=>{if(t.boundsTree)return t.boundsTree.shapecast({boundsTraverseOrder:e=>Gt.distanceToBox(e),intersectsBounds:(e,t,i)=>i<g&&i<o,intersectsRange:(t,n)=>{for(let o=t,a=t+n;o<a;o++){Tt(f,3*o,d,h),f.a.applyMatrix4(i),f.b.applyMatrix4(i),f.c.applyMatrix4(i),f.needsUpdate=!0;for(let t=e,i=e+s;t<i;t++){Tt(u,3*t,c,l),u.needsUpdate=!0;const e=u.distanceToTriangle(f,p,I);if(e<g&&(m.copy(p),E&&E.copy(I),g=e,C=t,T=o),e<r)return!0}}}});for(let n=0,o=Ee(t);n<o;n++){Tt(f,3*n,d,h),f.a.applyMatrix4(i),f.b.applyMatrix4(i),f.c.applyMatrix4(i),f.needsUpdate=!0;for(let t=e,i=e+s;t<i;t++){Tt(u,3*t,c,l),u.needsUpdate=!0;const e=u.distanceToTriangle(f,p,I);if(e<g&&(m.copy(p),E&&E.copy(I),g=e,C=t,T=n),e<r)return!0}}}}),Xe.releasePrimitive(u),Xe.releasePrimitive(f),g===1/0?null:(s.point?s.point.copy(m):s.point=m.clone(),s.distance=g,s.faceIndex=C,n&&(n.point?n.point.copy(E):n.point=E.clone(),n.point.applyMatrix4(kt),m.applyMatrix4(kt),n.distance=m.sub(n.point).length(),n.faceIndex=T),s)}function Kt(e,t=null){t&&Array.isArray(t)&&(t=new Set(t));const i=e.geometry,s=i.index?i.index.array:null,n=i.attributes.position;let r,o,a,l,c=0;const h=e._roots;for(let e=0,t=h.length;e<t;e++)r=h[e],o=new Uint32Array(r),a=new Uint16Array(r),l=new Float32Array(r),d(0,c),c+=r.byteLength;function d(i,r,c=!1){const h=2*i;if(a[h+15]===pe){const t=o[i+6];let r=1/0,c=1/0,d=1/0,u=-1/0,f=-1/0,p=-1/0;for(let i=t,o=t+a[h+14];i<o;i++){const t=3*e.resolveTriangleIndex(i);for(let e=0;e<3;e++){let i=t+e;i=s?s[i]:i;const o=n.getX(i),a=n.getY(i),l=n.getZ(i);o<r&&(r=o),o>u&&(u=o),a<c&&(c=a),a>f&&(f=a),l<d&&(d=l),l>p&&(p=l)}}return(l[i+0]!==r||l[i+1]!==c||l[i+2]!==d||l[i+3]!==u||l[i+4]!==f||l[i+5]!==p)&&(l[i+0]=r,l[i+1]=c,l[i+2]=d,l[i+3]=u,l[i+4]=f,l[i+5]=p,!0)}{const e=i+8,s=o[i+6],n=e+r,a=s+r;let h=c,u=!1,f=!1;t?h||(u=t.has(n),f=t.has(a),h=!u&&!f):(u=!0,f=!0);const p=h||f;let m=!1;(h||u)&&(m=d(e,r,h));let I=!1;p&&(I=d(s,r,h));const E=m||I;if(E)for(let t=0;t<3;t++){const n=e+t,r=s+t,o=l[n],a=l[n+3],c=l[r],h=l[r+3];l[i+t]=o<c?o:c,l[i+t+3]=a>h?a:h}return E}}}const Qt=new s;function qt(e,t,i,s,n){$e.setBuffer(e._roots[t]),Jt(0,e,i,s,n),$e.clearBuffer()}function Jt(e,t,i,s,n){const{float32Array:r,uint16Array:o,uint32Array:a}=$e,l=2*e;if(Ze(l,o)){!function(e,t,i,s,n,r){const{geometry:o,_indirectBuffer:a}=e;for(let e=s,l=s+n;e<l;e++)Ct(o,t,i,a?a[e]:e,r)}(t,i,s,je(e,a),Ke(l,o),n)}else{const o=Qe(e);yt(o,r,s,Qt)&&Jt(o,t,i,s,n);const l=qe(e,a);yt(l,r,s,Qt)&&Jt(l,t,i,s,n)}}const $t=new s,ei=["x","y","z"];function ti(e,t,i,s){$e.setBuffer(e._roots[t]);const n=ii(0,e,i,s);return $e.clearBuffer(),n}function ii(e,t,i,s){const{float32Array:n,uint16Array:r,uint32Array:o}=$e;let a=2*e;if(Ze(a,r)){return function(e,t,i,s,n){const{geometry:r,_indirectBuffer:o}=e;let a=1/0,l=null;for(let e=s,c=s+n;e<c;e++){let s;s=Ct(r,t,i,o?o[e]:e),s&&s.distance<a&&(l=s,a=s.distance)}return l}(t,i,s,je(e,o),Ke(a,r))}{const r=Je(e,o),a=ei[r],l=s.direction[a]>=0;let c,h;l?(c=Qe(e),h=qe(e,o)):(c=qe(e,o),h=Qe(e));const d=yt(c,n,s,$t)?ii(c,t,i,s):null;if(d){const e=d.point[a];if(l?e<=n[h+r]:e>=n[h+r+3])return d}const u=yt(h,n,s,$t)?ii(h,t,i,s):null;return d&&u?d.distance<=u.distance?d:u:d||u||null}}const si=new a,ni=new Ye,ri=new Ye,oi=new f,ai=new Ge,li=new Ge;function ci(e,t,i,s){$e.setBuffer(e._roots[t]);const n=hi(0,e,i,s);return $e.clearBuffer(),n}function hi(e,t,i,s,n=null){const{float32Array:r,uint16Array:o,uint32Array:a}=$e;let l=2*e;if(null===n&&(i.boundingBox||i.computeBoundingBox(),ai.set(i.boundingBox.min,i.boundingBox.max,s),n=ai),!Ze(l,o)){const o=e+8,l=a[e+6];return Re(o,r,si),!!(n.intersectsBox(si)&&hi(o,t,i,s,n)||(Re(l,r,si),n.intersectsBox(si)&&hi(l,t,i,s,n)))}{const n=t.geometry,c=n.index,h=n.attributes.position,d=i.index,u=i.attributes.position,f=je(e,a),p=Ke(l,o);if(oi.copy(s).invert(),i.boundsTree)return Re(e,r,li),li.matrix.copy(oi),li.needsUpdate=!0,i.boundsTree.shapecast({intersectsBounds:e=>li.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(s),e.b.applyMatrix4(s),e.c.applyMatrix4(s),e.needsUpdate=!0;for(let i=f,s=p+f;i<s;i++)if(Tt(ri,3*t.resolveTriangleIndex(i),c,h),ri.needsUpdate=!0,e.intersectsTriangle(ri))return!0;return!1}});for(let e=f,i=p+f;e<i;e++){const i=t.resolveTriangleIndex(e);Tt(ni,3*i,c,h),ni.a.applyMatrix4(oi),ni.b.applyMatrix4(oi),ni.c.applyMatrix4(oi),ni.needsUpdate=!0;for(let e=0,t=d.count;e<t;e+=3)if(Tt(ri,e,d,u),ri.needsUpdate=!0,ni.intersectsTriangle(ri))return!0}}}const di=new f,ui=new Ge,fi=new Ge,pi=new s,mi=new s,Ii=new s,Ei=new s;function gi(e,t,i,s={},n={},r=0,o=1/0){t.boundingBox||t.computeBoundingBox(),ui.set(t.boundingBox.min,t.boundingBox.max,i),ui.needsUpdate=!0;const a=e.geometry,l=a.attributes.position,c=a.index,h=t.attributes.position,d=t.index,u=Xe.getPrimitive(),f=Xe.getPrimitive();let p=pi,m=mi,I=null,E=null;n&&(I=Ii,E=Ei);let g=1/0,C=null,T=null;return di.copy(i).invert(),fi.matrix.copy(di),e.shapecast({boundsTraverseOrder:e=>ui.distanceToBox(e),intersectsBounds:(e,t,i)=>i<g&&i<o&&(t&&(fi.min.copy(e.min),fi.max.copy(e.max),fi.needsUpdate=!0),!0),intersectsRange:(s,n)=>{if(t.boundsTree){const a=t.boundsTree;return a.shapecast({boundsTraverseOrder:e=>fi.distanceToBox(e),intersectsBounds:(e,t,i)=>i<g&&i<o,intersectsRange:(t,o)=>{for(let R=t,v=t+o;R<v;R++){const t=a.resolveTriangleIndex(R);Tt(f,3*t,d,h),f.a.applyMatrix4(i),f.b.applyMatrix4(i),f.c.applyMatrix4(i),f.needsUpdate=!0;for(let t=s,i=s+n;t<i;t++){const i=e.resolveTriangleIndex(t);Tt(u,3*i,c,l),u.needsUpdate=!0;const s=u.distanceToTriangle(f,p,I);if(s<g&&(m.copy(p),E&&E.copy(I),g=s,C=t,T=R),s<r)return!0}}}})}for(let o=0,a=Ee(t);o<a;o++){Tt(f,3*o,d,h),f.a.applyMatrix4(i),f.b.applyMatrix4(i),f.c.applyMatrix4(i),f.needsUpdate=!0;for(let t=s,i=s+n;t<i;t++){const i=e.resolveTriangleIndex(t);Tt(u,3*i,c,l),u.needsUpdate=!0;const s=u.distanceToTriangle(f,p,I);if(s<g&&(m.copy(p),E&&E.copy(I),g=s,C=t,T=o),s<r)return!0}}}}),Xe.releasePrimitive(u),Xe.releasePrimitive(f),g===1/0?null:(s.point?s.point.copy(m):s.point=m.clone(),s.distance=g,s.faceIndex=C,n&&(n.point?n.point.copy(E):n.point=E.clone(),n.point.applyMatrix4(di),m.applyMatrix4(di),n.distance=m.sub(n.point).length(),n.faceIndex=T),s)}const Ci=new $e.constructor,Ti=new $e.constructor,Ri=new He((()=>new a)),vi=new a,Si=new a,yi=new a,wi=new a;let Ai=!1;function Fi(e,t,i,s,n,r=0,o=0,a=0,l=0,c=null,h=!1){let d,u;h?(d=Ti,u=Ci):(d=Ci,u=Ti);const f=d.float32Array,p=d.uint32Array,m=d.uint16Array,I=u.float32Array,E=u.uint32Array,g=u.uint16Array,C=2*t,T=Ze(2*e,m),R=Ze(C,g);let v=!1;if(R&&T)v=h?n(je(t,E),Ke(2*t,g),je(e,p),Ke(2*e,m),l,o+t,a,r+e):n(je(e,p),Ke(2*e,m),je(t,E),Ke(2*t,g),a,r+e,l,o+t);else if(R){const c=Ri.getPrimitive();Re(t,I,c),c.applyMatrix4(i);const d=Qe(e),u=qe(e,p);Re(d,f,vi),Re(u,f,Si);const m=c.intersectsBox(vi),E=c.intersectsBox(Si);v=m&&Fi(t,d,s,i,n,o,r,l,a+1,c,!h)||E&&Fi(t,u,s,i,n,o,r,l,a+1,c,!h),Ri.releasePrimitive(c)}else{const d=Qe(t),u=qe(t,E);Re(d,I,yi),Re(u,I,wi);const m=c.intersectsBox(yi),g=c.intersectsBox(wi);if(m&&g)v=Fi(e,d,i,s,n,r,o,a,l+1,c,h)||Fi(e,u,i,s,n,r,o,a,l+1,c,h);else if(m)if(T)v=Fi(e,d,i,s,n,r,o,a,l+1,c,h);else{const t=Ri.getPrimitive();t.copy(yi).applyMatrix4(i);const c=Qe(e),u=qe(e,p);Re(c,f,vi),Re(u,f,Si);const m=t.intersectsBox(vi),I=t.intersectsBox(Si);v=m&&Fi(d,c,s,i,n,o,r,l,a+1,t,!h)||I&&Fi(d,u,s,i,n,o,r,l,a+1,t,!h),Ri.releasePrimitive(t)}else if(g)if(T)v=Fi(e,u,i,s,n,r,o,a,l+1,c,h);else{const t=Ri.getPrimitive();t.copy(wi).applyMatrix4(i);const c=Qe(e),d=qe(e,p);Re(c,f,vi),Re(d,f,Si);const m=t.intersectsBox(vi),I=t.intersectsBox(Si);v=m&&Fi(u,c,s,i,n,o,r,l,a+1,t,!h)||I&&Fi(u,d,s,i,n,o,r,l,a+1,t,!h),Ri.releasePrimitive(t)}}return v}const Oi=new Ge,Ni=new a;class Pi{static serialize(e,t={}){t={cloneBuffers:!0,...t};const i=e.geometry,s=e._roots,n=e._indirectBuffer,r=i.getIndex();let o;return o=t.cloneBuffers?{roots:s.map((e=>e.slice())),index:r.array.slice(),indirectBuffer:n?n.slice():null}:{roots:s,index:r.array,indirectBuffer:n},o}static deserialize(e,t,i={}){i={setIndex:!0,indirect:!!e.indirectBuffer,...i};const{index:s,roots:n,indirectBuffer:r}=e,o=new Pi(t,{...i,[Ie]:!0});if(o._roots=n,o._indirectBuffer=r||null,i.setIndex){const i=t.getIndex();if(null===i){const i=new O(e.index,1,!1);t.setIndex(i)}else i.array!==s&&(i.array.set(s),i.needsUpdate=!0)}return o}get indirect(){return!!this._indirectBuffer}constructor(e,t={}){if(!e.isBufferGeometry)throw new Error("MeshBVH: Only BufferGeometries are supported.");if(e.index&&e.index.isInterleavedBufferAttribute)throw new Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.");if((t=Object.assign({strategy:0,maxDepth:40,maxLeafTris:10,verbose:!0,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,[Ie]:!1},t)).useSharedArrayBuffer&&!(typeof SharedArrayBuffer<"u"))throw new Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,t[Ie]||(_e(this,t),!e.boundingBox&&t.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new a)));const{_indirectBuffer:i}=this;this.resolveTriangleIndex=t.indirect?e=>i[e]:e=>e}refit(e=null){return(this.indirect?Kt:vt)(this,e)}traverse(e,t=0){const i=this._roots[t],s=new Uint32Array(i),n=new Uint16Array(i);!function t(r,o=0){const a=2*r,l=n[a+15]===pe;if(l){const t=s[r+6],c=n[a+14];e(o,l,new Float32Array(i,4*r,6),t,c)}else{const n=r+8,a=s[r+6],c=s[r+7];e(o,l,new Float32Array(i,4*r,6),c)||(t(n,o+1),t(a,o+1))}}(0)}raycast(e,t=N){const i=this._roots,s=this.geometry,n=[],r=t.isMaterial,o=Array.isArray(t),a=s.groups,l=r?t.side:t,c=this.indirect?qt:Ft;for(let s=0,r=i.length;s<r;s++){const i=o?t[a[s].materialIndex].side:l,r=n.length;if(c(this,s,i,e,n),o){const e=a[s].materialIndex;for(let t=r,i=n.length;t<i;t++)n[t].face.materialIndex=e}}return n}raycastFirst(e,t=N){const i=this._roots,s=this.geometry,n=t.isMaterial,r=Array.isArray(t);let o=null;const a=s.groups,l=n?t.side:t,c=this.indirect?ti:xt;for(let s=0,n=i.length;s<n;s++){const i=c(this,s,r?t[a[s].materialIndex].side:l,e);null!=i&&(null==o||i.distance<o.distance)&&(o=i,r&&(i.face.materialIndex=a[s].materialIndex))}return o}intersectsGeometry(e,t){let i=!1;const s=this._roots,n=this.indirect?ci:Vt;for(let r=0,o=s.length;r<o&&(i=n(this,r,e,t),!i);r++);return i}shapecast(e){const t=Xe.getPrimitive(),i=this.indirect?wt:Rt;let{boundsTraverseOrder:s,intersectsBounds:n,intersectsRange:r,intersectsTriangle:o}=e;if(r&&o){const e=r;r=(s,n,r,a,l)=>!!e(s,n,r,a,l)||i(s,n,this,o,r,a,t)}else r||(r=o?(e,s,n,r)=>i(e,s,this,o,n,r,t):(e,t,i)=>i);let a=!1,l=0;const c=this._roots;for(let e=0,t=c.length;e<t;e++){const t=c[e];if(a=nt(this,e,n,r,s,l),a)break;l+=t.byteLength}return Xe.releasePrimitive(t),a}bvhcast(e,t,i){let{intersectsRanges:s,intersectsTriangles:n}=i;const r=Xe.getPrimitive(),o=this.geometry.index,a=this.geometry.attributes.position,l=this.indirect?e=>{const t=this.resolveTriangleIndex(e);Tt(r,3*t,o,a)}:e=>{Tt(r,3*e,o,a)},c=Xe.getPrimitive(),h=e.geometry.index,d=e.geometry.attributes.position,u=e.indirect?t=>{const i=e.resolveTriangleIndex(t);Tt(c,3*i,h,d)}:e=>{Tt(c,3*e,h,d)};if(n){const e=(e,i,s,o,a,h,d,f)=>{for(let p=s,m=s+o;p<m;p++){u(p),c.a.applyMatrix4(t),c.b.applyMatrix4(t),c.c.applyMatrix4(t),c.needsUpdate=!0;for(let t=e,s=e+i;t<s;t++)if(l(t),r.needsUpdate=!0,n(r,c,t,p,a,h,d,f))return!0}return!1};if(s){const t=s;s=function(i,s,n,r,o,a,l,c){return!!t(i,s,n,r,o,a,l,c)||e(i,s,n,r,o,a,l,c)}}else s=e}return function(e,t,i,s){if(Ai)throw new Error("MeshBVH: Recursive calls to bvhcast not supported.");Ai=!0;const n=e._roots,r=t._roots;let o,a=0,l=0;const c=(new f).copy(i).invert();for(let e=0,t=n.length;e<t;e++){Ci.setBuffer(n[e]),l=0;const t=Ri.getPrimitive();Re(0,Ci.float32Array,t),t.applyMatrix4(c);for(let n=0,h=r.length;n<h&&(Ti.setBuffer(r[e]),o=Fi(0,0,i,c,s,a,l,0,0,t),Ti.clearBuffer(),l+=r[n].length,!o);n++);if(Ri.releasePrimitive(t),Ci.clearBuffer(),a+=n[e].length,o)break}return Ai=!1,o}(this,e,t,s)}intersectsBox(e,t){return Oi.set(e.min,e.max,t),Oi.needsUpdate=!0,this.shapecast({intersectsBounds:e=>Oi.intersectsBox(e),intersectsTriangle:e=>Oi.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:t=>e.intersectsBox(t),intersectsTriangle:t=>t.intersectsSphere(e)})}closestPointToGeometry(e,t,i={},s={},n=0,r=1/0){return(this.indirect?gi:jt)(this,e,t,i,s,n,r)}closestPointToPoint(e,t={},i=0,s=1/0){return function(e,t,i={},s=0,n=1/0){const r=s*s,o=n*n;let a=1/0,l=null;if(e.shapecast({boundsTraverseOrder:e=>(ot.copy(t).clamp(e.min,e.max),ot.distanceToSquared(t)),intersectsBounds:(e,t,i)=>i<a&&i<o,intersectsTriangle:(e,i)=>{e.closestPointToPoint(t,ot);const s=t.distanceToSquared(ot);return s<a&&(at.copy(ot),a=s,l=i),s<r}}),a===1/0)return null;const c=Math.sqrt(a);return i.point?i.point.copy(at):i.point=at.clone(),i.distance=c,i.faceIndex=l,i}(this,e,t,i,s)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach((t=>{Re(0,new Float32Array(t),Ni),e.union(Ni)})),e}}function xi(e,t,i){return null===e||(e.point.applyMatrix4(t.matrixWorld),e.distance=e.point.distanceTo(i.ray.origin),e.object=t,e.distance<i.near||e.distance>i.far)?null:e}const Li=new P,bi=new f,Mi=l.prototype.raycast;function Di(e,t){if(this.geometry.boundsTree){if(void 0===this.material)return;bi.copy(this.matrixWorld).invert(),Li.copy(e.ray).applyMatrix4(bi);const i=this.geometry.boundsTree;if(!0===e.firstHitOnly){const s=xi(i.raycastFirst(Li,this.material),this,e);s&&t.push(s)}else{const s=i.raycast(Li,this.material);for(let i=0,n=s.length;i<n;i++){const n=xi(s[i],this,e);n&&t.push(n)}}}else Mi.call(this,e,t)}function _i(e){return this.boundsTree=new Pi(this,e),this.boundsTree}function Ui(){this.boundsTree=null}let Bi=class{constructor(){ue(this,"enabled",!0),ue(this,"trigger",(e=>{if(!this.enabled)return;const t=this.handlers.slice(0);for(const i of t)i(e)})),ue(this,"handlers",[])}add(e){this.handlers.push(e)}remove(e){this.handlers=this.handlers.filter((t=>t!==e))}reset(){this.handlers.length=0}};class Vi{constructor(){ue(this,"enabled",!0),ue(this,"trigger",(async e=>{if(!this.enabled)return;const t=this.handlers.slice(0);for(const i of t)await i(e)})),ue(this,"handlers",[])}add(e){this.handlers.push(e)}remove(e){this.handlers=this.handlers.filter((t=>t!==e))}reset(){this.handlers.length=0}}class zi{constructor(e){ue(this,"isDisposeable",(()=>"dispose"in this&&"onDisposed"in this)),ue(this,"isResizeable",(()=>"resize"in this&&"getSize"in this)),ue(this,"isUpdateable",(()=>"onAfterUpdate"in this&&"onBeforeUpdate"in this&&"update"in this)),ue(this,"isHideable",(()=>"visible"in this)),ue(this,"isConfigurable",(()=>"setup"in this&&"config"in this&&"onSetup"in this)),this.components=e}}class ki extends zi{}class Yi extends zi{constructor(e){super(e),ue(this,"worlds",new Map),ue(this,"onWorldChanged",new Bi),ue(this,"currentWorld",null),this.onWorldChanged.add((({world:e,action:t})=>{"removed"===t&&this.worlds.delete(e.uuid)}))}}class Gi extends Yi{constructor(){super(...arguments),ue(this,"hasCameraControls",(()=>"controls"in this))}}class Hi extends Yi{constructor(){super(...arguments),ue(this,"onAfterUpdate",new Bi),ue(this,"onBeforeUpdate",new Bi),ue(this,"onDisposed",new Bi),ue(this,"onResize",new Bi),ue(this,"onClippingPlanesUpdated",new Bi),ue(this,"clippingPlanes",[])}updateClippingPlanes(){this.onClippingPlanesUpdated.trigger()}setPlane(e,t,i){t.isLocal=i;const s=this.clippingPlanes.indexOf(t);e&&-1===s?this.clippingPlanes.push(t):!e&&s>-1&&this.clippingPlanes.splice(s,1),this.three.clippingPlanes=this.clippingPlanes.filter((e=>!e.isLocal))}}const Wi=class e extends ki{constructor(t){super(t),ue(this,"_disposedComponents",new Set),ue(this,"enabled",!0),t.add(e.uuid,this)}get(){return this._disposedComponents}destroy(e,t=!0,i=!0){e.removeFromParent();const s=e;s.dispose&&s.dispose(),this.disposeGeometryAndMaterials(e,t),i&&s.children&&s.children.length&&this.disposeChildren(s),e.children.length=0}disposeGeometry(e){e.boundsTree&&e.disposeBoundsTree&&e.disposeBoundsTree(),e.dispose()}disposeGeometryAndMaterials(t,i){const s=t;s.geometry&&this.disposeGeometry(s.geometry),i&&s.material&&e.disposeMaterial(s),s.material=[],s.geometry=null}disposeChildren(e){for(const t of e.children)this.destroy(t)}static disposeMaterial(e){if(e.material)if(Array.isArray(e.material))for(const t of e.material)t.dispose();else e.material.dispose()}};ue(Wi,"uuid","76e9cd8e-ad8f-4753-9ef6-cbc60f7247fe");let Xi=Wi;class Zi extends Set{constructor(e){super(e),ue(this,"onItemAdded",new Bi),ue(this,"onItemDeleted",new Bi),ue(this,"onCleared",new Bi),ue(this,"guard",(()=>!0))}clear(){super.clear(),this.onCleared.trigger()}add(...e){for(const t of e)this.has(t)||!this.guard(t)||(super.add(t),this.onItemAdded||(this.onItemAdded=new Bi),this.onItemAdded.trigger(t));return this}delete(e){const t=super.delete(e);return t&&this.onItemDeleted.trigger(),t}dispose(){this.clear(),this.onItemAdded.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}}class ji extends Map{constructor(e){super(e),ue(this,"onItemSet",new Bi),ue(this,"onItemUpdated",new Bi),ue(this,"onItemDeleted",new Bi),ue(this,"onCleared",new Bi),ue(this,"guard",(()=>!0))}clear(){super.clear(),this.onCleared.trigger()}set(e,t){const i=this.has(e);if(!(this.guard??(()=>!0))(e,t))return this;const s=super.set(e,t);return i?(this.onItemUpdated||(this.onItemUpdated=new Bi),this.onItemUpdated.trigger({key:e,value:t})):(this.onItemSet||(this.onItemSet=new Bi),this.onItemSet.trigger({key:e,value:t})),s}delete(e){const t=super.delete(e);return t&&this.onItemDeleted.trigger(e),t}dispose(){this.clear(),this.onItemSet.reset(),this.onItemDeleted.reset(),this.onCleared.reset()}}class Ki{static isEntry(e){return new Set(["Boolean","Color","Text","Number","Select","Vector3","TextSet","None"]).has(e.type)}static copySchema(e,t={}){for(const i in e){const s=e[i];this.isEntry(s)?t[i]=this.copyEntry(s):(t[i]={},this.copySchema(s,t[i]))}return t}static copyEntry(e){if("Boolean"===e.type){const t=e;return{type:t.type,value:t.value}}if("Color"===e.type){const t=e;return{type:t.type,value:t.value.clone()}}if("Text"===e.type){const t=e;return{type:t.type,value:t.value}}if("Number"===e.type){const t=e;return{type:t.type,value:t.value,min:t.min,max:t.max,interpolable:t.interpolable}}if("Select"===e.type){const t=e;return{type:t.type,value:t.value,multiple:t.multiple,options:new Set(t.options)}}if("Vector3"===e.type){const t=e;return{type:t.type,value:t.value.clone()}}if("TextSet"===e.type){const t=e;return{type:t.type,value:new Set(t.value)}}if("None"===e.type){const t=e;return{type:t.type,value:t.value}}throw new Error("Invalid entry!")}}class Qi{constructor(){ue(this,"list",new Set)}add(e){for(const t of e)this.list.add(t)}remove(e){for(const t of e)this.list.delete(t)}set(e){for(const t of this.list)t.enabled=e}reset(){for(const e of this.list)e.reset()}}const qi=new s,Ji=new o,$i=new r,es=new s,ts=new c;class is{constructor(){this.tolerance=-1,this.faces=[],this.newFaces=[],this.assigned=new os,this.unassigned=new os,this.vertices=[]}setFromPoints(e){if(e.length>=4){this.makeEmpty();for(let t=0,i=e.length;t<i;t++)this.vertices.push(new rs(e[t]));this.compute()}return this}setFromObject(e){const t=[];return e.updateMatrixWorld(!0),e.traverse((function(e){const i=e.geometry;if(void 0!==i){const n=i.attributes.position;if(void 0!==n)for(let i=0,r=n.count;i<r;i++){const r=new s;r.fromBufferAttribute(n,i).applyMatrix4(e.matrixWorld),t.push(r)}}})),this.setFromPoints(t)}containsPoint(e){const t=this.faces;for(let i=0,s=t.length;i<s;i++)if(t[i].distanceToPoint(e)>this.tolerance)return!1;return!0}intersectRay(e,t){const i=this.faces;let s=-1/0,n=1/0;for(let t=0,r=i.length;t<r;t++){const r=i[t],o=r.distanceToPoint(e.origin),a=r.normal.dot(e.direction);if(o>0&&a>=0)return null;const l=0!==a?-o/a:0;if(!(l<=0)&&(a>0?n=Math.min(l,n):s=Math.max(l,s),s>n))return null}return s!==-1/0?e.at(s,t):e.at(n,t),t}intersectsRay(e){return null!==this.intersectRay(e,qi)}makeEmpty(){return this.faces=[],this.vertices=[],this}addVertexToFace(e,t){return e.face=t,null===t.outside?this.assigned.append(e):this.assigned.insertBefore(t.outside,e),t.outside=e,this}removeVertexFromFace(e,t){return e===t.outside&&(null!==e.next&&e.next.face===t?t.outside=e.next:t.outside=null),this.assigned.remove(e),this}removeAllVerticesFromFace(e){if(null!==e.outside){const t=e.outside;let i=e.outside;for(;null!==i.next&&i.next.face===e;)i=i.next;return this.assigned.removeSubList(t,i),t.prev=i.next=null,e.outside=null,t}}deleteFaceVertices(e,t){const i=this.removeAllVerticesFromFace(e);if(void 0!==i)if(void 0===t)this.unassigned.appendChain(i);else{let e=i;do{const i=e.next;t.distanceToPoint(e.point)>this.tolerance?this.addVertexToFace(e,t):this.unassigned.append(e),e=i}while(null!==e)}return this}resolveUnassignedPoints(e){if(!1===this.unassigned.isEmpty()){let t=this.unassigned.first();do{const i=t.next;let s=this.tolerance,n=null;for(let i=0;i<e.length;i++){const r=e[i];if(0===r.mark){const e=r.distanceToPoint(t.point);if(e>s&&(s=e,n=r),s>1e3*this.tolerance)break}}null!==n&&this.addVertexToFace(t,n),t=i}while(null!==t)}return this}computeExtremes(){const e=new s,t=new s,i=[],n=[];for(let e=0;e<3;e++)i[e]=n[e]=this.vertices[0];e.copy(this.vertices[0].point),t.copy(this.vertices[0].point);for(let s=0,r=this.vertices.length;s<r;s++){const r=this.vertices[s],o=r.point;for(let t=0;t<3;t++)o.getComponent(t)<e.getComponent(t)&&(e.setComponent(t,o.getComponent(t)),i[t]=r);for(let e=0;e<3;e++)o.getComponent(e)>t.getComponent(e)&&(t.setComponent(e,o.getComponent(e)),n[e]=r)}return this.tolerance=3*Number.EPSILON*(Math.max(Math.abs(e.x),Math.abs(t.x))+Math.max(Math.abs(e.y),Math.abs(t.y))+Math.max(Math.abs(e.z),Math.abs(t.z))),{min:i,max:n}}computeInitialHull(){const e=this.vertices,t=this.computeExtremes(),i=t.min,s=t.max;let n=0,r=0;for(let e=0;e<3;e++){const t=s[e].point.getComponent(e)-i[e].point.getComponent(e);t>n&&(n=t,r=e)}const o=i[r],a=s[r];let l,c;n=0,Ji.set(o.point,a.point);for(let t=0,i=this.vertices.length;t<i;t++){const i=e[t];if(i!==o&&i!==a){Ji.closestPointToPoint(i.point,!0,es);const e=es.distanceToSquared(i.point);e>n&&(n=e,l=i)}}n=-1,$i.setFromCoplanarPoints(o.point,a.point,l.point);for(let t=0,i=this.vertices.length;t<i;t++){const i=e[t];if(i!==o&&i!==a&&i!==l){const e=Math.abs($i.distanceToPoint(i.point));e>n&&(n=e,c=i)}}const h=[];if($i.distanceToPoint(c.point)<0){h.push(ss.create(o,a,l),ss.create(c,a,o),ss.create(c,l,a),ss.create(c,o,l));for(let e=0;e<3;e++){const t=(e+1)%3;h[e+1].getEdge(2).setTwin(h[0].getEdge(t)),h[e+1].getEdge(1).setTwin(h[t+1].getEdge(0))}}else{h.push(ss.create(o,l,a),ss.create(c,o,a),ss.create(c,a,l),ss.create(c,l,o));for(let e=0;e<3;e++){const t=(e+1)%3;h[e+1].getEdge(2).setTwin(h[0].getEdge((3-e)%3)),h[e+1].getEdge(0).setTwin(h[t+1].getEdge(1))}}for(let e=0;e<4;e++)this.faces.push(h[e]);for(let t=0,i=e.length;t<i;t++){const i=e[t];if(i!==o&&i!==a&&i!==l&&i!==c){n=this.tolerance;let e=null;for(let t=0;t<4;t++){const s=this.faces[t].distanceToPoint(i.point);s>n&&(n=s,e=this.faces[t])}null!==e&&this.addVertexToFace(i,e)}}return this}reindexFaces(){const e=[];for(let t=0;t<this.faces.length;t++){const i=this.faces[t];0===i.mark&&e.push(i)}return this.faces=e,this}nextVertexToAdd(){if(!1===this.assigned.isEmpty()){let e,t=0;const i=this.assigned.first().face;let s=i.outside;do{const n=i.distanceToPoint(s.point);n>t&&(t=n,e=s),s=s.next}while(null!==s&&s.face===i);return e}}computeHorizon(e,t,i,s){let n;this.deleteFaceVertices(i),i.mark=1,n=null===t?t=i.getEdge(0):t.next;do{const t=n.twin,i=t.face;0===i.mark&&(i.distanceToPoint(e)>this.tolerance?this.computeHorizon(e,t,i,s):s.push(n)),n=n.next}while(n!==t);return this}addAdjoiningFace(e,t){const i=ss.create(e,t.tail(),t.head());return this.faces.push(i),i.getEdge(-1).setTwin(t.twin),i.getEdge(0)}addNewFaces(e,t){this.newFaces=[];let i=null,s=null;for(let n=0;n<t.length;n++){const r=t[n],o=this.addAdjoiningFace(e,r);null===i?i=o:o.next.setTwin(s),this.newFaces.push(o.face),s=o}return i.next.setTwin(s),this}addVertexToHull(e){const t=[];return this.unassigned.clear(),this.removeVertexFromFace(e,e.face),this.computeHorizon(e.point,null,e.face,t),this.addNewFaces(e,t),this.resolveUnassignedPoints(this.newFaces),this}cleanup(){return this.assigned.clear(),this.unassigned.clear(),this.newFaces=[],this}compute(){let e;for(this.computeInitialHull();void 0!==(e=this.nextVertexToAdd());)this.addVertexToHull(e);return this.reindexFaces(),this.cleanup(),this}}class ss{constructor(){this.normal=new s,this.midpoint=new s,this.area=0,this.constant=0,this.outside=null,this.mark=0,this.edge=null}static create(e,t,i){const s=new ss,n=new ns(e,s),r=new ns(t,s),o=new ns(i,s);return n.next=o.prev=r,r.next=n.prev=o,o.next=r.prev=n,s.edge=n,s.compute()}getEdge(e){let t=this.edge;for(;e>0;)t=t.next,e--;for(;e<0;)t=t.prev,e++;return t}compute(){const e=this.edge.tail(),t=this.edge.head(),i=this.edge.next.head();return ts.set(e.point,t.point,i.point),ts.getNormal(this.normal),ts.getMidpoint(this.midpoint),this.area=ts.getArea(),this.constant=this.normal.dot(this.midpoint),this}distanceToPoint(e){return this.normal.dot(e)-this.constant}}class ns{constructor(e,t){this.vertex=e,this.prev=null,this.next=null,this.twin=null,this.face=t}head(){return this.vertex}tail(){return this.prev?this.prev.vertex:null}length(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceTo(e.point):-1}lengthSquared(){const e=this.head(),t=this.tail();return null!==t?t.point.distanceToSquared(e.point):-1}setTwin(e){return this.twin=e,e.twin=this,this}}class rs{constructor(e){this.point=e,this.prev=null,this.next=null,this.face=null}}class os{constructor(){this.head=null,this.tail=null}first(){return this.head}last(){return this.tail}clear(){return this.head=this.tail=null,this}insertBefore(e,t){return t.prev=e.prev,t.next=e,null===t.prev?this.head=t:t.prev.next=t,e.prev=t,this}insertAfter(e,t){return t.prev=e,t.next=e.next,null===t.next?this.tail=t:t.next.prev=t,e.next=t,this}append(e){return null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail,e.next=null,this.tail=e,this}appendChain(e){for(null===this.head?this.head=e:this.tail.next=e,e.prev=this.tail;null!==e.next;)e=e.next;return this.tail=e,this}remove(e){return null===e.prev?this.head=e.next:e.prev.next=e.next,null===e.next?this.tail=e.prev:e.next.prev=e.prev,this}removeSubList(e,t){return null===e.prev?this.head=t.next:e.prev.next=t.next,null===t.next?this.tail=e.prev:t.next.prev=e.prev,this}isEmpty(){return null===this.head}}const as=[2,2,1],ls=[1,0,0];function cs(e,t){return 3*e+t}function hs(e){const t=e.elements;let i=0;for(let e=0;e<3;e++){const s=t[cs(as[e],ls[e])];i+=2*s*s}return Math.sqrt(i)}function ds(e,t){let i=0,s=1;const n=e.elements;for(let e=0;e<3;e++){const t=Math.abs(n[cs(as[e],ls[e])]);t>i&&(i=t,s=e)}let r=1,o=0;const a=ls[s],l=as[s];if(Math.abs(n[cs(l,a)])>Number.EPSILON){const e=(n[cs(l,l)]-n[cs(a,a)])/2/n[cs(l,a)];let t;t=e<0?-1/(-e+Math.sqrt(1+e*e)):1/(e+Math.sqrt(1+e*e)),r=1/Math.sqrt(1+t*t),o=t*r}return t.identity(),t.elements[cs(a,a)]=r,t.elements[cs(l,l)]=r,t.elements[cs(l,a)]=o,t.elements[cs(a,l)]=-o,t}function us(e,t){let s=0,n=0;t.unitary.identity(),t.diagonal.copy(e);const r=t.unitary,o=t.diagonal,a=new i.Matrix3,l=new i.Matrix3,c=Number.EPSILON*function(e){const t=e.elements;let i=0;for(let e=0;e<9;e++)i+=t[e]*t[e];return Math.sqrt(i)}(o);for(;n<10&&hs(o)>c;)ds(o,a),l.copy(a).transpose(),o.multiply(a),o.premultiply(l),r.multiply(a),++s>2&&(n++,s=0);return t}function fs(e){const t=[];for(let s=0;s<e.length-2;s+=3){const n=e[s],r=e[s+1],o=e[s+2];t.push(new i.Vector3(n,r,o))}const s=new is;s.setFromPoints(t);const n={unitary:new i.Matrix3,diagonal:new i.Matrix3},r=s.faces,o=[],a=[];for(let e=0,t=r.length;e<t;e++){const t=r[e];let i=t.edge;o.length=0;do{o.push(i),i=i.next}while(i!==t.edge);for(let e=1,t=o.length-2;e<=t;e++){const t=o[0].vertex,i=o[e+0].vertex,s=o[e+1].vertex;a.push(t.point.x,t.point.y,t.point.z),a.push(i.point.x,i.point.y,i.point.z),a.push(s.point.x,s.point.y,s.point.z)}}const l=new i.Vector3,c=new i.Vector3,h=new i.Vector3,d=new i.Vector3,u=new i.Vector3,f=new i.Vector3,p=new i.Vector3,m=new i.Vector3;let I=0,E=0,g=0,C=0,T=0,R=0,v=0;for(let e=0,t=a.length;e<t;e+=9){l.fromArray(a,e),c.fromArray(a,e+3),h.fromArray(a,e+6),p.set(0,0,0),p.add(l).add(c).add(h).divideScalar(3),d.subVectors(c,l),u.subVectors(h,l);const t=f.crossVectors(d,u).length()/2;m.add(f.copy(p).multiplyScalar(t)),I+=t,E+=(9*p.x*p.x+l.x*l.x+c.x*c.x+h.x*h.x)*(t/12),g+=(9*p.x*p.y+l.x*l.y+c.x*c.y+h.x*h.y)*(t/12),C+=(9*p.x*p.z+l.x*l.z+c.x*c.z+h.x*h.z)*(t/12),T+=(9*p.y*p.y+l.y*l.y+c.y*c.y+h.y*h.y)*(t/12),R+=(9*p.y*p.z+l.y*l.z+c.y*c.z+h.y*h.z)*(t/12),v+=(9*p.z*p.z+l.z*l.z+c.z*c.z+h.z*h.z)*(t/12)}m.divideScalar(I),E/=I,g/=I,C/=I,T/=I,R/=I,v/=I,E-=m.x*m.x,g-=m.x*m.y,C-=m.x*m.z,T-=m.y*m.y,R-=m.y*m.z,v-=m.z*m.z;const S=new i.Matrix3;S.elements[0]=E,S.elements[1]=g,S.elements[2]=C,S.elements[3]=g,S.elements[4]=T,S.elements[5]=R,S.elements[6]=C,S.elements[7]=R,S.elements[8]=v,us(S,n);const y=n.unitary,w=new i.Vector3,A=new i.Vector3,F=new i.Vector3;y.extractBasis(w,A,F);let O=-1/0,N=-1/0,P=-1/0,x=1/0,L=1/0,b=1/0;for(let e=0,i=t.length;e<i;e++){const i=t[e];O=Math.max(w.dot(i),O),N=Math.max(A.dot(i),N),P=Math.max(F.dot(i),P),x=Math.min(w.dot(i),x),L=Math.min(A.dot(i),L),b=Math.min(F.dot(i),b)}w.multiplyScalar(.5*(x+O)),A.multiplyScalar(.5*(L+N)),F.multiplyScalar(.5*(b+P));const M=new i.Vector3,D=new i.Vector3,_=new i.Matrix3;M.add(w).add(A).add(F),D.x=O-x,D.y=N-L,D.z=P-b,D.multiplyScalar(.5),_.copy(y);const{x:U,y:B,z:V}=D,z=new i.Matrix4;z.makeScale(2*U,2*B,2*V);const k=new i.Matrix4;k.makeTranslation(-U,-B,-V);const Y=new i.Matrix4;Y.makeTranslation(M.x,M.y,M.z);const G=new i.Matrix4;G.setFromMatrix3(_);const H=new i.Matrix4;return H.multiply(Y),H.multiply(G),H.multiply(k),H.multiply(z),{center:M,halfSizes:D,rotation:_,transformation:H}}class ps{static isTransparent(e){return e.transparent&&e.opacity<1}}const ms=class e{static create(){const t=4294967295*Math.random()|0,i=4294967295*Math.random()|0,s=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return`${e._lut[255&t]+e._lut[t>>8&255]+e._lut[t>>16&255]+e._lut[t>>24&255]}-${e._lut[255&i]}${e._lut[i>>8&255]}-${e._lut[i>>16&15|64]}${e._lut[i>>24&255]}-${e._lut[63&s|128]}${e._lut[s>>8&255]}-${e._lut[s>>16&255]}${e._lut[s>>24&255]}${e._lut[255&n]}${e._lut[n>>8&255]}${e._lut[n>>16&255]}${e._lut[n>>24&255]}`.toLowerCase()}static validate(t){if(!e._pattern.test(t))throw new Error(`${t} is not a valid UUID v4.\n\n- If you're the tool creator, you can take one from https://www.uuidgenerator.net/.\n\n- If you're using a platform tool, verify the uuid isn't misspelled or contact the tool creator.`)}};ue(ms,"_pattern",/^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-4[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}$/),ue(ms,"_lut",["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"]);let Is=ms;class Es extends ki{constructor(e,t){super(e),ue(this,"onDisposed",new Bi),ue(this,"onVertexFound",new Bi),ue(this,"onVertexLost",new Bi),ue(this,"onEnabled",new Bi),ue(this,"components"),ue(this,"workingPlane",null),ue(this,"_pickedPoint",null),ue(this,"_config"),ue(this,"_enabled",!1),this.components=e,this.config={snapDistance:.25,showOnlyVertex:!1,...t},this.enabled=!1}set enabled(e){this._enabled=e,e||(this._pickedPoint=null),this.onEnabled.trigger(e)}get enabled(){return this._enabled}set config(e){this._config={...this._config,...e}}get config(){return this._config}dispose(){this.onVertexFound.reset(),this.onVertexLost.reset(),this.components=null,this.onDisposed.trigger(),this.onDisposed.reset()}get(e){if(!this.enabled)return this._pickedPoint;const t=this.components.get(ur).get(e).castRay();if(!t)return null!==this._pickedPoint&&(this.onVertexLost.trigger(),this._pickedPoint=null),this._pickedPoint;const i=this.getClosestVertex(t);return i?!this.workingPlane||Math.abs(this.workingPlane.distanceToPoint(i))<.001?((null===this._pickedPoint||!this._pickedPoint.equals(i))&&(this._pickedPoint=i.clone(),this.onVertexFound.trigger(this._pickedPoint)),this._pickedPoint):(this._pickedPoint=null,this._pickedPoint):(null!==this._pickedPoint&&(this.onVertexLost.trigger(),this._pickedPoint=null),this._pickedPoint)}getClosestVertex(e){let t=new i.Vector3,s=!1,n=Number.MAX_SAFE_INTEGER;const r=this.getVertices(e);if(null===r)return null;for(const i of r){if(!i)continue;const r=e.point.distanceTo(i);r>n||r>this._config.snapDistance||(s=!0,t=i,n=e.point.distanceTo(i))}return s?t:this.config.showOnlyVertex?null:e.point}getVertices(e){const t=e.object;if(!e.face||!t)return null;const s=t.geometry,n=new i.Matrix4,{instanceId:r}=e,o=void 0!==r,a=t instanceof i.InstancedMesh;return a&&o&&t.getMatrixAt(r,n),[this.getVertex(e.face.a,s),this.getVertex(e.face.b,s),this.getVertex(e.face.c,s)].map((e=>(e&&(a&&o&&e.applyMatrix4(n),e.applyMatrix4(t.matrixWorld)),e)))}getVertex(e,t){if(void 0===e)return null;const s=t.attributes.position;return new i.Vector3(s.getX(e),s.getY(e),s.getZ(e))}}var gs=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Cs(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ts={exports:{}};function Rs(e,t,i){i=i||2;var s,n,r,o,a,l,c,h=t&&t.length,d=h?t[0]*i:e.length,u=vs(e,0,d,i,!0),f=[];if(!u||u.next===u.prev)return f;if(h&&(u=function(e,t,i,s){var n,r,o,a,l,c=[];for(n=0,r=t.length;n<r;n++)o=t[n]*s,a=n<r-1?t[n+1]*s:e.length,(l=vs(e,o,a,s,!1))===l.next&&(l.steiner=!0),c.push(bs(l));for(c.sort(Ns),n=0;n<c.length;n++)i=Ps(c[n],i);return i}(e,t,u,i)),e.length>80*i){s=r=e[0],n=o=e[1];for(var p=i;p<d;p+=i)(a=e[p])<s&&(s=a),(l=e[p+1])<n&&(n=l),a>r&&(r=a),l>o&&(o=l);c=0!==(c=Math.max(r-s,o-n))?32767/c:0}return ys(u,f,i,s,n,c,0),f}function vs(e,t,i,s,n){var r,o;if(n===Xs(e,t,i,s)>0)for(r=t;r<i;r+=s)o=Gs(r,e[r],e[r+1],o);else for(r=i-s;r>=t;r-=s)o=Gs(r,e[r],e[r+1],o);return o&&Us(o,o.next)&&(Hs(o),o=o.next),o}function Ss(e,t){if(!e)return e;t||(t=e);var i,s=e;do{if(i=!1,s.steiner||!Us(s,s.next)&&0!==_s(s.prev,s,s.next))s=s.next;else{if(Hs(s),(s=t=s.prev)===s.next)break;i=!0}}while(i||s!==t);return t}function ys(e,t,i,s,n,r,o){if(e){!o&&r&&function(e,t,i,s){var n=e;do{0===n.z&&(n.z=Ls(n.x,n.y,t,i,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,i,s,n,r,o,a,l,c=1;do{for(i=e,e=null,r=null,o=0;i;){for(o++,s=i,a=0,t=0;t<c&&(a++,s=s.nextZ);t++);for(l=c;a>0||l>0&&s;)0!==a&&(0===l||!s||i.z<=s.z)?(n=i,i=i.nextZ,a--):(n=s,s=s.nextZ,l--),r?r.nextZ=n:e=n,n.prevZ=r,r=n;i=s}r.nextZ=null,c*=2}while(o>1)}(n)}(e,s,n,r);for(var a,l,c=e;e.prev!==e.next;)if(a=e.prev,l=e.next,r?As(e,s,n,r):ws(e))t.push(a.i/i|0),t.push(e.i/i|0),t.push(l.i/i|0),Hs(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?ys(e=Fs(Ss(e),t,i),t,i,s,n,r,2):2===o&&Os(e,t,i,s,n,r):ys(Ss(e),t,i,s,n,r,1);break}}}function ws(e){var t=e.prev,i=e,s=e.next;if(_s(t,i,s)>=0)return!1;for(var n=t.x,r=i.x,o=s.x,a=t.y,l=i.y,c=s.y,h=n<r?n<o?n:o:r<o?r:o,d=a<l?a<c?a:c:l<c?l:c,u=n>r?n>o?n:o:r>o?r:o,f=a>l?a>c?a:c:l>c?l:c,p=s.next;p!==t;){if(p.x>=h&&p.x<=u&&p.y>=d&&p.y<=f&&Ms(n,a,r,l,o,c,p.x,p.y)&&_s(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function As(e,t,i,s){var n=e.prev,r=e,o=e.next;if(_s(n,r,o)>=0)return!1;for(var a=n.x,l=r.x,c=o.x,h=n.y,d=r.y,u=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<d?h<u?h:u:d<u?d:u,m=a>l?a>c?a:c:l>c?l:c,I=h>d?h>u?h:u:d>u?d:u,E=Ls(f,p,t,i,s),g=Ls(m,I,t,i,s),C=e.prevZ,T=e.nextZ;C&&C.z>=E&&T&&T.z<=g;){if(C.x>=f&&C.x<=m&&C.y>=p&&C.y<=I&&C!==n&&C!==o&&Ms(a,h,l,d,c,u,C.x,C.y)&&_s(C.prev,C,C.next)>=0||(C=C.prevZ,T.x>=f&&T.x<=m&&T.y>=p&&T.y<=I&&T!==n&&T!==o&&Ms(a,h,l,d,c,u,T.x,T.y)&&_s(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;C&&C.z>=E;){if(C.x>=f&&C.x<=m&&C.y>=p&&C.y<=I&&C!==n&&C!==o&&Ms(a,h,l,d,c,u,C.x,C.y)&&_s(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;T&&T.z<=g;){if(T.x>=f&&T.x<=m&&T.y>=p&&T.y<=I&&T!==n&&T!==o&&Ms(a,h,l,d,c,u,T.x,T.y)&&_s(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function Fs(e,t,i){var s=e;do{var n=s.prev,r=s.next.next;!Us(n,r)&&Bs(n,s,s.next,r)&&ks(n,r)&&ks(r,n)&&(t.push(n.i/i|0),t.push(s.i/i|0),t.push(r.i/i|0),Hs(s),Hs(s.next),s=e=r),s=s.next}while(s!==e);return Ss(s)}function Os(e,t,i,s,n,r){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Ds(o,a)){var l=Ys(o,a);return o=Ss(o,o.next),l=Ss(l,l.next),ys(o,t,i,s,n,r,0),void ys(l,t,i,s,n,r,0)}a=a.next}o=o.next}while(o!==e)}function Ns(e,t){return e.x-t.x}function Ps(e,t){var i=function(e,t){var i,s=t,n=e.x,r=e.y,o=-1/0;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){var a=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=n&&a>o&&(o=a,i=s.x<s.next.x?s:s.next,a===n))return i}s=s.next}while(s!==t);if(!i)return null;var l,c=i,h=i.x,d=i.y,u=1/0;s=i;do{n>=s.x&&s.x>=h&&n!==s.x&&Ms(r<d?n:o,r,h,d,r<d?o:n,r,s.x,s.y)&&(l=Math.abs(r-s.y)/(n-s.x),ks(s,e)&&(l<u||l===u&&(s.x>i.x||s.x===i.x&&xs(i,s)))&&(i=s,u=l)),s=s.next}while(s!==c);return i}(e,t);if(!i)return t;var s=Ys(i,e);return Ss(s,s.next),Ss(i,i.next)}function xs(e,t){return _s(e.prev,e,t.prev)<0&&_s(t.next,e,e.next)<0}function Ls(e,t,i,s,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function bs(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function Ms(e,t,i,s,n,r,o,a){return(n-o)*(t-a)>=(e-o)*(r-a)&&(e-o)*(s-a)>=(i-o)*(t-a)&&(i-o)*(r-a)>=(n-o)*(s-a)}function Ds(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Bs(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(ks(e,t)&&ks(t,e)&&function(e,t){var i=e,s=!1,n=(e.x+t.x)/2,r=(e.y+t.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&n<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next}while(i!==e);return s}(e,t)&&(_s(e.prev,e,t.prev)||_s(e,t.prev,t))||Us(e,t)&&_s(e.prev,e,e.next)>0&&_s(t.prev,t,t.next)>0)}function _s(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function Us(e,t){return e.x===t.x&&e.y===t.y}function Bs(e,t,i,s){var n=zs(_s(e,t,i)),r=zs(_s(e,t,s)),o=zs(_s(i,s,e)),a=zs(_s(i,s,t));return!!(n!==r&&o!==a||0===n&&Vs(e,i,t)||0===r&&Vs(e,s,t)||0===o&&Vs(i,e,s)||0===a&&Vs(i,t,s))}function Vs(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function zs(e){return e>0?1:e<0?-1:0}function ks(e,t){return _s(e.prev,e,e.next)<0?_s(e,t,e.next)>=0&&_s(e,e.prev,t)>=0:_s(e,t,e.prev)<0||_s(e,e.next,t)<0}function Ys(e,t){var i=new Ws(e.i,e.x,e.y),s=new Ws(t.i,t.x,t.y),n=e.next,r=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,s.next=i,i.prev=s,r.next=s,s.prev=r,s}function Gs(e,t,i,s){var n=new Ws(e,t,i);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function Hs(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Ws(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Xs(e,t,i,s){for(var n=0,r=t,o=i-s;r<i;r+=s)n+=(e[o]-e[r])*(e[r+1]+e[o+1]),o=r;return n}Ts.exports=Rs,Ts.exports.default=Rs,Rs.deviation=function(e,t,i,s){var n=t&&t.length,r=n?t[0]*i:e.length,o=Math.abs(Xs(e,0,r,i));if(n)for(var a=0,l=t.length;a<l;a++){var c=t[a]*i,h=a<l-1?t[a+1]*i:e.length;o-=Math.abs(Xs(e,c,h,i))}var d=0;for(a=0;a<s.length;a+=3){var u=s[a]*i,f=s[a+1]*i,p=s[a+2]*i;d+=Math.abs((e[u]-e[p])*(e[f+1]-e[u+1])-(e[u]-e[f])*(e[p+1]-e[u+1]))}return 0===o&&0===d?0:Math.abs((d-o)/o)},Rs.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},s=0,n=0;n<e.length;n++){for(var r=0;r<e[n].length;r++)for(var o=0;o<t;o++)i.vertices.push(e[n][r][o]);n>0&&(s+=e[n-1].length,i.holes.push(s))}return i};const Zs=Cs(Ts.exports);ue(class extends ki{constructor(){super(...arguments),ue(this,"enabled",!0),ue(this,"_inverseMatrix",new i.Matrix4),ue(this,"_localPlane",new i.Plane),ue(this,"_tempLine",new i.Line3),ue(this,"_tempVector",new i.Vector3),ue(this,"_plane"),ue(this,"_plane2DCoordinateSystem",new i.Matrix4),ue(this,"_precission",1e4),ue(this,"_planeAxis")}get plane(){if(!this._plane)throw new Error("Plane not set");return this._plane}set plane(e){this._plane=e}createEdges(e){const{meshes:t,posAttr:s}=e;let n=0;s.array.fill(0);const r=[];let o=0;const a=new i.Mesh;for(const e of t)if(e.geometry){if(e.geometry.boundsTree||e.geometry.computeBoundsTree(),!e.geometry.boundsTree)throw new Error("Bounds tree not found for edges generation.");if(e instanceof i.InstancedMesh){if(0===e.count)continue;const t=e;for(let l=0;l<t.count;l++){a.geometry=e.geometry,a.matrix.copy(e.matrix);const c=new i.Matrix4;t.getMatrixAt(l,c),a.applyMatrix4(c),a.applyMatrix4(e.matrixWorld),a.updateMatrix(),a.updateMatrixWorld(),this._inverseMatrix.copy(a.matrixWorld).invert(),this._localPlane.copy(this.plane).applyMatrix4(this._inverseMatrix),n=this.shapecast(a,s,n),n!==o&&(r.push(n),o=n)}}else this._inverseMatrix.copy(e.matrixWorld).invert(),this._localPlane.copy(this.plane).applyMatrix4(this._inverseMatrix),n=this.shapecast(e,s,n),n!==o&&(r.push(n),o=n)}return{indexes:r,index:n}}createFills(e,t){this.updatePlane2DCoordinateSystem();const i=[];let s=0;for(let n=0;n<t.length;n++){const r=t[n],o=[];for(let e=s;e<r;e+=2)o.push(3*e);const a=this.computeFill(o,e);for(const e of a)i.push(e);s=r}return i}computeFill(e,t){const i=new Map,s={},n=new Map;let r=0;const o=new Map,a=new Map,l=new Set,c=this._precission;for(let h=0;h<e.length;h++){const d=e[h];let u=0,f=0,p=0,m=0;const I=t[d],E=t[d+1],g=t[d+2],C=t[d+3],T=t[d+4],R=t[d+5];if(this._tempVector.set(I,E,g),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),u=Math.trunc(this._tempVector.x*c)/c,f=Math.trunc(this._tempVector.y*c)/c,this._tempVector.set(C,T,R),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),p=Math.trunc(this._tempVector.x*c)/c,m=Math.trunc(this._tempVector.y*c)/c,u===p&&f===m)continue;const v=`${u}|${f}`,S=`${p}|${m}`;i.has(v)||i.set(v,d/3),i.has(S)||i.set(S,d/3+1);const y=i.get(v),w=i.get(S);s[y]=[u,f],s[w]=[p,m];const A=a.has(y),F=o.has(y),O=a.has(w),N=o.has(w);if(A||F||O||N){if(A&&N){const e=a.get(y),t=o.get(w);if(e!==t){const i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),o.set(s[s.length-1],t),o.delete(i[i.length-1]);for(const e of s)i.push(e)}else l.delete(t);a.delete(y),o.delete(w)}else if(F&&O){const e=a.get(w),t=o.get(y);if(e!==t){const i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),o.set(s[s.length-1],t),o.delete(i[i.length-1]);for(const e of s)i.push(e)}else l.delete(t);a.delete(w),o.delete(y)}else if(A&&O){const e=a.get(w),t=a.get(y),i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),a.delete(i[0]),a.delete(s[0]),o.delete(s[s.length-1]),a.set(s[s.length-1],t),s.reverse(),i.splice(0,0,...s)}else if(F&&N){const e=o.get(w),t=o.get(y),i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),o.delete(i[i.length-1]),o.delete(s[s.length-1]),a.delete(s[0]),o.set(s[0],t),s.reverse(),i.push(...s)}else if(A){const e=a.get(y),t=n.get(e);if(!t)continue;t.unshift(w),a.delete(y),a.set(w,e)}else if(F){const e=o.get(y),t=n.get(e);if(!t)continue;t.push(w),o.delete(y),o.set(w,e)}else if(O){const e=a.get(w),t=n.get(e);if(!t)continue;t.unshift(y),a.delete(w),a.set(y,e)}else if(N){const e=o.get(w),t=n.get(e);if(!t)continue;t.push(y),o.delete(w),o.set(y,e)}}else a.set(y,r),o.set(w,r),l.add(r),n.set(r,[y,w]),r++}const h=[];for(const[e,t]of n){if(l.has(e))continue;const i=[],n=new Map;let r=0;for(const e of t){const t=s[e];i.push(t[0],t[1]),n.set(r++,e)}const o=Zs(i);for(const e of o){const t=n.get(e);if(void 0===t)throw new Error("Map error!");h.push(t)}}return h}updatePlane2DCoordinateSystem(){this._plane2DCoordinateSystem=new i.Matrix4;const e=new i.Vector3(1,0,0),t=new i.Vector3(0,1,0),s=this.plane.normal,n=new i.Vector3;this.plane.coplanarPoint(n),"x"===this._planeAxis?e.crossVectors(t,s):"y"===this._planeAxis?t.crossVectors(s,e):"z"===this._planeAxis||(e.crossVectors(t,s).normalize(),t.crossVectors(s,e)),this._plane2DCoordinateSystem.fromArray([e.x,e.y,e.z,0,t.x,t.y,t.z,0,s.x,s.y,s.z,0,n.x,n.y,n.z,1]),this._plane2DCoordinateSystem.invert()}shapecast(e,t,i){return e.geometry.boundsTree.shapecast({intersectsBounds:e=>this._localPlane.intersectsBox(e),intersectsTriangle:s=>{let n=0;if(this._tempLine.start.copy(s.a),this._tempLine.end.copy(s.b),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const s=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,s.x,s.y,s.z),n++,i++}if(this._tempLine.start.copy(s.b),this._tempLine.end.copy(s.c),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const s=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,s.x,s.y,s.z),n++,i++}if(this._tempLine.start.copy(s.c),this._tempLine.end.copy(s.a),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const s=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,s.x,s.y,s.z),n++,i++}2!==n&&(i-=n)}}),i}},"uuid","1a193b87-6376-46c8-9e65-62a1576fdb64");const js=class e{constructor(){ue(this,"onDisposed",new Bi),ue(this,"list",new Map),ue(this,"enabled",!1),ue(this,"_clock"),ue(this,"onInit",new Bi),ue(this,"update",(()=>{if(!this.enabled)return;const e=this._clock.getDelta();for(const[t,i]of this.list)i.enabled&&i.isUpdateable()&&i.update(e);requestAnimationFrame(this.update)})),this._clock=new i.Clock,e.setupBVH()}add(e,t){if(this.list.has(e))throw new Error("You're trying to add a component that already exists in the components instance. Use Components.get() instead.");Is.validate(e),this.list.set(e,t)}get(e){const t=e.uuid;if(!this.list.has(t)){const i=new e(this);return this.list.has(t)||this.add(t,i),i}return this.list.get(t)}init(){this.enabled=!0,this._clock.start(),this.update(),this.onInit.trigger()}dispose(){this.enabled=!1;for(const[e,t]of this.list)t.enabled=!1,t.isDisposeable()&&t.dispose();this._clock.stop(),this.onDisposed.trigger(),this.onDisposed.reset()}static setupBVH(){i.BufferGeometry.prototype.computeBoundsTree=_i,i.BufferGeometry.prototype.disposeBoundsTree=Ui,i.Mesh.prototype.raycast=Di}};ue(js,"release","2.4.5");let Ks=js;class Qs extends zi{constructor(){super(...arguments),ue(this,"meshes",new Set),ue(this,"onAfterUpdate",new Bi),ue(this,"onBeforeUpdate",new Bi),ue(this,"onDisposed",new Bi),ue(this,"isDisposing",!1),ue(this,"enabled",!0),ue(this,"uuid",Is.create()),ue(this,"name"),ue(this,"_scene"),ue(this,"_camera"),ue(this,"_renderer",null)}get scene(){if(!this._scene)throw new Error("No scene initialized!");return this._scene}set scene(e){this._scene=e,e.worlds.set(this.uuid,this),e.currentWorld=this,e.onWorldChanged.trigger({world:this,action:"added"})}get camera(){if(!this._camera)throw new Error("No camera initialized!");return this._camera}set camera(e){this._camera=e,e.worlds.set(this.uuid,this),e.currentWorld=this,e.onWorldChanged.trigger({world:this,action:"added"})}get renderer(){return this._renderer}set renderer(e){this._renderer=e,e&&(e.worlds.set(this.uuid,this),e.currentWorld=this,e.onWorldChanged.trigger({world:this,action:"added"}))}update(e){this.enabled&&(!this._scene||!this._camera||(this.scene.currentWorld=this,this.camera.currentWorld=this,this.renderer&&(this.renderer.currentWorld=this),this.onBeforeUpdate.trigger(),this.scene.isUpdateable()&&this.scene.update(e),this.camera.isUpdateable()&&this.camera.update(e),this.renderer&&this.renderer.update(e),this.onAfterUpdate.trigger()))}dispose(e=!0){if(this.enabled=!1,this.isDisposing=!0,this.scene.onWorldChanged.trigger({world:this,action:"removed"}),this.camera.onWorldChanged.trigger({world:this,action:"removed"}),this.renderer&&this.renderer.onWorldChanged.trigger({world:this,action:"removed"}),e){const e=this.components.get(Xi);this.scene.dispose(),this.camera.isDisposeable()&&this.camera.dispose(),this.renderer&&this.renderer.dispose();for(const t of this.meshes)e.destroy(t);this.meshes.clear()}this._scene=null,this._camera=null,this._renderer=null,this.components.get(ir).list.delete(this.uuid),this.onDisposed.trigger(),this.onDisposed.reset()}}class qs{constructor(e,t,i,s){ue(this,"_component"),ue(this,"name"),ue(this,"uuid"),this._component=e,this.name=i,this.uuid=s??Is.create(),t.get($s).list.set(this.uuid,this)}get controls(){return Ki.copySchema(this._config)}set(e){for(const t in e)if(t in this){this[t]=e[t].value}}export(e=this._config,t={}){for(const i in e){const s=e[i];if(Ki.isEntry(s))if("Color"===s.type){const{r:e,g:n,b:r}=s.value;t[i]={...s,value:{r:e,g:n,b:r}}}else if("Vector3"===s.type){const{x:e,y:n,z:r}=s.value;t[i]={...s,value:{x:e,y:n,z:r}}}else if("TextSet"===s.type){const e=Array.from(s.value);t[i]={...s,value:e}}else if("Select"===s.type){const e=Array.from(s.options);t[i]={...s,options:e}}else t[i]={...s};else t[i]={},this.export(s,t[i])}return t}import(e,t={},s=!0){for(const s in e){const n=e[s];if(Ki.isEntry(n))if("Color"===n.type){const{r:e,g:r,b:o}=n.value;t[s]={...n,value:new i.Color(e,r,o)}}else if("Vector3"===n.type){const{x:e,y:r,z:o}=n.value;t[s]={...n,value:new i.Vector3(e,r,o)}}else"TextSet"===n.type?t[s]={...n,value:new Set(n.value)}:"Select"===n.type?t[s]={...n,options:new Set(n.options)}:t[s]={...n};else t[s]={},this.import(n,t[s],!1)}s&&this.set(t)}}const Js=class e extends ki{constructor(t){super(t),ue(this,"list",new ji),ue(this,"enabled",!0),t.add(e.uuid,this)}};ue(Js,"uuid","b8c764e0-6b24-4e77-9a32-35fa728ee5b4");let $s=Js;class en extends Hi{constructor(e,t,s){super(e),ue(this,"enabled",!0),ue(this,"container"),ue(this,"three"),ue(this,"_canvas"),ue(this,"_parameters"),ue(this,"_resizeObserver",null),ue(this,"onContainerUpdated",new Bi),ue(this,"_resizing",!1),ue(this,"resize",(e=>{if(this._resizing)return;this._resizing=!0,this.onContainerUpdated.trigger();const t=e?e.x:this.container.clientWidth,s=e?e.y:this.container.clientHeight;this.three.setSize(t,s),this.onResize.trigger(new i.Vector2(t,s)),this._resizing=!1})),ue(this,"resizeEvent",(()=>{this.resize()})),ue(this,"onContextLost",(e=>{e.preventDefault(),this.enabled=!1})),ue(this,"onContextBack",(()=>{this.three.setRenderTarget(null),this.three.dispose(),this.three=new i.WebGLRenderer({canvas:this._canvas,antialias:!0,alpha:!0,...this._parameters}),this.enabled=!0})),this.container=t,this._parameters=s,this.three=new i.WebGLRenderer({antialias:!0,alpha:!0,...s}),this.three.setPixelRatio(Math.min(window.devicePixelRatio,2)),this.setupRenderer(),this.setupEvents(!0),this.resize(),this._canvas=this.three.domElement;const n=this.three.getContext(),{canvas:r}=n;r.addEventListener("webglcontextlost",this.onContextLost,!1),r.addEventListener("webglcontextrestored",this.onContextBack,!1)}update(){if(!this.enabled||!this.currentWorld)return;this.onBeforeUpdate.trigger(this);const e=this.currentWorld.scene.three,t=this.currentWorld.camera.three;this.three.render(e,t),this.onAfterUpdate.trigger(this)}dispose(){this.enabled=!1,this.setupEvents(!1),this.three.domElement.remove(),this.three.forceContextLoss(),this.three.dispose(),this.onResize.reset(),this.onAfterUpdate.reset(),this.onBeforeUpdate.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}getSize(){return new i.Vector2(this.three.domElement.clientWidth,this.three.domElement.clientHeight)}setupEvents(e){const t=this.three.domElement.parentElement;if(!t)throw new Error("This renderer needs to have an HTML container!");this._resizeObserver&&(this._resizeObserver.disconnect(),this._resizeObserver=null),window.removeEventListener("resize",this.resizeEvent),e&&(this._resizeObserver=new ResizeObserver(this.resizeEvent),this._resizeObserver.observe(t),window.addEventListener("resize",this.resizeEvent))}setupRenderer(){this.three.localClippingEnabled=!0,this.container&&this.container.appendChild(this.three.domElement),this.onContainerUpdated.trigger()}}
/*!
 * camera-controls
 * https://github.com/yomotsu/camera-controls
 * (c) 2017 @yomotsu
 * Released under the MIT License.
 */const tn=1,sn=2,nn=4,rn=Object.freeze({NONE:0,ROTATE:1,TRUCK:2,OFFSET:4,DOLLY:8,ZOOM:16,TOUCH_ROTATE:32,TOUCH_TRUCK:64,TOUCH_OFFSET:128,TOUCH_DOLLY:256,TOUCH_ZOOM:512,TOUCH_DOLLY_TRUCK:1024,TOUCH_DOLLY_OFFSET:2048,TOUCH_DOLLY_ROTATE:4096,TOUCH_ZOOM_TRUCK:8192,TOUCH_ZOOM_OFFSET:16384,TOUCH_ZOOM_ROTATE:32768}),on=0,an=1,ln=-1;function cn(e){return e.isPerspectiveCamera}function hn(e){return e.isOrthographicCamera}const dn=2*Math.PI,un=Math.PI/2,fn=1e-5,pn=Math.PI/180;function mn(e,t,i){return Math.max(t,Math.min(i,e))}function In(e,t=fn){return Math.abs(e)<t}function En(e,t,i=fn){return In(e-t,i)}function gn(e,t){return Math.round(e/t)*t}function Cn(e){return isFinite(e)?e:e<0?-Number.MAX_VALUE:Number.MAX_VALUE}function Tn(e){return Math.abs(e)<Number.MAX_VALUE?e:e*(1/0)}function Rn(e,t,i,s,n=1/0,r){const o=2/(s=Math.max(1e-4,s)),a=o*r,l=1/(1+a+.48*a*a+.235*a*a*a);let c=e-t;const h=t,d=n*s;c=mn(c,-d,d),t=e-c;const u=(i.value+o*c)*r;i.value=(i.value-o*u)*l;let f=t+(c+u)*l;return h-e>0==f>h&&(f=h,i.value=(f-h)/r),f}function vn(e,t,i,s,n=1/0,r,o){const a=2/(s=Math.max(1e-4,s)),l=a*r,c=1/(1+l+.48*l*l+.235*l*l*l);let h=t.x,d=t.y,u=t.z,f=e.x-h,p=e.y-d,m=e.z-u;const I=h,E=d,g=u,C=n*s,T=f*f+p*p+m*m;if(T>C*C){const e=Math.sqrt(T);f=f/e*C,p=p/e*C,m=m/e*C}h=e.x-f,d=e.y-p,u=e.z-m;const R=(i.x+a*f)*r,v=(i.y+a*p)*r,S=(i.z+a*m)*r;i.x=(i.x-a*R)*c,i.y=(i.y-a*v)*c,i.z=(i.z-a*S)*c,o.x=h+(f+R)*c,o.y=d+(p+v)*c,o.z=u+(m+S)*c;const y=I-e.x,w=E-e.y,A=g-e.z;return y*(o.x-I)+w*(o.y-E)+A*(o.z-g)>0&&(o.x=I,o.y=E,o.z=g,i.x=(o.x-I)/r,i.y=(o.y-E)/r,i.z=(o.z-g)/r),o}function Sn(e,t){t.set(0,0),e.forEach((e=>{t.x+=e.clientX,t.y+=e.clientY})),t.x/=e.length,t.y/=e.length}function yn(e,t){return!!hn(e)&&(console.warn(`${t} is not supported in OrthographicCamera`),!0)}class wn{constructor(){this._listeners={}}addEventListener(e,t){const i=this._listeners;void 0===i[e]&&(i[e]=[]),-1===i[e].indexOf(t)&&i[e].push(t)}hasEventListener(e,t){const i=this._listeners;return void 0!==i[e]&&-1!==i[e].indexOf(t)}removeEventListener(e,t){const i=this._listeners[e];if(void 0!==i){const e=i.indexOf(t);-1!==e&&i.splice(e,1)}}removeAllEventListeners(e){e?Array.isArray(this._listeners[e])&&(this._listeners[e].length=0):this._listeners={}}dispatchEvent(e){const t=this._listeners[e.type];if(void 0!==t){e.target=this;const i=t.slice(0);for(let t=0,s=i.length;t<s;t++)i[t].call(this,e)}}}const An=1/8,Fn=typeof window<"u",On=Fn&&/Mac/.test(navigator.platform),Nn=!(Fn&&"PointerEvent"in window);let Pn,xn,Ln,bn,Mn,Dn,_n,Un,Bn,Vn,zn,kn,Yn,Gn,Hn,Wn,Xn,Zn,jn,Kn,Qn,qn,Jn;class $n extends wn{static install(e){Pn=e.THREE,xn=Object.freeze(new Pn.Vector3(0,0,0)),Ln=Object.freeze(new Pn.Vector3(0,1,0)),bn=Object.freeze(new Pn.Vector3(0,0,1)),Mn=new Pn.Vector2,Dn=new Pn.Vector3,_n=new Pn.Vector3,Un=new Pn.Vector3,Bn=new Pn.Vector3,Vn=new Pn.Vector3,zn=new Pn.Vector3,kn=new Pn.Vector3,Yn=new Pn.Vector3,Gn=new Pn.Vector3,Hn=new Pn.Spherical,Wn=new Pn.Spherical,Xn=new Pn.Box3,Zn=new Pn.Box3,jn=new Pn.Sphere,Kn=new Pn.Quaternion,Qn=new Pn.Quaternion,qn=new Pn.Matrix4,Jn=new Pn.Raycaster}static get ACTION(){return rn}constructor(e,t){super(),this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.minDistance=Number.EPSILON,this.maxDistance=1/0,this.infinityDolly=!1,this.minZoom=.01,this.maxZoom=1/0,this.smoothTime=.25,this.draggingSmoothTime=.125,this.maxSpeed=1/0,this.azimuthRotateSpeed=1,this.polarRotateSpeed=1,this.dollySpeed=1,this.dollyDragInverted=!1,this.truckSpeed=2,this.dollyToCursor=!1,this.dragToOffset=!1,this.verticalDragToForward=!1,this.boundaryFriction=0,this.restThreshold=.01,this.colliderMeshes=[],this.cancel=()=>{},this._enabled=!0,this._state=rn.NONE,this._viewport=null,this._changedDolly=0,this._changedZoom=0,this._hasRested=!0,this._boundaryEnclosesCamera=!1,this._needsUpdate=!0,this._updatedLastTime=!1,this._elementRect=new DOMRect,this._isDragging=!1,this._dragNeedsUpdate=!0,this._activePointers=[],this._lockedPointer=null,this._interactiveArea=new DOMRect(0,0,1,1),this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._isUserControllingOffset=!1,this._isUserControllingZoom=!1,this._lastDollyDirection=on,this._thetaVelocity={value:0},this._phiVelocity={value:0},this._radiusVelocity={value:0},this._targetVelocity=new Pn.Vector3,this._focalOffsetVelocity=new Pn.Vector3,this._zoomVelocity={value:0},this._truckInternal=(e,t,i)=>{let s,n;if(cn(this._camera)){const i=Dn.copy(this._camera.position).sub(this._target),r=this._camera.getEffectiveFOV()*pn,o=i.length()*Math.tan(.5*r);s=this.truckSpeed*e*o/this._elementRect.height,n=this.truckSpeed*t*o/this._elementRect.height}else{if(!hn(this._camera))return;{const i=this._camera;s=e*(i.right-i.left)/i.zoom/this._elementRect.width,n=t*(i.top-i.bottom)/i.zoom/this._elementRect.height}}this.verticalDragToForward?(i?this.setFocalOffset(this._focalOffsetEnd.x+s,this._focalOffsetEnd.y,this._focalOffsetEnd.z,!0):this.truck(s,0,!0),this.forward(-n,!0)):i?this.setFocalOffset(this._focalOffsetEnd.x+s,this._focalOffsetEnd.y+n,this._focalOffsetEnd.z,!0):this.truck(s,n,!0)},this._rotateInternal=(e,t)=>{const i=dn*this.azimuthRotateSpeed*e/this._elementRect.height,s=dn*this.polarRotateSpeed*t/this._elementRect.height;this.rotate(i,s,!0)},this._dollyInternal=(e,t,i)=>{const s=Math.pow(.95,-e*this.dollySpeed),n=this._sphericalEnd.radius,r=this._sphericalEnd.radius*s,o=mn(r,this.minDistance,this.maxDistance),a=o-r;this.infinityDolly&&this.dollyToCursor?this._dollyToNoClamp(r,!0):this.infinityDolly&&!this.dollyToCursor?(this.dollyInFixed(a,!0),this._dollyToNoClamp(o,!0)):this._dollyToNoClamp(o,!0),this.dollyToCursor&&(this._changedDolly+=(this.infinityDolly?r:o)-n,this._dollyControlCoord.set(t,i)),this._lastDollyDirection=Math.sign(-e)},this._zoomInternal=(e,t,i)=>{const s=Math.pow(.95,e*this.dollySpeed),n=this._zoom,r=this._zoom*s;this.zoomTo(r,!0),this.dollyToCursor&&(this._changedZoom+=r-n,this._dollyControlCoord.set(t,i))},typeof Pn>"u"&&console.error("camera-controls: `THREE` is undefined. You must first run `CameraControls.install( { THREE: THREE } )`. Check the docs for further information."),this._camera=e,this._yAxisUpSpace=(new Pn.Quaternion).setFromUnitVectors(this._camera.up,Ln),this._yAxisUpSpaceInverse=this._yAxisUpSpace.clone().invert(),this._state=rn.NONE,this._target=new Pn.Vector3,this._targetEnd=this._target.clone(),this._focalOffset=new Pn.Vector3,this._focalOffsetEnd=this._focalOffset.clone(),this._spherical=(new Pn.Spherical).setFromVector3(Dn.copy(this._camera.position).applyQuaternion(this._yAxisUpSpace)),this._sphericalEnd=this._spherical.clone(),this._lastDistance=this._spherical.radius,this._zoom=this._camera.zoom,this._zoomEnd=this._zoom,this._lastZoom=this._zoom,this._nearPlaneCorners=[new Pn.Vector3,new Pn.Vector3,new Pn.Vector3,new Pn.Vector3],this._updateNearPlaneCorners(),this._boundary=new Pn.Box3(new Pn.Vector3(-1/0,-1/0,-1/0),new Pn.Vector3(1/0,1/0,1/0)),this._cameraUp0=this._camera.up.clone(),this._target0=this._target.clone(),this._position0=this._camera.position.clone(),this._zoom0=this._zoom,this._focalOffset0=this._focalOffset.clone(),this._dollyControlCoord=new Pn.Vector2,this.mouseButtons={left:rn.ROTATE,middle:rn.DOLLY,right:rn.TRUCK,wheel:cn(this._camera)?rn.DOLLY:hn(this._camera)?rn.ZOOM:rn.NONE},this.touches={one:rn.TOUCH_ROTATE,two:cn(this._camera)?rn.TOUCH_DOLLY_TRUCK:hn(this._camera)?rn.TOUCH_ZOOM_TRUCK:rn.NONE,three:rn.TOUCH_TRUCK};const i=new Pn.Vector2,s=new Pn.Vector2,n=new Pn.Vector2,r=e=>{if(!this._enabled||!this._domElement)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),i=e.clientX/t.width,s=e.clientY/t.height;if(i<this._interactiveArea.left||i>this._interactiveArea.right||s<this._interactiveArea.top||s>this._interactiveArea.bottom)return}const t="mouse"!==e.pointerType?null:(e.buttons&tn)===tn?tn:(e.buttons&nn)===nn?nn:(e.buttons&sn)===sn?sn:null;if(null!==t){const e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}if((e.buttons&tn)===tn&&this._lockedPointer)return;const i={pointerId:e.pointerId,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:t};this._activePointers.push(i),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),this._isDragging=!0,p(e)},o=e=>{if(!this._enabled||!this._domElement||this._lockedPointer)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),i=e.clientX/t.width,s=e.clientY/t.height;if(i<this._interactiveArea.left||i>this._interactiveArea.right||s<this._interactiveArea.top||s>this._interactiveArea.bottom)return}const t=(e.buttons&tn)===tn?tn:(e.buttons&nn)===nn?nn:(e.buttons&sn)===sn?sn:null;if(null!==t){const e=this._findPointerByMouseButton(t);e&&this._disposePointer(e)}const i={pointerId:1,clientX:e.clientX,clientY:e.clientY,deltaX:0,deltaY:0,mouseButton:(e.buttons&tn)===tn?tn:(e.buttons&nn)===tn?nn:(e.buttons&sn)===tn?sn:null};this._activePointers.push(i),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.addEventListener("mousemove",l),this._domElement.ownerDocument.addEventListener("mouseup",h),this._isDragging=!0,p(e)},a=e=>{e.cancelable&&e.preventDefault();const t=e.pointerId,i=this._lockedPointer||this._findPointerById(t);if(i){if(i.clientX=e.clientX,i.clientY=e.clientY,i.deltaX=e.movementX,i.deltaY=e.movementY,this._state=0,"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else(!this._isDragging&&this._lockedPointer||this._isDragging&&(e.buttons&tn)===tn)&&(this._state=this._state|this.mouseButtons.left),this._isDragging&&(e.buttons&nn)===nn&&(this._state=this._state|this.mouseButtons.middle),this._isDragging&&(e.buttons&sn)===sn&&(this._state=this._state|this.mouseButtons.right);m()}},l=e=>{const t=this._lockedPointer||this._findPointerById(1);t&&(t.clientX=e.clientX,t.clientY=e.clientY,t.deltaX=e.movementX,t.deltaY=e.movementY,this._state=0,(this._lockedPointer||(e.buttons&tn)===tn)&&(this._state=this._state|this.mouseButtons.left),(e.buttons&nn)===nn&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&sn)===sn&&(this._state=this._state|this.mouseButtons.right),m())},c=e=>{const t=this._findPointerById(e.pointerId);if(!t||t!==this._lockedPointer){if(t&&this._disposePointer(t),"touch"===e.pointerType)switch(this._activePointers.length){case 0:this._state=rn.NONE;break;case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else this._state=rn.NONE;I()}},h=()=>{const e=this._findPointerById(1);e&&e===this._lockedPointer||(e&&this._disposePointer(e),this._state=rn.NONE,I())};let d=-1;const u=e=>{if(!this._domElement||!this._enabled||this.mouseButtons.wheel===rn.NONE)return;if(0!==this._interactiveArea.left||0!==this._interactiveArea.top||1!==this._interactiveArea.width||1!==this._interactiveArea.height){const t=this._domElement.getBoundingClientRect(),i=e.clientX/t.width,s=e.clientY/t.height;if(i<this._interactiveArea.left||i>this._interactiveArea.right||s<this._interactiveArea.top||s>this._interactiveArea.bottom)return}if(e.preventDefault(),this.dollyToCursor||this.mouseButtons.wheel===rn.ROTATE||this.mouseButtons.wheel===rn.TRUCK){const e=performance.now();d-e<1e3&&this._getClientRect(this._elementRect),d=e}const t=On?-1:-3,i=1===e.deltaMode?e.deltaY/t:e.deltaY/(10*t),s=this.dollyToCursor?(e.clientX-this._elementRect.x)/this._elementRect.width*2-1:0,n=this.dollyToCursor?(e.clientY-this._elementRect.y)/this._elementRect.height*-2+1:0;switch(this.mouseButtons.wheel){case rn.ROTATE:this._rotateInternal(e.deltaX,e.deltaY),this._isUserControllingRotate=!0;break;case rn.TRUCK:this._truckInternal(e.deltaX,e.deltaY,!1),this._isUserControllingTruck=!0;break;case rn.OFFSET:this._truckInternal(e.deltaX,e.deltaY,!0),this._isUserControllingOffset=!0;break;case rn.DOLLY:this._dollyInternal(-i,s,n),this._isUserControllingDolly=!0;break;case rn.ZOOM:this._zoomInternal(-i,s,n),this._isUserControllingZoom=!0}this.dispatchEvent({type:"control"})},f=e=>{if(this._domElement&&this._enabled){if(this.mouseButtons.right===$n.ACTION.NONE){const t=e instanceof PointerEvent?e.pointerId:(MouseEvent,0),i=this._findPointerById(t);return i&&this._disposePointer(i),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("mousemove",l),void this._domElement.ownerDocument.removeEventListener("mouseup",h)}e.preventDefault()}},p=e=>{if(this._enabled){if(Sn(this._activePointers,Mn),this._getClientRect(this._elementRect),i.copy(Mn),s.copy(Mn),this._activePointers.length>=2){const e=Mn.x-this._activePointers[1].clientX,t=Mn.y-this._activePointers[1].clientY,i=Math.sqrt(e*e+t*t);n.set(0,i);const r=.5*(this._activePointers[0].clientX+this._activePointers[1].clientX),o=.5*(this._activePointers[0].clientY+this._activePointers[1].clientY);s.set(r,o)}if(this._state=0,e)if("pointerType"in e&&"touch"===e.pointerType)switch(this._activePointers.length){case 1:this._state=this.touches.one;break;case 2:this._state=this.touches.two;break;case 3:this._state=this.touches.three}else!this._lockedPointer&&(e.buttons&tn)===tn&&(this._state=this._state|this.mouseButtons.left),(e.buttons&nn)===nn&&(this._state=this._state|this.mouseButtons.middle),(e.buttons&sn)===sn&&(this._state=this._state|this.mouseButtons.right);else this._lockedPointer&&(this._state=this._state|this.mouseButtons.left);((this._state&rn.ROTATE)===rn.ROTATE||(this._state&rn.TOUCH_ROTATE)===rn.TOUCH_ROTATE||(this._state&rn.TOUCH_DOLLY_ROTATE)===rn.TOUCH_DOLLY_ROTATE||(this._state&rn.TOUCH_ZOOM_ROTATE)===rn.TOUCH_ZOOM_ROTATE)&&(this._sphericalEnd.theta=this._spherical.theta,this._sphericalEnd.phi=this._spherical.phi,this._thetaVelocity.value=0,this._phiVelocity.value=0),((this._state&rn.TRUCK)===rn.TRUCK||(this._state&rn.TOUCH_TRUCK)===rn.TOUCH_TRUCK||(this._state&rn.TOUCH_DOLLY_TRUCK)===rn.TOUCH_DOLLY_TRUCK||(this._state&rn.TOUCH_ZOOM_TRUCK)===rn.TOUCH_ZOOM_TRUCK)&&(this._targetEnd.copy(this._target),this._targetVelocity.set(0,0,0)),((this._state&rn.DOLLY)===rn.DOLLY||(this._state&rn.TOUCH_DOLLY)===rn.TOUCH_DOLLY||(this._state&rn.TOUCH_DOLLY_TRUCK)===rn.TOUCH_DOLLY_TRUCK||(this._state&rn.TOUCH_DOLLY_OFFSET)===rn.TOUCH_DOLLY_OFFSET||(this._state&rn.TOUCH_DOLLY_ROTATE)===rn.TOUCH_DOLLY_ROTATE)&&(this._sphericalEnd.radius=this._spherical.radius,this._radiusVelocity.value=0),((this._state&rn.ZOOM)===rn.ZOOM||(this._state&rn.TOUCH_ZOOM)===rn.TOUCH_ZOOM||(this._state&rn.TOUCH_ZOOM_TRUCK)===rn.TOUCH_ZOOM_TRUCK||(this._state&rn.TOUCH_ZOOM_OFFSET)===rn.TOUCH_ZOOM_OFFSET||(this._state&rn.TOUCH_ZOOM_ROTATE)===rn.TOUCH_ZOOM_ROTATE)&&(this._zoomEnd=this._zoom,this._zoomVelocity.value=0),((this._state&rn.OFFSET)===rn.OFFSET||(this._state&rn.TOUCH_OFFSET)===rn.TOUCH_OFFSET||(this._state&rn.TOUCH_DOLLY_OFFSET)===rn.TOUCH_DOLLY_OFFSET||(this._state&rn.TOUCH_ZOOM_OFFSET)===rn.TOUCH_ZOOM_OFFSET)&&(this._focalOffsetEnd.copy(this._focalOffset),this._focalOffsetVelocity.set(0,0,0)),this.dispatchEvent({type:"controlstart"})}},m=()=>{if(!this._enabled||!this._dragNeedsUpdate)return;this._dragNeedsUpdate=!1,Sn(this._activePointers,Mn);const e=this._domElement&&document.pointerLockElement===this._domElement?this._lockedPointer||this._activePointers[0]:null,t=e?-e.deltaX:s.x-Mn.x,r=e?-e.deltaY:s.y-Mn.y;if(s.copy(Mn),((this._state&rn.ROTATE)===rn.ROTATE||(this._state&rn.TOUCH_ROTATE)===rn.TOUCH_ROTATE||(this._state&rn.TOUCH_DOLLY_ROTATE)===rn.TOUCH_DOLLY_ROTATE||(this._state&rn.TOUCH_ZOOM_ROTATE)===rn.TOUCH_ZOOM_ROTATE)&&(this._rotateInternal(t,r),this._isUserControllingRotate=!0),(this._state&rn.DOLLY)===rn.DOLLY||(this._state&rn.ZOOM)===rn.ZOOM){const e=this.dollyToCursor?(i.x-this._elementRect.x)/this._elementRect.width*2-1:0,t=this.dollyToCursor?(i.y-this._elementRect.y)/this._elementRect.height*-2+1:0,s=this.dollyDragInverted?-1:1;(this._state&rn.DOLLY)===rn.DOLLY?(this._dollyInternal(s*r*An,e,t),this._isUserControllingDolly=!0):(this._zoomInternal(s*r*An,e,t),this._isUserControllingZoom=!0)}if((this._state&rn.TOUCH_DOLLY)===rn.TOUCH_DOLLY||(this._state&rn.TOUCH_ZOOM)===rn.TOUCH_ZOOM||(this._state&rn.TOUCH_DOLLY_TRUCK)===rn.TOUCH_DOLLY_TRUCK||(this._state&rn.TOUCH_ZOOM_TRUCK)===rn.TOUCH_ZOOM_TRUCK||(this._state&rn.TOUCH_DOLLY_OFFSET)===rn.TOUCH_DOLLY_OFFSET||(this._state&rn.TOUCH_ZOOM_OFFSET)===rn.TOUCH_ZOOM_OFFSET||(this._state&rn.TOUCH_DOLLY_ROTATE)===rn.TOUCH_DOLLY_ROTATE||(this._state&rn.TOUCH_ZOOM_ROTATE)===rn.TOUCH_ZOOM_ROTATE){const e=Mn.x-this._activePointers[1].clientX,t=Mn.y-this._activePointers[1].clientY,i=Math.sqrt(e*e+t*t),r=n.y-i;n.set(0,i);const o=this.dollyToCursor?(s.x-this._elementRect.x)/this._elementRect.width*2-1:0,a=this.dollyToCursor?(s.y-this._elementRect.y)/this._elementRect.height*-2+1:0;(this._state&rn.TOUCH_DOLLY)===rn.TOUCH_DOLLY||(this._state&rn.TOUCH_DOLLY_ROTATE)===rn.TOUCH_DOLLY_ROTATE||(this._state&rn.TOUCH_DOLLY_TRUCK)===rn.TOUCH_DOLLY_TRUCK||(this._state&rn.TOUCH_DOLLY_OFFSET)===rn.TOUCH_DOLLY_OFFSET?(this._dollyInternal(r*An,o,a),this._isUserControllingDolly=!0):(this._zoomInternal(r*An,o,a),this._isUserControllingZoom=!0)}((this._state&rn.TRUCK)===rn.TRUCK||(this._state&rn.TOUCH_TRUCK)===rn.TOUCH_TRUCK||(this._state&rn.TOUCH_DOLLY_TRUCK)===rn.TOUCH_DOLLY_TRUCK||(this._state&rn.TOUCH_ZOOM_TRUCK)===rn.TOUCH_ZOOM_TRUCK)&&(this._truckInternal(t,r,!1),this._isUserControllingTruck=!0),((this._state&rn.OFFSET)===rn.OFFSET||(this._state&rn.TOUCH_OFFSET)===rn.TOUCH_OFFSET||(this._state&rn.TOUCH_DOLLY_OFFSET)===rn.TOUCH_DOLLY_OFFSET||(this._state&rn.TOUCH_ZOOM_OFFSET)===rn.TOUCH_ZOOM_OFFSET)&&(this._truckInternal(t,r,!0),this._isUserControllingOffset=!0),this.dispatchEvent({type:"control"})},I=()=>{Sn(this._activePointers,Mn),s.copy(Mn),this._dragNeedsUpdate=!1,(0===this._activePointers.length||1===this._activePointers.length&&this._activePointers[0]===this._lockedPointer)&&(this._isDragging=!1),0===this._activePointers.length&&this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("mouseup",h),this.dispatchEvent({type:"controlend"}))};this.lockPointer=()=>{!this._enabled||!this._domElement||(this.cancel(),this._lockedPointer={pointerId:-1,clientX:0,clientY:0,deltaX:0,deltaY:0,mouseButton:null},this._activePointers.push(this._lockedPointer),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.requestPointerLock(),this._domElement.ownerDocument.addEventListener("pointerlockchange",E),this._domElement.ownerDocument.addEventListener("pointerlockerror",g),this._domElement.ownerDocument.addEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.addEventListener("pointerup",c),p())},this.unlockPointer=()=>{null!==this._lockedPointer&&(this._disposePointer(this._lockedPointer),this._lockedPointer=null),document.exitPointerLock(),this.cancel(),this._domElement&&(this._domElement.ownerDocument.removeEventListener("pointerlockchange",E),this._domElement.ownerDocument.removeEventListener("pointerlockerror",g))};const E=()=>{this._domElement&&this._domElement.ownerDocument.pointerLockElement===this._domElement||this.unlockPointer()},g=()=>{this.unlockPointer()};this._addAllEventListeners=e=>{this._domElement=e,this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none",this._domElement.addEventListener("pointerdown",r),Nn&&this._domElement.addEventListener("mousedown",o),this._domElement.addEventListener("pointercancel",c),this._domElement.addEventListener("wheel",u,{passive:!1}),this._domElement.addEventListener("contextmenu",f)},this._removeAllEventListeners=()=>{this._domElement&&(this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect="",this._domElement.removeEventListener("pointerdown",r),this._domElement.removeEventListener("mousedown",o),this._domElement.removeEventListener("pointercancel",c),this._domElement.removeEventListener("wheel",u,{passive:!1}),this._domElement.removeEventListener("contextmenu",f),this._domElement.ownerDocument.removeEventListener("pointermove",a,{passive:!1}),this._domElement.ownerDocument.removeEventListener("mousemove",l),this._domElement.ownerDocument.removeEventListener("pointerup",c),this._domElement.ownerDocument.removeEventListener("mouseup",h),this._domElement.ownerDocument.removeEventListener("pointerlockchange",E),this._domElement.ownerDocument.removeEventListener("pointerlockerror",g))},this.cancel=()=>{this._state!==rn.NONE&&(this._state=rn.NONE,this._activePointers.length=0,I())},t&&this.connect(t),this.update(0)}get camera(){return this._camera}set camera(e){this._camera=e,this.updateCameraUp(),this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this._domElement&&(e?(this._domElement.style.touchAction="none",this._domElement.style.userSelect="none",this._domElement.style.webkitUserSelect="none"):(this.cancel(),this._domElement.style.touchAction="",this._domElement.style.userSelect="",this._domElement.style.webkitUserSelect=""))}get active(){return!this._hasRested}get currentAction(){return this._state}get distance(){return this._spherical.radius}set distance(e){this._spherical.radius===e&&this._sphericalEnd.radius===e||(this._spherical.radius=e,this._sphericalEnd.radius=e,this._needsUpdate=!0)}get azimuthAngle(){return this._spherical.theta}set azimuthAngle(e){this._spherical.theta===e&&this._sphericalEnd.theta===e||(this._spherical.theta=e,this._sphericalEnd.theta=e,this._needsUpdate=!0)}get polarAngle(){return this._spherical.phi}set polarAngle(e){this._spherical.phi===e&&this._sphericalEnd.phi===e||(this._spherical.phi=e,this._sphericalEnd.phi=e,this._needsUpdate=!0)}get boundaryEnclosesCamera(){return this._boundaryEnclosesCamera}set boundaryEnclosesCamera(e){this._boundaryEnclosesCamera=e,this._needsUpdate=!0}set interactiveArea(e){this._interactiveArea.width=mn(e.width,0,1),this._interactiveArea.height=mn(e.height,0,1),this._interactiveArea.x=mn(e.x,0,1-this._interactiveArea.width),this._interactiveArea.y=mn(e.y,0,1-this._interactiveArea.height)}addEventListener(e,t){super.addEventListener(e,t)}removeEventListener(e,t){super.removeEventListener(e,t)}rotate(e,t,i=!1){return this.rotateTo(this._sphericalEnd.theta+e,this._sphericalEnd.phi+t,i)}rotateAzimuthTo(e,t=!1){return this.rotateTo(e,this._sphericalEnd.phi,t)}rotatePolarTo(e,t=!1){return this.rotateTo(this._sphericalEnd.theta,e,t)}rotateTo(e,t,i=!1){this._isUserControllingRotate=!1;const s=mn(e,this.minAzimuthAngle,this.maxAzimuthAngle),n=mn(t,this.minPolarAngle,this.maxPolarAngle);this._sphericalEnd.theta=s,this._sphericalEnd.phi=n,this._sphericalEnd.makeSafe(),this._needsUpdate=!0,i||(this._spherical.theta=this._sphericalEnd.theta,this._spherical.phi=this._sphericalEnd.phi);const r=!i||En(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&En(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold);return this._createOnRestPromise(r)}dolly(e,t=!1){return this.dollyTo(this._sphericalEnd.radius-e,t)}dollyTo(e,t=!1){return this._isUserControllingDolly=!1,this._lastDollyDirection=on,this._changedDolly=0,this._dollyToNoClamp(mn(e,this.minDistance,this.maxDistance),t)}_dollyToNoClamp(e,t=!1){const i=this._sphericalEnd.radius;if(this.colliderMeshes.length>=1){const t=this._collisionTest(),s=En(t,this._spherical.radius);if(!(i>e)&&s)return Promise.resolve();this._sphericalEnd.radius=Math.min(e,t)}else this._sphericalEnd.radius=e;this._needsUpdate=!0,t||(this._spherical.radius=this._sphericalEnd.radius);const s=!t||En(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(s)}dollyInFixed(e,t=!1){this._targetEnd.add(this._getCameraDirection(Bn).multiplyScalar(e)),t||this._target.copy(this._targetEnd);const i=!t||En(this._target.x,this._targetEnd.x,this.restThreshold)&&En(this._target.y,this._targetEnd.y,this.restThreshold)&&En(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(i)}zoom(e,t=!1){return this.zoomTo(this._zoomEnd+e,t)}zoomTo(e,t=!1){this._isUserControllingZoom=!1,this._zoomEnd=mn(e,this.minZoom,this.maxZoom),this._needsUpdate=!0,t||(this._zoom=this._zoomEnd);const i=!t||En(this._zoom,this._zoomEnd,this.restThreshold);return this._changedZoom=0,this._createOnRestPromise(i)}pan(e,t,i=!1){return console.warn("`pan` has been renamed to `truck`"),this.truck(e,t,i)}truck(e,t,i=!1){this._camera.updateMatrix(),Vn.setFromMatrixColumn(this._camera.matrix,0),zn.setFromMatrixColumn(this._camera.matrix,1),Vn.multiplyScalar(e),zn.multiplyScalar(-t);const s=Dn.copy(Vn).add(zn),n=_n.copy(this._targetEnd).add(s);return this.moveTo(n.x,n.y,n.z,i)}forward(e,t=!1){Dn.setFromMatrixColumn(this._camera.matrix,0),Dn.crossVectors(this._camera.up,Dn),Dn.multiplyScalar(e);const i=_n.copy(this._targetEnd).add(Dn);return this.moveTo(i.x,i.y,i.z,t)}elevate(e,t=!1){return Dn.copy(this._camera.up).multiplyScalar(e),this.moveTo(this._targetEnd.x+Dn.x,this._targetEnd.y+Dn.y,this._targetEnd.z+Dn.z,t)}moveTo(e,t,i,s=!1){this._isUserControllingTruck=!1;const n=Dn.set(e,t,i).sub(this._targetEnd);this._encloseToBoundary(this._targetEnd,n,this.boundaryFriction),this._needsUpdate=!0,s||this._target.copy(this._targetEnd);const r=!s||En(this._target.x,this._targetEnd.x,this.restThreshold)&&En(this._target.y,this._targetEnd.y,this.restThreshold)&&En(this._target.z,this._targetEnd.z,this.restThreshold);return this._createOnRestPromise(r)}lookInDirectionOf(e,t,i,s=!1){const n=Dn.set(e,t,i).sub(this._targetEnd).normalize().multiplyScalar(-this._sphericalEnd.radius);return this.setPosition(n.x,n.y,n.z,s)}fitToBox(e,t,{cover:i=!1,paddingLeft:s=0,paddingRight:n=0,paddingBottom:r=0,paddingTop:o=0}={}){const a=[],l=e.isBox3?Xn.copy(e):Xn.setFromObject(e);l.isEmpty()&&(console.warn("camera-controls: fitTo() cannot be used with an empty box. Aborting"),Promise.resolve());const c=gn(this._sphericalEnd.theta,un),h=gn(this._sphericalEnd.phi,un);a.push(this.rotateTo(c,h,t));const d=Dn.setFromSpherical(this._sphericalEnd).normalize(),u=Kn.setFromUnitVectors(d,bn),f=En(Math.abs(d.y),1);f&&u.multiply(Qn.setFromAxisAngle(Ln,c)),u.multiply(this._yAxisUpSpaceInverse);const p=Zn.makeEmpty();_n.copy(l.min).applyQuaternion(u),p.expandByPoint(_n),_n.copy(l.min).setX(l.max.x).applyQuaternion(u),p.expandByPoint(_n),_n.copy(l.min).setY(l.max.y).applyQuaternion(u),p.expandByPoint(_n),_n.copy(l.max).setZ(l.min.z).applyQuaternion(u),p.expandByPoint(_n),_n.copy(l.min).setZ(l.max.z).applyQuaternion(u),p.expandByPoint(_n),_n.copy(l.max).setY(l.min.y).applyQuaternion(u),p.expandByPoint(_n),_n.copy(l.max).setX(l.min.x).applyQuaternion(u),p.expandByPoint(_n),_n.copy(l.max).applyQuaternion(u),p.expandByPoint(_n),p.min.x-=s,p.min.y-=r,p.max.x+=n,p.max.y+=o,u.setFromUnitVectors(bn,d),f&&u.premultiply(Qn.invert()),u.premultiply(this._yAxisUpSpace);const m=p.getSize(Dn),I=p.getCenter(_n).applyQuaternion(u);if(cn(this._camera)){const e=this.getDistanceToFitBox(m.x,m.y,m.z,i);a.push(this.moveTo(I.x,I.y,I.z,t)),a.push(this.dollyTo(e,t)),a.push(this.setFocalOffset(0,0,0,t))}else if(hn(this._camera)){const e=this._camera,s=e.right-e.left,n=e.top-e.bottom,r=i?Math.max(s/m.x,n/m.y):Math.min(s/m.x,n/m.y);a.push(this.moveTo(I.x,I.y,I.z,t)),a.push(this.zoomTo(r,t)),a.push(this.setFocalOffset(0,0,0,t))}return Promise.all(a)}fitToSphere(e,t){const i=[],s=e instanceof Pn.Sphere?jn.copy(e):$n.createBoundingSphere(e,jn);if(i.push(this.moveTo(s.center.x,s.center.y,s.center.z,t)),cn(this._camera)){const e=this.getDistanceToFitSphere(s.radius);i.push(this.dollyTo(e,t))}else if(hn(this._camera)){const e=this._camera.right-this._camera.left,n=this._camera.top-this._camera.bottom,r=2*s.radius,o=Math.min(e/r,n/r);i.push(this.zoomTo(o,t))}return i.push(this.setFocalOffset(0,0,0,t)),Promise.all(i)}setLookAt(e,t,i,s,n,r,o=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=on,this._changedDolly=0;const a=_n.set(s,n,r),l=Dn.set(e,t,i);this._targetEnd.copy(a),this._sphericalEnd.setFromVector3(l.sub(a).applyQuaternion(this._yAxisUpSpace)),this.normalizeRotations(),this._needsUpdate=!0,o||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const c=!o||En(this._target.x,this._targetEnd.x,this.restThreshold)&&En(this._target.y,this._targetEnd.y,this.restThreshold)&&En(this._target.z,this._targetEnd.z,this.restThreshold)&&En(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&En(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&En(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(c)}lerpLookAt(e,t,i,s,n,r,o,a,l,c,h,d,u,f=!1){this._isUserControllingRotate=!1,this._isUserControllingDolly=!1,this._isUserControllingTruck=!1,this._lastDollyDirection=on,this._changedDolly=0;const p=Dn.set(s,n,r),m=_n.set(e,t,i);Hn.setFromVector3(m.sub(p).applyQuaternion(this._yAxisUpSpace));const I=Un.set(c,h,d),E=_n.set(o,a,l);Wn.setFromVector3(E.sub(I).applyQuaternion(this._yAxisUpSpace)),this._targetEnd.copy(p.lerp(I,u));const g=Wn.theta-Hn.theta,C=Wn.phi-Hn.phi,T=Wn.radius-Hn.radius;this._sphericalEnd.set(Hn.radius+T*u,Hn.phi+C*u,Hn.theta+g*u),this.normalizeRotations(),this._needsUpdate=!0,f||(this._target.copy(this._targetEnd),this._spherical.copy(this._sphericalEnd));const R=!f||En(this._target.x,this._targetEnd.x,this.restThreshold)&&En(this._target.y,this._targetEnd.y,this.restThreshold)&&En(this._target.z,this._targetEnd.z,this.restThreshold)&&En(this._spherical.theta,this._sphericalEnd.theta,this.restThreshold)&&En(this._spherical.phi,this._sphericalEnd.phi,this.restThreshold)&&En(this._spherical.radius,this._sphericalEnd.radius,this.restThreshold);return this._createOnRestPromise(R)}setPosition(e,t,i,s=!1){return this.setLookAt(e,t,i,this._targetEnd.x,this._targetEnd.y,this._targetEnd.z,s)}setTarget(e,t,i,s=!1){const n=this.getPosition(Dn),r=this.setLookAt(n.x,n.y,n.z,e,t,i,s);return this._sphericalEnd.phi=mn(this._sphericalEnd.phi,this.minPolarAngle,this.maxPolarAngle),r}setFocalOffset(e,t,i,s=!1){this._isUserControllingOffset=!1,this._focalOffsetEnd.set(e,t,i),this._needsUpdate=!0,s||this._focalOffset.copy(this._focalOffsetEnd);const n=!s||En(this._focalOffset.x,this._focalOffsetEnd.x,this.restThreshold)&&En(this._focalOffset.y,this._focalOffsetEnd.y,this.restThreshold)&&En(this._focalOffset.z,this._focalOffsetEnd.z,this.restThreshold);return this._createOnRestPromise(n)}setOrbitPoint(e,t,i){this._camera.updateMatrixWorld(),Vn.setFromMatrixColumn(this._camera.matrixWorldInverse,0),zn.setFromMatrixColumn(this._camera.matrixWorldInverse,1),kn.setFromMatrixColumn(this._camera.matrixWorldInverse,2);const s=Dn.set(e,t,i),n=s.distanceTo(this._camera.position),r=s.sub(this._camera.position);Vn.multiplyScalar(r.x),zn.multiplyScalar(r.y),kn.multiplyScalar(r.z),Dn.copy(Vn).add(zn).add(kn),Dn.z=Dn.z+n,this.dollyTo(n,!1),this.setFocalOffset(-Dn.x,Dn.y,-Dn.z,!1),this.moveTo(e,t,i,!1)}setBoundary(e){if(!e)return this._boundary.min.set(-1/0,-1/0,-1/0),this._boundary.max.set(1/0,1/0,1/0),void(this._needsUpdate=!0);this._boundary.copy(e),this._boundary.clampPoint(this._targetEnd,this._targetEnd),this._needsUpdate=!0}setViewport(e,t,i,s){null!==e?(this._viewport=this._viewport||new Pn.Vector4,"number"==typeof e?this._viewport.set(e,t,i,s):this._viewport.copy(e)):this._viewport=null}getDistanceToFitBox(e,t,i,s=!1){if(yn(this._camera,"getDistanceToFitBox"))return this._spherical.radius;const n=e/t,r=this._camera.getEffectiveFOV()*pn,o=this._camera.aspect;return.5*((s?n>o:n<o)?t:e/o)/Math.tan(.5*r)+.5*i}getDistanceToFitSphere(e){if(yn(this._camera,"getDistanceToFitSphere"))return this._spherical.radius;const t=this._camera.getEffectiveFOV()*pn,i=2*Math.atan(Math.tan(.5*t)*this._camera.aspect),s=1<this._camera.aspect?t:i;return e/Math.sin(.5*s)}getTarget(e,t=!0){return(e&&e.isVector3?e:new Pn.Vector3).copy(t?this._targetEnd:this._target)}getPosition(e,t=!0){return(e&&e.isVector3?e:new Pn.Vector3).setFromSpherical(t?this._sphericalEnd:this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(t?this._targetEnd:this._target)}getSpherical(e,t=!0){return(e&&e instanceof Pn.Spherical?e:new Pn.Spherical).copy(t?this._sphericalEnd:this._spherical)}getFocalOffset(e,t=!0){return(e&&e.isVector3?e:new Pn.Vector3).copy(t?this._focalOffsetEnd:this._focalOffset)}normalizeRotations(){this._sphericalEnd.theta=this._sphericalEnd.theta%dn,this._sphericalEnd.theta<0&&(this._sphericalEnd.theta+=dn),this._spherical.theta+=dn*Math.round((this._sphericalEnd.theta-this._spherical.theta)/dn)}reset(e=!1){if(!En(this._camera.up.x,this._cameraUp0.x)||!En(this._camera.up.y,this._cameraUp0.y)||!En(this._camera.up.z,this._cameraUp0.z)){this._camera.up.copy(this._cameraUp0);const e=this.getPosition(Dn);this.updateCameraUp(),this.setPosition(e.x,e.y,e.z)}const t=[this.setLookAt(this._position0.x,this._position0.y,this._position0.z,this._target0.x,this._target0.y,this._target0.z,e),this.setFocalOffset(this._focalOffset0.x,this._focalOffset0.y,this._focalOffset0.z,e),this.zoomTo(this._zoom0,e)];return Promise.all(t)}saveState(){this._cameraUp0.copy(this._camera.up),this.getTarget(this._target0),this.getPosition(this._position0),this._zoom0=this._zoom,this._focalOffset0.copy(this._focalOffset)}updateCameraUp(){this._yAxisUpSpace.setFromUnitVectors(this._camera.up,Ln),this._yAxisUpSpaceInverse.copy(this._yAxisUpSpace).invert()}applyCameraUp(){const e=Dn.subVectors(this._target,this._camera.position).normalize(),t=_n.crossVectors(e,this._camera.up);this._camera.up.crossVectors(t,e).normalize(),this._camera.updateMatrixWorld();const i=this.getPosition(Dn);this.updateCameraUp(),this.setPosition(i.x,i.y,i.z)}update(e){const t=this._sphericalEnd.theta-this._spherical.theta,i=this._sphericalEnd.phi-this._spherical.phi,s=this._sphericalEnd.radius-this._spherical.radius,n=Yn.subVectors(this._targetEnd,this._target),r=Gn.subVectors(this._focalOffsetEnd,this._focalOffset),o=this._zoomEnd-this._zoom;if(In(t))this._thetaVelocity.value=0,this._spherical.theta=this._sphericalEnd.theta;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.theta=Rn(this._spherical.theta,this._sphericalEnd.theta,this._thetaVelocity,t,1/0,e),this._needsUpdate=!0}if(In(i))this._phiVelocity.value=0,this._spherical.phi=this._sphericalEnd.phi;else{const t=this._isUserControllingRotate?this.draggingSmoothTime:this.smoothTime;this._spherical.phi=Rn(this._spherical.phi,this._sphericalEnd.phi,this._phiVelocity,t,1/0,e),this._needsUpdate=!0}if(In(s))this._radiusVelocity.value=0,this._spherical.radius=this._sphericalEnd.radius;else{const t=this._isUserControllingDolly?this.draggingSmoothTime:this.smoothTime;this._spherical.radius=Rn(this._spherical.radius,this._sphericalEnd.radius,this._radiusVelocity,t,this.maxSpeed,e),this._needsUpdate=!0}if(In(n.x)&&In(n.y)&&In(n.z))this._targetVelocity.set(0,0,0),this._target.copy(this._targetEnd);else{const t=this._isUserControllingTruck?this.draggingSmoothTime:this.smoothTime;vn(this._target,this._targetEnd,this._targetVelocity,t,this.maxSpeed,e,this._target),this._needsUpdate=!0}if(In(r.x)&&In(r.y)&&In(r.z))this._focalOffsetVelocity.set(0,0,0),this._focalOffset.copy(this._focalOffsetEnd);else{const t=this._isUserControllingOffset?this.draggingSmoothTime:this.smoothTime;vn(this._focalOffset,this._focalOffsetEnd,this._focalOffsetVelocity,t,this.maxSpeed,e,this._focalOffset),this._needsUpdate=!0}if(In(o))this._zoomVelocity.value=0,this._zoom=this._zoomEnd;else{const t=this._isUserControllingZoom?this.draggingSmoothTime:this.smoothTime;this._zoom=Rn(this._zoom,this._zoomEnd,this._zoomVelocity,t,1/0,e)}if(this.dollyToCursor)if(cn(this._camera)&&0!==this._changedDolly){const e=this._spherical.radius-this._lastDistance,t=this._camera,i=this._getCameraDirection(Bn),s=Dn.copy(i).cross(t.up).normalize();0===s.lengthSq()&&(s.x=1);const n=_n.crossVectors(s,i),r=this._sphericalEnd.radius*Math.tan(t.getEffectiveFOV()*pn*.5),o=(this._sphericalEnd.radius-e-this._sphericalEnd.radius)/this._sphericalEnd.radius,a=Un.copy(this._targetEnd).add(s.multiplyScalar(this._dollyControlCoord.x*r*t.aspect)).add(n.multiplyScalar(this._dollyControlCoord.y*r)),l=Dn.copy(this._targetEnd).lerp(a,o),c=this._lastDollyDirection===an&&this._spherical.radius<=this.minDistance,h=this._lastDollyDirection===ln&&this.maxDistance<=this._spherical.radius;if(this.infinityDolly&&(c||h)){this._sphericalEnd.radius-=e,this._spherical.radius-=e;const t=_n.copy(i).multiplyScalar(-e);l.add(t)}this._boundary.clampPoint(l,l);const d=_n.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(d),this._changedDolly-=e,In(this._changedDolly)&&(this._changedDolly=0)}else if(hn(this._camera)&&0!==this._changedZoom){const e=this._zoom-this._lastZoom,t=this._camera,i=Dn.set(this._dollyControlCoord.x,this._dollyControlCoord.y,(t.near+t.far)/(t.near-t.far)).unproject(t),s=_n.set(0,0,-1).applyQuaternion(t.quaternion),n=Un.copy(i).add(s.multiplyScalar(-i.dot(t.up))),r=-(this._zoom-e-this._zoom)/this._zoom,o=this._getCameraDirection(Bn),a=this._targetEnd.dot(o),l=Dn.copy(this._targetEnd).lerp(n,r),c=l.dot(o),h=o.multiplyScalar(c-a);l.sub(h),this._boundary.clampPoint(l,l);const d=_n.subVectors(l,this._targetEnd);this._targetEnd.copy(l),this._target.add(d),this._changedZoom-=e,In(this._changedZoom)&&(this._changedZoom=0)}this._camera.zoom!==this._zoom&&(this._camera.zoom=this._zoom,this._camera.updateProjectionMatrix(),this._updateNearPlaneCorners(),this._needsUpdate=!0),this._dragNeedsUpdate=!0;const a=this._collisionTest();this._spherical.radius=Math.min(this._spherical.radius,a),this._spherical.makeSafe(),this._camera.position.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse).add(this._target),this._camera.lookAt(this._target),(!In(this._focalOffset.x)||!In(this._focalOffset.y)||!In(this._focalOffset.z))&&(this._camera.updateMatrixWorld(),Vn.setFromMatrixColumn(this._camera.matrix,0),zn.setFromMatrixColumn(this._camera.matrix,1),kn.setFromMatrixColumn(this._camera.matrix,2),Vn.multiplyScalar(this._focalOffset.x),zn.multiplyScalar(-this._focalOffset.y),kn.multiplyScalar(this._focalOffset.z),Dn.copy(Vn).add(zn).add(kn),this._camera.position.add(Dn)),this._boundaryEnclosesCamera&&this._encloseToBoundary(this._camera.position.copy(this._target),Dn.setFromSpherical(this._spherical).applyQuaternion(this._yAxisUpSpaceInverse),1);const l=this._needsUpdate;return l&&!this._updatedLastTime?(this._hasRested=!1,this.dispatchEvent({type:"wake"}),this.dispatchEvent({type:"update"})):l?(this.dispatchEvent({type:"update"}),In(t,this.restThreshold)&&In(i,this.restThreshold)&&In(s,this.restThreshold)&&In(n.x,this.restThreshold)&&In(n.y,this.restThreshold)&&In(n.z,this.restThreshold)&&In(r.x,this.restThreshold)&&In(r.y,this.restThreshold)&&In(r.z,this.restThreshold)&&In(o,this.restThreshold)&&!this._hasRested&&(this._hasRested=!0,this.dispatchEvent({type:"rest"}))):!l&&this._updatedLastTime&&this.dispatchEvent({type:"sleep"}),this._lastDistance=this._spherical.radius,this._lastZoom=this._zoom,this._updatedLastTime=l,this._needsUpdate=!1,l}toJSON(){return JSON.stringify({enabled:this._enabled,minDistance:this.minDistance,maxDistance:Cn(this.maxDistance),minZoom:this.minZoom,maxZoom:Cn(this.maxZoom),minPolarAngle:this.minPolarAngle,maxPolarAngle:Cn(this.maxPolarAngle),minAzimuthAngle:Cn(this.minAzimuthAngle),maxAzimuthAngle:Cn(this.maxAzimuthAngle),smoothTime:this.smoothTime,draggingSmoothTime:this.draggingSmoothTime,dollySpeed:this.dollySpeed,truckSpeed:this.truckSpeed,dollyToCursor:this.dollyToCursor,verticalDragToForward:this.verticalDragToForward,target:this._targetEnd.toArray(),position:Dn.setFromSpherical(this._sphericalEnd).add(this._targetEnd).toArray(),zoom:this._zoomEnd,focalOffset:this._focalOffsetEnd.toArray(),target0:this._target0.toArray(),position0:this._position0.toArray(),zoom0:this._zoom0,focalOffset0:this._focalOffset0.toArray()})}fromJSON(e,t=!1){const i=JSON.parse(e);this.enabled=i.enabled,this.minDistance=i.minDistance,this.maxDistance=Tn(i.maxDistance),this.minZoom=i.minZoom,this.maxZoom=Tn(i.maxZoom),this.minPolarAngle=i.minPolarAngle,this.maxPolarAngle=Tn(i.maxPolarAngle),this.minAzimuthAngle=Tn(i.minAzimuthAngle),this.maxAzimuthAngle=Tn(i.maxAzimuthAngle),this.smoothTime=i.smoothTime,this.draggingSmoothTime=i.draggingSmoothTime,this.dollySpeed=i.dollySpeed,this.truckSpeed=i.truckSpeed,this.dollyToCursor=i.dollyToCursor,this.verticalDragToForward=i.verticalDragToForward,this._target0.fromArray(i.target0),this._position0.fromArray(i.position0),this._zoom0=i.zoom0,this._focalOffset0.fromArray(i.focalOffset0),this.moveTo(i.target[0],i.target[1],i.target[2],t),Hn.setFromVector3(Dn.fromArray(i.position).sub(this._targetEnd).applyQuaternion(this._yAxisUpSpace)),this.rotateTo(Hn.theta,Hn.phi,t),this.dollyTo(Hn.radius,t),this.zoomTo(i.zoom,t),this.setFocalOffset(i.focalOffset[0],i.focalOffset[1],i.focalOffset[2],t),this._needsUpdate=!0}connect(e){this._domElement?console.warn("camera-controls is already connected."):(e.setAttribute("data-camera-controls-version","2.7.3"),this._addAllEventListeners(e),this._getClientRect(this._elementRect))}disconnect(){this.cancel(),this._removeAllEventListeners(),this._domElement&&(this._domElement.removeAttribute("data-camera-controls-version"),this._domElement=void 0)}dispose(){this.removeAllEventListeners(),this.disconnect()}_getTargetDirection(e){return e.setFromSpherical(this._spherical).divideScalar(this._spherical.radius).applyQuaternion(this._yAxisUpSpaceInverse)}_getCameraDirection(e){return this._getTargetDirection(e).negate()}_findPointerById(e){return this._activePointers.find((t=>t.pointerId===e))}_findPointerByMouseButton(e){return this._activePointers.find((t=>t.mouseButton===e))}_disposePointer(e){this._activePointers.splice(this._activePointers.indexOf(e),1)}_encloseToBoundary(e,t,i){const s=t.lengthSq();if(0===s)return e;const n=_n.copy(t).add(e),r=this._boundary.clampPoint(n,Un).sub(n),o=r.lengthSq();if(0===o)return e.add(t);if(o===s)return e;if(0===i)return e.add(t).add(r);{const s=1+i*o/t.dot(r);return e.add(_n.copy(t).multiplyScalar(s)).add(r.multiplyScalar(1-i))}}_updateNearPlaneCorners(){if(cn(this._camera)){const e=this._camera,t=e.near,i=e.getEffectiveFOV()*pn,s=Math.tan(.5*i)*t,n=s*e.aspect;this._nearPlaneCorners[0].set(-n,-s,0),this._nearPlaneCorners[1].set(n,-s,0),this._nearPlaneCorners[2].set(n,s,0),this._nearPlaneCorners[3].set(-n,s,0)}else if(hn(this._camera)){const e=this._camera,t=1/e.zoom,i=e.left*t,s=e.right*t,n=e.top*t,r=e.bottom*t;this._nearPlaneCorners[0].set(i,n,0),this._nearPlaneCorners[1].set(s,n,0),this._nearPlaneCorners[2].set(s,r,0),this._nearPlaneCorners[3].set(i,r,0)}}_collisionTest(){let e=1/0;if(!(this.colliderMeshes.length>=1)||yn(this._camera,"_collisionTest"))return e;const t=this._getTargetDirection(Bn);qn.lookAt(xn,t,this._camera.up);for(let i=0;i<4;i++){const s=_n.copy(this._nearPlaneCorners[i]);s.applyMatrix4(qn);const n=Un.addVectors(this._target,s);Jn.set(n,t),Jn.far=this._spherical.radius+1;const r=Jn.intersectObjects(this.colliderMeshes);0!==r.length&&r[0].distance<e&&(e=r[0].distance)}return e}_getClientRect(e){if(!this._domElement)return;const t=this._domElement.getBoundingClientRect();return e.x=t.left,e.y=t.top,this._viewport?(e.x+=this._viewport.x,e.y+=t.height-this._viewport.w-this._viewport.y,e.width=this._viewport.z,e.height=this._viewport.w):(e.width=t.width,e.height=t.height),e}_createOnRestPromise(e){return e?Promise.resolve():(this._hasRested=!1,this.dispatchEvent({type:"transitionstart"}),new Promise((e=>{const t=()=>{this.removeEventListener("rest",t),e()};this.addEventListener("rest",t)})))}_addAllEventListeners(e){}_removeAllEventListeners(){}get dampingFactor(){return console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead."),0}set dampingFactor(e){console.warn(".dampingFactor has been deprecated. use smoothTime (in seconds) instead.")}get draggingDampingFactor(){return console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead."),0}set draggingDampingFactor(e){console.warn(".draggingDampingFactor has been deprecated. use draggingSmoothTime (in seconds) instead.")}static createBoundingSphere(e,t=new Pn.Sphere){const i=t,s=i.center;Xn.makeEmpty(),e.traverseVisible((e=>{e.isMesh&&Xn.expandByObject(e)})),Xn.getCenter(s);let n=0;return e.traverseVisible((e=>{if(!e.isMesh)return;const t=e,i=t.geometry.clone();i.applyMatrix4(t.matrixWorld);const r=i.attributes.position;for(let e=0,t=r.count;e<t;e++)Dn.fromBufferAttribute(r,e),n=Math.max(n,s.distanceToSquared(Dn))})),i.radius=Math.sqrt(n),i}}class er extends Gi{constructor(e){super(e),ue(this,"onBeforeUpdate",new Bi),ue(this,"onAfterUpdate",new Bi),ue(this,"onAspectUpdated",new Bi),ue(this,"onDisposed",new Bi),ue(this,"three"),ue(this,"_allControls",new Map),ue(this,"updateAspect",(()=>{var e;if(this.currentWorld&&this.currentWorld.renderer){if(this.three instanceof i.OrthographicCamera)return void this.onAspectUpdated.trigger();if(null!=(e=this.currentWorld.renderer)&&e.isResizeable()){const e=this.currentWorld.renderer.getSize();this.three.aspect=e.width/e.height,this.three.updateProjectionMatrix(),this.onAspectUpdated.trigger()}}})),this.three=this.setupCamera(),this.setupEvents(!0),this.onWorldChanged.add((({action:e,world:t})=>{if("added"===e){const e=this.newCameraControls();this._allControls.set(t.uuid,e)}if("removed"===e){const e=this._allControls.get(t.uuid);e&&(e.dispose(),this._allControls.delete(t.uuid))}}))}get controls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");const e=this._allControls.get(this.currentWorld.uuid);if(!e)throw new Error("Controls not found!");return e}get enabled(){return null!==this.currentWorld&&this.controls.enabled}set enabled(e){null!==this.currentWorld&&(this.controls.enabled=e)}dispose(){this.setupEvents(!1),this.onAspectUpdated.reset(),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.three.removeFromParent(),this.onDisposed.trigger(),this.onDisposed.reset();for(const[e,t]of this._allControls)t.dispose()}update(e){this.enabled&&(this.onBeforeUpdate.trigger(this),this.controls.update(e),this.onAfterUpdate.trigger(this))}setupCamera(){const e=window.innerWidth/window.innerHeight,t=new i.PerspectiveCamera(60,e,1,1e3);return t.position.set(50,50,50),t.lookAt(new i.Vector3(0,0,0)),t}newCameraControls(){if(!this.currentWorld)throw new Error("This camera needs a world to work!");if(!this.currentWorld.renderer)throw new Error("This camera needs a renderer to work!");$n.install({THREE:er.getSubsetOfThree()});const{domElement:e}=this.currentWorld.renderer.three,t=new $n(this.three,e);return t.smoothTime=.2,t.dollyToCursor=!0,t.infinityDolly=!0,t.minDistance=6,t}setupEvents(e){e?window.addEventListener("resize",this.updateAspect):window.removeEventListener("resize",this.updateAspect)}static getSubsetOfThree(){return{MOUSE:i.MOUSE,Vector2:i.Vector2,Vector3:i.Vector3,Vector4:i.Vector4,Quaternion:i.Quaternion,Matrix4:i.Matrix4,Spherical:i.Spherical,Box3:i.Box3,Sphere:i.Sphere,Raycaster:i.Raycaster,MathUtils:i.MathUtils}}}const tr=class e extends ki{constructor(t){super(t),ue(this,"onAfterUpdate",new Bi),ue(this,"onBeforeUpdate",new Bi),ue(this,"onDisposed",new Bi),ue(this,"list",new ji),ue(this,"enabled",!0),t.add(e.uuid,this)}create(){const e=new Qs(this.components),t=e.uuid;if(this.list.has(t))throw new Error("There is already a world with this name!");return this.list.set(t,e),e}delete(e){if(!this.list.has(e.uuid))throw new Error("The provided world is not found in the list!");this.list.delete(e.uuid),e.dispose()}dispose(){this.enabled=!1;for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger()}update(e){if(this.enabled)for(const[t,i]of this.list)i.update(e)}};ue(tr,"uuid","fdb61dc4-2ec1-4966-b83d-54ea795fad4a");let ir=tr;async function sr(e,t,i,s,n,r,o){const a=e.fenceSync(e.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),await function(e,t,i,s){return new Promise(((n,r)=>{!function o(){const a=e.clientWaitSync(t,i,0);a!==e.WAIT_FAILED?a!==e.TIMEOUT_EXPIRED?n():setTimeout(o,s):r()}()}))}(e,a,0,10),e.deleteSync(a),e.bindBuffer(t,i),e.getBufferSubData(t,s,n,r,o),e.bindBuffer(t,null)}class nr extends qs{constructor(){super(...arguments),ue(this,"_config",{enabled:{value:!0,type:"Boolean"},width:{type:"Number",interpolable:!0,value:512,min:32,max:1024},height:{type:"Number",interpolable:!0,value:512,min:32,max:1024},autoUpdate:{value:!0,type:"Boolean"},renderDebugFrame:{value:!1,type:"Boolean"},updateInterval:{type:"Number",interpolable:!0,value:1,min:0,max:1},threshold:{type:"Number",interpolable:!0,value:100,min:1,max:512}}),ue(this,"_interval",null)}get enabled(){return this._config.enabled.value}set enabled(e){this._config.enabled.value=e,this._component.enabled=e}get width(){return this._config.width.value}set width(e){this.setWidthHeight(e,this.height)}get height(){return this._config.height.value}set height(e){this.setWidthHeight(this.width,e)}get autoUpdate(){return this._config.autoUpdate.value}set autoUpdate(e){this.setAutoAndInterval(e,this.updateInterval)}get updateInterval(){return this._config.updateInterval.value}set updateInterval(e){this.setAutoAndInterval(this.autoUpdate,e)}get renderDebugFrame(){return this._config.renderDebugFrame.value}set renderDebugFrame(e){this._config.renderDebugFrame.value=e}get threshold(){return this._config.threshold.value}set threshold(e){this._config.threshold.value=e}setWidthHeight(e,t){if(e<=0||t<=0)throw new Error("The width and height of the culler renderer must be more than 0!");this._config.width.value=e,this._config.height.value=t,this.resetRenderTarget()}setAutoAndInterval(e,t){if(t<=0)throw new Error("The updateInterval of the culler renderer must be more than 0!");this._config.autoUpdate.value=e,this._config.updateInterval.value=t,this.resetInterval(e)}resetRenderTarget(){this._component.renderTarget.dispose(),this._component.renderTarget=new i.WebGLRenderTarget(this.width,this.height),this._component.bufferSize=this.width*this.height*4,this._component.buffer=new Uint8Array(this._component.bufferSize)}resetInterval(e){null!==this._interval&&window.clearInterval(this._interval),e&&(this._interval=window.setInterval((async()=>{this._component.preventUpdate||await this._component.updateVisibility()}),this.updateInterval))}}class rr{constructor(e,t){if(ue(this,"onSetup",new Bi),ue(this,"onDisposed",new Bi),ue(this,"onViewUpdated",new Vi),ue(this,"enabled",!0),ue(this,"needsUpdate",!1),ue(this,"components"),ue(this,"renderTarget",new i.WebGLRenderTarget),ue(this,"bufferSize",1),ue(this,"buffer",new Uint8Array),ue(this,"preventUpdate",!1),ue(this,"config"),ue(this,"isSetup",!1),ue(this,"world"),ue(this,"renderer"),ue(this,"_defaultConfig",{enabled:!0,height:512,width:512,updateInterval:1e3,autoUpdate:!0,renderDebugFrame:!1,threshold:100}),ue(this,"worker"),ue(this,"scene",new i.Scene),ue(this,"_availableColor",1),ue(this,"_isWorkerBusy",!1),ue(this,"updateVisibility",(async e=>{if(!this.enabled||!this.needsUpdate&&!e||this._isWorkerBusy)return;this._isWorkerBusy=!0;const t=this.world.camera.three;t.updateMatrix();const{width:i,height:s}=this.config;this.renderer.setSize(i,s),this.renderer.setRenderTarget(this.renderTarget),this.renderer.render(this.scene,t);const n=this.renderer.getContext();await async function(e,t,i,s,n,r,o,a){const l=e.createBuffer();return e.bindBuffer(e.PIXEL_PACK_BUFFER,l),e.bufferData(e.PIXEL_PACK_BUFFER,a.byteLength,e.STREAM_READ),e.readPixels(t,i,s,n,r,o,0),e.bindBuffer(e.PIXEL_PACK_BUFFER,null),await sr(e,e.PIXEL_PACK_BUFFER,l,0,a),e.deleteBuffer(l),a}(n,0,0,i,s,n.RGBA,n.UNSIGNED_BYTE,this.buffer),this.renderer.setRenderTarget(null),this.config.renderDebugFrame&&this.renderer.render(this.scene,t),this.worker.postMessage({buffer:this.buffer}),this.needsUpdate=!1})),!t.renderer)throw new Error("The given world must have a renderer!");this.components=e,this.config=new nr(this,this.components,"Culler renderer"),this.world=t,this.renderer=new i.WebGLRenderer,this.renderer.clippingPlanes=t.renderer.clippingPlanes;const s=new Blob(['\n      addEventListener("message", (event) => {\n        const { buffer } = event.data;\n        const colors = new Map();\n        for (let i = 0; i < buffer.length; i += 4) {\n          const r = buffer[i];\n          const g = buffer[i + 1];\n          const b = buffer[i + 2];\n          const code = "" + r + "-" + g + "-" + b;\n          if(colors.has(code)) {\n            colors.set(code, colors.get(code) + 1);\n          } else {\n            colors.set(code, 1);\n          }\n        }\n        postMessage({ colors });\n      });\n    '],{type:"application/javascript"});this.worker=new Worker(URL.createObjectURL(s)),this.setup()}dispose(){this.enabled=!1,this.config.autoUpdate=!1,this.components.get($s).list.delete(this.config.uuid);for(const e of this.scene.children)e.removeFromParent();this.onViewUpdated.reset(),this.worker.terminate(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.renderTarget.dispose(),this.buffer=null,this.onDisposed.reset()}setup(e){const t={...this._defaultConfig,...e},{width:i,height:s}=t;this.config.setWidthHeight(i,s);const{updateInterval:n,autoUpdate:r}=t;this.config.setAutoAndInterval(r,n),this.config.threshold=t.threshold,this.isSetup=!0,this.onSetup.trigger()}getAvailableColor(){let e=BigInt(this._availableColor.toString());const t=[];do{t.unshift(Number(e%256n)),e/=256n}while(e);for(;3!==t.length;)t.unshift(0);const[i,s,n]=t;return{r:i,g:s,b:n,code:`${i}-${s}-${n}`}}increaseColor(){16777216!==this._availableColor?this._availableColor++:console.warn("Color can't be increased over 256 x 256 x 256!")}decreaseColor(){1!==this._availableColor?this._availableColor--:console.warn("Color can't be decreased under 0!")}}class or extends rr{constructor(e,t){super(e,t),ue(this,"onViewUpdated",new Bi),ue(this,"colorMeshes",new Map),ue(this,"_colorCodeMeshMap",new Map),ue(this,"_meshIDColorCodeMap",new Map),ue(this,"_currentVisibleMeshes",new Set),ue(this,"_recentlyHiddenMeshes",new Set),ue(this,"_transparentMat",new i.MeshBasicMaterial({transparent:!0,opacity:0})),ue(this,"handleWorkerMessage",(async e=>{if(this.preventUpdate)return;const t=e.data.colors;this._recentlyHiddenMeshes=new Set(this._currentVisibleMeshes),this._currentVisibleMeshes.clear();for(const[e,i]of t){if(i<this.config.threshold)continue;const t=this._colorCodeMeshMap.get(e);t&&(this._currentVisibleMeshes.add(t),this._recentlyHiddenMeshes.delete(t))}this.onViewUpdated.trigger({seen:this._currentVisibleMeshes,unseen:this._recentlyHiddenMeshes}),this._isWorkerBusy=!1})),this.worker.addEventListener("message",this.handleWorkerMessage),this.onViewUpdated.add((({seen:e,unseen:t})=>{for(const t of e)t.visible=!0;for(const e of t)e.visible=!1}))}get threshold(){return this.config.threshold}set threshold(e){this.config.threshold=e}dispose(){super.dispose(),this._currentVisibleMeshes.clear(),this._recentlyHiddenMeshes.clear(),this._meshIDColorCodeMap.clear(),this._transparentMat.dispose(),this._colorCodeMeshMap.clear();const e=this.components.get(Xi);for(const t in this.colorMeshes){const i=this.colorMeshes.get(t);i&&e.destroy(i,!0)}this.colorMeshes.clear()}add(e){if(!this.enabled)return;if(this.preventUpdate)return void console.log("Culler processing not finished yet.");this.preventUpdate=!0;const t=e instanceof i.InstancedMesh,{geometry:s,material:n}=e,{colorMaterial:r,code:o}=this.getAvailableMaterial();let a;if(Array.isArray(n)){let e=!0;const t=[];for(const i of n)ps.isTransparent(i)?t.push(this._transparentMat):(e=!1,t.push(r));if(e)return r.dispose(),void(this.preventUpdate=!1);a=t}else{if(ps.isTransparent(n))return r.dispose(),void(this.preventUpdate=!1);a=r}this._colorCodeMeshMap.set(o,e),this._meshIDColorCodeMap.set(e.uuid,o);const l=t?e.count:1,c=new i.InstancedMesh(s,a,l);t?c.instanceMatrix=e.instanceMatrix:c.setMatrixAt(0,new i.Matrix4),e.visible=!1,e.updateWorldMatrix(!0,!1),c.applyMatrix4(e.matrixWorld),c.updateMatrix(),this.scene.add(c),this.colorMeshes.set(e.uuid,c),this.increaseColor(),this.preventUpdate=!1}remove(e){if(this.preventUpdate)return void console.log("Culler processing not finished yet.");this.preventUpdate=!0;const t=this.components.get(Xi);this._currentVisibleMeshes.delete(e),this._recentlyHiddenMeshes.delete(e);const i=this.colorMeshes.get(e.uuid),s=this._meshIDColorCodeMap.get(e.uuid);i&&s?(this._colorCodeMeshMap.delete(s),this._meshIDColorCodeMap.delete(e.uuid),this.colorMeshes.delete(e.uuid),i.geometry=void 0,i.material=[],t.destroy(i,!0),this._recentlyHiddenMeshes.delete(e),this._currentVisibleMeshes.delete(e),this.preventUpdate=!1):this.preventUpdate=!1}updateInstanced(e){for(const t of e){const e=this.colorMeshes.get(t.uuid);e&&(e.count=t.count)}}getAvailableMaterial(){const{r:e,g:t,b:s,code:n}=this.getAvailableColor(),r=i.ColorManagement.enabled;i.ColorManagement.enabled=!1;const o=new i.Color(`rgb(${e}, ${t}, ${s})`);if(!this.world.renderer)throw new Error("Renderer not found in the world!");const a=this.world.renderer.clippingPlanes,l=new i.MeshBasicMaterial({color:o,clippingPlanes:a,side:i.DoubleSide});return i.ColorManagement.enabled=r,{colorMaterial:l,code:n}}}const ar=class e extends ki{constructor(t){super(t),ue(this,"onDisposed",new Bi),ue(this,"_enabled",!0),ue(this,"list",new Map),t.add(e.uuid,this)}get enabled(){return this._enabled}set enabled(e){this._enabled=e;for(const[t,i]of this.list)i.enabled=e}create(e){if(this.list.has(e.uuid))return this.list.get(e.uuid);const t=new or(this.components,e);return this.list.set(e.uuid,t),t}delete(e){const t=this.list.get(e.uuid);t&&t.dispose(),this.list.delete(e.uuid)}dispose(){this.enabled=!1,this.onDisposed.trigger(e.uuid),this.onDisposed.reset();for(const[e,t]of this.list)t.dispose();this.list.clear()}updateInstanced(e){for(const[,t]of this.list)t.updateInstanced(e)}};ue(ar,"uuid","69f2a50d-c266-44fc-b1bd-fa4d34be89e6");let lr=ar;class cr{constructor(e){ue(this,"_event"),ue(this,"_position",new i.Vector2),ue(this,"onDisposed",new Bi),ue(this,"updateMouseInfo",(e=>{this._event=e})),this.dom=e,this.setupEvents(!0)}get position(){if(this._event){const e=this.dom.getBoundingClientRect();this._position.x=this.getPositionX(e,this._event),this._position.y=this.getPositionY(e,this._event)}return this._position}dispose(){this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset()}getPositionY(e,t){return-(this.getDataObject(t).clientY-e.top)/(e.bottom-e.top)*2+1}getPositionX(e,t){return(this.getDataObject(t).clientX-e.left)/(e.right-e.left)*2-1}getDataObject(e){return e instanceof MouseEvent?e:e.touches[0]}setupEvents(e){e?(this.dom.addEventListener("pointermove",this.updateMouseInfo),this.dom.addEventListener("touchstart",this.updateMouseInfo)):(this.dom.removeEventListener("pointermove",this.updateMouseInfo),this.dom.removeEventListener("touchstart",this.updateMouseInfo))}}class hr{constructor(e,t){ue(this,"enabled",!0),ue(this,"components"),ue(this,"onDisposed",new Bi),ue(this,"mouse"),ue(this,"three",new i.Raycaster),ue(this,"world");const s=t.renderer;if(!s)throw new Error("A renderer is needed for the raycaster to work!");this.world=t,this.mouse=new cr(s.three.domElement),this.components=e}dispose(){this.mouse.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}castRay(e=Array.from(this.world.meshes),t=this.mouse.position){if(!this.world)throw new Error("A world is needed to cast rays!");const i=this.world.camera.three;return this.three.setFromCamera(t,i),this.intersect(e)}castRayFromVector(e,t,i=Array.from(this.world.meshes)){return this.three.set(e,t),this.intersect(i)}intersect(e=Array.from(this.world.meshes)){const t=this.three.intersectObjects(e),i=this.filterClippingPlanes(t);return i.length>0?i[0]:null}filterClippingPlanes(e){if(!this.world.renderer)throw new Error("Renderer not found!");const t=this.world.renderer.three;if(!t.clippingPlanes)return e;const i=t.clippingPlanes;return e.length<=0||!i||(null==i?void 0:i.length)<=0?e:e.filter((e=>i.every((t=>t.distanceToPoint(e.point)>0))))}}const dr=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),ue(this,"list",new Map),ue(this,"onDisposed",new Bi),t.add(e.uuid,this)}get(e){if(this.list.has(e.uuid))return this.list.get(e.uuid);const t=new hr(this.components,e);return this.list.set(e.uuid,t),e.onDisposed.add((()=>{this.delete(e)})),t}delete(e){const t=this.list.get(e.uuid);t&&t.dispose(),this.list.delete(e.uuid)}dispose(){for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger()}};ue(dr,"uuid","d5d8bdf0-db25-4952-b951-b643af207ace");let ur=dr;class fr extends qs{constructor(){super(...arguments),ue(this,"_config",{visible:{value:!0,type:"Boolean"},color:{value:new i.Color,type:"Color"},primarySize:{type:"Number",interpolable:!0,value:1,min:0,max:1e3},secondarySize:{type:"Number",interpolable:!0,value:10,min:0,max:1e3},distance:{type:"Number",interpolable:!0,value:500,min:0,max:500}})}get visible(){return this._config.visible.value}set visible(e){this._config.visible.value=e,this._component.visible=e}get color(){return this._config.color.value}set color(e){this._config.color.value=e,this._component.material.uniforms.uColor.value=e,this._component.material.uniformsNeedUpdate=!0}get primarySize(){return this._config.primarySize.value}set primarySize(e){this._config.primarySize.value=e,this._component.material.uniforms.uSize1.value=e,this._component.material.uniformsNeedUpdate=!0}get secondarySize(){return this._config.secondarySize.value}set secondarySize(e){this._config.secondarySize.value=e,this._component.material.uniforms.uSize2.value=e,this._component.material.uniformsNeedUpdate=!0}get distance(){return this._config.distance.value}set distance(e){this._config.distance.value=e,this._component.material.uniforms.uDistance.value=e,this._component.material.uniformsNeedUpdate=!0}}class pr{constructor(e,t){ue(this,"onDisposed",new Bi),ue(this,"onSetup",new Bi),ue(this,"isSetup",!1),ue(this,"world"),ue(this,"components"),ue(this,"config"),ue(this,"_defaultConfig",{visible:!0,color:new i.Color(12303291),primarySize:1,secondarySize:10,distance:500}),ue(this,"three"),ue(this,"_fade",3),ue(this,"updateZoom",(()=>{this.world.camera instanceof er&&(this.material.uniforms.uZoom.value=this.world.camera.three.zoom)})),this.world=t;const{color:s,primarySize:n,secondarySize:r,distance:o}=this._defaultConfig;this.components=e,this.config=new fr(this,this.components,"Grid");const a=new i.PlaneGeometry(2,2,1,1),l=new i.ShaderMaterial({side:i.DoubleSide,uniforms:{uSize1:{value:n},uSize2:{value:r},uColor:{value:s},uDistance:{value:o},uFade:{value:this._fade},uZoom:{value:1}},transparent:!0,vertexShader:"\n            \n            varying vec3 worldPosition;\n            \n            uniform float uDistance;\n            \n            void main() {\n            \n                    vec3 pos = position.xzy * uDistance;\n                    pos.xz += cameraPosition.xz;\n                    \n                    worldPosition = pos;\n                    \n                    gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);\n            \n            }\n            ",fragmentShader:"\n            \n            varying vec3 worldPosition;\n            \n            uniform float uZoom;\n            uniform float uFade;\n            uniform float uSize1;\n            uniform float uSize2;\n            uniform vec3 uColor;\n            uniform float uDistance;\n                \n                \n                \n                float getGrid(float size) {\n                \n                    vec2 r = worldPosition.xz / size;\n                    \n                    \n                    vec2 grid = abs(fract(r - 0.5) - 0.5) / fwidth(r);\n                    float line = min(grid.x, grid.y);\n                    \n                \n                    return 1.0 - min(line, 1.0);\n                }\n                \n            void main() {\n            \n                    \n                    float d = 1.0 - min(distance(cameraPosition.xz, worldPosition.xz) / uDistance, 1.0);\n                    \n                    float g1 = getGrid(uSize1);\n                    float g2 = getGrid(uSize2);\n                    \n                    // Ortho camera fades the grid away when zooming out\n                    float minZoom = step(0.2, uZoom);\n                    float zoomFactor = pow(min(uZoom, 1.), 2.) * minZoom;\n                    \n                    gl_FragColor = vec4(uColor.rgb, mix(g2, g1, g1) * pow(d, uFade));\n                    gl_FragColor.a = mix(0.5 * gl_FragColor.a, gl_FragColor.a, g2) * zoomFactor;\n                    \n                    if ( gl_FragColor.a <= 0.0 ) discard;\n                    \n            \n            }\n            \n            ",extensions:{derivatives:!0}});this.three=new i.Mesh(a,l),this.three.frustumCulled=!1,t.scene.three.add(this.three),this.setupEvents(!0)}get visible(){return this.three.visible}set visible(e){e?this.world.scene.three.add(this.three):this.three.removeFromParent()}get material(){return this.three.material}get fade(){return 3===this._fade}set fade(e){this._fade=e?3:0,this.material.uniforms.uFade.value=this._fade}setup(e){const t={...this._defaultConfig,...e};this.config.visible=!0,this.config.color=t.color,this.config.primarySize=t.primarySize,this.config.secondarySize=t.secondarySize,this.config.distance=t.distance,this.isSetup=!0,this.onSetup.trigger()}dispose(){this.setupEvents(!1),this.components.get($s).list.delete(this.config.uuid),this.components.get(Xi).destroy(this.three),this.onDisposed.trigger(),this.onDisposed.reset(),this.world=null,this.components=null}setupEvents(e){if(this.world.isDisposing||!(this.world.camera instanceof er))return;const t=this.world.camera.controls;e?t.addEventListener("update",this.updateZoom):t.removeEventListener("update",this.updateZoom)}}ue(class e extends ki{constructor(t){super(t),ue(this,"list",new Map),ue(this,"onDisposed",new Bi),ue(this,"enabled",!0),t.add(e.uuid,this)}create(e){if(this.list.has(e.uuid))throw new Error("This world already has a grid!");const t=new pr(this.components,e);return this.list.set(e.uuid,t),e.onDisposed.add((()=>{this.delete(e)})),t}delete(e){const t=this.list.get(e.uuid);t&&t.dispose(),this.list.delete(e.uuid)}dispose(){for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}},"uuid","d1e814d5-b81c-4452-87a2-f039375e0489");const mr=new h,Ir=new s,Er=new s,gr=new d,Cr={X:new s(1,0,0),Y:new s(0,1,0),Z:new s(0,0,1)},Tr={type:"change"},Rr={type:"mouseDown"},vr={type:"mouseUp",mode:null},Sr={type:"objectChange"};class yr extends m{constructor(e,t){super(),void 0===t&&(console.warn('THREE.TransformControls: The second parameter "domElement" is now mandatory.'),t=document),this.isTransformControls=!0,this.visible=!1,this.domElement=t,this.domElement.style.touchAction="none";const i=new Wr;this._gizmo=i,this.add(i);const n=new Xr;this._plane=n,this.add(n);const r=this;function o(e,t){let s=t;Object.defineProperty(r,e,{get:function(){return void 0!==s?s:t},set:function(t){s!==t&&(s=t,n[e]=t,i[e]=t,r.dispatchEvent({type:e+"-changed",value:t}),r.dispatchEvent(Tr))}}),r[e]=t,n[e]=t,i[e]=t}o("camera",e),o("object",void 0),o("enabled",!0),o("axis",null),o("mode","translate"),o("translationSnap",null),o("rotationSnap",null),o("scaleSnap",null),o("space","world"),o("size",1),o("dragging",!1),o("showX",!0),o("showY",!0),o("showZ",!0);const a=new s,l=new s,c=new d,h=new d,u=new s,f=new d,p=new s,m=new s,I=new s,E=new s;o("worldPosition",a),o("worldPositionStart",l),o("worldQuaternion",c),o("worldQuaternionStart",h),o("cameraPosition",u),o("cameraQuaternion",f),o("pointStart",p),o("pointEnd",m),o("rotationAxis",I),o("rotationAngle",0),o("eye",E),this._offset=new s,this._startNorm=new s,this._endNorm=new s,this._cameraScale=new s,this._parentPosition=new s,this._parentQuaternion=new d,this._parentQuaternionInv=new d,this._parentScale=new s,this._worldScaleStart=new s,this._worldQuaternionInv=new d,this._worldScale=new s,this._positionStart=new s,this._quaternionStart=new d,this._scaleStart=new s,this._getPointer=wr.bind(this),this._onPointerDown=Fr.bind(this),this._onPointerHover=Ar.bind(this),this._onPointerMove=Or.bind(this),this._onPointerUp=Nr.bind(this),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp)}updateMatrixWorld(){void 0!==this.object&&(this.object.updateMatrixWorld(),null===this.object.parent?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):this.object.parent.matrixWorld.decompose(this._parentPosition,this._parentQuaternion,this._parentScale),this.object.matrixWorld.decompose(this.worldPosition,this.worldQuaternion,this._worldScale),this._parentQuaternionInv.copy(this._parentQuaternion).invert(),this._worldQuaternionInv.copy(this.worldQuaternion).invert()),this.camera.updateMatrixWorld(),this.camera.matrixWorld.decompose(this.cameraPosition,this.cameraQuaternion,this._cameraScale),this.camera.isOrthographicCamera?this.camera.getWorldDirection(this.eye).negate():this.eye.copy(this.cameraPosition).sub(this.worldPosition).normalize(),super.updateMatrixWorld(this)}pointerHover(e){if(void 0===this.object||!0===this.dragging)return;mr.setFromCamera(e,this.camera);const t=Pr(this._gizmo.picker[this.mode],mr);this.axis=t?t.object.name:null}pointerDown(e){if(void 0!==this.object&&!0!==this.dragging&&0===e.button&&null!==this.axis){mr.setFromCamera(e,this.camera);const t=Pr(this._plane,mr,!0);t&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(t.point).sub(this.worldPositionStart)),this.dragging=!0,Rr.mode=this.mode,this.dispatchEvent(Rr)}}pointerMove(e){const t=this.axis,i=this.mode,s=this.object;let n=this.space;if("scale"===i?n="local":("E"===t||"XYZE"===t||"XYZ"===t)&&(n="world"),void 0===s||null===t||!1===this.dragging||-1!==e.button)return;mr.setFromCamera(e,this.camera);const r=Pr(this._plane,mr,!0);if(r){if(this.pointEnd.copy(r.point).sub(this.worldPositionStart),"translate"===i)this._offset.copy(this.pointEnd).sub(this.pointStart),"local"===n&&"XYZ"!==t&&this._offset.applyQuaternion(this._worldQuaternionInv),-1===t.indexOf("X")&&(this._offset.x=0),-1===t.indexOf("Y")&&(this._offset.y=0),-1===t.indexOf("Z")&&(this._offset.z=0),"local"===n&&"XYZ"!==t?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&("local"===n&&(s.position.applyQuaternion(gr.copy(this._quaternionStart).invert()),-1!==t.search("X")&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),"world"===n&&(s.parent&&s.position.add(Ir.setFromMatrixPosition(s.parent.matrixWorld)),-1!==t.search("X")&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),-1!==t.search("Y")&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),-1!==t.search("Z")&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(Ir.setFromMatrixPosition(s.parent.matrixWorld))));else if("scale"===i){if(-1!==t.search("XYZ")){let e=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(e*=-1),Er.set(e,e,e)}else Ir.copy(this.pointStart),Er.copy(this.pointEnd),Ir.applyQuaternion(this._worldQuaternionInv),Er.applyQuaternion(this._worldQuaternionInv),Er.divide(Ir),-1===t.search("X")&&(Er.x=1),-1===t.search("Y")&&(Er.y=1),-1===t.search("Z")&&(Er.z=1);s.scale.copy(this._scaleStart).multiply(Er),this.scaleSnap&&(-1!==t.search("X")&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Y")&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),-1!==t.search("Z")&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if("rotate"===i){this._offset.copy(this.pointEnd).sub(this.pointStart);const e=20/this.worldPosition.distanceTo(Ir.setFromMatrixPosition(this.camera.matrixWorld));let i=!1;"XYZE"===t?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(Ir.copy(this.rotationAxis).cross(this.eye))*e):("X"===t||"Y"===t||"Z"===t)&&(this.rotationAxis.copy(Cr[t]),Ir.copy(Cr[t]),"local"===n&&Ir.applyQuaternion(this.worldQuaternion),Ir.cross(this.eye),0===Ir.length()?i=!0:this.rotationAngle=this._offset.dot(Ir.normalize())*e),("E"===t||i)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),"local"===n&&"E"!==t&&"XYZE"!==t?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(gr.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(gr.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(Tr),this.dispatchEvent(Sr)}}pointerUp(e){0===e.button&&(this.dragging&&null!==this.axis&&(vr.mode=this.mode,this.dispatchEvent(vr)),this.dragging=!1,this.axis=null)}dispose(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.traverse((function(e){e.geometry&&e.geometry.dispose(),e.material&&e.material.dispose()}))}attach(e){return this.object=e,this.visible=!0,this}detach(){return this.object=void 0,this.visible=!1,this.axis=null,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(Tr),this.dispatchEvent(Sr),this.pointStart.copy(this.pointEnd))}getRaycaster(){return mr}getMode(){return this.mode}setMode(e){this.mode=e}setTranslationSnap(e){this.translationSnap=e}setRotationSnap(e){this.rotationSnap=e}setScaleSnap(e){this.scaleSnap=e}setSize(e){this.size=e}setSpace(e){this.space=e}}function wr(e){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:e.button};{const t=this.domElement.getBoundingClientRect();return{x:(e.clientX-t.left)/t.width*2-1,y:-(e.clientY-t.top)/t.height*2+1,button:e.button}}}function Ar(e){if(this.enabled)switch(e.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(e))}}function Fr(e){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(e.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(e)),this.pointerDown(this._getPointer(e)))}function Or(e){this.enabled&&this.pointerMove(this._getPointer(e))}function Nr(e){this.enabled&&(this.domElement.releasePointerCapture(e.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(e)))}function Pr(e,t,i){const s=t.intersectObject(e,!0);for(let e=0;e<s.length;e++)if(s[e].object.visible||i)return s[e];return!1}const xr=new u,Lr=new s(0,1,0),br=new s(0,0,0),Mr=new f,Dr=new d,_r=new d,Ur=new s,Br=new f,Vr=new s(1,0,0),zr=new s(0,1,0),kr=new s(0,0,1),Yr=new s,Gr=new s,Hr=new s;class Wr extends m{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const e=new I({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),t=new E({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),i=e.clone();i.opacity=.15;const s=t.clone();s.opacity=.5;const n=e.clone();n.color.setHex(16711680);const r=e.clone();r.color.setHex(65280);const o=e.clone();o.color.setHex(255);const a=e.clone();a.color.setHex(16711680),a.opacity=.5;const c=e.clone();c.color.setHex(65280),c.opacity=.5;const h=e.clone();h.color.setHex(255),h.opacity=.5;const d=e.clone();d.opacity=.25;const u=e.clone();u.color.setHex(16776960),u.opacity=.25,e.clone().color.setHex(16776960);const f=e.clone();f.color.setHex(7895160);const p=new g(0,.04,.1,12);p.translate(0,.05,0);const A=new C(.08,.08,.08);A.translate(0,.04,0);const F=new T;F.setAttribute("position",new R([0,0,0,1,0,0],3));const O=new g(.0075,.0075,.5,3);function N(e,t){const i=new w(e,.0075,3,64,t*Math.PI*2);return i.rotateY(Math.PI/2),i.rotateX(Math.PI/2),i}O.translate(0,.25,0);const P={X:[[new l(p,n),[.5,0,0],[0,0,-Math.PI/2]],[new l(p,n),[-.5,0,0],[0,0,Math.PI/2]],[new l(O,n),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new l(p,r),[0,.5,0]],[new l(p,r),[0,-.5,0],[Math.PI,0,0]],[new l(O,r)]],Z:[[new l(p,o),[0,0,.5],[Math.PI/2,0,0]],[new l(p,o),[0,0,-.5],[-Math.PI/2,0,0]],[new l(O,o),null,[Math.PI/2,0,0]]],XYZ:[[new l(new v(.1,0),d.clone()),[0,0,0]]],XY:[[new l(new C(.15,.15,.01),h.clone()),[.15,.15,0]]],YZ:[[new l(new C(.15,.15,.01),a.clone()),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new l(new C(.15,.15,.01),c.clone()),[.15,0,.15],[-Math.PI/2,0,0]]]},x={X:[[new l(new g(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new l(new g(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new l(new g(.2,0,.6,4),i),[0,.3,0]],[new l(new g(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new l(new g(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new l(new g(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new l(new v(.2,0),i)]],XY:[[new l(new C(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new l(new C(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new l(new C(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]]},L={START:[[new l(new v(.01,2),s),null,null,null,"helper"]],END:[[new l(new v(.01,2),s),null,null,null,"helper"]],DELTA:[[new S(function(){const e=new T;return e.setAttribute("position",new R([0,0,0,1,1,1],3)),e}(),s),null,null,null,"helper"]],X:[[new S(F,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new S(F,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new S(F,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},b={XYZE:[[new l(N(.5,1),f),null,[0,Math.PI/2,0]]],X:[[new l(N(.5,.5),n)]],Y:[[new l(N(.5,.5),r),null,[0,0,-Math.PI/2]]],Z:[[new l(N(.5,.5),o),null,[0,Math.PI/2,0]]],E:[[new l(N(.75,1),u),null,[0,Math.PI/2,0]]]},M={AXIS:[[new S(F,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]]},D={XYZE:[[new l(new y(.25,10,8),i)]],X:[[new l(new w(.5,.1,4,24),i),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new l(new w(.5,.1,4,24),i),[0,0,0],[Math.PI/2,0,0]]],Z:[[new l(new w(.5,.1,4,24),i),[0,0,0],[0,0,-Math.PI/2]]],E:[[new l(new w(.75,.1,2,24),i)]]},_={X:[[new l(A,n),[.5,0,0],[0,0,-Math.PI/2]],[new l(O,n),[0,0,0],[0,0,-Math.PI/2]],[new l(A,n),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new l(A,r),[0,.5,0]],[new l(O,r)],[new l(A,r),[0,-.5,0],[0,0,Math.PI]]],Z:[[new l(A,o),[0,0,.5],[Math.PI/2,0,0]],[new l(O,o),[0,0,0],[Math.PI/2,0,0]],[new l(A,o),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new l(new C(.15,.15,.01),h),[.15,.15,0]]],YZ:[[new l(new C(.15,.15,.01),a),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new l(new C(.15,.15,.01),c),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new l(new C(.1,.1,.1),d.clone())]]},U={X:[[new l(new g(.2,0,.6,4),i),[.3,0,0],[0,0,-Math.PI/2]],[new l(new g(.2,0,.6,4),i),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new l(new g(.2,0,.6,4),i),[0,.3,0]],[new l(new g(.2,0,.6,4),i),[0,-.3,0],[0,0,Math.PI]]],Z:[[new l(new g(.2,0,.6,4),i),[0,0,.3],[Math.PI/2,0,0]],[new l(new g(.2,0,.6,4),i),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new l(new C(.2,.2,.01),i),[.15,.15,0]]],YZ:[[new l(new C(.2,.2,.01),i),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new l(new C(.2,.2,.01),i),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new l(new C(.2,.2,.2),i),[0,0,0]]]},B={X:[[new S(F,s.clone()),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new S(F,s.clone()),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new S(F,s.clone()),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function V(e){const t=new m;for(const i in e)for(let s=e[i].length;s--;){const n=e[i][s][0].clone(),r=e[i][s][1],o=e[i][s][2],a=e[i][s][3],l=e[i][s][4];n.name=i,n.tag=l,r&&n.position.set(r[0],r[1],r[2]),o&&n.rotation.set(o[0],o[1],o[2]),a&&n.scale.set(a[0],a[1],a[2]),n.updateMatrix();const c=n.geometry.clone();c.applyMatrix4(n.matrix),n.geometry=c,n.renderOrder=1/0,n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),t.add(n)}return t}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=V(P)),this.add(this.gizmo.rotate=V(b)),this.add(this.gizmo.scale=V(_)),this.add(this.picker.translate=V(x)),this.add(this.picker.rotate=V(D)),this.add(this.picker.scale=V(U)),this.add(this.helper.translate=V(L)),this.add(this.helper.rotate=V(M)),this.add(this.helper.scale=V(B)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(e){const t="local"===("scale"===this.mode?"local":this.space)?this.worldQuaternion:_r;this.gizmo.translate.visible="translate"===this.mode,this.gizmo.rotate.visible="rotate"===this.mode,this.gizmo.scale.visible="scale"===this.mode,this.helper.translate.visible="translate"===this.mode,this.helper.rotate.visible="rotate"===this.mode,this.helper.scale.visible="scale"===this.mode;let i=[];i=i.concat(this.picker[this.mode].children),i=i.concat(this.gizmo[this.mode].children),i=i.concat(this.helper[this.mode].children);for(let e=0;e<i.length;e++){const s=i[e];let n;s.visible=!0,s.rotation.set(0,0,0),s.position.copy(this.worldPosition),(n=this.camera.isOrthographicCamera?(this.camera.top-this.camera.bottom)/this.camera.zoom:this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),s.scale.set(1,1,1).multiplyScalar(n*this.size/4),"helper"!==s.tag)?(s.quaternion.copy(t),"translate"===this.mode||"scale"===this.mode?("X"===s.name&&Math.abs(Lr.copy(Vr).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Y"===s.name&&Math.abs(Lr.copy(zr).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"Z"===s.name&&Math.abs(Lr.copy(kr).applyQuaternion(t).dot(this.eye))>.99&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XY"===s.name&&Math.abs(Lr.copy(kr).applyQuaternion(t).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"YZ"===s.name&&Math.abs(Lr.copy(Vr).applyQuaternion(t).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1),"XZ"===s.name&&Math.abs(Lr.copy(zr).applyQuaternion(t).dot(this.eye))<.2&&(s.scale.set(1e-10,1e-10,1e-10),s.visible=!1)):"rotate"===this.mode&&(Dr.copy(t),Lr.copy(this.eye).applyQuaternion(gr.copy(t).invert()),-1!==s.name.search("E")&&s.quaternion.setFromRotationMatrix(Mr.lookAt(this.eye,br,zr)),"X"===s.name&&(gr.setFromAxisAngle(Vr,Math.atan2(-Lr.y,Lr.z)),gr.multiplyQuaternions(Dr,gr),s.quaternion.copy(gr)),"Y"===s.name&&(gr.setFromAxisAngle(zr,Math.atan2(Lr.x,Lr.z)),gr.multiplyQuaternions(Dr,gr),s.quaternion.copy(gr)),"Z"===s.name&&(gr.setFromAxisAngle(kr,Math.atan2(Lr.y,Lr.x)),gr.multiplyQuaternions(Dr,gr),s.quaternion.copy(gr))),s.visible=s.visible&&(-1===s.name.indexOf("X")||this.showX),s.visible=s.visible&&(-1===s.name.indexOf("Y")||this.showY),s.visible=s.visible&&(-1===s.name.indexOf("Z")||this.showZ),s.visible=s.visible&&(-1===s.name.indexOf("E")||this.showX&&this.showY&&this.showZ),s.material._color=s.material._color||s.material.color.clone(),s.material._opacity=s.material._opacity||s.material.opacity,s.material.color.copy(s.material._color),s.material.opacity=s.material._opacity,this.enabled&&this.axis&&(s.name===this.axis||this.axis.split("").some((function(e){return s.name===e})))&&(s.material.color.setHex(16776960),s.material.opacity=1)):(s.visible=!1,"AXIS"===s.name?(s.visible=!!this.axis,"X"===this.axis&&(gr.setFromEuler(xr.set(0,0,0)),s.quaternion.copy(t).multiply(gr),Math.abs(Lr.copy(Vr).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Y"===this.axis&&(gr.setFromEuler(xr.set(0,0,Math.PI/2)),s.quaternion.copy(t).multiply(gr),Math.abs(Lr.copy(zr).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"Z"===this.axis&&(gr.setFromEuler(xr.set(0,Math.PI/2,0)),s.quaternion.copy(t).multiply(gr),Math.abs(Lr.copy(kr).applyQuaternion(t).dot(this.eye))>.9&&(s.visible=!1)),"XYZE"===this.axis&&(gr.setFromEuler(xr.set(0,Math.PI/2,0)),Lr.copy(this.rotationAxis),s.quaternion.setFromRotationMatrix(Mr.lookAt(br,Lr,zr)),s.quaternion.multiply(gr),s.visible=this.dragging),"E"===this.axis&&(s.visible=!1)):"START"===s.name?(s.position.copy(this.worldPositionStart),s.visible=this.dragging):"END"===s.name?(s.position.copy(this.worldPosition),s.visible=this.dragging):"DELTA"===s.name?(s.position.copy(this.worldPositionStart),s.quaternion.copy(this.worldQuaternionStart),Ir.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),Ir.applyQuaternion(this.worldQuaternionStart.clone().invert()),s.scale.copy(Ir),s.visible=this.dragging):(s.quaternion.copy(t),this.dragging?s.position.copy(this.worldPositionStart):s.position.copy(this.worldPosition),this.axis&&(s.visible=-1!==this.axis.search(s.name))))}super.updateMatrixWorld(e)}}class Xr extends l{constructor(){super(new A(1e5,1e5,2,2),new I({visible:!1,wireframe:!0,side:F,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(e){let t=this.space;switch(this.position.copy(this.worldPosition),"scale"===this.mode&&(t="local"),Yr.copy(Vr).applyQuaternion("local"===t?this.worldQuaternion:_r),Gr.copy(zr).applyQuaternion("local"===t?this.worldQuaternion:_r),Hr.copy(kr).applyQuaternion("local"===t?this.worldQuaternion:_r),Lr.copy(Gr),this.mode){case"translate":case"scale":switch(this.axis){case"X":Lr.copy(this.eye).cross(Yr),Ur.copy(Yr).cross(Lr);break;case"Y":Lr.copy(this.eye).cross(Gr),Ur.copy(Gr).cross(Lr);break;case"Z":Lr.copy(this.eye).cross(Hr),Ur.copy(Hr).cross(Lr);break;case"XY":Ur.copy(Hr);break;case"YZ":Ur.copy(Yr);break;case"XZ":Lr.copy(Hr),Ur.copy(Gr);break;case"XYZ":case"E":Ur.set(0,0,0)}break;default:Ur.set(0,0,0)}0===Ur.length()?this.quaternion.copy(this.cameraQuaternion):(Br.lookAt(Ir.set(0,0,0),Ur,Lr),this.quaternion.setFromRotationMatrix(Br)),super.updateMatrixWorld(e)}}class Zr{constructor(e,t,s,n,r,o=5,a=!0){if(ue(this,"onDraggingStarted",new Bi),ue(this,"onDraggingEnded",new Bi),ue(this,"onDisposed",new Bi),ue(this,"normal"),ue(this,"origin"),ue(this,"three",new i.Plane),ue(this,"components"),ue(this,"world"),ue(this,"type","default"),ue(this,"_helper"),ue(this,"_visible",!0),ue(this,"_enabled",!0),ue(this,"_controlsActive",!1),ue(this,"_arrowBoundBox",new i.Mesh),ue(this,"_planeMesh"),ue(this,"_controls"),ue(this,"_hiddenMaterial",new i.MeshBasicMaterial({visible:!1})),ue(this,"update",(()=>{this._enabled&&this.three.setFromNormalAndCoplanarPoint(this.normal,this._helper.position)})),ue(this,"changeDrag",(e=>{this._visible=!e.value,this.preventCameraMovement(),this.notifyDraggingChanged(e)})),this.components=e,this.world=t,!t.renderer)throw new Error("The given world must have a renderer!");this.normal=n,this.origin=s,t.renderer.setPlane(!0,this.three),this._planeMesh=Zr.newPlaneMesh(o,r),this._helper=this.newHelper(),this._controls=this.newTransformControls(),this.three.setFromNormalAndCoplanarPoint(n,s),a&&this.toggleControls(!0)}get enabled(){return this._enabled}set enabled(e){if(!this.world.isDisposing){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");this._enabled=e,this.world.renderer.setPlane(e,this.three)}}get visible(){return this._visible}set visible(e){this._visible=e,this._controls.visible=e,this._helper.visible=e,this.toggleControls(e)}get meshes(){return[this._planeMesh,this._arrowBoundBox]}get planeMaterial(){return this._planeMesh.material}set planeMaterial(e){this._planeMesh.material=e}get size(){return this._planeMesh.scale.x}set size(e){this._planeMesh.scale.set(e,e,e)}get helper(){return this._helper}setFromNormalAndCoplanarPoint(e,t){this.reset(),this.normal.equals(e)||(this.normal.copy(e),this._helper.lookAt(e)),this.origin.copy(t),this._helper.position.copy(t),this._helper.updateMatrix(),this.update()}dispose(){this._enabled=!1,this.onDraggingStarted.reset(),this.onDraggingEnded.reset(),this._helper.removeFromParent(),this.world.renderer&&this.world.renderer.setPlane(!1,this.three),this._arrowBoundBox.removeFromParent(),this._arrowBoundBox.geometry.dispose(),this._planeMesh.geometry.dispose(),this._controls.removeFromParent(),this._controls.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}reset(){const e=new i.Vector3(1,0,0),t=new i.Vector3;this.normal.equals(e)||(this.normal.copy(e),this._helper.lookAt(e)),this.origin.copy(t),this._helper.position.copy(t),this._helper.updateMatrix()}toggleControls(e){if(e){if(this._controlsActive)return;this._controls.addEventListener("change",this.update),this._controls.addEventListener("dragging-changed",this.changeDrag)}else this._controls.removeEventListener("change",this.update),this._controls.removeEventListener("dragging-changed",this.changeDrag);this._controlsActive=e}newTransformControls(){if(!this.world.renderer)throw new Error("No renderer found for clipping plane!");const e=this.world.camera.three,t=this.world.renderer.three.domElement,i=new yr(e,t);return this.initializeControls(i),this.world.scene.three.add(i),i}initializeControls(e){e.attach(this._helper),e.showX=!1,e.showY=!1,e.setSpace("local"),this.createArrowBoundingBox(),e.children[0].children[0].add(this._arrowBoundBox)}createArrowBoundingBox(){this._arrowBoundBox.geometry=new i.CylinderGeometry(.18,.18,1.2),this._arrowBoundBox.material=this._hiddenMaterial,this._arrowBoundBox.rotateX(Math.PI/2),this._arrowBoundBox.updateMatrix(),this._arrowBoundBox.geometry.applyMatrix4(this._arrowBoundBox.matrix)}notifyDraggingChanged(e){e.value?this.onDraggingStarted.trigger():this.onDraggingEnded.trigger()}preventCameraMovement(){this.world.camera.enabled=this._visible}newHelper(){const e=new i.Object3D;return e.lookAt(this.normal),e.position.copy(this.origin),this._planeMesh.position.z+=.01,e.add(this._planeMesh),this.world.scene.three.add(e),e}static newPlaneMesh(e,t){const s=new i.PlaneGeometry(1),n=new i.Mesh(s,t);return n.scale.set(e,e,e),n}}class jr extends qs{constructor(){super(...arguments),ue(this,"_config",{enabled:{value:!0,type:"Boolean"},visible:{value:!0,type:"Boolean"},color:{value:new i.Color,type:"Color"},opacity:{type:"Number",interpolable:!0,value:1,min:0,max:1},size:{type:"Number",interpolable:!0,value:2,min:0,max:100}})}get enabled(){return this._config.enabled.value}set enabled(e){this._config.enabled.value=e,this._component.enabled=e}get visible(){return this._config.visible.value}set visible(e){this._config.visible.value=e,this._component.visible=e}get color(){return this._config.color.value}set color(e){this._config.color.value=e,this._component.material.color.copy(e)}get opacity(){return this._config.opacity.value}set opacity(e){this._config.opacity.value=e,this._component.material.opacity=e}get size(){return this._config.size.value}set size(e){this._config.size.value=e,this._component.size=e}}const Kr=class e extends ki{constructor(t){super(t),ue(this,"onSetup",new Bi),ue(this,"onBeforeDrag",new Bi),ue(this,"onAfterDrag",new Bi),ue(this,"onBeforeCreate",new Bi),ue(this,"onBeforeCancel",new Bi),ue(this,"onAfterCancel",new Bi),ue(this,"onBeforeDelete",new Bi),ue(this,"onAfterCreate",new Bi),ue(this,"onAfterDelete",new Bi),ue(this,"onDisposed",new Bi),ue(this,"isSetup",!1),ue(this,"orthogonalY",!1),ue(this,"toleranceOrthogonalY",.7),ue(this,"Type",Zr),ue(this,"list",[]),ue(this,"config",new jr(this,this.components,"Clipper",e.uuid)),ue(this,"_defaultConfig",{color:new i.Color(12255487),opacity:.2,size:2}),ue(this,"_material",new i.MeshBasicMaterial({color:12255487,side:i.DoubleSide,transparent:!0,opacity:.2})),ue(this,"_size",5),ue(this,"_enabled",!1),ue(this,"_visible",!0),ue(this,"_onStartDragging",(()=>{this.onBeforeDrag.trigger()})),ue(this,"_onEndDragging",(()=>{this.onAfterDrag.trigger()})),this.components.add(e.uuid,this)}get enabled(){return this._enabled}set enabled(e){this._enabled=e;for(const t of this.list)t.enabled=e;this.updateMaterialsAndPlanes()}get visible(){return this._visible}set visible(e){this._visible=e;for(const t of this.list)t.visible=e}get material(){return this._material}set material(e){this._material=e;for(const t of this.list)t.planeMaterial=e}get size(){return this._size}set size(e){this._size=e;for(const t of this.list)t.size=e}dispose(){this._enabled=!1,this.components.get($s).list.delete(this.config.uuid);for(const e of this.list)e.dispose();this.list.length=0,this._material.dispose(),this.onBeforeCreate.reset(),this.onBeforeCancel.reset(),this.onBeforeDelete.reset(),this.onBeforeDrag.reset(),this.onAfterCreate.reset(),this.onAfterCancel.reset(),this.onAfterDelete.reset(),this.onAfterDrag.reset(),this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}create(e){const t=this.components.get(ur).get(e).castRay();return t?this.createPlaneFromIntersection(e,t):null}createFromNormalAndCoplanarPoint(e,t,i){const s=this.newPlane(e,i,t);return this.updateMaterialsAndPlanes(),s}delete(e,t){t||(t=this.pickPlane(e)),t&&this.deletePlane(t)}deleteAll(e){const t=[...this.list];for(const i of t)if(!e||e.has(i.type)){this.delete(i.world,i);const e=this.list.indexOf(i);-1!==e&&this.list.splice(e,1)}}setup(e){const t={...this._defaultConfig,...e};this.config.color=t.color,this.config.opacity=t.opacity,this.config.size=t.size,this.isSetup=!0,this.onSetup.trigger()}deletePlane(e){const t=this.list.indexOf(e);if(-1!==t){if(this.list.splice(t,1),!e.world.renderer)throw new Error("Renderer not found for this plane's world!");e.world.renderer.setPlane(!1,e.three),e.dispose(),this.updateMaterialsAndPlanes(),this.onAfterDelete.trigger(e)}}pickPlane(e){const t=this.components.get(ur).get(e),i=this.getAllPlaneMeshes(),s=t.castRay(i);if(s){const e=s.object;return this.list.find((t=>t.meshes.includes(e)))}}getAllPlaneMeshes(){const e=[];for(const t of this.list)e.push(...t.meshes);return e}createPlaneFromIntersection(e,t){var s;if(!e.renderer)throw new Error("The given world must have a renderer!");const n=t.point.distanceTo(new i.Vector3(0,0,0)),r=null==(s=t.face)?void 0:s.normal;if(!n||!r)return null;const o=this.getWorldNormal(t,r),a=this.newPlane(e,t.point,o.negate());return a.visible=this._visible,a.size=this._size,e.renderer.setPlane(!0,a.three),this.updateMaterialsAndPlanes(),a}getWorldNormal(e,t){const s=e.object;let n=e.object.matrixWorld.clone();if(s instanceof i.InstancedMesh&&void 0!==e.instanceId){const t=new i.Matrix4;s.getMatrixAt(e.instanceId,t),n=t.multiply(n)}const r=(new i.Matrix3).getNormalMatrix(n),o=t.clone().applyMatrix3(r).normalize();return this.normalizePlaneDirectionY(o),o}normalizePlaneDirectionY(e){this.orthogonalY&&(e.y>this.toleranceOrthogonalY&&(e.x=0,e.y=1,e.z=0),e.y<-this.toleranceOrthogonalY&&(e.x=0,e.y=-1,e.z=0))}newPlane(e,t,i){const s=new this.Type(this.components,e,t,i,this._material);return s.onDraggingStarted.add(this._onStartDragging),s.onDraggingEnded.add(this._onEndDragging),this.list.push(s),this.onAfterCreate.trigger(s),s}updateMaterialsAndPlanes(){const e=this.components.get(ir);for(const[t,i]of e.list){if(!i.renderer)continue;i.renderer.updateClippingPlanes();const{clippingPlanes:e}=i.renderer;for(const t of i.meshes)if(t.material)if(Array.isArray(t.material))for(const i of t.material)i.clippingPlanes=e;else t.material.clippingPlanes=e}}};ue(Kr,"uuid","66290bc5-18c4-4cd1-9379-2e17a0617611");let Qr=Kr;class qr{constructor(e){ue(this,"enabled",!1),ue(this,"id","FirstPerson"),this.camera=e}set(e){if(this.enabled=e,e){if("Perspective"!==this.camera.projection.current)return void this.camera.set("Orbit");this.setupFirstPersonCamera()}}setupFirstPersonCamera(){const e=this.camera.controls,t=new i.Vector3;e.distance--,e.getPosition(t),e.minDistance=1,e.maxDistance=1,e.distance=1,e.moveTo(t.x,t.y,t.z),e.truckSpeed=50,e.mouseButtons.wheel=$n.ACTION.DOLLY,e.touches.two=$n.ACTION.TOUCH_ZOOM_TRUCK}}class Jr{constructor(e){ue(this,"enabled",!0),ue(this,"id","Orbit"),this.camera=e,this.activateOrbitControls()}set(e){this.enabled=e,e&&this.activateOrbitControls()}activateOrbitControls(){const e=this.camera.controls;e.minDistance=1,e.maxDistance=300;const t=new i.Vector3;e.getPosition(t);const s=t.length();e.distance=s,e.truckSpeed=2;const{rotation:n}=this.camera.three,r=new i.Vector3(0,0,-1).applyEuler(n),o=t.addScaledVector(r,s);e.moveTo(o.x,o.y,o.z)}}class $r{constructor(e){ue(this,"enabled",!1),ue(this,"id","Plan"),ue(this,"mouseAction1"),ue(this,"mouseAction2"),ue(this,"mouseInitialized",!1),ue(this,"defaultAzimuthSpeed"),ue(this,"defaultPolarSpeed"),this.camera=e,this.defaultAzimuthSpeed=e.controls.azimuthRotateSpeed,this.defaultPolarSpeed=e.controls.polarRotateSpeed}set(e){this.enabled=e;const t=this.camera.controls;t.azimuthRotateSpeed=e?0:this.defaultAzimuthSpeed,t.polarRotateSpeed=e?0:this.defaultPolarSpeed,this.mouseInitialized||(this.mouseAction1=t.touches.one,this.mouseAction2=t.touches.two,this.mouseInitialized=!0),e?(t.mouseButtons.left=$n.ACTION.TRUCK,t.touches.one=$n.ACTION.TOUCH_TRUCK,t.touches.two=$n.ACTION.TOUCH_ZOOM):(t.mouseButtons.left=$n.ACTION.ROTATE,t.touches.one=this.mouseAction1,t.touches.two=this.mouseAction2)}}class eo{constructor(e){ue(this,"onChanged",new Bi),ue(this,"current","Perspective"),ue(this,"camera"),ue(this,"matchOrthoDistanceEnabled",!1),ue(this,"_component"),ue(this,"_previousDistance",-1),this._component=e,this.camera=e.three}async set(e){this.current!==e&&("Orthographic"===e?this.setOrthoCamera():await this.setPerspectiveCamera(),this.onChanged.trigger(this.camera))}async toggle(){const e="Perspective"===this.current?"Orthographic":"Perspective";await this.set(e)}setOrthoCamera(){if(null===this._component.mode||"FirstPerson"===this._component.mode.id)return;this._previousDistance=this._component.controls.distance,this._component.controls.distance=200;const e=this.getPerspectiveDims();if(!e)return;const{width:t,height:i}=e;this.setupOrthoCamera(i,t),this.camera=this._component.threeOrtho,this.current="Orthographic"}getPerspectiveDims(){const e=this._component.currentWorld;if(!e||!e.renderer)return null;const t=new i.Vector3;this._component.threePersp.getWorldDirection(t);const s=new i.Vector3;this._component.controls.getTarget(s);const n=s.clone().sub(this._component.threePersp.position).dot(t),r=e.renderer.getSize(),o=r.x/r.y,a=this._component.threePersp,l=2*n*Math.atan(a.fov*(Math.PI/180)/2);return{width:l*o,height:l}}setupOrthoCamera(e,t){this._component.controls.mouseButtons.wheel=$n.ACTION.ZOOM,this._component.controls.mouseButtons.middle=$n.ACTION.ZOOM,this._component.controls.touches.two=$n.ACTION.TOUCH_ZOOM_TRUCK,this._component.controls.touches.three=$n.ACTION.TOUCH_ZOOM_TRUCK,this._component.controls.dollySpeed=5;const i=this._component.threePersp,s=this._component.threeOrtho;s.zoom=1,s.left=t/-2,s.right=t/2,s.top=e/2,s.bottom=e/-2,s.updateProjectionMatrix(),s.position.copy(i.position),s.quaternion.copy(i.quaternion),this._component.controls.camera=s}getDistance(){const e=this._component.threePersp,t=this._component.threeOrtho;return(t.top-t.bottom)/t.zoom/(2*Math.atan(e.fov*(Math.PI/180)/2))}async setPerspectiveCamera(){this._component.controls.mouseButtons.wheel=$n.ACTION.DOLLY,this._component.controls.mouseButtons.middle=$n.ACTION.DOLLY;const e=this._component.threePersp,t=this._component.threeOrtho;e.position.copy(t.position),e.quaternion.copy(t.quaternion),this._component.controls.mouseButtons.wheel=$n.ACTION.DOLLY,this._component.controls.touches.two=$n.ACTION.TOUCH_DOLLY_TRUCK,this._component.controls.touches.three=$n.ACTION.TOUCH_DOLLY_TRUCK,this._component.controls.dollySpeed=5,this.matchOrthoDistanceEnabled?this._component.controls.distance=this.getDistance():this._component.controls.distance=this._previousDistance,await this._component.controls.zoomTo(1),e.updateProjectionMatrix(),this._component.controls.camera=e,this.camera=e,this.current="Perspective"}}class to extends er{constructor(e){super(e),ue(this,"projection"),ue(this,"threeOrtho"),ue(this,"threePersp"),ue(this,"_userInputButtons",{}),ue(this,"_frustumSize",50),ue(this,"_navigationModes",new Map),ue(this,"_mode",null),ue(this,"previousSize",null),this.threePersp=this.three,this.threeOrtho=this.newOrthoCamera(),this.projection=new eo(this),this.onAspectUpdated.add((()=>{this.setOrthoPerspCameraAspect()})),this.projection.onChanged.add((e=>{this.three=e,this.updateAspect()})),this.onWorldChanged.add((({action:e})=>{"added"===e&&(this._navigationModes.clear(),this._navigationModes.set("Orbit",new Jr(this)),this._navigationModes.set("FirstPerson",new qr(this)),this._navigationModes.set("Plan",new $r(this)),this._mode=this._navigationModes.get("Orbit"),this.mode.set(!0,{preventTargetAdjustment:!0}),this.currentWorld&&this.currentWorld.renderer&&(this.previousSize=this.currentWorld.renderer.getSize().clone()))}))}get mode(){if(!this._mode)throw new Error("Mode not found, camera not initialized");return this._mode}dispose(){super.dispose(),this.threeOrtho.removeFromParent()}set(e){if(null!==this.mode&&this.mode.id!==e){if(this.mode.set(!1),!this._navigationModes.has(e))throw new Error("The specified mode does not exist!");this._mode=this._navigationModes.get(e),this.mode.set(!0)}}async fit(e,t=1.5){if(!this.enabled)return;const s=Number.MAX_VALUE,n=Number.MIN_VALUE,r=new i.Vector3(s,s,s),o=new i.Vector3(n,n,n);for(const t of e){const e=(new i.Box3).setFromObject(t);e.min.x<r.x&&(r.x=e.min.x),e.min.y<r.y&&(r.y=e.min.y),e.min.z<r.z&&(r.z=e.min.z),e.max.x>o.x&&(o.x=e.max.x),e.max.y>o.y&&(o.y=e.max.y),e.max.z>o.z&&(o.z=e.max.z)}const a=new i.Box3(r,o),l=new i.Vector3;a.getSize(l);const c=new i.Vector3;a.getCenter(c);const h=Math.max(l.x,l.y,l.z)*t,d=new i.Sphere(c,h);await this.controls.fitToSphere(d,!0)}setUserInput(e){e?this.enableUserInput():this.disableUserInput()}disableUserInput(){this._userInputButtons.left=this.controls.mouseButtons.left,this._userInputButtons.right=this.controls.mouseButtons.right,this._userInputButtons.middle=this.controls.mouseButtons.middle,this._userInputButtons.wheel=this.controls.mouseButtons.wheel,this.controls.mouseButtons.left=0,this.controls.mouseButtons.right=0,this.controls.mouseButtons.middle=0,this.controls.mouseButtons.wheel=0}enableUserInput(){0!==Object.keys(this._userInputButtons).length&&(this.controls.mouseButtons.left=this._userInputButtons.left,this.controls.mouseButtons.right=this._userInputButtons.right,this.controls.mouseButtons.middle=this._userInputButtons.middle,this.controls.mouseButtons.wheel=this._userInputButtons.wheel)}newOrthoCamera(){const e=window.innerWidth/window.innerHeight;return new i.OrthographicCamera(this._frustumSize*e/-2,this._frustumSize*e/2,this._frustumSize/2,this._frustumSize/-2,.1,1e3)}setOrthoPerspCameraAspect(){if(!this.currentWorld||!this.currentWorld.renderer||!this.previousSize)return;const e=this.currentWorld.renderer.getSize(),t=this.threeOrtho.top,i=this.threeOrtho.right,s=t*(e.y/this.previousSize.y),n=i*(e.x/this.previousSize.x);this.threeOrtho.left=-n,this.threeOrtho.right=n,this.threeOrtho.top=s,this.threeOrtho.bottom=-s,this.threeOrtho.updateProjectionMatrix(),this.previousSize.copy(e)}}const io=new Map([[he.IFCRELAGGREGATES,{forRelated:"Decomposes",forRelating:"IsDecomposedBy"}],[he.IFCRELASSOCIATESMATERIAL,{forRelated:"HasAssociations",forRelating:"AssociatedTo"}],[he.IFCRELASSOCIATESCLASSIFICATION,{forRelated:"HasAssociations",forRelating:"ClassificationForObjects"}],[he.IFCRELASSIGNSTOGROUP,{forRelated:"HasAssignments",forRelating:"IsGroupedBy"}],[he.IFCRELDEFINESBYPROPERTIES,{forRelated:"IsDefinedBy",forRelating:"DefinesOcurrence"}],[he.IFCRELDEFINESBYTYPE,{forRelated:"IsTypedBy",forRelating:"Types"}],[he.IFCRELDEFINESBYTEMPLATE,{forRelated:"IsDefinedBy",forRelating:"Defines"}],[he.IFCRELCONTAINEDINSPATIALSTRUCTURE,{forRelated:"ContainedInStructure",forRelating:"ContainsElements"}],[he.IFCRELFLOWCONTROLELEMENTS,{forRelated:"AssignedToFlowElement",forRelating:"HasControlElements"}],[he.IFCRELCONNECTSELEMENTS,{forRelated:"ConnectedFrom",forRelating:"ConnectedTo"}],[he.IFCRELASSIGNSTOPRODUCT,{forRelated:"HasAssignments",forRelating:"ReferencedBy"}],[he.IFCRELDECLARES,{forRelated:"HasContext",forRelating:"Declares"}],[he.IFCRELASSIGNSTOCONTROL,{forRelated:"HasAssignments",forRelating:"Controls"}],[he.IFCRELNESTS,{forRelated:"Nests",forRelating:"IsNestedBy"}],[he.IFCRELASSOCIATESDOCUMENT,{forRelated:"HasAssociations",forRelating:"DocumentRefForObjects"}]]),so={950732822:"IFCURIREFERENCE",4075327185:"IFCTIME",1209108979:"IFCTEMPERATURERATEOFCHANGEMEASURE",3457685358:"IFCSOUNDPRESSURELEVELMEASURE",4157543285:"IFCSOUNDPOWERLEVELMEASURE",2798247006:"IFCPROPERTYSETDEFINITIONSET",1790229001:"IFCPOSITIVEINTEGER",525895558:"IFCNONNEGATIVELENGTHMEASURE",1774176899:"IFCLINEINDEX",1275358634:"IFCLANGUAGEID",2541165894:"IFCDURATION",3701338814:"IFCDAYINWEEKNUMBER",2195413836:"IFCDATETIME",937566702:"IFCDATE",1683019596:"IFCCARDINALPOINTREFERENCE",2314439260:"IFCBINARY",1500781891:"IFCAREADENSITYMEASURE",3683503648:"IFCARCINDEX",4065007721:"IFCYEARNUMBER",1718600412:"IFCWARPINGMOMENTMEASURE",51269191:"IFCWARPINGCONSTANTMEASURE",2593997549:"IFCVOLUMETRICFLOWRATEMEASURE",3458127941:"IFCVOLUMEMEASURE",3345633955:"IFCVAPORPERMEABILITYMEASURE",1278329552:"IFCTORQUEMEASURE",2591213694:"IFCTIMESTAMP",2726807636:"IFCTIMEMEASURE",743184107:"IFCTHERMODYNAMICTEMPERATUREMEASURE",2016195849:"IFCTHERMALTRANSMITTANCEMEASURE",857959152:"IFCTHERMALRESISTANCEMEASURE",2281867870:"IFCTHERMALEXPANSIONCOEFFICIENTMEASURE",2645777649:"IFCTHERMALCONDUCTIVITYMEASURE",232962298:"IFCTHERMALADMITTANCEMEASURE",296282323:"IFCTEXTTRANSFORMATION",603696268:"IFCTEXTFONTNAME",3490877962:"IFCTEXTDECORATION",1460886941:"IFCTEXTALIGNMENT",2801250643:"IFCTEXT",58845555:"IFCTEMPERATUREGRADIENTMEASURE",361837227:"IFCSPECULARROUGHNESS",2757832317:"IFCSPECULAREXPONENT",3477203348:"IFCSPECIFICHEATCAPACITYMEASURE",993287707:"IFCSOUNDPRESSUREMEASURE",846465480:"IFCSOUNDPOWERMEASURE",3471399674:"IFCSOLIDANGLEMEASURE",408310005:"IFCSHEARMODULUSMEASURE",2190458107:"IFCSECTIONALAREAINTEGRALMEASURE",3467162246:"IFCSECTIONMODULUSMEASURE",2766185779:"IFCSECONDINMINUTE",3211557302:"IFCROTATIONALSTIFFNESSMEASURE",1755127002:"IFCROTATIONALMASSMEASURE",2133746277:"IFCROTATIONALFREQUENCYMEASURE",200335297:"IFCREAL",96294661:"IFCRATIOMEASURE",3972513137:"IFCRADIOACTIVITYMEASURE",3665567075:"IFCPRESSUREMEASURE",2169031380:"IFCPRESENTABLETEXT",1364037233:"IFCPOWERMEASURE",1245737093:"IFCPOSITIVERATIOMEASURE",3054510233:"IFCPOSITIVEPLANEANGLEMEASURE",2815919920:"IFCPOSITIVELENGTHMEASURE",4042175685:"IFCPLANEANGLEMEASURE",2642773653:"IFCPLANARFORCEMEASURE",2260317790:"IFCPARAMETERVALUE",929793134:"IFCPHMEASURE",2395907400:"IFCNUMERICMEASURE",2095195183:"IFCNORMALISEDRATIOMEASURE",765770214:"IFCMONTHINYEARNUMBER",2615040989:"IFCMONETARYMEASURE",3114022597:"IFCMOMENTOFINERTIAMEASURE",1648970520:"IFCMOLECULARWEIGHTMEASURE",3177669450:"IFCMOISTUREDIFFUSIVITYMEASURE",1753493141:"IFCMODULUSOFSUBGRADEREACTIONMEASURE",1052454078:"IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE",2173214787:"IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE",3341486342:"IFCMODULUSOFELASTICITYMEASURE",102610177:"IFCMINUTEINHOUR",3531705166:"IFCMASSPERLENGTHMEASURE",3124614049:"IFCMASSMEASURE",4017473158:"IFCMASSFLOWRATEMEASURE",1477762836:"IFCMASSDENSITYMEASURE",2486716878:"IFCMAGNETICFLUXMEASURE",286949696:"IFCMAGNETICFLUXDENSITYMEASURE",151039812:"IFCLUMINOUSINTENSITYMEASURE",2755797622:"IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE",2095003142:"IFCLUMINOUSFLUXMEASURE",503418787:"IFCLOGICAL",3086160713:"IFCLINEARVELOCITYMEASURE",1307019551:"IFCLINEARSTIFFNESSMEASURE",2128979029:"IFCLINEARMOMENTMEASURE",191860431:"IFCLINEARFORCEMEASURE",1243674935:"IFCLENGTHMEASURE",3258342251:"IFCLABEL",2054016361:"IFCKINEMATICVISCOSITYMEASURE",3192672207:"IFCISOTHERMALMOISTURECAPACITYMEASURE",3686016028:"IFCIONCONCENTRATIONMEASURE",3809634241:"IFCINTEGERCOUNTRATEMEASURE",1939436016:"IFCINTEGER",2679005408:"IFCINDUCTANCEMEASURE",3358199106:"IFCILLUMINANCEMEASURE",983778844:"IFCIDENTIFIER",2589826445:"IFCHOURINDAY",1158859006:"IFCHEATINGVALUEMEASURE",3113092358:"IFCHEATFLUXDENSITYMEASURE",3064340077:"IFCGLOBALLYUNIQUEID",3044325142:"IFCFREQUENCYMEASURE",1361398929:"IFCFORCEMEASURE",2590844177:"IFCFONTWEIGHT",2715512545:"IFCFONTVARIANT",1102727119:"IFCFONTSTYLE",2078135608:"IFCENERGYMEASURE",2506197118:"IFCELECTRICVOLTAGEMEASURE",2951915441:"IFCELECTRICRESISTANCEMEASURE",3790457270:"IFCELECTRICCURRENTMEASURE",2093906313:"IFCELECTRICCONDUCTANCEMEASURE",3818826038:"IFCELECTRICCHARGEMEASURE",1827137117:"IFCELECTRICCAPACITANCEMEASURE",69416015:"IFCDYNAMICVISCOSITYMEASURE",524656162:"IFCDOSEEQUIVALENTMEASURE",4134073009:"IFCDIMENSIONCOUNT",1514641115:"IFCDESCRIPTIVEMEASURE",300323983:"IFCDAYLIGHTSAVINGHOUR",86635668:"IFCDAYINMONTHNUMBER",94842927:"IFCCURVATUREMEASURE",1778710042:"IFCCOUNTMEASURE",3238673880:"IFCCONTEXTDEPENDENTMEASURE",3812528620:"IFCCOMPOUNDPLANEANGLEMEASURE",2991860651:"IFCCOMPLEXNUMBER",1867003952:"IFCBOXALIGNMENT",2735952531:"IFCBOOLEAN",2650437152:"IFCAREAMEASURE",632304761:"IFCANGULARVELOCITYMEASURE",360377573:"IFCAMOUNTOFSUBSTANCEMEASURE",4182062534:"IFCACCELERATIONMEASURE",3699917729:"IFCABSORBEDDOSEMEASURE",1971632696:"IFCGEOSLICE",2680139844:"IFCGEOMODEL",24726584:"IFCELECTRICFLOWTREATMENTDEVICE",3693000487:"IFCDISTRIBUTIONBOARD",3460952963:"IFCCONVEYORSEGMENT",3999819293:"IFCCAISSONFOUNDATION",3314249567:"IFCBOREHOLE",4196446775:"IFCBEARING",325726236:"IFCALIGNMENT",3425753595:"IFCTRACKELEMENT",991950508:"IFCSIGNAL",3798194928:"IFCREINFORCEDSOIL",3290496277:"IFCRAIL",1383356374:"IFCPAVEMENT",2182337498:"IFCNAVIGATIONELEMENT",234836483:"IFCMOORINGDEVICE",2078563270:"IFCMOBILETELECOMMUNICATIONSAPPLIANCE",1638804497:"IFCLIQUIDTERMINAL",1154579445:"IFCLINEARPOSITIONINGELEMENT",2696325953:"IFCKERB",2713699986:"IFCGEOTECHNICALASSEMBLY",2142170206:"IFCELECTRICFLOWTREATMENTDEVICETYPE",3376911765:"IFCEARTHWORKSFILL",1077100507:"IFCEARTHWORKSELEMENT",3071239417:"IFCEARTHWORKSCUT",479945903:"IFCDISTRIBUTIONBOARDTYPE",3426335179:"IFCDEEPFOUNDATION",1502416096:"IFCCOURSE",2940368186:"IFCCONVEYORSEGMENTTYPE",3203706013:"IFCCAISSONFOUNDATIONTYPE",3862327254:"IFCBUILTSYSTEM",1876633798:"IFCBUILTELEMENT",963979645:"IFCBRIDGEPART",644574406:"IFCBRIDGE",3649138523:"IFCBEARINGTYPE",1662888072:"IFCALIGNMENTVERTICAL",317615605:"IFCALIGNMENTSEGMENT",1545765605:"IFCALIGNMENTHORIZONTAL",4266260250:"IFCALIGNMENTCANT",3956297820:"IFCVIBRATIONDAMPERTYPE",1530820697:"IFCVIBRATIONDAMPER",840318589:"IFCVEHICLE",1953115116:"IFCTRANSPORTATIONDEVICE",618700268:"IFCTRACKELEMENTTYPE",2281632017:"IFCTENDONCONDUITTYPE",3663046924:"IFCTENDONCONDUIT",42703149:"IFCSINESPIRAL",1894708472:"IFCSIGNALTYPE",3599934289:"IFCSIGNTYPE",33720170:"IFCSIGN",1027922057:"IFCSEVENTHORDERPOLYNOMIALSPIRAL",544395925:"IFCSEGMENTEDREFERENCECURVE",3649235739:"IFCSECONDORDERPOLYNOMIALSPIRAL",550521510:"IFCROADPART",146592293:"IFCROAD",3818125796:"IFCRELADHERESTOELEMENT",4021432810:"IFCREFERENT",1891881377:"IFCRAILWAYPART",3992365140:"IFCRAILWAY",1763565496:"IFCRAILTYPE",1946335990:"IFCPOSITIONINGELEMENT",514975943:"IFCPAVEMENTTYPE",506776471:"IFCNAVIGATIONELEMENTTYPE",710110818:"IFCMOORINGDEVICETYPE",1950438474:"IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE",976884017:"IFCMARINEPART",525669439:"IFCMARINEFACILITY",1770583370:"IFCLIQUIDTERMINALTYPE",2176059722:"IFCLINEARELEMENT",679976338:"IFCKERBTYPE",3948183225:"IFCIMPACTPROTECTIONDEVICETYPE",2568555532:"IFCIMPACTPROTECTIONDEVICE",2898700619:"IFCGRADIENTCURVE",1594536857:"IFCGEOTECHNICALSTRATUM",4230923436:"IFCGEOTECHNICALELEMENT",4228831410:"IFCFACILITYPARTCOMMON",1310830890:"IFCFACILITYPART",24185140:"IFCFACILITY",4234616927:"IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID",1306400036:"IFCDEEPFOUNDATIONTYPE",4189326743:"IFCCOURSETYPE",2000195564:"IFCCOSINESPIRAL",3497074424:"IFCCLOTHOID",1626504194:"IFCBUILTELEMENTTYPE",3651464721:"IFCVEHICLETYPE",1229763772:"IFCTRIANGULATEDIRREGULARNETWORK",3665877780:"IFCTRANSPORTATIONDEVICETYPE",782932809:"IFCTHIRDORDERPOLYNOMIALSPIRAL",2735484536:"IFCSPIRAL",1356537516:"IFCSECTIONEDSURFACE",1290935644:"IFCSECTIONEDSOLIDHORIZONTAL",1862484736:"IFCSECTIONEDSOLID",1441486842:"IFCRELPOSITIONS",1033248425:"IFCRELASSOCIATESPROFILEDEF",3381221214:"IFCPOLYNOMIALCURVE",2485787929:"IFCOFFSETCURVEBYDISTANCES",590820931:"IFCOFFSETCURVE",3465909080:"IFCINDEXEDPOLYGONALTEXTUREMAP",593015953:"IFCDIRECTRIXCURVESWEPTAREASOLID",4212018352:"IFCCURVESEGMENT",3425423356:"IFCAXIS2PLACEMENTLINEAR",823603102:"IFCSEGMENT",2165702409:"IFCPOINTBYDISTANCEEXPRESSION",182550632:"IFCOPENCROSSPROFILEDEF",388784114:"IFCLINEARPLACEMENT",536804194:"IFCALIGNMENTHORIZONTALSEGMENT",3752311538:"IFCALIGNMENTCANTSEGMENT",1010789467:"IFCTEXTURECOORDINATEINDICESWITHVOIDS",222769930:"IFCTEXTURECOORDINATEINDICES",2691318326:"IFCQUANTITYNUMBER",3633395639:"IFCALIGNMENTVERTICALSEGMENT",2879124712:"IFCALIGNMENTPARAMETERSEGMENT",25142252:"IFCCONTROLLER",3087945054:"IFCALARM",4288193352:"IFCACTUATOR",630975310:"IFCUNITARYCONTROLELEMENT",4086658281:"IFCSENSOR",2295281155:"IFCPROTECTIVEDEVICETRIPPINGUNIT",182646315:"IFCFLOWINSTRUMENT",1426591983:"IFCFIRESUPPRESSIONTERMINAL",819412036:"IFCFILTER",3415622556:"IFCFAN",1003880860:"IFCELECTRICTIMECONTROL",402227799:"IFCELECTRICMOTOR",264262732:"IFCELECTRICGENERATOR",3310460725:"IFCELECTRICFLOWSTORAGEDEVICE",862014818:"IFCELECTRICDISTRIBUTIONBOARD",1904799276:"IFCELECTRICAPPLIANCE",1360408905:"IFCDUCTSILENCER",3518393246:"IFCDUCTSEGMENT",342316401:"IFCDUCTFITTING",562808652:"IFCDISTRIBUTIONCIRCUIT",4074379575:"IFCDAMPER",3640358203:"IFCCOOLINGTOWER",4136498852:"IFCCOOLEDBEAM",2272882330:"IFCCONDENSER",3571504051:"IFCCOMPRESSOR",3221913625:"IFCCOMMUNICATIONSAPPLIANCE",639361253:"IFCCOIL",3902619387:"IFCCHILLER",4217484030:"IFCCABLESEGMENT",1051757585:"IFCCABLEFITTING",3758799889:"IFCCABLECARRIERSEGMENT",635142910:"IFCCABLECARRIERFITTING",2938176219:"IFCBURNER",32344328:"IFCBOILER",2906023776:"IFCBEAMSTANDARDCASE",277319702:"IFCAUDIOVISUALAPPLIANCE",2056796094:"IFCAIRTOAIRHEATRECOVERY",177149247:"IFCAIRTERMINALBOX",1634111441:"IFCAIRTERMINAL",486154966:"IFCWINDOWSTANDARDCASE",4237592921:"IFCWASTETERMINAL",4156078855:"IFCWALLELEMENTEDCASE",4207607924:"IFCVALVE",4292641817:"IFCUNITARYEQUIPMENT",3179687236:"IFCUNITARYCONTROLELEMENTTYPE",3026737570:"IFCTUBEBUNDLE",3825984169:"IFCTRANSFORMER",812556717:"IFCTANK",1162798199:"IFCSWITCHINGDEVICE",385403989:"IFCSTRUCTURALLOADCASE",1404847402:"IFCSTACKTERMINAL",1999602285:"IFCSPACEHEATER",3420628829:"IFCSOLARDEVICE",3027962421:"IFCSLABSTANDARDCASE",3127900445:"IFCSLABELEMENTEDCASE",1329646415:"IFCSHADINGDEVICE",3053780830:"IFCSANITARYTERMINAL",2572171363:"IFCREINFORCINGBARTYPE",1232101972:"IFCRATIONALBSPLINECURVEWITHKNOTS",90941305:"IFCPUMP",655969474:"IFCPROTECTIVEDEVICETRIPPINGUNITTYPE",738039164:"IFCPROTECTIVEDEVICE",1156407060:"IFCPLATESTANDARDCASE",3612865200:"IFCPIPESEGMENT",310824031:"IFCPIPEFITTING",3694346114:"IFCOUTLET",144952367:"IFCOUTERBOUNDARYCURVE",2474470126:"IFCMOTORCONNECTION",1911478936:"IFCMEMBERSTANDARDCASE",1437502449:"IFCMEDICALDEVICE",629592764:"IFCLIGHTFIXTURE",76236018:"IFCLAMP",2176052936:"IFCJUNCTIONBOX",4175244083:"IFCINTERCEPTOR",2068733104:"IFCHUMIDIFIER",3319311131:"IFCHEATEXCHANGER",2188021234:"IFCFLOWMETER",1209101575:"IFCEXTERNALSPATIALELEMENT",484807127:"IFCEVAPORATOR",3747195512:"IFCEVAPORATIVECOOLER",2814081492:"IFCENGINE",2417008758:"IFCELECTRICDISTRIBUTIONBOARDTYPE",3242481149:"IFCDOORSTANDARDCASE",3205830791:"IFCDISTRIBUTIONSYSTEM",400855858:"IFCCOMMUNICATIONSAPPLIANCETYPE",905975707:"IFCCOLUMNSTANDARDCASE",1677625105:"IFCCIVILELEMENT",3296154744:"IFCCHIMNEY",2674252688:"IFCCABLEFITTINGTYPE",2188180465:"IFCBURNERTYPE",1177604601:"IFCBUILDINGSYSTEM",39481116:"IFCBUILDINGELEMENTPARTTYPE",1136057603:"IFCBOUNDARYCURVE",2461110595:"IFCBSPLINECURVEWITHKNOTS",1532957894:"IFCAUDIOVISUALAPPLIANCETYPE",4088093105:"IFCWORKCALENDAR",4009809668:"IFCWINDOWTYPE",926996030:"IFCVOIDINGFEATURE",2391383451:"IFCVIBRATIONISOLATOR",2415094496:"IFCTENDONTYPE",3081323446:"IFCTENDONANCHORTYPE",413509423:"IFCSYSTEMFURNITUREELEMENT",3101698114:"IFCSURFACEFEATURE",3657597509:"IFCSTRUCTURALSURFACEACTION",2757150158:"IFCSTRUCTURALCURVEREACTION",1004757350:"IFCSTRUCTURALCURVEACTION",338393293:"IFCSTAIRTYPE",1072016465:"IFCSOLARDEVICETYPE",4074543187:"IFCSHADINGDEVICETYPE",2157484638:"IFCSEAMCURVE",2781568857:"IFCROOFTYPE",2310774935:"IFCREINFORCINGMESHTYPE",964333572:"IFCREINFORCINGELEMENTTYPE",683857671:"IFCRATIONALBSPLINESURFACEWITHKNOTS",1469900589:"IFCRAMPTYPE",2839578677:"IFCPOLYGONALFACESET",1158309216:"IFCPILETYPE",3079942009:"IFCOPENINGSTANDARDCASE",1114901282:"IFCMEDICALDEVICETYPE",3113134337:"IFCINTERSECTIONCURVE",3946677679:"IFCINTERCEPTORTYPE",2571569899:"IFCINDEXEDPOLYCURVE",3493046030:"IFCGEOGRAPHICELEMENT",1509553395:"IFCFURNITURE",1893162501:"IFCFOOTINGTYPE",2853485674:"IFCEXTERNALSPATIALSTRUCTUREELEMENT",4148101412:"IFCEVENT",132023988:"IFCENGINETYPE",2397081782:"IFCELEMENTASSEMBLYTYPE",2323601079:"IFCDOORTYPE",1213902940:"IFCCYLINDRICALSURFACE",1525564444:"IFCCONSTRUCTIONPRODUCTRESOURCETYPE",4105962743:"IFCCONSTRUCTIONMATERIALRESOURCETYPE",2185764099:"IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE",15328376:"IFCCOMPOSITECURVEONSURFACE",3875453745:"IFCCOMPLEXPROPERTYTEMPLATE",3893394355:"IFCCIVILELEMENTTYPE",2197970202:"IFCCHIMNEYTYPE",167062518:"IFCBSPLINESURFACEWITHKNOTS",2887950389:"IFCBSPLINESURFACE",2603310189:"IFCADVANCEDBREPWITHVOIDS",1635779807:"IFCADVANCEDBREP",2916149573:"IFCTRIANGULATEDFACESET",1935646853:"IFCTOROIDALSURFACE",2387106220:"IFCTESSELLATEDFACESET",3206491090:"IFCTASKTYPE",699246055:"IFCSURFACECURVE",4095615324:"IFCSUBCONTRACTRESOURCETYPE",603775116:"IFCSTRUCTURALSURFACEREACTION",4015995234:"IFCSPHERICALSURFACE",2481509218:"IFCSPATIALZONETYPE",463610769:"IFCSPATIALZONE",710998568:"IFCSPATIALELEMENTTYPE",1412071761:"IFCSPATIALELEMENT",3663146110:"IFCSIMPLEPROPERTYTEMPLATE",3243963512:"IFCREVOLVEDAREASOLIDTAPERED",816062949:"IFCREPARAMETRISEDCOMPOSITECURVESEGMENT",1521410863:"IFCRELSPACEBOUNDARY2NDLEVEL",3523091289:"IFCRELSPACEBOUNDARY1STLEVEL",427948657:"IFCRELINTERFERESELEMENTS",307848117:"IFCRELDEFINESBYTEMPLATE",1462361463:"IFCRELDEFINESBYOBJECT",2565941209:"IFCRELDECLARES",1027710054:"IFCRELASSIGNSTOGROUPBYFACTOR",3521284610:"IFCPROPERTYTEMPLATE",492091185:"IFCPROPERTYSETTEMPLATE",653396225:"IFCPROJECTLIBRARY",569719735:"IFCPROCEDURETYPE",3967405729:"IFCPREDEFINEDPROPERTYSET",1682466193:"IFCPCURVE",428585644:"IFCLABORRESOURCETYPE",2294589976:"IFCINDEXEDPOLYGONALFACEWITHVOIDS",178912537:"IFCINDEXEDPOLYGONALFACE",4095422895:"IFCGEOGRAPHICELEMENTTYPE",2652556860:"IFCFIXEDREFERENCESWEPTAREASOLID",2804161546:"IFCEXTRUDEDAREASOLIDTAPERED",4024345920:"IFCEVENTTYPE",2629017746:"IFCCURVEBOUNDEDSURFACE",1815067380:"IFCCREWRESOURCETYPE",3419103109:"IFCCONTEXT",2574617495:"IFCCONSTRUCTIONRESOURCETYPE",2059837836:"IFCCARTESIANPOINTLIST3D",1675464909:"IFCCARTESIANPOINTLIST2D",574549367:"IFCCARTESIANPOINTLIST",3406155212:"IFCADVANCEDFACE",3698973494:"IFCTYPERESOURCE",3736923433:"IFCTYPEPROCESS",901063453:"IFCTESSELLATEDITEM",1096409881:"IFCSWEPTDISKSOLIDPOLYGONAL",1042787934:"IFCRESOURCETIME",1608871552:"IFCRESOURCECONSTRAINTRELATIONSHIP",2943643501:"IFCRESOURCEAPPROVALRELATIONSHIP",2090586900:"IFCQUANTITYSET",1482703590:"IFCPROPERTYTEMPLATEDEFINITION",3778827333:"IFCPREDEFINEDPROPERTIES",2998442950:"IFCMIRROREDPROFILEDEF",853536259:"IFCMATERIALRELATIONSHIP",3404854881:"IFCMATERIALPROFILESETUSAGETAPERING",3079605661:"IFCMATERIALPROFILESETUSAGE",2852063980:"IFCMATERIALCONSTITUENTSET",3708119e3:"IFCMATERIALCONSTITUENT",1585845231:"IFCLAGTIME",2133299955:"IFCINDEXEDTRIANGLETEXTUREMAP",1437953363:"IFCINDEXEDTEXTUREMAP",3570813810:"IFCINDEXEDCOLOURMAP",1437805879:"IFCEXTERNALREFERENCERELATIONSHIP",297599258:"IFCEXTENDEDPROPERTIES",211053100:"IFCEVENTTIME",2713554722:"IFCCONVERSIONBASEDUNITWITHOFFSET",3285139300:"IFCCOLOURRGBLIST",1236880293:"IFCWORKTIME",1199560280:"IFCTIMEPERIOD",3611470254:"IFCTEXTUREVERTEXLIST",2771591690:"IFCTASKTIMERECURRING",1549132990:"IFCTASKTIME",2043862942:"IFCTABLECOLUMN",2934153892:"IFCSURFACEREINFORCEMENTAREA",609421318:"IFCSTRUCTURALLOADORRESULT",3478079324:"IFCSTRUCTURALLOADCONFIGURATION",1054537805:"IFCSCHEDULINGTIME",2439245199:"IFCRESOURCELEVELRELATIONSHIP",2433181523:"IFCREFERENCE",3915482550:"IFCRECURRENCEPATTERN",986844984:"IFCPROPERTYABSTRACTION",3843373140:"IFCPROJECTEDCRS",677532197:"IFCPRESENTATIONITEM",1507914824:"IFCMATERIALUSAGEDEFINITION",552965576:"IFCMATERIALPROFILEWITHOFFSETS",164193824:"IFCMATERIALPROFILESET",2235152071:"IFCMATERIALPROFILE",1847252529:"IFCMATERIALLAYERWITHOFFSETS",760658860:"IFCMATERIALDEFINITION",3057273783:"IFCMAPCONVERSION",4294318154:"IFCEXTERNALINFORMATION",1466758467:"IFCCOORDINATEREFERENCESYSTEM",1785450214:"IFCCOORDINATEOPERATION",775493141:"IFCCONNECTIONVOLUMEGEOMETRY",979691226:"IFCREINFORCINGBAR",3700593921:"IFCELECTRICDISTRIBUTIONPOINT",1062813311:"IFCDISTRIBUTIONCONTROLELEMENT",1052013943:"IFCDISTRIBUTIONCHAMBERELEMENT",578613899:"IFCCONTROLLERTYPE",2454782716:"IFCCHAMFEREDGEFEATURE",753842376:"IFCBEAM",3001207471:"IFCALARMTYPE",2874132201:"IFCACTUATORTYPE",3304561284:"IFCWINDOW",3512223829:"IFCWALLSTANDARDCASE",2391406946:"IFCWALL",3313531582:"IFCVIBRATIONISOLATORTYPE",2347447852:"IFCTENDONANCHOR",3824725483:"IFCTENDON",2515109513:"IFCSTRUCTURALANALYSISMODEL",4252922144:"IFCSTAIRFLIGHT",331165859:"IFCSTAIR",1529196076:"IFCSLAB",1783015770:"IFCSENSORTYPE",1376911519:"IFCROUNDEDEDGEFEATURE",2016517767:"IFCROOF",2320036040:"IFCREINFORCINGMESH",3027567501:"IFCREINFORCINGELEMENT",3055160366:"IFCRATIONALBEZIERCURVE",3283111854:"IFCRAMPFLIGHT",3024970846:"IFCRAMP",2262370178:"IFCRAILING",3171933400:"IFCPLATE",1687234759:"IFCPILE",1073191201:"IFCMEMBER",900683007:"IFCFOOTING",3508470533:"IFCFLOWTREATMENTDEVICE",2223149337:"IFCFLOWTERMINAL",707683696:"IFCFLOWSTORAGEDEVICE",987401354:"IFCFLOWSEGMENT",3132237377:"IFCFLOWMOVINGDEVICE",4037862832:"IFCFLOWINSTRUMENTTYPE",4278956645:"IFCFLOWFITTING",2058353004:"IFCFLOWCONTROLLER",4222183408:"IFCFIRESUPPRESSIONTERMINALTYPE",1810631287:"IFCFILTERTYPE",346874300:"IFCFANTYPE",1658829314:"IFCENERGYCONVERSIONDEVICE",857184966:"IFCELECTRICALELEMENT",1634875225:"IFCELECTRICALCIRCUIT",712377611:"IFCELECTRICTIMECONTROLTYPE",1217240411:"IFCELECTRICMOTORTYPE",1365060375:"IFCELECTRICHEATERTYPE",1534661035:"IFCELECTRICGENERATORTYPE",3277789161:"IFCELECTRICFLOWSTORAGEDEVICETYPE",663422040:"IFCELECTRICAPPLIANCETYPE",855621170:"IFCEDGEFEATURE",2030761528:"IFCDUCTSILENCERTYPE",3760055223:"IFCDUCTSEGMENTTYPE",869906466:"IFCDUCTFITTINGTYPE",395920057:"IFCDOOR",3041715199:"IFCDISTRIBUTIONPORT",3040386961:"IFCDISTRIBUTIONFLOWELEMENT",1945004755:"IFCDISTRIBUTIONELEMENT",2063403501:"IFCDISTRIBUTIONCONTROLELEMENTTYPE",1599208980:"IFCDISTRIBUTIONCHAMBERELEMENTTYPE",2635815018:"IFCDISCRETEACCESSORYTYPE",1335981549:"IFCDISCRETEACCESSORY",4147604152:"IFCDIAMETERDIMENSION",3961806047:"IFCDAMPERTYPE",3495092785:"IFCCURTAINWALL",1973544240:"IFCCOVERING",2954562838:"IFCCOOLINGTOWERTYPE",335055490:"IFCCOOLEDBEAMTYPE",488727124:"IFCCONSTRUCTIONPRODUCTRESOURCE",1060000209:"IFCCONSTRUCTIONMATERIALRESOURCE",3898045240:"IFCCONSTRUCTIONEQUIPMENTRESOURCE",1163958913:"IFCCONDITIONCRITERION",2188551683:"IFCCONDITION",2816379211:"IFCCONDENSERTYPE",3850581409:"IFCCOMPRESSORTYPE",843113511:"IFCCOLUMN",2301859152:"IFCCOILTYPE",2611217952:"IFCCIRCLE",2951183804:"IFCCHILLERTYPE",1285652485:"IFCCABLESEGMENTTYPE",3293546465:"IFCCABLECARRIERSEGMENTTYPE",395041908:"IFCCABLECARRIERFITTINGTYPE",1909888760:"IFCBUILDINGELEMENTPROXYTYPE",1095909175:"IFCBUILDINGELEMENTPROXY",2979338954:"IFCBUILDINGELEMENTPART",52481810:"IFCBUILDINGELEMENTCOMPONENT",3299480353:"IFCBUILDINGELEMENT",231477066:"IFCBOILERTYPE",1916977116:"IFCBEZIERCURVE",819618141:"IFCBEAMTYPE",1967976161:"IFCBSPLINECURVE",3460190687:"IFCASSET",2470393545:"IFCANGULARDIMENSION",1871374353:"IFCAIRTOAIRHEATRECOVERYTYPE",3352864051:"IFCAIRTERMINALTYPE",1411407467:"IFCAIRTERMINALBOXTYPE",3821786052:"IFCACTIONREQUEST",1213861670:"IFC2DCOMPOSITECURVE",1033361043:"IFCZONE",3342526732:"IFCWORKSCHEDULE",4218914973:"IFCWORKPLAN",1028945134:"IFCWORKCONTROL",1133259667:"IFCWASTETERMINALTYPE",1898987631:"IFCWALLTYPE",2769231204:"IFCVIRTUALELEMENT",728799441:"IFCVALVETYPE",1911125066:"IFCUNITARYEQUIPMENTTYPE",1600972822:"IFCTUBEBUNDLETYPE",3593883385:"IFCTRIMMEDCURVE",1620046519:"IFCTRANSPORTELEMENT",1692211062:"IFCTRANSFORMERTYPE",1637806684:"IFCTIMESERIESSCHEDULE",5716631:"IFCTANKTYPE",2254336722:"IFCSYSTEM",2315554128:"IFCSWITCHINGDEVICETYPE",148013059:"IFCSUBCONTRACTRESOURCE",1975003073:"IFCSTRUCTURALSURFACECONNECTION",2986769608:"IFCSTRUCTURALRESULTGROUP",1235345126:"IFCSTRUCTURALPOINTREACTION",734778138:"IFCSTRUCTURALPOINTCONNECTION",2082059205:"IFCSTRUCTURALPOINTACTION",3987759626:"IFCSTRUCTURALPLANARACTIONVARYING",1621171031:"IFCSTRUCTURALPLANARACTION",1252848954:"IFCSTRUCTURALLOADGROUP",1721250024:"IFCSTRUCTURALLINEARACTIONVARYING",1807405624:"IFCSTRUCTURALLINEARACTION",2445595289:"IFCSTRUCTURALCURVEMEMBERVARYING",214636428:"IFCSTRUCTURALCURVEMEMBER",4243806635:"IFCSTRUCTURALCURVECONNECTION",1179482911:"IFCSTRUCTURALCONNECTION",682877961:"IFCSTRUCTURALACTION",1039846685:"IFCSTAIRFLIGHTTYPE",3112655638:"IFCSTACKTERMINALTYPE",3812236995:"IFCSPACETYPE",652456506:"IFCSPACEPROGRAM",1305183839:"IFCSPACEHEATERTYPE",3856911033:"IFCSPACE",2533589738:"IFCSLABTYPE",4097777520:"IFCSITE",4105383287:"IFCSERVICELIFE",3517283431:"IFCSCHEDULETIMECONTROL",1768891740:"IFCSANITARYTERMINALTYPE",2863920197:"IFCRELASSIGNSTASKS",160246688:"IFCRELAGGREGATES",2324767716:"IFCRAMPFLIGHTTYPE",2893384427:"IFCRAILINGTYPE",3248260540:"IFCRADIUSDIMENSION",2250791053:"IFCPUMPTYPE",1842657554:"IFCPROTECTIVEDEVICETYPE",3651124850:"IFCPROJECTIONELEMENT",3642467123:"IFCPROJECTORDERRECORD",2904328755:"IFCPROJECTORDER",2744685151:"IFCPROCEDURE",3740093272:"IFCPORT",3724593414:"IFCPOLYLINE",4017108033:"IFCPLATETYPE",4231323485:"IFCPIPESEGMENTTYPE",804291784:"IFCPIPEFITTINGTYPE",3327091369:"IFCPERMIT",2382730787:"IFCPERFORMANCEHISTORY",2837617999:"IFCOUTLETTYPE",3425660407:"IFCORDERACTION",3588315303:"IFCOPENINGELEMENT",4143007308:"IFCOCCUPANT",1916936684:"IFCMOVE",977012517:"IFCMOTORCONNECTIONTYPE",3181161470:"IFCMEMBERTYPE",2108223431:"IFCMECHANICALFASTENERTYPE",377706215:"IFCMECHANICALFASTENER",2506943328:"IFCLINEARDIMENSION",1161773419:"IFCLIGHTFIXTURETYPE",1051575348:"IFCLAMPTYPE",3827777499:"IFCLABORRESOURCE",4288270099:"IFCJUNCTIONBOXTYPE",2391368822:"IFCINVENTORY",1806887404:"IFCHUMIDIFIERTYPE",1251058090:"IFCHEATEXCHANGERTYPE",2706460486:"IFCGROUP",3009204131:"IFCGRID",200128114:"IFCGASTERMINALTYPE",814719939:"IFCFURNITURESTANDARD",263784265:"IFCFURNISHINGELEMENT",3009222698:"IFCFLOWTREATMENTDEVICETYPE",2297155007:"IFCFLOWTERMINALTYPE",1339347760:"IFCFLOWSTORAGEDEVICETYPE",1834744321:"IFCFLOWSEGMENTTYPE",1482959167:"IFCFLOWMOVINGDEVICETYPE",3815607619:"IFCFLOWMETERTYPE",3198132628:"IFCFLOWFITTINGTYPE",3907093117:"IFCFLOWCONTROLLERTYPE",1287392070:"IFCFEATUREELEMENTSUBTRACTION",2143335405:"IFCFEATUREELEMENTADDITION",2827207264:"IFCFEATUREELEMENT",2489546625:"IFCFASTENERTYPE",647756555:"IFCFASTENER",3737207727:"IFCFACETEDBREPWITHVOIDS",807026263:"IFCFACETEDBREP",3390157468:"IFCEVAPORATORTYPE",3174744832:"IFCEVAPORATIVECOOLERTYPE",3272907226:"IFCEQUIPMENTSTANDARD",1962604670:"IFCEQUIPMENTELEMENT",2107101300:"IFCENERGYCONVERSIONDEVICETYPE",1704287377:"IFCELLIPSE",2590856083:"IFCELEMENTCOMPONENTTYPE",1623761950:"IFCELEMENTCOMPONENT",4123344466:"IFCELEMENTASSEMBLY",1758889154:"IFCELEMENT",360485395:"IFCELECTRICALBASEPROPERTIES",3849074793:"IFCDISTRIBUTIONFLOWELEMENTTYPE",3256556792:"IFCDISTRIBUTIONELEMENTTYPE",681481545:"IFCDIMENSIONCURVEDIRECTEDCALLOUT",1457835157:"IFCCURTAINWALLTYPE",3295246426:"IFCCREWRESOURCE",1916426348:"IFCCOVERINGTYPE",1419761937:"IFCCOSTSCHEDULE",3895139033:"IFCCOSTITEM",3293443760:"IFCCONTROL",2559216714:"IFCCONSTRUCTIONRESOURCE",2510884976:"IFCCONIC",3732776249:"IFCCOMPOSITECURVE",300633059:"IFCCOLUMNTYPE",2937912522:"IFCCIRCLEHOLLOWPROFILEDEF",3124254112:"IFCBUILDINGSTOREY",1950629157:"IFCBUILDINGELEMENTTYPE",4031249490:"IFCBUILDING",1260505505:"IFCBOUNDEDCURVE",3649129432:"IFCBOOLEANCLIPPINGRESULT",1334484129:"IFCBLOCK",3207858831:"IFCASYMMETRICISHAPEPROFILEDEF",1674181508:"IFCANNOTATION",2296667514:"IFCACTOR",2097647324:"IFCTRANSPORTELEMENTTYPE",3473067441:"IFCTASK",1580310250:"IFCSYSTEMFURNITUREELEMENTTYPE",4124788165:"IFCSURFACEOFREVOLUTION",2809605785:"IFCSURFACEOFLINEAREXTRUSION",2028607225:"IFCSURFACECURVESWEPTAREASOLID",4070609034:"IFCSTRUCTUREDDIMENSIONCALLOUT",2218152070:"IFCSTRUCTURALSURFACEMEMBERVARYING",3979015343:"IFCSTRUCTURALSURFACEMEMBER",3689010777:"IFCSTRUCTURALREACTION",530289379:"IFCSTRUCTURALMEMBER",3136571912:"IFCSTRUCTURALITEM",3544373492:"IFCSTRUCTURALACTIVITY",451544542:"IFCSPHERE",3893378262:"IFCSPATIALSTRUCTUREELEMENTTYPE",2706606064:"IFCSPATIALSTRUCTUREELEMENT",3626867408:"IFCRIGHTCIRCULARCYLINDER",4158566097:"IFCRIGHTCIRCULARCONE",1856042241:"IFCREVOLVEDAREASOLID",2914609552:"IFCRESOURCE",1401173127:"IFCRELVOIDSELEMENT",3451746338:"IFCRELSPACEBOUNDARY",366585022:"IFCRELSERVICESBUILDINGS",4122056220:"IFCRELSEQUENCE",1058617721:"IFCRELSCHEDULESCOSTITEMS",1245217292:"IFCRELREFERENCEDINSPATIALSTRUCTURE",750771296:"IFCRELPROJECTSELEMENT",202636808:"IFCRELOVERRIDESPROPERTIES",2051452291:"IFCRELOCCUPIESSPACES",3268803585:"IFCRELNESTS",4189434867:"IFCRELINTERACTIONREQUIREMENTS",279856033:"IFCRELFLOWCONTROLELEMENTS",3940055652:"IFCRELFILLSELEMENT",781010003:"IFCRELDEFINESBYTYPE",4186316022:"IFCRELDEFINESBYPROPERTIES",693640335:"IFCRELDEFINES",2551354335:"IFCRELDECOMPOSES",2802773753:"IFCRELCOVERSSPACES",886880790:"IFCRELCOVERSBLDGELEMENTS",3242617779:"IFCRELCONTAINEDINSPATIALSTRUCTURE",3678494232:"IFCRELCONNECTSWITHREALIZINGELEMENTS",504942748:"IFCRELCONNECTSWITHECCENTRICITY",1638771189:"IFCRELCONNECTSSTRUCTURALMEMBER",3912681535:"IFCRELCONNECTSSTRUCTURALELEMENT",2127690289:"IFCRELCONNECTSSTRUCTURALACTIVITY",3190031847:"IFCRELCONNECTSPORTS",4201705270:"IFCRELCONNECTSPORTTOELEMENT",3945020480:"IFCRELCONNECTSPATHELEMENTS",1204542856:"IFCRELCONNECTSELEMENTS",826625072:"IFCRELCONNECTS",2851387026:"IFCRELASSOCIATESPROFILEPROPERTIES",2655215786:"IFCRELASSOCIATESMATERIAL",3840914261:"IFCRELASSOCIATESLIBRARY",982818633:"IFCRELASSOCIATESDOCUMENT",2728634034:"IFCRELASSOCIATESCONSTRAINT",919958153:"IFCRELASSOCIATESCLASSIFICATION",4095574036:"IFCRELASSOCIATESAPPROVAL",1327628568:"IFCRELASSOCIATESAPPLIEDVALUE",1865459582:"IFCRELASSOCIATES",205026976:"IFCRELASSIGNSTORESOURCE",3372526763:"IFCRELASSIGNSTOPROJECTORDER",2857406711:"IFCRELASSIGNSTOPRODUCT",4278684876:"IFCRELASSIGNSTOPROCESS",1307041759:"IFCRELASSIGNSTOGROUP",2495723537:"IFCRELASSIGNSTOCONTROL",1683148259:"IFCRELASSIGNSTOACTOR",3939117080:"IFCRELASSIGNS",3454111270:"IFCRECTANGULARTRIMMEDSURFACE",2798486643:"IFCRECTANGULARPYRAMID",2770003689:"IFCRECTANGLEHOLLOWPROFILEDEF",3219374653:"IFCPROXY",1451395588:"IFCPROPERTYSET",4194566429:"IFCPROJECTIONCURVE",103090709:"IFCPROJECT",4208778838:"IFCPRODUCT",2945172077:"IFCPROCESS",220341763:"IFCPLANE",603570806:"IFCPLANARBOX",3566463478:"IFCPERMEABLECOVERINGPROPERTIES",3505215534:"IFCOFFSETCURVE3D",3388369263:"IFCOFFSETCURVE2D",3888040117:"IFCOBJECT",1425443689:"IFCMANIFOLDSOLIDBREP",1281925730:"IFCLINE",572779678:"IFCLSHAPEPROFILEDEF",1484403080:"IFCISHAPEPROFILEDEF",987898635:"IFCGEOMETRICCURVESET",1268542332:"IFCFURNITURETYPE",4238390223:"IFCFURNISHINGELEMENTTYPE",3455213021:"IFCFLUIDFLOWPROPERTIES",315944413:"IFCFILLAREASTYLETILES",4203026998:"IFCFILLAREASTYLETILESYMBOLWITHSTYLE",374418227:"IFCFILLAREASTYLEHATCHING",2047409740:"IFCFACEBASEDSURFACEMODEL",477187591:"IFCEXTRUDEDAREASOLID",80994333:"IFCENERGYPROPERTIES",2835456948:"IFCELLIPSEPROFILEDEF",2777663545:"IFCELEMENTARYSURFACE",339256511:"IFCELEMENTTYPE",1883228015:"IFCELEMENTQUANTITY",1472233963:"IFCEDGELOOP",4006246654:"IFCDRAUGHTINGPREDEFINEDCURVEFONT",445594917:"IFCDRAUGHTINGPREDEFINEDCOLOUR",3073041342:"IFCDRAUGHTINGCALLOUT",526551008:"IFCDOORSTYLE",1714330368:"IFCDOORPANELPROPERTIES",2963535650:"IFCDOORLININGPROPERTIES",32440307:"IFCDIRECTION",4054601972:"IFCDIMENSIONCURVETERMINATOR",606661476:"IFCDIMENSIONCURVE",693772133:"IFCDEFINEDSYMBOL",2827736869:"IFCCURVEBOUNDEDPLANE",2601014836:"IFCCURVE",2147822146:"IFCCSGSOLID",2506170314:"IFCCSGPRIMITIVE3D",194851669:"IFCCRANERAILFSHAPEPROFILEDEF",4133800736:"IFCCRANERAILASHAPEPROFILEDEF",2485617015:"IFCCOMPOSITECURVESEGMENT",2205249479:"IFCCLOSEDSHELL",1383045692:"IFCCIRCLEPROFILEDEF",1416205885:"IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM",3331915920:"IFCCARTESIANTRANSFORMATIONOPERATOR3D",3486308946:"IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM",3749851601:"IFCCARTESIANTRANSFORMATIONOPERATOR2D",59481748:"IFCCARTESIANTRANSFORMATIONOPERATOR",1123145078:"IFCCARTESIANPOINT",2898889636:"IFCCSHAPEPROFILEDEF",2713105998:"IFCBOXEDHALFSPACE",2581212453:"IFCBOUNDINGBOX",4182860854:"IFCBOUNDEDSURFACE",2736907675:"IFCBOOLEANRESULT",2740243338:"IFCAXIS2PLACEMENT3D",3125803723:"IFCAXIS2PLACEMENT2D",4261334040:"IFCAXIS1PLACEMENT",1302238472:"IFCANNOTATIONSURFACE",2265737646:"IFCANNOTATIONFILLAREAOCCURRENCE",669184980:"IFCANNOTATIONFILLAREA",3288037868:"IFCANNOTATIONCURVEOCCURRENCE",2543172580:"IFCZSHAPEPROFILEDEF",1299126871:"IFCWINDOWSTYLE",512836454:"IFCWINDOWPANELPROPERTIES",336235671:"IFCWINDOWLININGPROPERTIES",2759199220:"IFCVERTEXLOOP",1417489154:"IFCVECTOR",427810014:"IFCUSHAPEPROFILEDEF",2347495698:"IFCTYPEPRODUCT",1628702193:"IFCTYPEOBJECT",1345879162:"IFCTWODIRECTIONREPEATFACTOR",2715220739:"IFCTRAPEZIUMPROFILEDEF",3124975700:"IFCTEXTLITERALWITHEXTENT",4282788508:"IFCTEXTLITERAL",3028897424:"IFCTERMINATORSYMBOL",3071757647:"IFCTSHAPEPROFILEDEF",230924584:"IFCSWEPTSURFACE",1260650574:"IFCSWEPTDISKSOLID",2247615214:"IFCSWEPTAREASOLID",1878645084:"IFCSURFACESTYLERENDERING",2513912981:"IFCSURFACE",2233826070:"IFCSUBEDGE",3653947884:"IFCSTRUCTURALSTEELPROFILEPROPERTIES",3843319758:"IFCSTRUCTURALPROFILEPROPERTIES",1190533807:"IFCSTRUCTURALLOADSINGLEFORCEWARPING",1597423693:"IFCSTRUCTURALLOADSINGLEFORCE",1973038258:"IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION",2473145415:"IFCSTRUCTURALLOADSINGLEDISPLACEMENT",2668620305:"IFCSTRUCTURALLOADPLANARFORCE",1595516126:"IFCSTRUCTURALLOADLINEARFORCE",390701378:"IFCSPACETHERMALLOADPROPERTIES",1202362311:"IFCSOUNDVALUE",2485662743:"IFCSOUNDPROPERTIES",723233188:"IFCSOLIDMODEL",2609359061:"IFCSLIPPAGECONNECTIONCONDITION",4124623270:"IFCSHELLBASEDSURFACEMODEL",2411513650:"IFCSERVICELIFEFACTOR",1509187699:"IFCSECTIONEDSPINE",2778083089:"IFCROUNDEDRECTANGLEPROFILEDEF",478536968:"IFCRELATIONSHIP",3765753017:"IFCREINFORCEMENTDEFINITIONPROPERTIES",3413951693:"IFCREGULARTIMESERIES",3615266464:"IFCRECTANGLEPROFILEDEF",110355661:"IFCPROPERTYTABLEVALUE",3650150729:"IFCPROPERTYSINGLEVALUE",3357820518:"IFCPROPERTYSETDEFINITION",941946838:"IFCPROPERTYREFERENCEVALUE",2752243245:"IFCPROPERTYLISTVALUE",4166981789:"IFCPROPERTYENUMERATEDVALUE",1680319473:"IFCPROPERTYDEFINITION",871118103:"IFCPROPERTYBOUNDEDVALUE",673634403:"IFCPRODUCTDEFINITIONSHAPE",179317114:"IFCPREDEFINEDPOINTMARKERSYMBOL",433424934:"IFCPREDEFINEDDIMENSIONSYMBOL",2559016684:"IFCPREDEFINEDCURVEFONT",759155922:"IFCPREDEFINEDCOLOUR",2775532180:"IFCPOLYGONALBOUNDEDHALFSPACE",2924175390:"IFCPOLYLOOP",1423911732:"IFCPOINTONSURFACE",4022376103:"IFCPOINTONCURVE",2067069095:"IFCPOINT",1663979128:"IFCPLANAREXTENT",2004835150:"IFCPLACEMENT",597895409:"IFCPIXELTEXTURE",3021840470:"IFCPHYSICALCOMPLEXQUANTITY",2519244187:"IFCPATH",2529465313:"IFCPARAMETERIZEDPROFILEDEF",1029017970:"IFCORIENTEDEDGE",2665983363:"IFCOPENSHELL",2833995503:"IFCONEDIRECTIONREPEATFACTOR",219451334:"IFCOBJECTDEFINITION",1430189142:"IFCMECHANICALCONCRETEMATERIALPROPERTIES",2022407955:"IFCMATERIALDEFINITIONREPRESENTATION",2347385850:"IFCMAPPEDITEM",1008929658:"IFCLOOP",2624227202:"IFCLOCALPLACEMENT",3422422726:"IFCLIGHTSOURCESPOT",1520743889:"IFCLIGHTSOURCEPOSITIONAL",4266656042:"IFCLIGHTSOURCEGONIOMETRIC",2604431987:"IFCLIGHTSOURCEDIRECTIONAL",125510826:"IFCLIGHTSOURCEAMBIENT",1402838566:"IFCLIGHTSOURCE",3741457305:"IFCIRREGULARTIMESERIES",3905492369:"IFCIMAGETEXTURE",2445078500:"IFCHYGROSCOPICMATERIALPROPERTIES",812098782:"IFCHALFSPACESOLID",178086475:"IFCGRIDPLACEMENT",3590301190:"IFCGEOMETRICSET",4142052618:"IFCGEOMETRICREPRESENTATIONSUBCONTEXT",2453401579:"IFCGEOMETRICREPRESENTATIONITEM",3448662350:"IFCGEOMETRICREPRESENTATIONCONTEXT",1446786286:"IFCGENERALPROFILEPROPERTIES",803998398:"IFCGENERALMATERIALPROPERTIES",3857492461:"IFCFUELPROPERTIES",738692330:"IFCFILLAREASTYLE",4219587988:"IFCFAILURECONNECTIONCONDITION",3008276851:"IFCFACESURFACE",803316827:"IFCFACEOUTERBOUND",1809719519:"IFCFACEBOUND",2556980723:"IFCFACE",1860660968:"IFCEXTENDEDMATERIALPROPERTIES",476780140:"IFCEDGECURVE",3900360178:"IFCEDGE",4170525392:"IFCDRAUGHTINGPREDEFINEDTEXTFONT",3732053477:"IFCDOCUMENTREFERENCE",1694125774:"IFCDIMENSIONPAIR",2273265877:"IFCDIMENSIONCALLOUTRELATIONSHIP",3632507154:"IFCDERIVEDPROFILEDEF",3800577675:"IFCCURVESTYLE",2889183280:"IFCCONVERSIONBASEDUNIT",3050246964:"IFCCONTEXTDEPENDENTUNIT",45288368:"IFCCONNECTIONPOINTECCENTRICITY",1981873012:"IFCCONNECTIONCURVEGEOMETRY",370225590:"IFCCONNECTEDFACESET",1485152156:"IFCCOMPOSITEPROFILEDEF",2542286263:"IFCCOMPLEXPROPERTY",776857604:"IFCCOLOURRGB",647927063:"IFCCLASSIFICATIONREFERENCE",3150382593:"IFCCENTERLINEPROFILEDEF",616511568:"IFCBLOBTEXTURE",2705031697:"IFCARBITRARYPROFILEDEFWITHVOIDS",1310608509:"IFCARBITRARYOPENPROFILEDEF",3798115385:"IFCARBITRARYCLOSEDPROFILEDEF",2297822566:"IFCANNOTATIONTEXTOCCURRENCE",3612888222:"IFCANNOTATIONSYMBOLOCCURRENCE",962685235:"IFCANNOTATIONSURFACEOCCURRENCE",2442683028:"IFCANNOTATIONOCCURRENCE",1065908215:"IFCWATERPROPERTIES",891718957:"IFCVIRTUALGRIDINTERSECTION",1907098498:"IFCVERTEXPOINT",3304826586:"IFCVERTEXBASEDTEXTUREMAP",2799835756:"IFCVERTEX",180925521:"IFCUNITASSIGNMENT",1735638870:"IFCTOPOLOGYREPRESENTATION",1377556343:"IFCTOPOLOGICALREPRESENTATIONITEM",581633288:"IFCTIMESERIESVALUE",1718945513:"IFCTIMESERIESREFERENCERELATIONSHIP",3101149627:"IFCTIMESERIES",3317419933:"IFCTHERMALMATERIALPROPERTIES",1210645708:"IFCTEXTUREVERTEX",2552916305:"IFCTEXTUREMAP",1742049831:"IFCTEXTURECOORDINATEGENERATOR",280115917:"IFCTEXTURECOORDINATE",1484833681:"IFCTEXTSTYLEWITHBOXCHARACTERISTICS",1640371178:"IFCTEXTSTYLETEXTMODEL",2636378356:"IFCTEXTSTYLEFORDEFINEDFONT",1983826977:"IFCTEXTSTYLEFONTMODEL",1447204868:"IFCTEXTSTYLE",912023232:"IFCTELECOMADDRESS",531007025:"IFCTABLEROW",985171141:"IFCTABLE",1290481447:"IFCSYMBOLSTYLE",626085974:"IFCSURFACETEXTURE",1351298697:"IFCSURFACESTYLEWITHTEXTURES",846575682:"IFCSURFACESTYLESHADING",1607154358:"IFCSURFACESTYLEREFRACTION",3303107099:"IFCSURFACESTYLELIGHTING",1300840506:"IFCSURFACESTYLE",3049322572:"IFCSTYLEDREPRESENTATION",3958052878:"IFCSTYLEDITEM",2830218821:"IFCSTYLEMODEL",3408363356:"IFCSTRUCTURALLOADTEMPERATURE",2525727697:"IFCSTRUCTURALLOADSTATIC",2162789131:"IFCSTRUCTURALLOAD",2273995522:"IFCSTRUCTURALCONNECTIONCONDITION",3692461612:"IFCSIMPLEPROPERTY",4240577450:"IFCSHAPEREPRESENTATION",3982875396:"IFCSHAPEMODEL",867548509:"IFCSHAPEASPECT",4165799628:"IFCSECTIONREINFORCEMENTPROPERTIES",2042790032:"IFCSECTIONPROPERTIES",448429030:"IFCSIUNIT",2341007311:"IFCROOT",3679540991:"IFCRIBPLATEPROFILEPROPERTIES",1660063152:"IFCREPRESENTATIONMAP",3008791417:"IFCREPRESENTATIONITEM",3377609919:"IFCREPRESENTATIONCONTEXT",1076942058:"IFCREPRESENTATION",1222501353:"IFCRELAXATION",1580146022:"IFCREINFORCEMENTBARPROPERTIES",2692823254:"IFCREFERENCESVALUEDOCUMENT",825690147:"IFCQUANTITYWEIGHT",2405470396:"IFCQUANTITYVOLUME",3252649465:"IFCQUANTITYTIME",931644368:"IFCQUANTITYLENGTH",2093928680:"IFCQUANTITYCOUNT",2044713172:"IFCQUANTITYAREA",3710013099:"IFCPROPERTYENUMERATION",148025276:"IFCPROPERTYDEPENDENCYRELATIONSHIP",3896028662:"IFCPROPERTYCONSTRAINTRELATIONSHIP",2598011224:"IFCPROPERTY",2802850158:"IFCPROFILEPROPERTIES",3958567839:"IFCPROFILEDEF",2267347899:"IFCPRODUCTSOFCOMBUSTIONPROPERTIES",2095639259:"IFCPRODUCTREPRESENTATION",2417041796:"IFCPRESENTATIONSTYLEASSIGNMENT",3119450353:"IFCPRESENTATIONSTYLE",1304840413:"IFCPRESENTATIONLAYERWITHSTYLE",2022622350:"IFCPRESENTATIONLAYERASSIGNMENT",1775413392:"IFCPREDEFINEDTEXTFONT",3213052703:"IFCPREDEFINEDTERMINATORSYMBOL",990879717:"IFCPREDEFINEDSYMBOL",3727388367:"IFCPREDEFINEDITEM",3355820592:"IFCPOSTALADDRESS",2226359599:"IFCPHYSICALSIMPLEQUANTITY",2483315170:"IFCPHYSICALQUANTITY",101040310:"IFCPERSONANDORGANIZATION",2077209135:"IFCPERSON",1207048766:"IFCOWNERHISTORY",1411181986:"IFCORGANIZATIONRELATIONSHIP",4251960020:"IFCORGANIZATION",1227763645:"IFCOPTICALMATERIALPROPERTIES",2251480897:"IFCOBJECTIVE",3701648758:"IFCOBJECTPLACEMENT",1918398963:"IFCNAMEDUNIT",2706619895:"IFCMONETARYUNIT",3368373690:"IFCMETRIC",677618848:"IFCMECHANICALSTEELMATERIALPROPERTIES",4256014907:"IFCMECHANICALMATERIALPROPERTIES",2597039031:"IFCMEASUREWITHUNIT",3265635763:"IFCMATERIALPROPERTIES",2199411900:"IFCMATERIALLIST",1303795690:"IFCMATERIALLAYERSETUSAGE",3303938423:"IFCMATERIALLAYERSET",248100487:"IFCMATERIALLAYER",1847130766:"IFCMATERIALCLASSIFICATIONRELATIONSHIP",1838606355:"IFCMATERIAL",30780891:"IFCLOCALTIME",1566485204:"IFCLIGHTINTENSITYDISTRIBUTION",4162380809:"IFCLIGHTDISTRIBUTIONDATA",3452421091:"IFCLIBRARYREFERENCE",2655187982:"IFCLIBRARYINFORMATION",3020489413:"IFCIRREGULARTIMESERIESVALUE",852622518:"IFCGRIDAXIS",3548104201:"IFCEXTERNALLYDEFINEDTEXTFONT",3207319532:"IFCEXTERNALLYDEFINEDSYMBOL",1040185647:"IFCEXTERNALLYDEFINEDSURFACESTYLE",2242383968:"IFCEXTERNALLYDEFINEDHATCHSTYLE",3200245327:"IFCEXTERNALREFERENCE",1648886627:"IFCENVIRONMENTALIMPACTVALUE",3796139169:"IFCDRAUGHTINGCALLOUTRELATIONSHIP",770865208:"IFCDOCUMENTINFORMATIONRELATIONSHIP",1154170062:"IFCDOCUMENTINFORMATION",1376555844:"IFCDOCUMENTELECTRONICFORMAT",2949456006:"IFCDIMENSIONALEXPONENTS",1045800335:"IFCDERIVEDUNITELEMENT",1765591967:"IFCDERIVEDUNIT",1072939445:"IFCDATEANDTIME",3510044353:"IFCCURVESTYLEFONTPATTERN",2367409068:"IFCCURVESTYLEFONTANDSCALING",1105321065:"IFCCURVESTYLEFONT",539742890:"IFCCURRENCYRELATIONSHIP",602808272:"IFCCOSTVALUE",1065062679:"IFCCOORDINATEDUNIVERSALTIMEOFFSET",347226245:"IFCCONSTRAINTRELATIONSHIP",613356794:"IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP",1658513725:"IFCCONSTRAINTAGGREGATIONRELATIONSHIP",1959218052:"IFCCONSTRAINT",2732653382:"IFCCONNECTIONSURFACEGEOMETRY",4257277454:"IFCCONNECTIONPORTGEOMETRY",2614616156:"IFCCONNECTIONPOINTGEOMETRY",2859738748:"IFCCONNECTIONGEOMETRY",3264961684:"IFCCOLOURSPECIFICATION",3639012971:"IFCCLASSIFICATIONNOTATIONFACET",938368621:"IFCCLASSIFICATIONNOTATION",1098599126:"IFCCLASSIFICATIONITEMRELATIONSHIP",1767535486:"IFCCLASSIFICATIONITEM",747523909:"IFCCLASSIFICATION",622194075:"IFCCALENDARDATE",2069777674:"IFCBOUNDARYNODECONDITIONWARPING",1387855156:"IFCBOUNDARYNODECONDITION",3367102660:"IFCBOUNDARYFACECONDITION",1560379544:"IFCBOUNDARYEDGECONDITION",4037036970:"IFCBOUNDARYCONDITION",3869604511:"IFCAPPROVALRELATIONSHIP",390851274:"IFCAPPROVALPROPERTYRELATIONSHIP",2080292479:"IFCAPPROVALACTORRELATIONSHIP",130549933:"IFCAPPROVAL",1110488051:"IFCAPPLIEDVALUERELATIONSHIP",411424972:"IFCAPPLIEDVALUE",639542469:"IFCAPPLICATION",618182010:"IFCADDRESS",3630933823:"IFCACTORROLE",599546466:"FILE_DESCRIPTION",1390159747:"FILE_NAME",1109904537:"FILE_SCHEMA"};class no{static async getUnits(e){var t,i,s;const{IFCUNITASSIGNMENT:n}=he,r=await e.getAllPropertiesOfType(n);if(!r)return 1;const o=Object.keys(r),a=r[parseInt(o[0],10)];for(const n of a.Units){if(void 0===n.value||null===n.value)continue;const r=await e.getProperties(n.value);if(!r||!r.UnitType||!r.UnitType.value||"LENGTHUNIT"!==r.UnitType.value)continue;let o=1,a=1;return"METRE"===r.Name.value&&(a=1),"FOOT"===r.Name.value&&(a=.3048),"MILLI"===(null==(t=r.Prefix)?void 0:t.value)?o=.001:"CENTI"===(null==(i=r.Prefix)?void 0:i.value)?o=.01:"DECI"===(null==(s=r.Prefix)?void 0:s.value)&&(o=.1),a*o}return 1}static async findItemByGuid(e,t){var i;const s=e.getAllPropertiesIDs();for(const n of s){const s=await e.getProperties(n);if(s&&(null==(i=s.GlobalId)?void 0:i.value)===t)return s}return null}static async getRelationMap(e,t,i){var s;const n=i??(async()=>{}),r={},o=e.getAllPropertiesIDs();for(const i of o){const o=await e.getProperties(i);if(!o)continue;const a=o.type===t,l=Object.keys(o).find((e=>e.startsWith("Relating"))),c=Object.keys(o).find((e=>e.startsWith("Related")));if(!(a&&l&&c))continue;const h=await e.getProperties(null==(s=o[l])?void 0:s.value),d=o[c];if(!(h&&d&&d&&Array.isArray(d)))continue;const u=d.map((e=>e.value));await n(h.expressID,u),r[h.expressID]=u}return r}static async getQsetQuantities(e,t,i){const s=i??(()=>{}),n=await e.getProperties(t);return n&&n.type===he.IFCELEMENTQUANTITY?(n.Quantities??[{}]).map((e=>(e.value&&s(e.value),e.value))).filter((e=>null!==e)):null}static async getPsetProps(e,t,i){const s=i??(()=>{}),n=await e.getProperties(t);return n&&n.type===he.IFCPROPERTYSET?(n.HasProperties??[{}]).map((e=>(e.value&&s(e.value),e.value))).filter((e=>null!==e)):null}static async getPsetRel(e,t){var i;if(!await e.getProperties(t))return null;const s=await e.getAllPropertiesOfType(he.IFCRELDEFINESBYPROPERTIES);if(!s)return null;const n=Object.values(s);let r=null;for(const e of n)(null==(i=e.RelatingPropertyDefinition)?void 0:i.value)===t&&(r=e.expressID);return r}static async getQsetRel(e,t){return no.getPsetRel(e,t)}static async getEntityName(e,t){var i;const s=await e.getProperties(t);if(!s)return{key:null,name:null};const n=Object.keys(s).find((e=>e.endsWith("Name")))??null;return{key:n,name:n?null==(i=s[n])?void 0:i.value:null}}static async getQuantityValue(e,t){const i=await e.getProperties(t);if(!i)return{key:null,value:null};const s=Object.keys(i).find((e=>e.endsWith("Value")))??null;let n;return n=null===s||void 0===i[s]||null===i[s]?null:i[s].value,{key:s,value:n}}static isRel(e){return so[e].startsWith("IFCREL")}static async attributeExists(e,t,i){const s=await e.getProperties(t);return!!s&&Object.keys(s).includes(i)}static async groupEntitiesByType(e,t){var i;const s=new Map;for(const n of t){const t=await e.getProperties(n);if(!t)continue;const r=t.type;s.get(r)||s.set(r,new Set),null==(i=s.get(r))||i.add(n)}return s}}const ro={IFCURIREFERENCE:"IfcUriReference",IFCTIME:"IfcTime",IFCTEMPERATURERATEOFCHANGEMEASURE:"IfcTemperatureRateOfChangeMeasure",IFCSOUNDPRESSURELEVELMEASURE:"IfcSoundPressureLevelMeasure",IFCSOUNDPOWERLEVELMEASURE:"IfcSoundPowerLevelMeasure",IFCPROPERTYSETDEFINITIONSET:"IfcPropertySetDefinitionSet",IFCPOSITIVEINTEGER:"IfcPositiveInteger",IFCNONNEGATIVELENGTHMEASURE:"IfcNonNegativeLengthMeasure",IFCLINEINDEX:"IfcLineIndex",IFCLANGUAGEID:"IfcLanguageId",IFCDURATION:"IfcDuration",IFCDAYINWEEKNUMBER:"IfcDayInWeekNumber",IFCDATETIME:"IfcDateTime",IFCDATE:"IfcDate",IFCCARDINALPOINTREFERENCE:"IfcCardinalPointReference",IFCBINARY:"IfcBinary",IFCAREADENSITYMEASURE:"IfcAreaDensityMeasure",IFCARCINDEX:"IfcArcIndex",IFCYEARNUMBER:"IfcYearNumber",IFCWARPINGMOMENTMEASURE:"IfcWarpingMomentMeasure",IFCWARPINGCONSTANTMEASURE:"IfcWarpingConstantMeasure",IFCVOLUMETRICFLOWRATEMEASURE:"IfcVolumetricFlowRateMeasure",IFCVOLUMEMEASURE:"IfcVolumeMeasure",IFCVAPORPERMEABILITYMEASURE:"IfcVaporPermeabilityMeasure",IFCTORQUEMEASURE:"IfcTorqueMeasure",IFCTIMESTAMP:"IfcTimestamp",IFCTIMEMEASURE:"IfcTimeMeasure",IFCTHERMODYNAMICTEMPERATUREMEASURE:"IfcThermodynamicTemperatureMeasure",IFCTHERMALTRANSMITTANCEMEASURE:"IfcThermalTransmittanceMeasure",IFCTHERMALRESISTANCEMEASURE:"IfcThermalResistanceMeasure",IFCTHERMALEXPANSIONCOEFFICIENTMEASURE:"IfcThermalExpansionCoefficientMeasure",IFCTHERMALCONDUCTIVITYMEASURE:"IfcThermalConductivityMeasure",IFCTHERMALADMITTANCEMEASURE:"IfcThermalAdmittanceMeasure",IFCTEXTTRANSFORMATION:"IfcTextTransformation",IFCTEXTFONTNAME:"IfcTextFontName",IFCTEXTDECORATION:"IfcTextDecoration",IFCTEXTALIGNMENT:"IfcTextAlignment",IFCTEXT:"IfcText",IFCTEMPERATUREGRADIENTMEASURE:"IfcTemperatureGradientMeasure",IFCSPECULARROUGHNESS:"IfcSpecularRoughness",IFCSPECULAREXPONENT:"IfcSpecularExponent",IFCSPECIFICHEATCAPACITYMEASURE:"IfcSpecificHeatCapacityMeasure",IFCSOUNDPRESSUREMEASURE:"IfcSoundPressureMeasure",IFCSOUNDPOWERMEASURE:"IfcSoundPowerMeasure",IFCSOLIDANGLEMEASURE:"IfcSolidAngleMeasure",IFCSHEARMODULUSMEASURE:"IfcShearModulusMeasure",IFCSECTIONALAREAINTEGRALMEASURE:"IfcSectionalAreaIntegralMeasure",IFCSECTIONMODULUSMEASURE:"IfcSectionModulusMeasure",IFCSECONDINMINUTE:"IfcSecondInMinute",IFCROTATIONALSTIFFNESSMEASURE:"IfcRotationalStiffnessMeasure",IFCROTATIONALMASSMEASURE:"IfcRotationalMassMeasure",IFCROTATIONALFREQUENCYMEASURE:"IfcRotationalFrequencyMeasure",IFCREAL:"IfcReal",IFCRATIOMEASURE:"IfcRatioMeasure",IFCRADIOACTIVITYMEASURE:"IfcRadioactivityMeasure",IFCPRESSUREMEASURE:"IfcPressureMeasure",IFCPRESENTABLETEXT:"IfcPresentableText",IFCPOWERMEASURE:"IfcPowerMeasure",IFCPOSITIVERATIOMEASURE:"IfcPositiveRatioMeasure",IFCPOSITIVEPLANEANGLEMEASURE:"IfcPositivePlaneAngleMeasure",IFCPOSITIVELENGTHMEASURE:"IfcPositiveLengthMeasure",IFCPLANEANGLEMEASURE:"IfcPlaneAngleMeasure",IFCPLANARFORCEMEASURE:"IfcPlanarForceMeasure",IFCPARAMETERVALUE:"IfcParameterValue",IFCPHMEASURE:"IfcPhMeasure",IFCNUMERICMEASURE:"IfcNumericMeasure",IFCNORMALISEDRATIOMEASURE:"IfcNormalisedRatioMeasure",IFCMONTHINYEARNUMBER:"IfcMonthInYearNumber",IFCMONETARYMEASURE:"IfcMonetaryMeasure",IFCMOMENTOFINERTIAMEASURE:"IfcMomentOfInertiaMeasure",IFCMOLECULARWEIGHTMEASURE:"IfcMolecularWeightMeasure",IFCMOISTUREDIFFUSIVITYMEASURE:"IfcMoistureDiffusivityMeasure",IFCMODULUSOFSUBGRADEREACTIONMEASURE:"IfcModulusOfSubgradeReactionMeasure",IFCMODULUSOFROTATIONALSUBGRADEREACTIONMEASURE:"IfcModulusOfRotationalSubgradeReactionMeasure",IFCMODULUSOFLINEARSUBGRADEREACTIONMEASURE:"IfcModulusOfLinearSubgradeReactionMeasure",IFCMODULUSOFELASTICITYMEASURE:"IfcModulusOfElasticityMeasure",IFCMINUTEINHOUR:"IfcMinuteInHour",IFCMASSPERLENGTHMEASURE:"IfcMassPerLengthMeasure",IFCMASSMEASURE:"IfcMassMeasure",IFCMASSFLOWRATEMEASURE:"IfcMassFlowRateMeasure",IFCMASSDENSITYMEASURE:"IfcMassDensityMeasure",IFCMAGNETICFLUXMEASURE:"IfcMagneticFluxMeasure",IFCMAGNETICFLUXDENSITYMEASURE:"IfcMagneticFluxDensityMeasure",IFCLUMINOUSINTENSITYMEASURE:"IfcLuminousIntensityMeasure",IFCLUMINOUSINTENSITYDISTRIBUTIONMEASURE:"IfcLuminousIntensityDistributionMeasure",IFCLUMINOUSFLUXMEASURE:"IfcLuminousFluxMeasure",IFCLOGICAL:"IfcLogical",IFCLINEARVELOCITYMEASURE:"IfcLinearVelocityMeasure",IFCLINEARSTIFFNESSMEASURE:"IfcLinearStiffnessMeasure",IFCLINEARMOMENTMEASURE:"IfcLinearMomentMeasure",IFCLINEARFORCEMEASURE:"IfcLinearForceMeasure",IFCLENGTHMEASURE:"IfcLengthMeasure",IFCLABEL:"IfcLabel",IFCKINEMATICVISCOSITYMEASURE:"IfcKinematicViscosityMeasure",IFCISOTHERMALMOISTURECAPACITYMEASURE:"IfcIsothermalMoistureCapacityMeasure",IFCIONCONCENTRATIONMEASURE:"IfcIonConcentrationMeasure",IFCINTEGERCOUNTRATEMEASURE:"IfcIntegerCountRateMeasure",IFCINTEGER:"IfcInteger",IFCINDUCTANCEMEASURE:"IfcInductanceMeasure",IFCILLUMINANCEMEASURE:"IfcIlluminanceMeasure",IFCIDENTIFIER:"IfcIdentifier",IFCHOURINDAY:"IfcHourInDay",IFCHEATINGVALUEMEASURE:"IfcHeatingValueMeasure",IFCHEATFLUXDENSITYMEASURE:"IfcHeatFluxDensityMeasure",IFCGLOBALLYUNIQUEID:"IfcGloballyUniqueId",IFCFREQUENCYMEASURE:"IfcFrequencyMeasure",IFCFORCEMEASURE:"IfcForceMeasure",IFCFONTWEIGHT:"IfcFontWeight",IFCFONTVARIANT:"IfcFontVariant",IFCFONTSTYLE:"IfcFontStyle",IFCENERGYMEASURE:"IfcEnergyMeasure",IFCELECTRICVOLTAGEMEASURE:"IfcElectricVoltageMeasure",IFCELECTRICRESISTANCEMEASURE:"IfcElectricResistanceMeasure",IFCELECTRICCURRENTMEASURE:"IfcElectricCurrentMeasure",IFCELECTRICCONDUCTANCEMEASURE:"IfcElectricConductanceMeasure",IFCELECTRICCHARGEMEASURE:"IfcElectricChargeMeasure",IFCELECTRICCAPACITANCEMEASURE:"IfcElectricCapacitanceMeasure",IFCDYNAMICVISCOSITYMEASURE:"IfcDynamicViscosityMeasure",IFCDOSEEQUIVALENTMEASURE:"IfcDoseEquivalentMeasure",IFCDIMENSIONCOUNT:"IfcDimensionCount",IFCDESCRIPTIVEMEASURE:"IfcDescriptiveMeasure",IFCDAYLIGHTSAVINGHOUR:"IfcDaylightSavingHour",IFCDAYINMONTHNUMBER:"IfcDayInMonthNumber",IFCCURVATUREMEASURE:"IfcCurvatureMeasure",IFCCOUNTMEASURE:"IfcCountMeasure",IFCCONTEXTDEPENDENTMEASURE:"IfcContextDependentMeasure",IFCCOMPOUNDPLANEANGLEMEASURE:"IfcCompoundPlaneAngleMeasure",IFCCOMPLEXNUMBER:"IfcComplexNumber",IFCBOXALIGNMENT:"IfcBoxAlignment",IFCBOOLEAN:"IfcBoolean",IFCAREAMEASURE:"IfcAreaMeasure",IFCANGULARVELOCITYMEASURE:"IfcAngularVelocityMeasure",IFCAMOUNTOFSUBSTANCEMEASURE:"IfcAmountOfSubstanceMeasure",IFCACCELERATIONMEASURE:"IfcAccelerationMeasure",IFCABSORBEDDOSEMEASURE:"IfcAbsorbedDoseMeasure",IFCGEOSLICE:"IfcGeoSlice",IFCGEOMODEL:"IfcGeoModel",IFCELECTRICFLOWTREATMENTDEVICE:"IfcElectricFlowTreatmentDevice",IFCDISTRIBUTIONBOARD:"IfcDistributionBoard",IFCCONVEYORSEGMENT:"IfcConveyorSegment",IFCCAISSONFOUNDATION:"IfcCaissonFoundation",IFCBOREHOLE:"IfcBorehole",IFCBEARING:"IfcBearing",IFCALIGNMENT:"IfcAlignment",IFCTRACKELEMENT:"IfcTrackElement",IFCSIGNAL:"IfcSignal",IFCREINFORCEDSOIL:"IfcReinforcedSoil",IFCRAIL:"IfcRail",IFCPAVEMENT:"IfcPavement",IFCNAVIGATIONELEMENT:"IfcNavigationElement",IFCMOORINGDEVICE:"IfcMooringDevice",IFCMOBILETELECOMMUNICATIONSAPPLIANCE:"IfcMobileTelecommunicationsAppliance",IFCLIQUIDTERMINAL:"IfcLiquidTerminal",IFCLINEARPOSITIONINGELEMENT:"IfcLinearPositioningElement",IFCKERB:"IfcKerb",IFCGEOTECHNICALASSEMBLY:"IfcGeotechnicalAssembly",IFCELECTRICFLOWTREATMENTDEVICETYPE:"IfcElectricFlowTreatmentDeviceType",IFCEARTHWORKSFILL:"IfcEarthworksFill",IFCEARTHWORKSELEMENT:"IfcEarthworksElement",IFCEARTHWORKSCUT:"IfcEarthworksCut",IFCDISTRIBUTIONBOARDTYPE:"IfcDistributionBoardType",IFCDEEPFOUNDATION:"IfcDeepFoundation",IFCCOURSE:"IfcCourse",IFCCONVEYORSEGMENTTYPE:"IfcConveyorSegmentType",IFCCAISSONFOUNDATIONTYPE:"IfcCaissonFoundationType",IFCBUILTSYSTEM:"IfcBuiltSystem",IFCBUILTELEMENT:"IfcBuiltElement",IFCBRIDGEPART:"IfcBridgePart",IFCBRIDGE:"IfcBridge",IFCBEARINGTYPE:"IfcBearingType",IFCALIGNMENTVERTICAL:"IfcAlignmentVertical",IFCALIGNMENTSEGMENT:"IfcAlignmentSegment",IFCALIGNMENTHORIZONTAL:"IfcAlignmentHorizontal",IFCALIGNMENTCANT:"IfcAlignmentCant",IFCVIBRATIONDAMPERTYPE:"IfcVibrationDamperType",IFCVIBRATIONDAMPER:"IfcVibrationDamper",IFCVEHICLE:"IfcVehicle",IFCTRANSPORTATIONDEVICE:"IfcTransportationDevice",IFCTRACKELEMENTTYPE:"IfcTrackElementType",IFCTENDONCONDUITTYPE:"IfcTendonConduitType",IFCTENDONCONDUIT:"IfcTendonConduit",IFCSINESPIRAL:"IfcSineSpiral",IFCSIGNALTYPE:"IfcSignalType",IFCSIGNTYPE:"IfcSignType",IFCSIGN:"IfcSign",IFCSEVENTHORDERPOLYNOMIALSPIRAL:"IfcSeventhOrderPolynomialSpiral",IFCSEGMENTEDREFERENCECURVE:"IfcSegmentedReferenceCurve",IFCSECONDORDERPOLYNOMIALSPIRAL:"IfcSecondOrderPolynomialSpiral",IFCROADPART:"IfcRoadPart",IFCROAD:"IfcRoad",IFCRELADHERESTOELEMENT:"IfcRelAdheresToElement",IFCREFERENT:"IfcReferent",IFCRAILWAYPART:"IfcRailwayPart",IFCRAILWAY:"IfcRailway",IFCRAILTYPE:"IfcRailType",IFCPOSITIONINGELEMENT:"IfcPositioningElement",IFCPAVEMENTTYPE:"IfcPavementType",IFCNAVIGATIONELEMENTTYPE:"IfcNavigationElementType",IFCMOORINGDEVICETYPE:"IfcMooringDeviceType",IFCMOBILETELECOMMUNICATIONSAPPLIANCETYPE:"IfcMobileTelecommunicationsApplianceType",IFCMARINEPART:"IfcMarinePart",IFCMARINEFACILITY:"IfcMarineFacility",IFCLIQUIDTERMINALTYPE:"IfcLiquidTerminalType",IFCLINEARELEMENT:"IfcLinearElement",IFCKERBTYPE:"IfcKerbType",IFCIMPACTPROTECTIONDEVICETYPE:"IfcImpactProtectionDeviceType",IFCIMPACTPROTECTIONDEVICE:"IfcImpactProtectionDevice",IFCGRADIENTCURVE:"IfcGradientCurve",IFCGEOTECHNICALSTRATUM:"IfcGeotechnicalStratum",IFCGEOTECHNICALELEMENT:"IfcGeotechnicalElement",IFCFACILITYPARTCOMMON:"IfcFacilityPartCommon",IFCFACILITYPART:"IfcFacilityPart",IFCFACILITY:"IfcFacility",IFCDIRECTRIXDERIVEDREFERENCESWEPTAREASOLID:"IfcDirectrixDerivedReferenceSweptAreaSolid",IFCDEEPFOUNDATIONTYPE:"IfcDeepFoundationType",IFCCOURSETYPE:"IfcCourseType",IFCCOSINESPIRAL:"IfcCosineSpiral",IFCCLOTHOID:"IfcClothoid",IFCBUILTELEMENTTYPE:"IfcBuiltElementType",IFCVEHICLETYPE:"IfcVehicleType",IFCTRIANGULATEDIRREGULARNETWORK:"IfcTriangulatedIrregularNetwork",IFCTRANSPORTATIONDEVICETYPE:"IfcTransportationDeviceType",IFCTHIRDORDERPOLYNOMIALSPIRAL:"IfcThirdOrderPolynomialSpiral",IFCSPIRAL:"IfcSpiral",IFCSECTIONEDSURFACE:"IfcSectionedSurface",IFCSECTIONEDSOLIDHORIZONTAL:"IfcSectionedSolidHorizontal",IFCSECTIONEDSOLID:"IfcSectionedSolid",IFCRELPOSITIONS:"IfcRelPositions",IFCRELASSOCIATESPROFILEDEF:"IfcRelAssociatesProfileDef",IFCPOLYNOMIALCURVE:"IfcPolynomialCurve",IFCOFFSETCURVEBYDISTANCES:"IfcOffsetCurveByDistances",IFCOFFSETCURVE:"IfcOffsetCurve",IFCINDEXEDPOLYGONALTEXTUREMAP:"IfcIndexedPolygonalTextureMap",IFCDIRECTRIXCURVESWEPTAREASOLID:"IfcDirectrixCurveSweptAreaSolid",IFCCURVESEGMENT:"IfcCurveSegment",IFCAXIS2PLACEMENTLINEAR:"IfcAxis2PlacementLinear",IFCSEGMENT:"IfcSegment",IFCPOINTBYDISTANCEEXPRESSION:"IfcPointByDistanceExpression",IFCOPENCROSSPROFILEDEF:"IfcOpenCrossProfileDef",IFCLINEARPLACEMENT:"IfcLinearPlacement",IFCALIGNMENTHORIZONTALSEGMENT:"IfcAlignmentHorizontalSegment",IFCALIGNMENTCANTSEGMENT:"IfcAlignmentCantSegment",IFCTEXTURECOORDINATEINDICESWITHVOIDS:"IfcTextureCoordinateIndicesWithVoids",IFCTEXTURECOORDINATEINDICES:"IfcTextureCoordinateIndices",IFCQUANTITYNUMBER:"IfcQuantityNumber",IFCALIGNMENTVERTICALSEGMENT:"IfcAlignmentVerticalSegment",IFCALIGNMENTPARAMETERSEGMENT:"IfcAlignmentParameterSegment",IFCCONTROLLER:"IfcController",IFCALARM:"IfcAlarm",IFCACTUATOR:"IfcActuator",IFCUNITARYCONTROLELEMENT:"IfcUnitaryControlElement",IFCSENSOR:"IfcSensor",IFCPROTECTIVEDEVICETRIPPINGUNIT:"IfcProtectiveDeviceTrippingUnit",IFCFLOWINSTRUMENT:"IfcFlowInstrument",IFCFIRESUPPRESSIONTERMINAL:"IfcFireSuppressionTerminal",IFCFILTER:"IfcFilter",IFCFAN:"IfcFan",IFCELECTRICTIMECONTROL:"IfcElectricTimeControl",IFCELECTRICMOTOR:"IfcElectricMotor",IFCELECTRICGENERATOR:"IfcElectricGenerator",IFCELECTRICFLOWSTORAGEDEVICE:"IfcElectricFlowStorageDevice",IFCELECTRICDISTRIBUTIONBOARD:"IfcElectricDistributionBoard",IFCELECTRICAPPLIANCE:"IfcElectricAppliance",IFCDUCTSILENCER:"IfcDuctSilencer",IFCDUCTSEGMENT:"IfcDuctSegment",IFCDUCTFITTING:"IfcDuctFitting",IFCDISTRIBUTIONCIRCUIT:"IfcDistributionCircuit",IFCDAMPER:"IfcDamper",IFCCOOLINGTOWER:"IfcCoolingTower",IFCCOOLEDBEAM:"IfcCooledBeam",IFCCONDENSER:"IfcCondenser",IFCCOMPRESSOR:"IfcCompressor",IFCCOMMUNICATIONSAPPLIANCE:"IfcCommunicationsAppliance",IFCCOIL:"IfcCoil",IFCCHILLER:"IfcChiller",IFCCABLESEGMENT:"IfcCableSegment",IFCCABLEFITTING:"IfcCableFitting",IFCCABLECARRIERSEGMENT:"IfcCableCarrierSegment",IFCCABLECARRIERFITTING:"IfcCableCarrierFitting",IFCBURNER:"IfcBurner",IFCBOILER:"IfcBoiler",IFCBEAMSTANDARDCASE:"IfcBeamStandardCase",IFCAUDIOVISUALAPPLIANCE:"IfcAudioVisualAppliance",IFCAIRTOAIRHEATRECOVERY:"IfcAirToAirHeatRecovery",IFCAIRTERMINALBOX:"IfcAirTerminalBox",IFCAIRTERMINAL:"IfcAirTerminal",IFCWINDOWSTANDARDCASE:"IfcWindowStandardCase",IFCWASTETERMINAL:"IfcWasteTerminal",IFCWALLELEMENTEDCASE:"IfcWallElementedCase",IFCVALVE:"IfcValve",IFCUNITARYEQUIPMENT:"IfcUnitaryEquipment",IFCUNITARYCONTROLELEMENTTYPE:"IfcUnitaryControlElementType",IFCTUBEBUNDLE:"IfcTubeBundle",IFCTRANSFORMER:"IfcTransformer",IFCTANK:"IfcTank",IFCSWITCHINGDEVICE:"IfcSwitchingDevice",IFCSTRUCTURALLOADCASE:"IfcStructuralLoadCase",IFCSTACKTERMINAL:"IfcStackTerminal",IFCSPACEHEATER:"IfcSpaceHeater",IFCSOLARDEVICE:"IfcSolarDevice",IFCSLABSTANDARDCASE:"IfcSlabStandardCase",IFCSLABELEMENTEDCASE:"IfcSlabElementedCase",IFCSHADINGDEVICE:"IfcShadingDevice",IFCSANITARYTERMINAL:"IfcSanitaryTerminal",IFCREINFORCINGBARTYPE:"IfcReinforcingBarType",IFCRATIONALBSPLINECURVEWITHKNOTS:"IfcRationalBSplineCurveWithKnots",IFCPUMP:"IfcPump",IFCPROTECTIVEDEVICETRIPPINGUNITTYPE:"IfcProtectiveDeviceTrippingUnitType",IFCPROTECTIVEDEVICE:"IfcProtectiveDevice",IFCPLATESTANDARDCASE:"IfcPlateStandardCase",IFCPIPESEGMENT:"IfcPipeSegment",IFCPIPEFITTING:"IfcPipeFitting",IFCOUTLET:"IfcOutlet",IFCOUTERBOUNDARYCURVE:"IfcOuterBoundaryCurve",IFCMOTORCONNECTION:"IfcMotorConnection",IFCMEMBERSTANDARDCASE:"IfcMemberStandardCase",IFCMEDICALDEVICE:"IfcMedicalDevice",IFCLIGHTFIXTURE:"IfcLightFixture",IFCLAMP:"IfcLamp",IFCJUNCTIONBOX:"IfcJunctionBox",IFCINTERCEPTOR:"IfcInterceptor",IFCHUMIDIFIER:"IfcHumidifier",IFCHEATEXCHANGER:"IfcHeatExchanger",IFCFLOWMETER:"IfcFlowMeter",IFCEXTERNALSPATIALELEMENT:"IfcExternalSpatialElement",IFCEVAPORATOR:"IfcEvaporator",IFCEVAPORATIVECOOLER:"IfcEvaporativeCooler",IFCENGINE:"IfcEngine",IFCELECTRICDISTRIBUTIONBOARDTYPE:"IfcElectricDistributionBoardType",IFCDOORSTANDARDCASE:"IfcDoorStandardCase",IFCDISTRIBUTIONSYSTEM:"IfcDistributionSystem",IFCCOMMUNICATIONSAPPLIANCETYPE:"IfcCommunicationsApplianceType",IFCCOLUMNSTANDARDCASE:"IfcColumnStandardCase",IFCCIVILELEMENT:"IfcCivilElement",IFCCHIMNEY:"IfcChimney",IFCCABLEFITTINGTYPE:"IfcCableFittingType",IFCBURNERTYPE:"IfcBurnerType",IFCBUILDINGSYSTEM:"IfcBuildingSystem",IFCBUILDINGELEMENTPARTTYPE:"IfcBuildingElementPartType",IFCBOUNDARYCURVE:"IfcBoundaryCurve",IFCBSPLINECURVEWITHKNOTS:"IfcBSplineCurveWithKnots",IFCAUDIOVISUALAPPLIANCETYPE:"IfcAudioVisualApplianceType",IFCWORKCALENDAR:"IfcWorkCalendar",IFCWINDOWTYPE:"IfcWindowType",IFCVOIDINGFEATURE:"IfcVoidingFeature",IFCVIBRATIONISOLATOR:"IfcVibrationIsolator",IFCTENDONTYPE:"IfcTendonType",IFCTENDONANCHORTYPE:"IfcTendonAnchorType",IFCSYSTEMFURNITUREELEMENT:"IfcSystemFurnitureElement",IFCSURFACEFEATURE:"IfcSurfaceFeature",IFCSTRUCTURALSURFACEACTION:"IfcStructuralSurfaceAction",IFCSTRUCTURALCURVEREACTION:"IfcStructuralCurveReaction",IFCSTRUCTURALCURVEACTION:"IfcStructuralCurveAction",IFCSTAIRTYPE:"IfcStairType",IFCSOLARDEVICETYPE:"IfcSolarDeviceType",IFCSHADINGDEVICETYPE:"IfcShadingDeviceType",IFCSEAMCURVE:"IfcSeamCurve",IFCROOFTYPE:"IfcRoofType",IFCREINFORCINGMESHTYPE:"IfcReinforcingMeshType",IFCREINFORCINGELEMENTTYPE:"IfcReinforcingElementType",IFCRATIONALBSPLINESURFACEWITHKNOTS:"IfcRationalBSplineSurfaceWithKnots",IFCRAMPTYPE:"IfcRampType",IFCPOLYGONALFACESET:"IfcPolygonalFaceSet",IFCPILETYPE:"IfcPileType",IFCOPENINGSTANDARDCASE:"IfcOpeningStandardCase",IFCMEDICALDEVICETYPE:"IfcMedicalDeviceType",IFCINTERSECTIONCURVE:"IfcIntersectionCurve",IFCINTERCEPTORTYPE:"IfcInterceptorType",IFCINDEXEDPOLYCURVE:"IfcIndexedPolyCurve",IFCGEOGRAPHICELEMENT:"IfcGeographicElement",IFCFURNITURE:"IfcFurniture",IFCFOOTINGTYPE:"IfcFootingType",IFCEXTERNALSPATIALSTRUCTUREELEMENT:"IfcExternalSpatialStructureElement",IFCEVENT:"IfcEvent",IFCENGINETYPE:"IfcEngineType",IFCELEMENTASSEMBLYTYPE:"IfcElementAssemblyType",IFCDOORTYPE:"IfcDoorType",IFCCYLINDRICALSURFACE:"IfcCylindricalSurface",IFCCONSTRUCTIONPRODUCTRESOURCETYPE:"IfcConstructionProductResourceType",IFCCONSTRUCTIONMATERIALRESOURCETYPE:"IfcConstructionMaterialResourceType",IFCCONSTRUCTIONEQUIPMENTRESOURCETYPE:"IfcConstructionEquipmentResourceType",IFCCOMPOSITECURVEONSURFACE:"IfcCompositeCurveOnSurface",IFCCOMPLEXPROPERTYTEMPLATE:"IfcComplexPropertyTemplate",IFCCIVILELEMENTTYPE:"IfcCivilElementType",IFCCHIMNEYTYPE:"IfcChimneyType",IFCBSPLINESURFACEWITHKNOTS:"IfcBSplineSurfaceWithKnots",IFCBSPLINESURFACE:"IfcBSplineSurface",IFCADVANCEDBREPWITHVOIDS:"IfcAdvancedBrepWithVoids",IFCADVANCEDBREP:"IfcAdvancedBrep",IFCTRIANGULATEDFACESET:"IfcTriangulatedFaceSet",IFCTOROIDALSURFACE:"IfcToroidalSurface",IFCTESSELLATEDFACESET:"IfcTessellatedFaceSet",IFCTASKTYPE:"IfcTaskType",IFCSURFACECURVE:"IfcSurfaceCurve",IFCSUBCONTRACTRESOURCETYPE:"IfcSubContractResourceType",IFCSTRUCTURALSURFACEREACTION:"IfcStructuralSurfaceReaction",IFCSPHERICALSURFACE:"IfcSphericalSurface",IFCSPATIALZONETYPE:"IfcSpatialZoneType",IFCSPATIALZONE:"IfcSpatialZone",IFCSPATIALELEMENTTYPE:"IfcSpatialElementType",IFCSPATIALELEMENT:"IfcSpatialElement",IFCSIMPLEPROPERTYTEMPLATE:"IfcSimplePropertyTemplate",IFCREVOLVEDAREASOLIDTAPERED:"IfcRevolvedAreaSolidTapered",IFCREPARAMETRISEDCOMPOSITECURVESEGMENT:"IfcReparametrisedCompositeCurveSegment",IFCRELSPACEBOUNDARY2NDLEVEL:"IfcRelSpaceBoundary2ndLevel",IFCRELSPACEBOUNDARY1STLEVEL:"IfcRelSpaceBoundary1stLevel",IFCRELINTERFERESELEMENTS:"IfcRelInterferesElements",IFCRELDEFINESBYTEMPLATE:"IfcRelDefinesByTemplate",IFCRELDEFINESBYOBJECT:"IfcRelDefinesByObject",IFCRELDECLARES:"IfcRelDeclares",IFCRELASSIGNSTOGROUPBYFACTOR:"IfcRelAssignsToGroupByFactor",IFCPROPERTYTEMPLATE:"IfcPropertyTemplate",IFCPROPERTYSETTEMPLATE:"IfcPropertySetTemplate",IFCPROJECTLIBRARY:"IfcProjectLibrary",IFCPROCEDURETYPE:"IfcProcedureType",IFCPREDEFINEDPROPERTYSET:"IfcPredefinedPropertySet",IFCPCURVE:"IfcPCurve",IFCLABORRESOURCETYPE:"IfcLaborResourceType",IFCINDEXEDPOLYGONALFACEWITHVOIDS:"IfcIndexedPolygonalFaceWithVoids",IFCINDEXEDPOLYGONALFACE:"IfcIndexedPolygonalFace",IFCGEOGRAPHICELEMENTTYPE:"IfcGeographicElementType",IFCFIXEDREFERENCESWEPTAREASOLID:"IfcFixedReferenceSweptAreaSolid",IFCEXTRUDEDAREASOLIDTAPERED:"IfcExtrudedAreaSolidTapered",IFCEVENTTYPE:"IfcEventType",IFCCURVEBOUNDEDSURFACE:"IfcCurveBoundedSurface",IFCCREWRESOURCETYPE:"IfcCrewResourceType",IFCCONTEXT:"IfcContext",IFCCONSTRUCTIONRESOURCETYPE:"IfcConstructionResourceType",IFCCARTESIANPOINTLIST3D:"IfcCartesianPointList3D",IFCCARTESIANPOINTLIST2D:"IfcCartesianPointList2D",IFCCARTESIANPOINTLIST:"IfcCartesianPointList",IFCADVANCEDFACE:"IfcAdvancedFace",IFCTYPERESOURCE:"IfcTypeResource",IFCTYPEPROCESS:"IfcTypeProcess",IFCTESSELLATEDITEM:"IfcTessellatedItem",IFCSWEPTDISKSOLIDPOLYGONAL:"IfcSweptDiskSolidPolygonal",IFCRESOURCETIME:"IfcResourceTime",IFCRESOURCECONSTRAINTRELATIONSHIP:"IfcResourceConstraintRelationship",IFCRESOURCEAPPROVALRELATIONSHIP:"IfcResourceApprovalRelationship",IFCQUANTITYSET:"IfcQuantitySet",IFCPROPERTYTEMPLATEDEFINITION:"IfcPropertyTemplateDefinition",IFCPREDEFINEDPROPERTIES:"IfcPredefinedProperties",IFCMIRROREDPROFILEDEF:"IfcMirroredProfileDef",IFCMATERIALRELATIONSHIP:"IfcMaterialRelationship",IFCMATERIALPROFILESETUSAGETAPERING:"IfcMaterialProfileSetUsageTapering",IFCMATERIALPROFILESETUSAGE:"IfcMaterialProfileSetUsage",IFCMATERIALCONSTITUENTSET:"IfcMaterialConstituentSet",IFCMATERIALCONSTITUENT:"IfcMaterialConstituent",IFCLAGTIME:"IfcLagTime",IFCINDEXEDTRIANGLETEXTUREMAP:"IfcIndexedTriangleTextureMap",IFCINDEXEDTEXTUREMAP:"IfcIndexedTextureMap",IFCINDEXEDCOLOURMAP:"IfcIndexedColourMap",IFCEXTERNALREFERENCERELATIONSHIP:"IfcExternalReferenceRelationship",IFCEXTENDEDPROPERTIES:"IfcExtendedProperties",IFCEVENTTIME:"IfcEventTime",IFCCONVERSIONBASEDUNITWITHOFFSET:"IfcConversionBasedUnitWithOffset",IFCCOLOURRGBLIST:"IfcColourRgbList",IFCWORKTIME:"IfcWorkTime",IFCTIMEPERIOD:"IfcTimePeriod",IFCTEXTUREVERTEXLIST:"IfcTextureVertexList",IFCTASKTIMERECURRING:"IfcTaskTimeRecurring",IFCTASKTIME:"IfcTaskTime",IFCTABLECOLUMN:"IfcTableColumn",IFCSURFACEREINFORCEMENTAREA:"IfcSurfaceReinforcementArea",IFCSTRUCTURALLOADORRESULT:"IfcStructuralLoadOrResult",IFCSTRUCTURALLOADCONFIGURATION:"IfcStructuralLoadConfiguration",IFCSCHEDULINGTIME:"IfcSchedulingTime",IFCRESOURCELEVELRELATIONSHIP:"IfcResourceLevelRelationship",IFCREFERENCE:"IfcReference",IFCRECURRENCEPATTERN:"IfcRecurrencePattern",IFCPROPERTYABSTRACTION:"IfcPropertyAbstraction",IFCPROJECTEDCRS:"IfcProjectedCrs",IFCPRESENTATIONITEM:"IfcPresentationItem",IFCMATERIALUSAGEDEFINITION:"IfcMaterialUsageDefinition",IFCMATERIALPROFILEWITHOFFSETS:"IfcMaterialProfileWithOffsets",IFCMATERIALPROFILESET:"IfcMaterialProfileSet",IFCMATERIALPROFILE:"IfcMaterialProfile",IFCMATERIALLAYERWITHOFFSETS:"IfcMaterialLayerWithOffsets",IFCMATERIALDEFINITION:"IfcMaterialDefinition",IFCMAPCONVERSION:"IfcMapConversion",IFCEXTERNALINFORMATION:"IfcExternalInformation",IFCCOORDINATEREFERENCESYSTEM:"IfcCoordinateReferenceSystem",IFCCOORDINATEOPERATION:"IfcCoordinateOperation",IFCCONNECTIONVOLUMEGEOMETRY:"IfcConnectionVolumeGeometry",IFCREINFORCINGBAR:"IfcReinforcingBar",IFCELECTRICDISTRIBUTIONPOINT:"IfcElectricDistributionPoint",IFCDISTRIBUTIONCONTROLELEMENT:"IfcDistributionControlElement",IFCDISTRIBUTIONCHAMBERELEMENT:"IfcDistributionChamberElement",IFCCONTROLLERTYPE:"IfcControllerType",IFCCHAMFEREDGEFEATURE:"IfcChamferEdgeFeature",IFCBEAM:"IfcBeam",IFCALARMTYPE:"IfcAlarmType",IFCACTUATORTYPE:"IfcActuatorType",IFCWINDOW:"IfcWindow",IFCWALLSTANDARDCASE:"IfcWallStandardCase",IFCWALL:"IfcWall",IFCVIBRATIONISOLATORTYPE:"IfcVibrationIsolatorType",IFCTENDONANCHOR:"IfcTendonAnchor",IFCTENDON:"IfcTendon",IFCSTRUCTURALANALYSISMODEL:"IfcStructuralAnalysisModel",IFCSTAIRFLIGHT:"IfcStairFlight",IFCSTAIR:"IfcStair",IFCSLAB:"IfcSlab",IFCSENSORTYPE:"IfcSensorType",IFCROUNDEDEDGEFEATURE:"IfcRoundedEdgeFeature",IFCROOF:"IfcRoof",IFCREINFORCINGMESH:"IfcReinforcingMesh",IFCREINFORCINGELEMENT:"IfcReinforcingElement",IFCRATIONALBEZIERCURVE:"IfcRationalBezierCurve",IFCRAMPFLIGHT:"IfcRampFlight",IFCRAMP:"IfcRamp",IFCRAILING:"IfcRailing",IFCPLATE:"IfcPlate",IFCPILE:"IfcPile",IFCMEMBER:"IfcMember",IFCFOOTING:"IfcFooting",IFCFLOWTREATMENTDEVICE:"IfcFlowTreatmentDevice",IFCFLOWTERMINAL:"IfcFlowTerminal",IFCFLOWSTORAGEDEVICE:"IfcFlowStorageDevice",IFCFLOWSEGMENT:"IfcFlowSegment",IFCFLOWMOVINGDEVICE:"IfcFlowMovingDevice",IFCFLOWINSTRUMENTTYPE:"IfcFlowInstrumentType",IFCFLOWFITTING:"IfcFlowFitting",IFCFLOWCONTROLLER:"IfcFlowController",IFCFIRESUPPRESSIONTERMINALTYPE:"IfcFireSuppressionTerminalType",IFCFILTERTYPE:"IfcFilterType",IFCFANTYPE:"IfcFanType",IFCENERGYCONVERSIONDEVICE:"IfcEnergyConversionDevice",IFCELECTRICALELEMENT:"IfcElectricalElement",IFCELECTRICALCIRCUIT:"IfcElectricalCircuit",IFCELECTRICTIMECONTROLTYPE:"IfcElectricTimeControlType",IFCELECTRICMOTORTYPE:"IfcElectricMotorType",IFCELECTRICHEATERTYPE:"IfcElectricHeaterType",IFCELECTRICGENERATORTYPE:"IfcElectricGeneratorType",IFCELECTRICFLOWSTORAGEDEVICETYPE:"IfcElectricFlowStorageDeviceType",IFCELECTRICAPPLIANCETYPE:"IfcElectricApplianceType",IFCEDGEFEATURE:"IfcEdgeFeature",IFCDUCTSILENCERTYPE:"IfcDuctSilencerType",IFCDUCTSEGMENTTYPE:"IfcDuctSegmentType",IFCDUCTFITTINGTYPE:"IfcDuctFittingType",IFCDOOR:"IfcDoor",IFCDISTRIBUTIONPORT:"IfcDistributionPort",IFCDISTRIBUTIONFLOWELEMENT:"IfcDistributionFlowElement",IFCDISTRIBUTIONELEMENT:"IfcDistributionElement",IFCDISTRIBUTIONCONTROLELEMENTTYPE:"IfcDistributionControlElementType",IFCDISTRIBUTIONCHAMBERELEMENTTYPE:"IfcDistributionChamberElementType",IFCDISCRETEACCESSORYTYPE:"IfcDiscreteAccessoryType",IFCDISCRETEACCESSORY:"IfcDiscreteAccessory",IFCDIAMETERDIMENSION:"IfcDiameterDimension",IFCDAMPERTYPE:"IfcDamperType",IFCCURTAINWALL:"IfcCurtainWall",IFCCOVERING:"IfcCovering",IFCCOOLINGTOWERTYPE:"IfcCoolingTowerType",IFCCOOLEDBEAMTYPE:"IfcCooledBeamType",IFCCONSTRUCTIONPRODUCTRESOURCE:"IfcConstructionProductResource",IFCCONSTRUCTIONMATERIALRESOURCE:"IfcConstructionMaterialResource",IFCCONSTRUCTIONEQUIPMENTRESOURCE:"IfcConstructionEquipmentResource",IFCCONDITIONCRITERION:"IfcConditionCriterion",IFCCONDITION:"IfcCondition",IFCCONDENSERTYPE:"IfcCondenserType",IFCCOMPRESSORTYPE:"IfcCompressorType",IFCCOLUMN:"IfcColumn",IFCCOILTYPE:"IfcCoilType",IFCCIRCLE:"IfcCircle",IFCCHILLERTYPE:"IfcChillerType",IFCCABLESEGMENTTYPE:"IfcCableSegmentType",IFCCABLECARRIERSEGMENTTYPE:"IfcCableCarrierSegmentType",IFCCABLECARRIERFITTINGTYPE:"IfcCableCarrierFittingType",IFCBUILDINGELEMENTPROXYTYPE:"IfcBuildingElementProxyType",IFCBUILDINGELEMENTPROXY:"IfcBuildingElementProxy",IFCBUILDINGELEMENTPART:"IfcBuildingElementPart",IFCBUILDINGELEMENTCOMPONENT:"IfcBuildingElementComponent",IFCBUILDINGELEMENT:"IfcBuildingElement",IFCBOILERTYPE:"IfcBoilerType",IFCBEZIERCURVE:"IfcBezierCurve",IFCBEAMTYPE:"IfcBeamType",IFCBSPLINECURVE:"IfcBSplineCurve",IFCASSET:"IfcAsset",IFCANGULARDIMENSION:"IfcAngularDimension",IFCAIRTOAIRHEATRECOVERYTYPE:"IfcAirToAirHeatRecoveryType",IFCAIRTERMINALTYPE:"IfcAirTerminalType",IFCAIRTERMINALBOXTYPE:"IfcAirTerminalBoxType",IFCACTIONREQUEST:"IfcActionRequest",IFC2DCOMPOSITECURVE:"Ifc2DCompositeCurve",IFCZONE:"IfcZone",IFCWORKSCHEDULE:"IfcWorkSchedule",IFCWORKPLAN:"IfcWorkPlan",IFCWORKCONTROL:"IfcWorkControl",IFCWASTETERMINALTYPE:"IfcWasteTerminalType",IFCWALLTYPE:"IfcWallType",IFCVIRTUALELEMENT:"IfcVirtualElement",IFCVALVETYPE:"IfcValveType",IFCUNITARYEQUIPMENTTYPE:"IfcUnitaryEquipmentType",IFCTUBEBUNDLETYPE:"IfcTubeBundleType",IFCTRIMMEDCURVE:"IfcTrimmedCurve",IFCTRANSPORTELEMENT:"IfcTransportElement",IFCTRANSFORMERTYPE:"IfcTransformerType",IFCTIMESERIESSCHEDULE:"IfcTimeSeriesSchedule",IFCTANKTYPE:"IfcTankType",IFCSYSTEM:"IfcSystem",IFCSWITCHINGDEVICETYPE:"IfcSwitchingDeviceType",IFCSUBCONTRACTRESOURCE:"IfcSubContractResource",IFCSTRUCTURALSURFACECONNECTION:"IfcStructuralSurfaceConnection",IFCSTRUCTURALRESULTGROUP:"IfcStructuralResultGroup",IFCSTRUCTURALPOINTREACTION:"IfcStructuralPointReaction",IFCSTRUCTURALPOINTCONNECTION:"IfcStructuralPointConnection",IFCSTRUCTURALPOINTACTION:"IfcStructuralPointAction",IFCSTRUCTURALPLANARACTIONVARYING:"IfcStructuralPlanarActionVarying",IFCSTRUCTURALPLANARACTION:"IfcStructuralPlanarAction",IFCSTRUCTURALLOADGROUP:"IfcStructuralLoadGroup",IFCSTRUCTURALLINEARACTIONVARYING:"IfcStructuralLinearActionVarying",IFCSTRUCTURALLINEARACTION:"IfcStructuralLinearAction",IFCSTRUCTURALCURVEMEMBERVARYING:"IfcStructuralCurveMemberVarying",IFCSTRUCTURALCURVEMEMBER:"IfcStructuralCurveMember",IFCSTRUCTURALCURVECONNECTION:"IfcStructuralCurveConnection",IFCSTRUCTURALCONNECTION:"IfcStructuralConnection",IFCSTRUCTURALACTION:"IfcStructuralAction",IFCSTAIRFLIGHTTYPE:"IfcStairFlightType",IFCSTACKTERMINALTYPE:"IfcStackTerminalType",IFCSPACETYPE:"IfcSpaceType",IFCSPACEPROGRAM:"IfcSpaceProgram",IFCSPACEHEATERTYPE:"IfcSpaceHeaterType",IFCSPACE:"IfcSpace",IFCSLABTYPE:"IfcSlabType",IFCSITE:"IfcSite",IFCSERVICELIFE:"IfcServiceLife",IFCSCHEDULETIMECONTROL:"IfcScheduleTimeControl",IFCSANITARYTERMINALTYPE:"IfcSanitaryTerminalType",IFCRELASSIGNSTASKS:"IfcRelAssignsTasks",IFCRELAGGREGATES:"IfcRelAggregates",IFCRAMPFLIGHTTYPE:"IfcRampFlightType",IFCRAILINGTYPE:"IfcRailingType",IFCRADIUSDIMENSION:"IfcRadiusDimension",IFCPUMPTYPE:"IfcPumpType",IFCPROTECTIVEDEVICETYPE:"IfcProtectiveDeviceType",IFCPROJECTIONELEMENT:"IfcProjectionElement",IFCPROJECTORDERRECORD:"IfcProjectOrderRecord",IFCPROJECTORDER:"IfcProjectOrder",IFCPROCEDURE:"IfcProcedure",IFCPORT:"IfcPort",IFCPOLYLINE:"IfcPolyline",IFCPLATETYPE:"IfcPlateType",IFCPIPESEGMENTTYPE:"IfcPipeSegmentType",IFCPIPEFITTINGTYPE:"IfcPipeFittingType",IFCPERMIT:"IfcPermit",IFCPERFORMANCEHISTORY:"IfcPerformanceHistory",IFCOUTLETTYPE:"IfcOutletType",IFCORDERACTION:"IfcOrderAction",IFCOPENINGELEMENT:"IfcOpeningElement",IFCOCCUPANT:"IfcOccupant",IFCMOVE:"IfcMove",IFCMOTORCONNECTIONTYPE:"IfcMotorConnectionType",IFCMEMBERTYPE:"IfcMemberType",IFCMECHANICALFASTENERTYPE:"IfcMechanicalFastenerType",IFCMECHANICALFASTENER:"IfcMechanicalFastener",IFCLINEARDIMENSION:"IfcLinearDimension",IFCLIGHTFIXTURETYPE:"IfcLightFixtureType",IFCLAMPTYPE:"IfcLampType",IFCLABORRESOURCE:"IfcLaborResource",IFCJUNCTIONBOXTYPE:"IfcJunctionBoxType",IFCINVENTORY:"IfcInventory",IFCHUMIDIFIERTYPE:"IfcHumidifierType",IFCHEATEXCHANGERTYPE:"IfcHeatExchangerType",IFCGROUP:"IfcGroup",IFCGRID:"IfcGrid",IFCGASTERMINALTYPE:"IfcGasTerminalType",IFCFURNITURESTANDARD:"IfcFurnitureStandard",IFCFURNISHINGELEMENT:"IfcFurnishingElement",IFCFLOWTREATMENTDEVICETYPE:"IfcFlowTreatmentDeviceType",IFCFLOWTERMINALTYPE:"IfcFlowTerminalType",IFCFLOWSTORAGEDEVICETYPE:"IfcFlowStorageDeviceType",IFCFLOWSEGMENTTYPE:"IfcFlowSegmentType",IFCFLOWMOVINGDEVICETYPE:"IfcFlowMovingDeviceType",IFCFLOWMETERTYPE:"IfcFlowMeterType",IFCFLOWFITTINGTYPE:"IfcFlowFittingType",IFCFLOWCONTROLLERTYPE:"IfcFlowControllerType",IFCFEATUREELEMENTSUBTRACTION:"IfcFeatureElementSubtraction",IFCFEATUREELEMENTADDITION:"IfcFeatureElementAddition",IFCFEATUREELEMENT:"IfcFeatureElement",IFCFASTENERTYPE:"IfcFastenerType",IFCFASTENER:"IfcFastener",IFCFACETEDBREPWITHVOIDS:"IfcFacetedBrepWithVoids",IFCFACETEDBREP:"IfcFacetedBrep",IFCEVAPORATORTYPE:"IfcEvaporatorType",IFCEVAPORATIVECOOLERTYPE:"IfcEvaporativeCoolerType",IFCEQUIPMENTSTANDARD:"IfcEquipmentStandard",IFCEQUIPMENTELEMENT:"IfcEquipmentElement",IFCENERGYCONVERSIONDEVICETYPE:"IfcEnergyConversionDeviceType",IFCELLIPSE:"IfcEllipse",IFCELEMENTCOMPONENTTYPE:"IfcElementComponentType",IFCELEMENTCOMPONENT:"IfcElementComponent",IFCELEMENTASSEMBLY:"IfcElementAssembly",IFCELEMENT:"IfcElement",IFCELECTRICALBASEPROPERTIES:"IfcElectricalBaseProperties",IFCDISTRIBUTIONFLOWELEMENTTYPE:"IfcDistributionFlowElementType",IFCDISTRIBUTIONELEMENTTYPE:"IfcDistributionElementType",IFCDIMENSIONCURVEDIRECTEDCALLOUT:"IfcDimensionCurveDirectedCallout",IFCCURTAINWALLTYPE:"IfcCurtainWallType",IFCCREWRESOURCE:"IfcCrewResource",IFCCOVERINGTYPE:"IfcCoveringType",IFCCOSTSCHEDULE:"IfcCostSchedule",IFCCOSTITEM:"IfcCostItem",IFCCONTROL:"IfcControl",IFCCONSTRUCTIONRESOURCE:"IfcConstructionResource",IFCCONIC:"IfcConic",IFCCOMPOSITECURVE:"IfcCompositeCurve",IFCCOLUMNTYPE:"IfcColumnType",IFCCIRCLEHOLLOWPROFILEDEF:"IfcCircleHollowProfileDef",IFCBUILDINGSTOREY:"IfcBuildingStorey",IFCBUILDINGELEMENTTYPE:"IfcBuildingElementType",IFCBUILDING:"IfcBuilding",IFCBOUNDEDCURVE:"IfcBoundedCurve",IFCBOOLEANCLIPPINGRESULT:"IfcBooleanClippingResult",IFCBLOCK:"IfcBlock",IFCASYMMETRICISHAPEPROFILEDEF:"IfcAsymmetricIShapeProfileDef",IFCANNOTATION:"IfcAnnotation",IFCACTOR:"IfcActor",IFCTRANSPORTELEMENTTYPE:"IfcTransportElementType",IFCTASK:"IfcTask",IFCSYSTEMFURNITUREELEMENTTYPE:"IfcSystemFurnitureElementType",IFCSURFACEOFREVOLUTION:"IfcSurfaceOfRevolution",IFCSURFACEOFLINEAREXTRUSION:"IfcSurfaceOfLinearExtrusion",IFCSURFACECURVESWEPTAREASOLID:"IfcSurfaceCurveSweptAreaSolid",IFCSTRUCTUREDDIMENSIONCALLOUT:"IfcStructuredDimensionCallout",IFCSTRUCTURALSURFACEMEMBERVARYING:"IfcStructuralSurfaceMemberVarying",IFCSTRUCTURALSURFACEMEMBER:"IfcStructuralSurfaceMember",IFCSTRUCTURALREACTION:"IfcStructuralReaction",IFCSTRUCTURALMEMBER:"IfcStructuralMember",IFCSTRUCTURALITEM:"IfcStructuralItem",IFCSTRUCTURALACTIVITY:"IfcStructuralActivity",IFCSPHERE:"IfcSphere",IFCSPATIALSTRUCTUREELEMENTTYPE:"IfcSpatialStructureElementType",IFCSPATIALSTRUCTUREELEMENT:"IfcSpatialStructureElement",IFCRIGHTCIRCULARCYLINDER:"IfcRightCircularCylinder",IFCRIGHTCIRCULARCONE:"IfcRightCircularCone",IFCREVOLVEDAREASOLID:"IfcRevolvedAreaSolid",IFCRESOURCE:"IfcResource",IFCRELVOIDSELEMENT:"IfcRelVoidsElement",IFCRELSPACEBOUNDARY:"IfcRelSpaceBoundary",IFCRELSERVICESBUILDINGS:"IfcRelServicesBuildings",IFCRELSEQUENCE:"IfcRelSequence",IFCRELSCHEDULESCOSTITEMS:"IfcRelSchedulesCostItems",IFCRELREFERENCEDINSPATIALSTRUCTURE:"IfcRelReferencedInSpatialStructure",IFCRELPROJECTSELEMENT:"IfcRelProjectsElement",IFCRELOVERRIDESPROPERTIES:"IfcRelOverridesProperties",IFCRELOCCUPIESSPACES:"IfcRelOccupiesSpaces",IFCRELNESTS:"IfcRelNests",IFCRELINTERACTIONREQUIREMENTS:"IfcRelInteractionRequirements",IFCRELFLOWCONTROLELEMENTS:"IfcRelFlowControlElements",IFCRELFILLSELEMENT:"IfcRelFillsElement",IFCRELDEFINESBYTYPE:"IfcRelDefinesByType",IFCRELDEFINESBYPROPERTIES:"IfcRelDefinesByProperties",IFCRELDEFINES:"IfcRelDefines",IFCRELDECOMPOSES:"IfcRelDecomposes",IFCRELCOVERSSPACES:"IfcRelCoversSpaces",IFCRELCOVERSBLDGELEMENTS:"IfcRelCoversBldgElements",IFCRELCONTAINEDINSPATIALSTRUCTURE:"IfcRelContainedInSpatialStructure",IFCRELCONNECTSWITHREALIZINGELEMENTS:"IfcRelConnectsWithRealizingElements",IFCRELCONNECTSWITHECCENTRICITY:"IfcRelConnectsWithEccentricity",IFCRELCONNECTSSTRUCTURALMEMBER:"IfcRelConnectsStructuralMember",IFCRELCONNECTSSTRUCTURALELEMENT:"IfcRelConnectsStructuralElement",IFCRELCONNECTSSTRUCTURALACTIVITY:"IfcRelConnectsStructuralActivity",IFCRELCONNECTSPORTS:"IfcRelConnectsPorts",IFCRELCONNECTSPORTTOELEMENT:"IfcRelConnectsPortToElement",IFCRELCONNECTSPATHELEMENTS:"IfcRelConnectsPathElements",IFCRELCONNECTSELEMENTS:"IfcRelConnectsElements",IFCRELCONNECTS:"IfcRelConnects",IFCRELASSOCIATESPROFILEPROPERTIES:"IfcRelAssociatesProfileProperties",IFCRELASSOCIATESMATERIAL:"IfcRelAssociatesMaterial",IFCRELASSOCIATESLIBRARY:"IfcRelAssociatesLibrary",IFCRELASSOCIATESDOCUMENT:"IfcRelAssociatesDocument",IFCRELASSOCIATESCONSTRAINT:"IfcRelAssociatesConstraint",IFCRELASSOCIATESCLASSIFICATION:"IfcRelAssociatesClassification",IFCRELASSOCIATESAPPROVAL:"IfcRelAssociatesApproval",IFCRELASSOCIATESAPPLIEDVALUE:"IfcRelAssociatesAppliedValue",IFCRELASSOCIATES:"IfcRelAssociates",IFCRELASSIGNSTORESOURCE:"IfcRelAssignsToResource",IFCRELASSIGNSTOPROJECTORDER:"IfcRelAssignsToProjectOrder",IFCRELASSIGNSTOPRODUCT:"IfcRelAssignsToProduct",IFCRELASSIGNSTOPROCESS:"IfcRelAssignsToProcess",IFCRELASSIGNSTOGROUP:"IfcRelAssignsToGroup",IFCRELASSIGNSTOCONTROL:"IfcRelAssignsToControl",IFCRELASSIGNSTOACTOR:"IfcRelAssignsToActor",IFCRELASSIGNS:"IfcRelAssigns",IFCRECTANGULARTRIMMEDSURFACE:"IfcRectangularTrimmedSurface",IFCRECTANGULARPYRAMID:"IfcRectangularPyramid",IFCRECTANGLEHOLLOWPROFILEDEF:"IfcRectangleHollowProfileDef",IFCPROXY:"IfcProxy",IFCPROPERTYSET:"IfcPropertySet",IFCPROJECTIONCURVE:"IfcProjectionCurve",IFCPROJECT:"IfcProject",IFCPRODUCT:"IfcProduct",IFCPROCESS:"IfcProcess",IFCPLANE:"IfcPlane",IFCPLANARBOX:"IfcPlanarBox",IFCPERMEABLECOVERINGPROPERTIES:"IfcPermeableCoveringProperties",IFCOFFSETCURVE3D:"IfcOffsetCurve3D",IFCOFFSETCURVE2D:"IfcOffsetCurve2D",IFCOBJECT:"IfcObject",IFCMANIFOLDSOLIDBREP:"IfcManifoldSolidBrep",IFCLINE:"IfcLine",IFCLSHAPEPROFILEDEF:"IfcLShapeProfileDef",IFCISHAPEPROFILEDEF:"IfcIShapeProfileDef",IFCGEOMETRICCURVESET:"IfcGeometricCurveSet",IFCFURNITURETYPE:"IfcFurnitureType",IFCFURNISHINGELEMENTTYPE:"IfcFurnishingElementType",IFCFLUIDFLOWPROPERTIES:"IfcFluidFlowProperties",IFCFILLAREASTYLETILES:"IfcFillAreaStyleTiles",IFCFILLAREASTYLETILESYMBOLWITHSTYLE:"IfcFillAreaStyleTileSymbolWithStyle",IFCFILLAREASTYLEHATCHING:"IfcFillAreaStyleHatching",IFCFACEBASEDSURFACEMODEL:"IfcFaceBasedSurfaceModel",IFCEXTRUDEDAREASOLID:"IfcExtrudedAreaSolid",IFCENERGYPROPERTIES:"IfcEnergyProperties",IFCELLIPSEPROFILEDEF:"IfcEllipseProfileDef",IFCELEMENTARYSURFACE:"IfcElementarySurface",IFCELEMENTTYPE:"IfcElementType",IFCELEMENTQUANTITY:"IfcElementQuantity",IFCEDGELOOP:"IfcEdgeLoop",IFCDRAUGHTINGPREDEFINEDCURVEFONT:"IfcDraughtingPredefinedCurveFont",IFCDRAUGHTINGPREDEFINEDCOLOUR:"IfcDraughtingPredefinedColour",IFCDRAUGHTINGCALLOUT:"IfcDraughtingCallout",IFCDOORSTYLE:"IfcDoorStyle",IFCDOORPANELPROPERTIES:"IfcDoorPanelProperties",IFCDOORLININGPROPERTIES:"IfcDoorLiningProperties",IFCDIRECTION:"IfcDirection",IFCDIMENSIONCURVETERMINATOR:"IfcDimensionCurveTerminator",IFCDIMENSIONCURVE:"IfcDimensionCurve",IFCDEFINEDSYMBOL:"IfcDefinedSymbol",IFCCURVEBOUNDEDPLANE:"IfcCurveBoundedPlane",IFCCURVE:"IfcCurve",IFCCSGSOLID:"IfcCsgSolid",IFCCSGPRIMITIVE3D:"IfcCsgPrimitive3D",IFCCRANERAILFSHAPEPROFILEDEF:"IfcCraneRailFShapeProfileDef",IFCCRANERAILASHAPEPROFILEDEF:"IfcCraneRailAShapeProfileDef",IFCCOMPOSITECURVESEGMENT:"IfcCompositeCurveSegment",IFCCLOSEDSHELL:"IfcClosedShell",IFCCIRCLEPROFILEDEF:"IfcCircleProfileDef",IFCCARTESIANTRANSFORMATIONOPERATOR3DNONUNIFORM:"IfcCartesianTransformationOperator3DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR3D:"IfcCartesianTransformationOperator3D",IFCCARTESIANTRANSFORMATIONOPERATOR2DNONUNIFORM:"IfcCartesianTransformationOperator2DNonUniform",IFCCARTESIANTRANSFORMATIONOPERATOR2D:"IfcCartesianTransformationOperator2D",IFCCARTESIANTRANSFORMATIONOPERATOR:"IfcCartesianTransformationOperator",IFCCARTESIANPOINT:"IfcCartesianPoint",IFCCSHAPEPROFILEDEF:"IfcCShapeProfileDef",IFCBOXEDHALFSPACE:"IfcBoxedHalfSpace",IFCBOUNDINGBOX:"IfcBoundingBox",IFCBOUNDEDSURFACE:"IfcBoundedSurface",IFCBOOLEANRESULT:"IfcBooleanResult",IFCAXIS2PLACEMENT3D:"IfcAxis2Placement3D",IFCAXIS2PLACEMENT2D:"IfcAxis2Placement2D",IFCAXIS1PLACEMENT:"IfcAxis1Placement",IFCANNOTATIONSURFACE:"IfcAnnotationSurface",IFCANNOTATIONFILLAREAOCCURRENCE:"IfcAnnotationFillAreaOccurrence",IFCANNOTATIONFILLAREA:"IfcAnnotationFillArea",IFCANNOTATIONCURVEOCCURRENCE:"IfcAnnotationCurveOccurrence",IFCZSHAPEPROFILEDEF:"IfcZShapeProfileDef",IFCWINDOWSTYLE:"IfcWindowStyle",IFCWINDOWPANELPROPERTIES:"IfcWindowPanelProperties",IFCWINDOWLININGPROPERTIES:"IfcWindowLiningProperties",IFCVERTEXLOOP:"IfcVertexLoop",IFCVECTOR:"IfcVector",IFCUSHAPEPROFILEDEF:"IfcUShapeProfileDef",IFCTYPEPRODUCT:"IfcTypeProduct",IFCTYPEOBJECT:"IfcTypeObject",IFCTWODIRECTIONREPEATFACTOR:"IfcTwoDirectionRepeatFactor",IFCTRAPEZIUMPROFILEDEF:"IfcTrapeziumProfileDef",IFCTEXTLITERALWITHEXTENT:"IfcTextLiteralWithExtent",IFCTEXTLITERAL:"IfcTextLiteral",IFCTERMINATORSYMBOL:"IfcTerminatorSymbol",IFCTSHAPEPROFILEDEF:"IfcTShapeProfileDef",IFCSWEPTSURFACE:"IfcSweptSurface",IFCSWEPTDISKSOLID:"IfcSweptDiskSolid",IFCSWEPTAREASOLID:"IfcSweptAreaSolid",IFCSURFACESTYLERENDERING:"IfcSurfaceStyleRendering",IFCSURFACE:"IfcSurface",IFCSUBEDGE:"IfcSubedge",IFCSTRUCTURALSTEELPROFILEPROPERTIES:"IfcStructuralSteelProfileProperties",IFCSTRUCTURALPROFILEPROPERTIES:"IfcStructuralProfileProperties",IFCSTRUCTURALLOADSINGLEFORCEWARPING:"IfcStructuralLoadSingleForceWarping",IFCSTRUCTURALLOADSINGLEFORCE:"IfcStructuralLoadSingleForce",IFCSTRUCTURALLOADSINGLEDISPLACEMENTDISTORTION:"IfcStructuralLoadSingleDisplacementDistortion",IFCSTRUCTURALLOADSINGLEDISPLACEMENT:"IfcStructuralLoadSingleDisplacement",IFCSTRUCTURALLOADPLANARFORCE:"IfcStructuralLoadPlanarForce",IFCSTRUCTURALLOADLINEARFORCE:"IfcStructuralLoadLinearForce",IFCSPACETHERMALLOADPROPERTIES:"IfcSpaceThermalLoadProperties",IFCSOUNDVALUE:"IfcSoundValue",IFCSOUNDPROPERTIES:"IfcSoundProperties",IFCSOLIDMODEL:"IfcSolidModel",IFCSLIPPAGECONNECTIONCONDITION:"IfcSlippageConnectionCondition",IFCSHELLBASEDSURFACEMODEL:"IfcShellBasedSurfaceModel",IFCSERVICELIFEFACTOR:"IfcServiceLifeFactor",IFCSECTIONEDSPINE:"IfcSectionedSpine",IFCROUNDEDRECTANGLEPROFILEDEF:"IfcRoundedRectangleProfileDef",IFCRELATIONSHIP:"IfcRelationship",IFCREINFORCEMENTDEFINITIONPROPERTIES:"IfcReinforcementDefinitionProperties",IFCREGULARTIMESERIES:"IfcRegularTimeSeries",IFCRECTANGLEPROFILEDEF:"IfcRectangleProfileDef",IFCPROPERTYTABLEVALUE:"IfcPropertyTableValue",IFCPROPERTYSINGLEVALUE:"IfcPropertySingleValue",IFCPROPERTYSETDEFINITION:"IfcPropertySetDefinition",IFCPROPERTYREFERENCEVALUE:"IfcPropertyReferenceValue",IFCPROPERTYLISTVALUE:"IfcPropertyListValue",IFCPROPERTYENUMERATEDVALUE:"IfcPropertyEnumeratedValue",IFCPROPERTYDEFINITION:"IfcPropertyDefinition",IFCPROPERTYBOUNDEDVALUE:"IfcPropertyBoundedValue",IFCPRODUCTDEFINITIONSHAPE:"IfcProductDefinitionShape",IFCPREDEFINEDPOINTMARKERSYMBOL:"IfcPredefinedPointMarkerSymbol",IFCPREDEFINEDDIMENSIONSYMBOL:"IfcPredefinedDimensionSymbol",IFCPREDEFINEDCURVEFONT:"IfcPredefinedCurveFont",IFCPREDEFINEDCOLOUR:"IfcPredefinedColour",IFCPOLYGONALBOUNDEDHALFSPACE:"IfcPolygonalBoundedHalfSpace",IFCPOLYLOOP:"IfcPolyLoop",IFCPOINTONSURFACE:"IfcPointOnSurface",IFCPOINTONCURVE:"IfcPointOnCurve",IFCPOINT:"IfcPoint",IFCPLANAREXTENT:"IfcPlanarExtent",IFCPLACEMENT:"IfcPlacement",IFCPIXELTEXTURE:"IfcPixelTexture",IFCPHYSICALCOMPLEXQUANTITY:"IfcPhysicalComplexQuantity",IFCPATH:"IfcPath",IFCPARAMETERIZEDPROFILEDEF:"IfcParameterizedProfileDef",IFCORIENTEDEDGE:"IfcOrientedEdge",IFCOPENSHELL:"IfcOpenShell",IFCONEDIRECTIONREPEATFACTOR:"IfcOneDirectionRepeatFactor",IFCOBJECTDEFINITION:"IfcObjectDefinition",IFCMECHANICALCONCRETEMATERIALPROPERTIES:"IfcMechanicalConcreteMaterialProperties",IFCMATERIALDEFINITIONREPRESENTATION:"IfcMaterialDefinitionRepresentation",IFCMAPPEDITEM:"IfcMappedItem",IFCLOOP:"IfcLoop",IFCLOCALPLACEMENT:"IfcLocalPlacement",IFCLIGHTSOURCESPOT:"IfcLightSourceSpot",IFCLIGHTSOURCEPOSITIONAL:"IfcLightSourcePositional",IFCLIGHTSOURCEGONIOMETRIC:"IfcLightSourceGoniometric",IFCLIGHTSOURCEDIRECTIONAL:"IfcLightSourceDirectional",IFCLIGHTSOURCEAMBIENT:"IfcLightSourceAmbient",IFCLIGHTSOURCE:"IfcLightSource",IFCIRREGULARTIMESERIES:"IfcIrregularTimeSeries",IFCIMAGETEXTURE:"IfcImageTexture",IFCHYGROSCOPICMATERIALPROPERTIES:"IfcHygroscopicMaterialProperties",IFCHALFSPACESOLID:"IfcHalfSpaceSolid",IFCGRIDPLACEMENT:"IfcGridPlacement",IFCGEOMETRICSET:"IfcGeometricSet",IFCGEOMETRICREPRESENTATIONSUBCONTEXT:"IfcGeometricRepresentationSubContext",IFCGEOMETRICREPRESENTATIONITEM:"IfcGeometricRepresentationItem",IFCGEOMETRICREPRESENTATIONCONTEXT:"IfcGeometricRepresentationContext",IFCGENERALPROFILEPROPERTIES:"IfcGeneralProfileProperties",IFCGENERALMATERIALPROPERTIES:"IfcGeneralMaterialProperties",IFCFUELPROPERTIES:"IfcFuelProperties",IFCFILLAREASTYLE:"IfcFillAreaStyle",IFCFAILURECONNECTIONCONDITION:"IfcFailureConnectionCondition",IFCFACESURFACE:"IfcFaceSurface",IFCFACEOUTERBOUND:"IfcFaceOuterBound",IFCFACEBOUND:"IfcFaceBound",IFCFACE:"IfcFace",IFCEXTENDEDMATERIALPROPERTIES:"IfcExtendedMaterialProperties",IFCEDGECURVE:"IfcEdgeCurve",IFCEDGE:"IfcEdge",IFCDRAUGHTINGPREDEFINEDTEXTFONT:"IfcDraughtingPredefinedTextFont",IFCDOCUMENTREFERENCE:"IfcDocumentReference",IFCDIMENSIONPAIR:"IfcDimensionPair",IFCDIMENSIONCALLOUTRELATIONSHIP:"IfcDimensionCalloutRelationship",IFCDERIVEDPROFILEDEF:"IfcDerivedProfileDef",IFCCURVESTYLE:"IfcCurveStyle",IFCCONVERSIONBASEDUNIT:"IfcConversionBasedUnit",IFCCONTEXTDEPENDENTUNIT:"IfcContextDependentUnit",IFCCONNECTIONPOINTECCENTRICITY:"IfcConnectionPointEccentricity",IFCCONNECTIONCURVEGEOMETRY:"IfcConnectionCurveGeometry",IFCCONNECTEDFACESET:"IfcConnectedFaceSet",IFCCOMPOSITEPROFILEDEF:"IfcCompositeProfileDef",IFCCOMPLEXPROPERTY:"IfcComplexProperty",IFCCOLOURRGB:"IfcColourRgb",IFCCLASSIFICATIONREFERENCE:"IfcClassificationReference",IFCCENTERLINEPROFILEDEF:"IfcCenterLineProfileDef",IFCBLOBTEXTURE:"IfcBlobTexture",IFCARBITRARYPROFILEDEFWITHVOIDS:"IfcArbitraryProfileDefWithVoids",IFCARBITRARYOPENPROFILEDEF:"IfcArbitraryOpenProfileDef",IFCARBITRARYCLOSEDPROFILEDEF:"IfcArbitraryClosedProfileDef",IFCANNOTATIONTEXTOCCURRENCE:"IfcAnnotationTextOccurrence",IFCANNOTATIONSYMBOLOCCURRENCE:"IfcAnnotationSymbolOccurrence",IFCANNOTATIONSURFACEOCCURRENCE:"IfcAnnotationSurfaceOccurrence",IFCANNOTATIONOCCURRENCE:"IfcAnnotationOccurrence",IFCWATERPROPERTIES:"IfcWaterProperties",IFCVIRTUALGRIDINTERSECTION:"IfcVirtualGridIntersection",IFCVERTEXPOINT:"IfcVertexPoint",IFCVERTEXBASEDTEXTUREMAP:"IfcVertexBasedTextureMap",IFCVERTEX:"IfcVertex",IFCUNITASSIGNMENT:"IfcUnitAssignment",IFCTOPOLOGYREPRESENTATION:"IfcTopologyRepresentation",IFCTOPOLOGICALREPRESENTATIONITEM:"IfcTopologicalRepresentationItem",IFCTIMESERIESVALUE:"IfcTimeSeriesValue",IFCTIMESERIESREFERENCERELATIONSHIP:"IfcTimeSeriesReferenceRelationship",IFCTIMESERIES:"IfcTimeSeries",IFCTHERMALMATERIALPROPERTIES:"IfcThermalMaterialProperties",IFCTEXTUREVERTEX:"IfcTextureVertex",IFCTEXTUREMAP:"IfcTextureMap",IFCTEXTURECOORDINATEGENERATOR:"IfcTextureCoordinateGenerator",IFCTEXTURECOORDINATE:"IfcTextureCoordinate",IFCTEXTSTYLEWITHBOXCHARACTERISTICS:"IfcTextStyleWithBoxCharacteristics",IFCTEXTSTYLETEXTMODEL:"IfcTextStyleTextModel",IFCTEXTSTYLEFORDEFINEDFONT:"IfcTextStyleForDefinedFont",IFCTEXTSTYLEFONTMODEL:"IfcTextStyleFontModel",IFCTEXTSTYLE:"IfcTextStyle",IFCTELECOMADDRESS:"IfcTelecomAddress",IFCTABLEROW:"IfcTableRow",IFCTABLE:"IfcTable",IFCSYMBOLSTYLE:"IfcSymbolStyle",IFCSURFACETEXTURE:"IfcSurfaceTexture",IFCSURFACESTYLEWITHTEXTURES:"IfcSurfaceStyleWithTextures",IFCSURFACESTYLESHADING:"IfcSurfaceStyleShading",IFCSURFACESTYLEREFRACTION:"IfcSurfaceStyleRefraction",IFCSURFACESTYLELIGHTING:"IfcSurfaceStyleLighting",IFCSURFACESTYLE:"IfcSurfaceStyle",IFCSTYLEDREPRESENTATION:"IfcStyledRepresentation",IFCSTYLEDITEM:"IfcStyledItem",IFCSTYLEMODEL:"IfcStyleModel",IFCSTRUCTURALLOADTEMPERATURE:"IfcStructuralLoadTemperature",IFCSTRUCTURALLOADSTATIC:"IfcStructuralLoadStatic",IFCSTRUCTURALLOAD:"IfcStructuralLoad",IFCSTRUCTURALCONNECTIONCONDITION:"IfcStructuralConnectionCondition",IFCSIMPLEPROPERTY:"IfcSimpleProperty",IFCSHAPEREPRESENTATION:"IfcShapeRepresentation",IFCSHAPEMODEL:"IfcShapeModel",IFCSHAPEASPECT:"IfcShapeAspect",IFCSECTIONREINFORCEMENTPROPERTIES:"IfcSectionReinforcementProperties",IFCSECTIONPROPERTIES:"IfcSectionProperties",IFCSIUNIT:"IfcSIUnit",IFCROOT:"IfcRoot",IFCRIBPLATEPROFILEPROPERTIES:"IfcRibPlateProfileProperties",IFCREPRESENTATIONMAP:"IfcRepresentationMap",IFCREPRESENTATIONITEM:"IfcRepresentationItem",IFCREPRESENTATIONCONTEXT:"IfcRepresentationContext",IFCREPRESENTATION:"IfcRepresentation",IFCRELAXATION:"IfcRelaxation",IFCREINFORCEMENTBARPROPERTIES:"IfcReinforcementBarProperties",IFCREFERENCESVALUEDOCUMENT:"IfcReferencesValueDocument",IFCQUANTITYWEIGHT:"IfcQuantityWeight",IFCQUANTITYVOLUME:"IfcQuantityVolume",IFCQUANTITYTIME:"IfcQuantityTime",IFCQUANTITYLENGTH:"IfcQuantityLength",IFCQUANTITYCOUNT:"IfcQuantityCount",IFCQUANTITYAREA:"IfcQuantityArea",IFCPROPERTYENUMERATION:"IfcPropertyEnumeration",IFCPROPERTYDEPENDENCYRELATIONSHIP:"IfcPropertyDependencyRelationship",IFCPROPERTYCONSTRAINTRELATIONSHIP:"IfcPropertyConstraintRelationship",IFCPROPERTY:"IfcProperty",IFCPROFILEPROPERTIES:"IfcProfileProperties",IFCPROFILEDEF:"IfcProfileDef",IFCPRODUCTSOFCOMBUSTIONPROPERTIES:"IfcProductsOfCombustionProperties",IFCPRODUCTREPRESENTATION:"IfcProductRepresentation",IFCPRESENTATIONSTYLEASSIGNMENT:"IfcPresentationStyleAssignment",IFCPRESENTATIONSTYLE:"IfcPresentationStyle",IFCPRESENTATIONLAYERWITHSTYLE:"IfcPresentationLayerWithStyle",IFCPRESENTATIONLAYERASSIGNMENT:"IfcPresentationLayerAssignment",IFCPREDEFINEDTEXTFONT:"IfcPredefinedTextFont",IFCPREDEFINEDTERMINATORSYMBOL:"IfcPredefinedTerminatorSymbol",IFCPREDEFINEDSYMBOL:"IfcPredefinedSymbol",IFCPREDEFINEDITEM:"IfcPredefinedItem",IFCPOSTALADDRESS:"IfcPostalAddress",IFCPHYSICALSIMPLEQUANTITY:"IfcPhysicalSimpleQuantity",IFCPHYSICALQUANTITY:"IfcPhysicalQuantity",IFCPERSONANDORGANIZATION:"IfcPersonAndOrganization",IFCPERSON:"IfcPerson",IFCOWNERHISTORY:"IfcOwnerHistory",IFCORGANIZATIONRELATIONSHIP:"IfcOrganizationRelationship",IFCORGANIZATION:"IfcOrganization",IFCOPTICALMATERIALPROPERTIES:"IfcOpticalMaterialProperties",IFCOBJECTIVE:"IfcObjective",IFCOBJECTPLACEMENT:"IfcObjectPlacement",IFCNAMEDUNIT:"IfcNamedUnit",IFCMONETARYUNIT:"IfcMonetaryUnit",IFCMETRIC:"IfcMetric",IFCMECHANICALSTEELMATERIALPROPERTIES:"IfcMechanicalSteelMaterialProperties",IFCMECHANICALMATERIALPROPERTIES:"IfcMechanicalMaterialProperties",IFCMEASUREWITHUNIT:"IfcMeasureWithUnit",IFCMATERIALPROPERTIES:"IfcMaterialProperties",IFCMATERIALLIST:"IfcMaterialList",IFCMATERIALLAYERSETUSAGE:"IfcMaterialLayerSetUsage",IFCMATERIALLAYERSET:"IfcMaterialLayerSet",IFCMATERIALLAYER:"IfcMaterialLayer",IFCMATERIALCLASSIFICATIONRELATIONSHIP:"IfcMaterialClassificationRelationship",IFCMATERIAL:"IfcMaterial",IFCLOCALTIME:"IfcLocalTime",IFCLIGHTINTENSITYDISTRIBUTION:"IfcLightIntensityDistribution",IFCLIGHTDISTRIBUTIONDATA:"IfcLightDistributionData",IFCLIBRARYREFERENCE:"IfcLibraryReference",IFCLIBRARYINFORMATION:"IfcLibraryInformation",IFCIRREGULARTIMESERIESVALUE:"IfcIrregularTimeSeriesValue",IFCGRIDAXIS:"IfcGridAxis",IFCEXTERNALLYDEFINEDTEXTFONT:"IfcExternallyDefinedTextFont",IFCEXTERNALLYDEFINEDSYMBOL:"IfcExternallyDefinedSymbol",IFCEXTERNALLYDEFINEDSURFACESTYLE:"IfcExternallyDefinedSurfaceStyle",IFCEXTERNALLYDEFINEDHATCHSTYLE:"IfcExternallyDefinedHatchStyle",IFCEXTERNALREFERENCE:"IfcExternalReference",IFCENVIRONMENTALIMPACTVALUE:"IfcEnvironmentalImpactValue",IFCDRAUGHTINGCALLOUTRELATIONSHIP:"IfcDraughtingCalloutRelationship",IFCDOCUMENTINFORMATIONRELATIONSHIP:"IfcDocumentInformationRelationship",IFCDOCUMENTINFORMATION:"IfcDocumentInformation",IFCDOCUMENTELECTRONICFORMAT:"IfcDocumentElectronicFormat",IFCDIMENSIONALEXPONENTS:"IfcDimensionalExponents",IFCDERIVEDUNITELEMENT:"IfcDerivedUnitElement",IFCDERIVEDUNIT:"IfcDerivedUnit",IFCDATEANDTIME:"IfcDateAndTime",IFCCURVESTYLEFONTPATTERN:"IfcCurveStyleFontPattern",IFCCURVESTYLEFONTANDSCALING:"IfcCurveStyleFontAndScaling",IFCCURVESTYLEFONT:"IfcCurveStyleFont",IFCCURRENCYRELATIONSHIP:"IfcCurrencyRelationship",IFCCOSTVALUE:"IfcCostValue",IFCCOORDINATEDUNIVERSALTIMEOFFSET:"IfcCoordinatedUniversalTimeOffset",IFCCONSTRAINTRELATIONSHIP:"IfcConstraintRelationship",IFCCONSTRAINTCLASSIFICATIONRELATIONSHIP:"IfcConstraintClassificationRelationship",IFCCONSTRAINTAGGREGATIONRELATIONSHIP:"IfcConstraintAggregationRelationship",IFCCONSTRAINT:"IfcConstraint",IFCCONNECTIONSURFACEGEOMETRY:"IfcConnectionSurfaceGeometry",IFCCONNECTIONPORTGEOMETRY:"IfcConnectionPortGeometry",IFCCONNECTIONPOINTGEOMETRY:"IfcConnectionPointGeometry",IFCCONNECTIONGEOMETRY:"IfcConnectionGeometry",IFCCOLOURSPECIFICATION:"IfcColourSpecification",IFCCLASSIFICATIONNOTATIONFACET:"IfcClassificationNotationFacet",IFCCLASSIFICATIONNOTATION:"IfcClassificationNotation",IFCCLASSIFICATIONITEMRELATIONSHIP:"IfcClassificationItemRelationship",IFCCLASSIFICATIONITEM:"IfcClassificationItem",IFCCLASSIFICATION:"IfcClassification",IFCCALENDARDATE:"IfcCalendarDate",IFCBOUNDARYNODECONDITIONWARPING:"IfcBoundaryNodeConditionWarping",IFCBOUNDARYNODECONDITION:"IfcBoundaryNodeCondition",IFCBOUNDARYFACECONDITION:"IfcBoundaryFaceCondition",IFCBOUNDARYEDGECONDITION:"IfcBoundaryEdgeCondition",IFCBOUNDARYCONDITION:"IfcBoundaryCondition",IFCAPPROVALRELATIONSHIP:"IfcApprovalRelationship",IFCAPPROVALPROPERTYRELATIONSHIP:"IfcApprovalPropertyRelationship",IFCAPPROVALACTORRELATIONSHIP:"IfcApprovalActorRelationship",IFCAPPROVAL:"IfcApproval",IFCAPPLIEDVALUERELATIONSHIP:"IfcAppliedValueRelationship",IFCAPPLIEDVALUE:"IfcAppliedValue",IFCAPPLICATION:"IfcApplication",IFCADDRESS:"IfcAddress",IFCACTORROLE:"IfcActorRole"};class oo{constructor(){ue(this,"factor",1),ue(this,"complement",1)}apply(e){const t=this.getScaleMatrix().multiply(e);e.copy(t)}setUp(e){var t,i,s;this.factor=1;const n=this.getLengthUnits(e);if(!n)return;const r=null==n,o=void 0===n.Name||null===n.Name;r||o||("FOOT"===n.Name.value&&(this.factor=.3048),"MILLI"===(null==(t=n.Prefix)?void 0:t.value)?this.complement=.001:("CENTI"===(null==(i=n.Prefix)?void 0:i.value)||"DECI"===(null==(s=n.Prefix)?void 0:s.value))&&(this.complement=.01))}getLengthUnits(e){try{const t=e.GetLineIDsWithType(0,he.IFCUNITASSIGNMENT).get(0),i=e.GetLine(0,t);for(const t of i.Units){if(!t||null===t.value||void 0===t.value)continue;const i=e.GetLine(0,t.value);if(i.UnitType&&"LENGTHUNIT"===i.UnitType.value)return i}return null}catch{return console.log("Could not get units"),null}}getScaleMatrix(){const e=this.factor;return(new i.Matrix4).fromArray([e,0,0,0,0,e,0,0,0,0,e,0,0,0,0,1])}}class ao{constructor(){ue(this,"itemsByFloor",{}),ue(this,"_units",new oo)}setUp(e){this._units.setUp(e),this.cleanUp();try{const t=e.GetLineIDsWithType(0,he.IFCRELCONTAINEDINSPATIALSTRUCTURE),i=new Set,s=e.GetLineIDsWithType(0,he.IFCSPACE);for(let e=0;e<s.size();e++)i.add(s.get(e));const n=e.GetLineIDsWithType(0,he.IFCRELAGGREGATES),r=n.size();for(let t=0;t<r;t++){const s=n.get(t),r=e.GetLine(0,s);if(!r||!r.RelatingObject||!r.RelatedObjects)continue;const o=r.RelatingObject.value,a=r.RelatedObjects;for(const e of a){const t=e.value;i.has(t)&&(this.itemsByFloor[t]=o)}}const o={},a=t.size();for(let s=0;s<a;s++){const n=t.get(s),r=e.GetLine(0,n);if(!r||!r.RelatingStructure||!r.RelatedElements)continue;const a=r.RelatingStructure.value,l=r.RelatedElements;if(i.has(a))for(const e of l){o[a]||(o[a]=[]);const t=e.value;o[a].push(t)}else for(const e of l){const t=e.value;this.itemsByFloor[t]=a}}for(const e in o){const t=this.itemsByFloor[e];if(void 0!==t){const i=o[e];for(const e of i)this.itemsByFloor[e]=t}}for(let t=0;t<r;t++){const i=n.get(t),s=e.GetLine(0,i);if(!s||!s.RelatingObject||!s.RelatedObjects)continue;const r=s.RelatingObject.value,o=s.RelatedObjects;for(const e of o){const t=e.value,i=this.itemsByFloor[r];void 0!==i&&(this.itemsByFloor[t]=i)}}}catch{console.log("Could not get floors.")}}cleanUp(){this.itemsByFloor={}}}class lo{constructor(){ue(this,"includeProperties",!0),ue(this,"optionalCategories",[he.IFCSPACE]),ue(this,"wasm",{path:"",absolute:!1,logLevel:he.LogLevel.LOG_LEVEL_OFF}),ue(this,"excludedCategories",new Set),ue(this,"includedCategories",new Set),ue(this,"saveLocations",!1),ue(this,"webIfc",{COORDINATE_TO_ORIGIN:!0}),ue(this,"autoSetWasm",!0),ue(this,"customLocateFileHandler",null)}}class co{constructor(){ue(this,"defLineMat",new i.LineBasicMaterial({color:16777215}))}read(e){const t={IfcAlignment:e.GetAllAlignments(0),IfcCrossSection2D:e.GetAllCrossSections2D(0),IfcCrossSection3D:e.GetAllCrossSections3D(0)};return this.get(t)}get(e){if(e.IfcAlignment){const t=new Map;for(const i of e.IfcAlignment){const e=new oe.Alignment;e.absolute=this.getCurves(i.curve3D,e),e.horizontal=this.getCurves(i.horizontal,e),e.vertical=this.getCurves(i.vertical,e),t.set(t.size,e)}return{alignments:t,coordinationMatrix:new i.Matrix4}}}getCurves(e,t){const s=[];let n=0;for(const r of e){const e={};if(r.data)for(const t of r.data){const[i,s]=t.split(": "),n=parseFloat(s);e[i]=n||s}const{points:o}=r,a=new Float32Array(3*o.length);for(let e=0;e<o.length;e++){const{x:t,y:i,z:s}=o[e];a[3*e]=t,a[3*e+1]=i,a[3*e+2]=s||0}const l=new i.BufferAttribute(a,3),c=new i.EdgesGeometry;c.setAttribute("position",l);const h=new oe.CurveMesh(n,e,t,c,this.defLineMat);s.push(h.curve),n++}return s}}class ho{getNameInfo(e){var t;const i={},{arguments:s}=e.GetHeaderLine(0,he.FILE_NAME)||{};if(!s)return i;const[n,r,o,a,l,c,h]=s;if(null!=n&&n.value&&(i.name=n.value),null!=r&&r.value&&(i.creationDate=new Date(r.value)),o){i.author={};const[e,t]=o;null!=e&&e.value&&(i.author.name=e.value),null!=t&&t.value&&(i.author.email=t.value)}return a&&null!=(t=a[0])&&t.value&&(i.organization=a[0].value),null!=l&&l.value&&(i.preprocessorVersion=null==l?void 0:l.value),null!=c&&c.value&&(i.originatingSystem=null==c?void 0:c.value),null!=h&&h.value&&(i.authorization=null==h?void 0:h.value),i}getDescriptionInfo(e){var t;const i={},{arguments:s}=e.GetHeaderLine(0,he.FILE_DESCRIPTION)||{};if(!s)return i;const[n,r]=s;if(Array.isArray(n)&&null!=(t=n[0])&&t.value){const e=n[0].value.match(/\[([^\]]+)\]/);e&&e[1]&&(i.viewDefinition=e[1])}return null!=r&&r.value&&(i.implementationLevel=r.value),i}}class uo{static get(e,t){const i=[he.IFCPROJECT,he.IFCSITE,he.IFCBUILDING,he.IFCBUILDINGSTOREY,he.IFCSPACE,he.IFCROAD,he.IFCFACILITY,he.IFCFACILITYPART,he.IFCBRIDGE],s=e.data;for(const e of i){const i=t.GetLineIDsWithType(0,e),n=i.size();for(let t=0;t<n;t++){const n=i.get(t);s.has(n)||s.set(n,[[],[0,e]])}}}}const fo=new Set([1123145078,574549367,1675464909,2059837836,3798115385,32440307,3125803723,3207858831,2740243338,2624227202,4240577450,3615266464,3724593414,220341763,477187591,1878645084,1300840506,3303107099,1607154358,1878645084,846575682,1351298697,2417041796,3049322572,3331915920,1416205885,776857604,3285139300,3958052878,2827736869,2732653382,673634403,3448662350,4142052618,2924175390,803316827,2556980723,1809719519,2205249479,807026263,3737207727,1660063152,2347385850,2705031697,3732776249,2485617015,2611217952,1704287377,2937912522,2770003689,1281925730,1484403080,3448662350,4142052618,3800577675,4006246654,3590301190,1383045692,2775532180,2047409740,370225590,3593883385,2665983363,4124623270,812098782,3649129432,987898635,1105321065,3510044353,1635779807,2603310189,3406155212,1310608509,4261334040,2736907675,3649129432,1136057603,1260505505,4182860854,2713105998,2898889636,59481748,3749851601,3486308946,3150382593,1062206242,3264961684,15328376,1485152156,370225590,1981873012,2859738748,45288368,2614616156,2732653382,775493141,2147822146,2601014836,2629017746,1186437898,2367409068,1213902940,3632507154,3900360178,476780140,1472233963,2804161546,3008276851,738692330,374418227,315944413,3905492369,3570813810,2571569899,178912537,2294589976,1437953363,2133299955,572779678,3092502836,388784114,2624227202,1425443689,3057273783,2347385850,1682466193,2519244187,2839578677,3958567839,2513912981,2830218821,427810014,2916149573]),po=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),t.add(e.uuid,this)}async export(e,t,i=!1,s=!0){const n={},r=new Set(e.GetIfcEntityList(t)),o=new Set([he.IFCPROJECT,he.IFCSITE,he.IFCBUILDING,he.IFCBUILDINGSTOREY,he.IFCSPACE]);for(const e of o)r.add(e);for(const a of r){if(fo.has(a))continue;const r=o.has(a)&&s,l=e.GetLineIDsWithType(t,a);for(const t of l)try{const s=e.GetLine(0,t,r,i);n[s.expressID]=s}catch{console.log(`Could not get property ${t}, with recursive ${r} and indirect ${i}.`)}}return n}};ue(po,"uuid","b32c4332-cd67-436e-ba7f-196646c7a635");let mo=po;const Io=class e extends ki{constructor(t){super(t),ue(this,"onDisposed",new Bi),ue(this,"onIfcStartedLoading",new Bi),ue(this,"onSetup",new Bi),ue(this,"settings",new lo),ue(this,"webIfc",new he.IfcAPI),ue(this,"enabled",!0),ue(this,"_material",new i.MeshLambertMaterial),ue(this,"_spatialTree",new ao),ue(this,"_metaData",new ho),ue(this,"_fragmentInstances",new Map),ue(this,"_civil",new co),ue(this,"_visitedFragments",new Map),ue(this,"_materialT",new i.MeshLambertMaterial({transparent:!0,opacity:.5})),this.components.add(e.uuid,this),this.settings.excludedCategories.add(he.IFCOPENINGELEMENT)}dispose(){this.webIfc=null,this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}async setup(e){this.settings={...this.settings,...e},this.settings.autoSetWasm&&await this.autoSetWasm(),this.onSetup.trigger()}async load(e,t=!0,i=""){const s=performance.now();this.onIfcStartedLoading.trigger(),await this.readIfcFile(e);const n=await this.getAllGeometries();n.name=i;const r=await this.components.get(mo).export(this.webIfc,0);n.setLocalProperties(r);const o=this.components.get(wo);o.groups.set(n.uuid,n);for(const e of n.items)o.list.set(e.id,e),e.mesh.uuid=e.id,e.group=n;o.onFragmentsLoaded.trigger(n),t&&o.coordinate([n]);for(const[e]of n.data){const t=r[e];if(!t||!t.GlobalId)continue;const i=t.GlobalId.value||t.GlobalId;n.globalToExpressIDs.set(i,e)}return uo.get(n,this.webIfc),this.cleanUp(),console.log(`Streaming the IFC took ${performance.now()-s} ms!`),n}async readIfcFile(e){const{path:t,absolute:i,logLevel:s}=this.settings.wasm;return this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(this.settings.customLocateFileHandler||void 0),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(e,this.settings.webIfc)}cleanUp(){try{this.webIfc.Dispose()}catch{console.log("Web-ifc wasn't disposed.")}this.webIfc=null,this.webIfc=new he.IfcAPI,this._visitedFragments.clear(),this._fragmentInstances.clear()}async getAllGeometries(){this._spatialTree.setUp(this.webIfc);const e=this.webIfc.GetIfcEntityList(0),t=new oe.FragmentsGroup;t.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};const i=[];for(const s of e){if(!this.webIfc.IsIfcElement(s)&&s!==he.IFCSPACE)continue;const e=this.settings.includedCategories;if(e.size>0&&!e.has(s))continue;if(this.settings.excludedCategories.has(s))continue;const n=this.webIfc.GetLineIDsWithType(0,s),r=n.size();for(let e=0;e<r;e++){const r=n.get(e);i.push(r);const o=this._spatialTree.itemsByFloor[r]||0;t.data.set(r,[[],[o,s]])}}this._spatialTree.cleanUp(),this.webIfc.StreamMeshes(0,i,(e=>{this.getMesh(e,t)}));for(const e of this._visitedFragments){const{index:i,fragment:s}=e[1];t.keyFragments.set(i,s.id)}for(const e of t.items){const t=this._fragmentInstances.get(e.id);if(!t)throw new Error("Fragment not found!");const i=[];for(const[e,s]of t)i.push(s);e.add(i)}const s=this.webIfc.GetCoordinationMatrix(0);return t.coordinationMatrix.fromArray(s),t.civilData=this._civil.read(this.webIfc),t}getMesh(e,t){const s=e.geometries.size(),n=e.expressID;for(let r=0;r<s;r++){const s=e.geometries.get(r),{x:o,y:a,z:l,w:c}=s.color,h=1!==c,{geometryExpressID:d}=s,u=`${d}-${h}`;if(!this._visitedFragments.has(u)){const e=this.getGeometry(this.webIfc,d),i=h?this._materialT:this._material,s=new oe.Fragment(e,i,1);t.add(s.mesh),t.items.push(s);const n=this._visitedFragments.size;this._visitedFragments.set(u,{index:n,fragment:s})}const f=(new i.Color).setRGB(o,a,l,"srgb"),p=new i.Matrix4;p.fromArray(s.flatTransformation);const m=this._visitedFragments.get(u);if(void 0===m)throw new Error("Error getting geometry data for streaming!");const I=t.data.get(n);if(!I)throw new Error("Data not found!");I[0].push(m.index);const{fragment:E}=m;this._fragmentInstances.has(E.id)||this._fragmentInstances.set(E.id,new Map);const g=this._fragmentInstances.get(E.id);if(!g)throw new Error("Instances not found!");if(g.has(n)){const e=g.get(n);if(!e)throw new Error("Instance not found!");e.transforms.push(p),e.colors&&e.colors.push(f)}else g.set(n,{id:n,transforms:[p],colors:[f]})}}getGeometry(e,t){const s=e.GetGeometry(0,t),n=e.GetIndexArray(s.GetIndexData(),s.GetIndexDataSize()),r=e.GetVertexArray(s.GetVertexData(),s.GetVertexDataSize()),o=new Float32Array(r.length/2),a=new Float32Array(r.length/2);for(let e=0;e<r.length;e+=6)o[e/2]=r[e],o[e/2+1]=r[e+1],o[e/2+2]=r[e+2],a[e/2]=r[e+3],a[e/2+1]=r[e+4],a[e/2+2]=r[e+5];const l=new i.BufferGeometry,c=new i.BufferAttribute(o,3),h=new i.BufferAttribute(a,3);return l.setAttribute("position",c),l.setAttribute("normal",h),l.setIndex(Array.from(n)),s.delete(),l}async autoSetWasm(){const e=await fetch(`https://unpkg.com/@thatopen/components@${Ks.release}/package.json`);if(!e.ok)return void console.warn("Couldn't get openbim-components package.json. Set wasm settings manually.");const t=await e.json();if("web-ifc"in t.peerDependencies){const e=t.peerDependencies["web-ifc"];this.settings.wasm.path=`https://unpkg.com/web-ifc@${e}/`,this.settings.wasm.absolute=!0}else console.warn("Couldn't get web-ifc from peer dependencies in openbim-components. Set wasm settings manually.")}};ue(Io,"uuid","a659add7-1418-4771-a0d6-7d4d438e4624");let Eo=Io;const go={IfcRelAssignsToControl:{related:5,relating:7},IfcRelAssignsToGroup:{related:5,relating:7},IfcRelAssignsToProduct:{related:5,relating:7},IfcRelAssociatesClassification:{related:5,relating:6},IfcRelAssociatesMaterial:{related:5,relating:6},IfcRelAssociatesDocument:{related:5,relating:6},IfcRelContainedInSpatialStructure:{related:5,relating:6},IfcRelFlowControlElements:{related:5,relating:6},IfcRelConnectsElements:{related:7,relating:6},IfcRelDeclares:{related:6,relating:5},IfcRelAggregates:{related:6,relating:5},IfcRelNests:{related:6,relating:5},IfcRelDefinesByProperties:{related:5,relating:6},IfcRelDefinesByType:{related:5,relating:6},IfcRelDefinesByTemplate:{related:5,relating:6}},Co={[he.IFCRELASSIGNSTOCONTROL]:"IfcRelAssignsToControl",[he.IFCRELASSIGNSTOGROUP]:"IfcRelAssignsToGroup",[he.IFCRELASSIGNSTOPRODUCT]:"IfcRelAssignsToProduct",[he.IFCRELASSOCIATESCLASSIFICATION]:"IfcRelAssociatesClassification",[he.IFCRELASSOCIATESMATERIAL]:"IfcRelAssociatesMaterial",[he.IFCRELASSOCIATESDOCUMENT]:"IfcRelAssociatesDocument",[he.IFCRELCONTAINEDINSPATIALSTRUCTURE]:"IfcRelContainedInSpatialStructure",[he.IFCRELCONNECTSELEMENTS]:"IfcRelConnectsElements",[he.IFCRELFLOWCONTROLELEMENTS]:"IfcRelFlowControlElements",[he.IFCRELDECLARES]:"IfcRelDeclares",[he.IFCRELAGGREGATES]:"IfcRelAggregates",[he.IFCRELNESTS]:"IfcRelNests",[he.IFCRELDEFINESBYPROPERTIES]:"IfcRelDefinesByProperties",[he.IFCRELDEFINESBYTYPE]:"IfcRelDefinesByType",[he.IFCRELDEFINESBYTEMPLATE]:"IfcRelDefinesByTemplate"},To=class e extends ki{constructor(t){super(t),ue(this,"onDisposed",new Bi),ue(this,"onRequestFile",new Bi),ue(this,"ifcToExport",null),ue(this,"onElementToPset",new Bi),ue(this,"onPropToPset",new Bi),ue(this,"onPsetRemoved",new Bi),ue(this,"onDataChanged",new Bi),ue(this,"wasm",{path:"/",absolute:!1}),ue(this,"enabled",!0),ue(this,"attributeListeners",{}),ue(this,"selectedModel"),ue(this,"changeMap",{}),this.components.add(e.uuid,this)}dispose(){this.selectedModel=void 0,this.attributeListeners={},this.changeMap={},this.onElementToPset.reset(),this.onPropToPset.reset(),this.onPsetRemoved.reset(),this.onDataChanged.reset(),this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}static getIFCSchema(e){const t=e.ifcMetadata.schema;if(!t)throw new Error("IFC Schema not found");return t.startsWith("IFC2X3")?"IFC2X3":t.startsWith("IFC4")&&""===t.replace("IFC4","")?"IFC4":t.startsWith("IFC4X3")?"IFC4X3":t}async setData(e,...t){for(const i of t){const{expressID:t}=i;(!t||-1===t)&&(i.expressID=this.getNewExpressID(e)),await e.setProperties(i.expressID,i),this.registerChange(e,i.expressID)}}async newPset(t,i,s){const n=e.getIFCSchema(t),{handle:r}=await this.getOwnerHistory(t),o=this.newGUID(t),a=new he[n].IfcLabel(i),l=s?new he[n].IfcText(s):null,c=new he[n].IfcPropertySet(o,r,a,l,[]);return c.expressID=this.getNewExpressID(t),await this.setData(t,c),{pset:c}}async removePset(e,...t){for(const i of t){const t=await e.getProperties(i);if((null==t?void 0:t.type)!==he.IFCPROPERTYSET)continue;const s=await no.getPsetRel(e,i);if(s&&(await e.setProperties(s,null),this.registerChange(e,s)),t){for(const i of t.HasProperties)await e.setProperties(i.value,null);await e.setProperties(i,null),this.onPsetRemoved.trigger({model:e,psetID:i}),this.registerChange(e,i)}}}newSingleStringProperty(e,t,i,s){return this.newSingleProperty(e,t,i,s)}newSingleNumericProperty(e,t,i,s){return this.newSingleProperty(e,t,i,s)}newSingleBooleanProperty(e,t,i,s){return this.newSingleProperty(e,t,i,s)}async removePsetProp(e,t,i){const s=await e.getProperties(t),n=await e.getProperties(i);!s||!n||s.type===he.IFCPROPERTYSET&&n&&(s.HasProperties=s.HasProperties.filter((e=>e.value!==i)),await e.setProperties(i,null),this.registerChange(e,t,i))}addElementToPset(e,t,...i){this.components.get(So).addEntitiesRelation(e,t,{type:he.IFCRELDEFINESBYPROPERTIES,inv:"DefinesOcurrence"},...i)}async addPropToPset(e,t,...i){const s=await e.getProperties(t);if(s){for(const n of i){if(s.HasProperties.includes(n))continue;const i=new he.Handle(n);s.HasProperties.push(i),this.onPropToPset.trigger({model:e,psetID:t,propID:n})}this.registerChange(e,t)}}async createIfcRel(t,i,s,n){const r=Co[i];if(!r)throw new Error(`IfcPropertiesManager: ${r} is unsoported.`);const o=e.getIFCSchema(t),a=go[r],l=he[o][r];if(!a||!l)throw new Error(`IfcPropertiesManager: ${r} is unsoported.`);const c=[new he[o].IfcGloballyUniqueId(Is.create())],{related:h,relating:d}=a,u=[...new Set(n)].map((e=>new he.Handle(e))),f=(e,t)=>{for(let i=e;i<t-1;i++)c.push(null)};h<d?(f(1,h),c.push(u),f(h,d),c.push(new he.Handle(s))):(f(1,d),f(d,h),c.push(new he.Handle(s)),c.push(u));const p=new l(...c);return await this.setData(t,p),p}async saveToIfc(e,t){const i=this.components.get(Eo),s=i.webIfc,n=await i.readIfcFile(t);await this.components.get(So).applyRelationChanges();const r=this.changeMap[e.uuid]??[];for(const t of r){const i=await e.getProperties(t);i?s.WriteLine(n,i):s.GetLine(n,t)&&s.DeleteLine(n,t)}const o=s.SaveModel(n);return i.webIfc.CloseModel(n),i.cleanUp(),o}async getEntityRef(e,t){const i=await e.getAllPropertiesOfType(t);if(!i)return null;const s=[];for(const e in i){const t=new he.Handle(Number(e));s.push(t)}return s}async setAttributeListener(e,t,i){this.attributeListeners[e.uuid]||(this.attributeListeners[e.uuid]={});const s=this.attributeListeners[e.uuid][t]?this.attributeListeners[e.uuid][t][i]:null;if(s)return s;const n=await e.getProperties(t);if(!n)throw new Error(`Entity with expressID ${t} doesn't exists.`);const r=n[i];if(Array.isArray(r)||!r)throw new Error(`Attribute ${i} is array or null, and it can't have a listener.`);const o=r.value;if(void 0===o||null==o)throw new Error(`Attribute ${i} has a badly defined handle.`);const a=new Bi;return Object.defineProperty(n[i],"value",{get(){return this._value},async set(e){this._value=e,a.trigger(e)}}),n[i].value=o,this.attributeListeners[e.uuid][t]||(this.attributeListeners[e.uuid][t]={}),this.attributeListeners[e.uuid][t][i]=a,a}getNewExpressID(e){return e.ifcMetadata.maxExpressID++,e.ifcMetadata.maxExpressID}newGUID(t){const i=e.getIFCSchema(t);return new he[i].IfcGloballyUniqueId(Is.create())}async getOwnerHistory(e){const t=await e.getAllPropertiesOfType(he.IFCOWNERHISTORY);if(!t)throw new Error("No OwnerHistory was found.");const i=t[Object.keys(t).map((e=>parseInt(e,10)))[0]];return{entity:i,handle:new he.Handle(i.expressID)}}registerChange(e,...t){this.changeMap[e.uuid]||(this.changeMap[e.uuid]=new Set);for(const i of t)this.changeMap[e.uuid].add(i),this.onDataChanged.trigger({model:e,expressID:i})}async newSingleProperty(t,i,s,n){const r=e.getIFCSchema(t),o=new he[r].IfcIdentifier(s),a=new he[r][i](n),l=new he[r].IfcPropertySingleValue(o,null,a,null);return l.expressID=this.getNewExpressID(t),await this.setData(t,l),l}};ue(To,"uuid","58c2d9f0-183c-48d6-a402-dfcf5b9a34df");let Ro=To;const vo=class e extends ki{constructor(t){super(t),ue(this,"onDisposed",new Bi),ue(this,"onRelationsIndexed",new Bi),ue(this,"relationMaps",{}),ue(this,"enabled",!0),ue(this,"_relToAttributesMap",io),ue(this,"_inverseAttributes",["IsDecomposedBy","Decomposes","AssociatedTo","HasAssociations","ClassificationForObjects","IsGroupedBy","HasAssignments","IsDefinedBy","DefinesOcurrence","IsTypedBy","Types","Defines","ContainedInStructure","ContainsElements","HasControlElements","AssignedToFlowElement","ConnectedTo","ConnectedFrom","ReferencedBy","Declares","HasContext","Controls","IsNestedBy","Nests","DocumentRefForObjects"]),ue(this,"_ifcRels",[he.IFCRELAGGREGATES,he.IFCRELASSOCIATESMATERIAL,he.IFCRELASSOCIATESCLASSIFICATION,he.IFCRELASSIGNSTOGROUP,he.IFCRELDEFINESBYPROPERTIES,he.IFCRELDEFINESBYTYPE,he.IFCRELDEFINESBYTEMPLATE,he.IFCRELCONTAINEDINSPATIALSTRUCTURE,he.IFCRELFLOWCONTROLELEMENTS,he.IFCRELCONNECTSELEMENTS,he.IFCRELASSIGNSTOPRODUCT,he.IFCRELDECLARES,he.IFCRELASSIGNSTOCONTROL,he.IFCRELNESTS,he.IFCRELASSOCIATESDOCUMENT]),ue(this,"onFragmentsDisposed",(e=>{delete this.relationMaps[e.groupID]})),ue(this,"_changeMap",{}),ue(this,"onEntitiesRelated",new Bi),this.components.add(e.uuid,this),t.get(wo).onFragmentsDisposed.add(this.onFragmentsDisposed)}indexRelations(e,t,i,s){const n=Object.keys(t).find((e=>e.startsWith("Relating"))),r=Object.keys(t).find((e=>e.startsWith("Related")));if(!n||!r)return;const o=t[n].value,a=t[r].map((e=>e.value)),l=this.getEntityRelations(e,o,s);for(const e of a)l.push(e);for(const t of a)this.getEntityRelations(e,t,i).push(o)}getAttributeIndex(e){const t=this._inverseAttributes.indexOf(e);if(-1===t)throw new Error(`IfcRelationsIndexer: ${e} is not a valid IFC Inverse Attribute name or its not supported yet by this component.`);return t}setRelationMap(e,t){this.relationMaps[e.uuid]=t,this.onRelationsIndexed.trigger({modelID:e.uuid,relationsMap:t})}async process(e,t){if(!e.hasProperties)throw new Error("FragmentsGroup properties not found");let i=this.relationMaps[e.uuid];i||(i=new Map,this.relationMaps[e.uuid]=i);const s=e.getLocalProperties();if(!s)return i;const n=(null==t?void 0:t.relationsToProcess)??this._ifcRels;for(const[e,t]of Object.entries(s)){if(!n.includes(t.type))continue;const e=this._relToAttributesMap.get(t.type);if(!e)continue;const{forRelated:s,forRelating:r}=e;this.indexRelations(i,t,s,r)}return this.setRelationMap(e,i),i}async processFromWebIfc(e,t){const i=new Map;for(const s of this._ifcRels){const n=this._relToAttributesMap.get(s);if(!n)continue;const{forRelated:r,forRelating:o}=n,a=e.GetLineIDsWithType(t,s);for(let s=0;s<a.size();s++){const n=await e.properties.getItemProperties(t,a.get(s));this.indexRelations(i,n,r,o)}}return this.onRelationsIndexed.trigger({modelID:t.toString(),relationsMap:i}),i}getEntityRelations(e,t,i){const s=this.getAttributeIndex(i);let n;if(n=e instanceof ae?this.relationMaps[e.uuid]:"string"==typeof e?this.relationMaps[e]:e,!n&&(e instanceof ae||"string"==typeof e)){n=new Map;const t=e instanceof ae?e.uuid:e;this.relationMaps[t]=n}let r=n.get(t);r||(r=new Map,n.set(t,r));let o=r.get(s);return o||(o=[],r.set(s,o)),o}serializeRelations(e){const t={};for(const[i,s]of e.entries()){t[i]||(t[i]={});for(const[e,n]of s.entries())t[i][e]=n}return JSON.stringify(t)}serializeModelRelations(e){const t=this.relationMaps[e.uuid];return t?this.serializeRelations(t):null}serializeAllRelations(){const e={};for(const t in this.relationMaps){const i=this.relationMaps[t],s={};for(const[e,t]of i.entries()){s[e]||(s[e]={});for(const[i,n]of t.entries())s[e][i]=n}e[t]=s}return JSON.stringify(e)}getRelationsMapFromJSON(e){const t=JSON.parse(e),i=new Map;for(const e in t){const s=t[e],n=new Map;for(const e in s)n.set(Number(e),s[e]);i.set(Number(e),n)}return i}dispose(){this.relationMaps={},this.components.get(wo).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}getEntitiesWithRelation(e,t,i){const s=this.relationMaps[e.uuid];if(!s)throw new Error("IfcRelationsIndexer: the model relations are not indexed!");const n=new Set;for(const[e,r]of s){const s=this.getAttributeIndex(t),o=r.get(s);o&&o.includes(i)&&n.add(e)}return n}addEntityRelations(e,t,i,...s){const n=this.getEntityRelations(e,t,i);if(n)n.push(...s);else{const n=this.getAttributeIndex(i),r=this.relationMaps[e.uuid].get(t);null==r||r.set(n,s)}}async applyRelationChanges(){const e=this.components.get(wo),t=this.components.get(Ro);for(const i in this._changeMap){const s=e.groups.get(i);if(!s)continue;const n=this._changeMap[i];for(const[e,i]of n)for(const[n,r]of i){const{related:i,relID:o}=r;if(o){const e=await s.getProperties(o);if(!e)continue;const r=Object.keys(e),a=r.find((e=>e.startsWith("Related"))),l=r.find((e=>e.startsWith("Relating")));if(!a||!l)continue;e[a]=[...i].map((e=>new he.Handle(e))),e[l]=new he.Handle(n),await t.setData(s,e)}else{const o=await t.createIfcRel(s,e,n,[...i]);if(!o)continue;r.relID=o.expressID}}}}addEntitiesRelation(e,t,i,...s){const{type:n,inv:r}=i;let o=this.relationMaps[e.uuid];if(o||(o=new Map,this.relationMaps[e.uuid]=o),!this._ifcRels.includes(n))return;const a=io.get(n);if(!a)return;const{forRelated:l,forRelating:c}=a;if(l!==r&&c!==r)return;let h=this._changeMap[e.uuid];h||(h=new ji,this._changeMap[e.uuid]=h);const d=c===r?[t]:s,u=l===r?[t]:s;let f=h.get(n);f||(f=new ji,f.onItemSet.add((()=>this.onEntitiesRelated.trigger({invAttribute:r,relType:n,relatingIDs:d,relatedIDs:u}))),f.onItemUpdated.add((()=>this.onEntitiesRelated.trigger({invAttribute:r,relType:n,relatingIDs:d,relatedIDs:u}))),h.set(n,f));for(const e of d){let t=f.get(e);t||(t={related:new Zi},f.set(e,t)),t.related.add(...u)}for(const t of d)this.getEntityRelations(e,t,c).push(...u);for(const t of u)this.getEntityRelations(e,t,l).push(...d)}getEntityChildren(e,t,i=new Set){if(i.add(t),void 0===this.relationMaps[e.uuid])throw new Error("The provided model has no indices. You have to generate them first.");const s=this.getEntityRelations(e,t,"IsDecomposedBy");if(s)for(const t of s)this.getEntityChildren(e,t,i);const n=this.getEntityRelations(e,t,"ContainsElements");if(n)for(const t of n)this.getEntityChildren(e,t,i);return i}};ue(vo,"uuid","23a889ab-83b3-44a4-8bee-ead83438370b");let So=vo;const yo=class e extends ki{constructor(t){super(t),ue(this,"onDisposed",new Bi),ue(this,"onFragmentsLoaded",new Bi),ue(this,"onFragmentsDisposed",new Bi),ue(this,"list",new ji),ue(this,"groups",new ji),ue(this,"baseCoordinationModel",""),ue(this,"baseCoordinationMatrix",new i.Matrix4),ue(this,"enabled",!0),ue(this,"_loader",new le),this.components.add(e.uuid,this)}get meshes(){const e=[];for(const[t,i]of this.list)e.push(i.mesh);return e}dispose(){for(const[e,t]of this.groups)t.dispose(!0);this.baseCoordinationModel="",this.groups.clear(),this.list.clear(),this.onFragmentsLoaded.reset(),this.onFragmentsDisposed.reset(),this.onDisposed.trigger(),this.onDisposed.reset()}disposeGroup(e){const{uuid:t}=e,s=[];for(const t of e.items)s.push(t.id),this.list.delete(t.id);e.dispose(!0),this.groups.delete(e.uuid),0===this.groups.size&&(this.baseCoordinationModel="",this.baseCoordinationMatrix=new i.Matrix4),this.onFragmentsDisposed.trigger({groupID:t,fragmentIDs:s})}load(e,t){const i={coordinate:!0,...t},{coordinate:s,name:n,properties:r,relationsMap:o}=i,a=this._loader.import(e);t&&(a.isStreamed=t.isStreamed||!1),n&&(a.name=n);for(const e of a.items)e.group=a,this.list.set(e.id,e);return s&&this.coordinate([a]),this.groups.set(a.uuid,a),r&&a.setLocalProperties(r),o&&this.components.get(So).setRelationMap(a,o),this.onFragmentsLoaded.trigger(a),a}export(e){return this._loader.export(e)}getModelIdMap(e){const t={};for(const i in e){const s=this.list.get(i);if(!s||!s.group)continue;const n=s.group;n.uuid in t||(t[n.uuid]=new Set);const r=e[i];for(const e of r)t[n.uuid].add(e)}return t}modelIdToFragmentIdMap(e){let t={};for(const i in e){const s=this.groups.get(i);if(!s)continue;const n=e[i],r=s.getFragmentMap(n);t={...t,...r}}return t}guidToFragmentIdMap(e){const t={};for(const[i,s]of this.groups){i in t||(t[i]=new Set);for(const n of e){const e=s.globalToExpressIDs.get(n);e&&t[i].add(e)}}return this.modelIdToFragmentIdMap(t)}fragmentIdMapToGuids(e){const t=[],i=this.getModelIdMap(e);for(const e in i){const s=this.groups.get(e);if(!s)continue;const n=i[e];for(const e of n)for(const[i,n]of s.globalToExpressIDs.entries())if(n===e){t.push(i);break}}return t}coordinate(e=Array.from(this.groups.values())){if(0===this.baseCoordinationModel.length){const t=e.pop();if(!t)return;this.baseCoordinationModel=t.uuid,this.baseCoordinationMatrix=t.coordinationMatrix.clone()}if(e.length)for(const t of e)t.coordinationMatrix.equals(this.baseCoordinationMatrix)||(t.position.set(0,0,0),t.rotation.set(0,0,0),t.scale.set(1,1,1),t.updateMatrix(),this.applyBaseCoordinateSystem(t,t.coordinationMatrix))}applyBaseCoordinateSystem(e,t){t&&e.applyMatrix4(t.clone().invert()),e.applyMatrix4(this.baseCoordinationMatrix)}clone(e,t){const i=e.cloneGroup(t);this.groups.set(i.uuid,i);for(const e of i.items)this.list.set(e.id,e);return i}};ue(yo,"uuid","fef46874-46a3-461b-8c44-2922ab77c806");let wo=yo;function Ao(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Fo={exports:{}};
/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/const Oo=Cs(Fo.exports=function e(t,i,s){function n(o,a){if(!i[o]){if(!t[o]){if(!a&&Ao)return Ao(o);if(r)return r(o,!0);var l=new Error("Cannot find module '"+o+"'");throw l.code="MODULE_NOT_FOUND",l}var c=i[o]={exports:{}};t[o][0].call(c.exports,(function(e){return n(t[o][1][e]||e)}),c,c.exports,e,t,i,s)}return i[o].exports}for(var r=Ao,o=0;o<s.length;o++)n(s[o]);return n}({1:[function(e,t,i){var s=e("./utils"),n=e("./support"),r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";i.encode=function(e){for(var t,i,n,o,a,l,c,h=[],d=0,u=e.length,f=u,p="string"!==s.getTypeOf(e);d<e.length;)f=u-d,n=p?(t=e[d++],i=d<u?e[d++]:0,d<u?e[d++]:0):(t=e.charCodeAt(d++),i=d<u?e.charCodeAt(d++):0,d<u?e.charCodeAt(d++):0),o=t>>2,a=(3&t)<<4|i>>4,l=1<f?(15&i)<<2|n>>6:64,c=2<f?63&n:64,h.push(r.charAt(o)+r.charAt(a)+r.charAt(l)+r.charAt(c));return h.join("")},i.decode=function(e){var t,i,s,o,a,l,c=0,h=0,d="data:";if(e.substr(0,d.length)===d)throw new Error("Invalid base64 input, it looks like a data url.");var u,f=3*(e=e.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(e.charAt(e.length-1)===r.charAt(64)&&f--,e.charAt(e.length-2)===r.charAt(64)&&f--,f%1!=0)throw new Error("Invalid base64 input, bad content length.");for(u=n.uint8array?new Uint8Array(0|f):new Array(0|f);c<e.length;)t=r.indexOf(e.charAt(c++))<<2|(o=r.indexOf(e.charAt(c++)))>>4,i=(15&o)<<4|(a=r.indexOf(e.charAt(c++)))>>2,s=(3&a)<<6|(l=r.indexOf(e.charAt(c++))),u[h++]=t,64!==a&&(u[h++]=i),64!==l&&(u[h++]=s);return u}},{"./support":30,"./utils":32}],2:[function(e,t,i){var s=e("./external"),n=e("./stream/DataWorker"),r=e("./stream/Crc32Probe"),o=e("./stream/DataLengthProbe");function a(e,t,i,s,n){this.compressedSize=e,this.uncompressedSize=t,this.crc32=i,this.compression=s,this.compressedContent=n}a.prototype={getContentWorker:function(){var e=new n(s.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new o("data_length")),t=this;return e.on("end",(function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")})),e},getCompressedWorker:function(){return new n(s.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},a.createWorkerFrom=function(e,t,i){return e.pipe(new r).pipe(new o("uncompressedSize")).pipe(t.compressWorker(i)).pipe(new o("compressedSize")).withStreamInfo("compression",t)},t.exports=a},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(e,t,i){var s=e("./stream/GenericWorker");i.STORE={magic:"\0\0",compressWorker:function(){return new s("STORE compression")},uncompressWorker:function(){return new s("STORE decompression")}},i.DEFLATE=e("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(e,t,i){var s=e("./utils"),n=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t){return void 0!==e&&e.length?"string"!==s.getTypeOf(e)?function(e,t,i,s){var r=n,o=s+i;e^=-1;for(var a=s;a<o;a++)e=e>>>8^r[255&(e^t[a])];return~e}(0|t,e,e.length,0):function(e,t,i,s){var r=n,o=s+i;e^=-1;for(var a=s;a<o;a++)e=e>>>8^r[255&(e^t.charCodeAt(a))];return~e}(0|t,e,e.length,0):0}},{"./utils":32}],5:[function(e,t,i){i.base64=!1,i.binary=!1,i.dir=!1,i.createFolders=!0,i.date=null,i.compression=null,i.compressionOptions=null,i.comment=null,i.unixPermissions=null,i.dosPermissions=null},{}],6:[function(e,t,i){var s=null;s=typeof Promise<"u"?Promise:e("lie"),t.exports={Promise:s}},{lie:37}],7:[function(e,t,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",n=e("pako"),r=e("./utils"),o=e("./stream/GenericWorker"),a=s?"uint8array":"array";function l(e,t){o.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}i.magic="\b\0",r.inherits(l,o),l.prototype.processChunk=function(e){this.meta=e.meta,null===this._pako&&this._createPako(),this._pako.push(r.transformTo(a,e.data),!1)},l.prototype.flush=function(){o.prototype.flush.call(this),null===this._pako&&this._createPako(),this._pako.push([],!0)},l.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this._pako=null},l.prototype._createPako=function(){this._pako=new n[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}},i.compressWorker=function(e){return new l("Deflate",e)},i.uncompressWorker=function(){return new l("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(e,t,i){function s(e,t){var i,s="";for(i=0;i<t;i++)s+=String.fromCharCode(255&e),e>>>=8;return s}function n(e,t,i,n,o,h){var d,u,f=e.file,p=e.compression,m=h!==a.utf8encode,I=r.transformTo("string",h(f.name)),E=r.transformTo("string",a.utf8encode(f.name)),g=f.comment,C=r.transformTo("string",h(g)),T=r.transformTo("string",a.utf8encode(g)),R=E.length!==f.name.length,v=T.length!==g.length,S="",y="",w="",A=f.dir,F=f.date,O={crc32:0,compressedSize:0,uncompressedSize:0};t&&!i||(O.crc32=e.crc32,O.compressedSize=e.compressedSize,O.uncompressedSize=e.uncompressedSize);var N=0;t&&(N|=8),m||!R&&!v||(N|=2048);var P,x,L,b=0,M=0;A&&(b|=16),"UNIX"===o?(M=798,b|=(P=f.unixPermissions,x=A,L=P,P||(L=x?16893:33204),(65535&L)<<16)):(M=20,b|=function(e){return 63&(e||0)}(f.dosPermissions)),d=F.getUTCHours(),d<<=6,d|=F.getUTCMinutes(),d<<=5,d|=F.getUTCSeconds()/2,u=F.getUTCFullYear()-1980,u<<=4,u|=F.getUTCMonth()+1,u<<=5,u|=F.getUTCDate(),R&&(y=s(1,1)+s(l(I),4)+E,S+="up"+s(y.length,2)+y),v&&(w=s(1,1)+s(l(C),4)+T,S+="uc"+s(w.length,2)+w);var D="";return D+="\n\0",D+=s(N,2),D+=p.magic,D+=s(d,2),D+=s(u,2),D+=s(O.crc32,4),D+=s(O.compressedSize,4),D+=s(O.uncompressedSize,4),D+=s(I.length,2),D+=s(S.length,2),{fileRecord:c.LOCAL_FILE_HEADER+D+I+S,dirRecord:c.CENTRAL_FILE_HEADER+s(M,2)+D+s(C.length,2)+"\0\0\0\0"+s(b,4)+s(n,4)+I+S+C}}var r=e("../utils"),o=e("../stream/GenericWorker"),a=e("../utf8"),l=e("../crc32"),c=e("../signature");function h(e,t,i,s){o.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=i,this.encodeFileName=s,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}r.inherits(h,o),h.prototype.push=function(e){var t=e.meta.percent||0,i=this.entriesCount,s=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,o.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:i?(t+100*(i-s-1))/i:100}}))},h.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var i=n(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:i.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(e){this.accumulate=!1;var t,i=this.streamFiles&&!e.file.dir,r=n(e,i,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),i)this.push({data:(t=e,c.DATA_DESCRIPTOR+s(t.crc32,4)+s(t.compressedSize,4)+s(t.uncompressedSize,4)),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var i,n,o,a,l,h,d=this.bytesWritten-e,u=(i=this.dirRecords.length,n=d,o=e,a=this.zipComment,l=this.encodeFileName,h=r.transformTo("string",l(a)),c.CENTRAL_DIRECTORY_END+"\0\0\0\0"+s(i,2)+s(i,2)+s(n,4)+s(o,4)+s(h.length,2)+h);this.push({data:u,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()})),e.on("error",(function(e){t.error(e)})),this},h.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(e){var t=this._sources;if(!o.prototype.error.call(this,e))return!1;for(var i=0;i<t.length;i++)try{t[i].error(e)}catch{}return!0},h.prototype.lock=function(){o.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()},t.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(e,t,i){var s=e("../compressions"),n=e("./ZipFileWorker");i.generateWorker=function(e,t,i){var r=new n(t.streamFiles,i,t.platform,t.encodeFileName),o=0;try{e.forEach((function(e,i){o++;var n=function(e,t){var i=e||t,n=s[i];if(!n)throw new Error(i+" is not a valid compression method !");return n}(i.options.compression,t.compression),a=i.options.compressionOptions||t.compressionOptions||{},l=i.dir,c=i.date;i._compressWorker(n,a).withStreamInfo("file",{name:e,dir:l,date:c,comment:i.comment||"",unixPermissions:i.unixPermissions,dosPermissions:i.dosPermissions}).pipe(r)})),r.entriesCount=o}catch(e){r.error(e)}return r}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(e,t,i){function s(){if(!(this instanceof s))return new s;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var e=new s;for(var t in this)"function"!=typeof this[t]&&(e[t]=this[t]);return e}}(s.prototype=e("./object")).loadAsync=e("./load"),s.support=e("./support"),s.defaults=e("./defaults"),s.version="3.10.1",s.loadAsync=function(e,t){return(new s).loadAsync(e,t)},s.external=e("./external"),t.exports=s},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(e,t,i){var s=e("./utils"),n=e("./external"),r=e("./utf8"),o=e("./zipEntries"),a=e("./stream/Crc32Probe"),l=e("./nodejsUtils");function c(e){return new n.Promise((function(t,i){var s=e.decompressed.getContentWorker().pipe(new a);s.on("error",(function(e){i(e)})).on("end",(function(){s.streamInfo.crc32!==e.decompressed.crc32?i(new Error("Corrupted zip : CRC32 mismatch")):t()})).resume()}))}t.exports=function(e,t){var i=this;return t=s.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:r.utf8decode}),l.isNode&&l.isStream(e)?n.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):s.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then((function(e){var i=new o(t);return i.load(e),i})).then((function(e){var i=[n.Promise.resolve(e)],s=e.files;if(t.checkCRC32)for(var r=0;r<s.length;r++)i.push(c(s[r]));return n.Promise.all(i)})).then((function(e){for(var n=e.shift(),r=n.files,o=0;o<r.length;o++){var a=r[o],l=a.fileNameStr,c=s.resolve(a.fileNameStr);i.file(c,a.decompressed,{binary:!0,optimizedBinaryString:!0,date:a.date,dir:a.dir,comment:a.fileCommentStr.length?a.fileCommentStr:null,unixPermissions:a.unixPermissions,dosPermissions:a.dosPermissions,createFolders:t.createFolders}),a.dir||(i.file(c).unsafeOriginalName=l)}return n.zipComment.length&&(i.comment=n.zipComment),i}))}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(e,t,i){var s=e("../utils"),n=e("../stream/GenericWorker");function r(e,t){n.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}s.inherits(r,n),r.prototype._bindStream=function(e){var t=this;(this._stream=e).pause(),e.on("data",(function(e){t.push({data:e,meta:{percent:0}})})).on("error",(function(e){t.isPaused?this.generatedError=e:t.error(e)})).on("end",(function(){t.isPaused?t._upstreamEnded=!0:t.end()}))},r.prototype.pause=function(){return!!n.prototype.pause.call(this)&&(this._stream.pause(),!0)},r.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},t.exports=r},{"../stream/GenericWorker":28,"../utils":32}],13:[function(e,t,i){var s=e("readable-stream").Readable;function n(e,t,i){s.call(this,t),this._helper=e;var n=this;e.on("data",(function(e,t){n.push(e)||n._helper.pause(),i&&i(t)})).on("error",(function(e){n.emit("error",e)})).on("end",(function(){n.push(null)}))}e("../utils").inherits(n,s),n.prototype._read=function(){this._helper.resume()},t.exports=n},{"../utils":32,"readable-stream":16}],14:[function(e,t,i){t.exports={isNode:typeof Buffer<"u",newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if("number"==typeof e)throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&"function"==typeof e.on&&"function"==typeof e.pause&&"function"==typeof e.resume}}},{}],15:[function(e,t,i){function s(e,t,i){var s,n=r.getTypeOf(t),a=r.extend(i||{},l);a.date=a.date||new Date,null!==a.compression&&(a.compression=a.compression.toUpperCase()),"string"==typeof a.unixPermissions&&(a.unixPermissions=parseInt(a.unixPermissions,8)),a.unixPermissions&&16384&a.unixPermissions&&(a.dir=!0),a.dosPermissions&&16&a.dosPermissions&&(a.dir=!0),a.dir&&(e=m(e)),a.createFolders&&(s=p(e))&&I.call(this,s,!0);var d="string"===n&&!1===a.binary&&!1===a.base64;i&&void 0!==i.binary||(a.binary=!d),(t instanceof c&&0===t.uncompressedSize||a.dir||!t||0===t.length)&&(a.base64=!1,a.binary=!0,t="",a.compression="STORE",n="string");var E=null;E=t instanceof c||t instanceof o?t:u.isNode&&u.isStream(t)?new f(e,t):r.prepareContent(e,t,a.binary,a.optimizedBinaryString,a.base64);var g=new h(e,E,a);this.files[e]=g}var n=e("./utf8"),r=e("./utils"),o=e("./stream/GenericWorker"),a=e("./stream/StreamHelper"),l=e("./defaults"),c=e("./compressedObject"),h=e("./zipObject"),d=e("./generate"),u=e("./nodejsUtils"),f=e("./nodejs/NodejsStreamInputAdapter"),p=function(e){"/"===e.slice(-1)&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return 0<t?e.substring(0,t):""},m=function(e){return"/"!==e.slice(-1)&&(e+="/"),e},I=function(e,t){return t=void 0!==t?t:l.createFolders,e=m(e),this.files[e]||s.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function E(e){return"[object RegExp]"===Object.prototype.toString.call(e)}var g={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,i,s;for(t in this.files)s=this.files[t],(i=t.slice(this.root.length,t.length))&&t.slice(0,this.root.length)===this.root&&e(i,s)},filter:function(e){var t=[];return this.forEach((function(i,s){e(i,s)&&t.push(s)})),t},file:function(e,t,i){if(1!==arguments.length)return e=this.root+e,s.call(this,e,t,i),this;if(E(e)){var n=e;return this.filter((function(e,t){return!t.dir&&n.test(e)}))}var r=this.files[this.root+e];return r&&!r.dir?r:null},folder:function(e){if(!e)return this;if(E(e))return this.filter((function(t,i){return i.dir&&e.test(t)}));var t=this.root+e,i=I.call(this,t),s=this.clone();return s.root=i.name,s},remove:function(e){e=this.root+e;var t=this.files[e];if(t||("/"!==e.slice(-1)&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var i=this.filter((function(t,i){return i.name.slice(0,e.length)===e})),s=0;s<i.length;s++)delete this.files[i[s].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,i={};try{if((i=r.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:n.utf8encode})).type=i.type.toLowerCase(),i.compression=i.compression.toUpperCase(),"binarystring"===i.type&&(i.type="string"),!i.type)throw new Error("No output type specified.");r.checkSupport(i.type),"darwin"!==i.platform&&"freebsd"!==i.platform&&"linux"!==i.platform&&"sunos"!==i.platform||(i.platform="UNIX"),"win32"===i.platform&&(i.platform="DOS");var s=i.comment||this.comment||"";t=d.generateWorker(this,i,s)}catch(e){(t=new o("error")).error(e)}return new a(t,i.type||"string",i.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return(e=e||{}).type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};t.exports=g},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(e,t,i){t.exports=e("stream")},{stream:void 0}],17:[function(e,t,i){var s=e("./DataReader");function n(e){s.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=255&e[t]}e("../utils").inherits(n,s),n.prototype.byteAt=function(e){return this.data[this.zero+e]},n.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),i=e.charCodeAt(1),s=e.charCodeAt(2),n=e.charCodeAt(3),r=this.length-4;0<=r;--r)if(this.data[r]===t&&this.data[r+1]===i&&this.data[r+2]===s&&this.data[r+3]===n)return r-this.zero;return-1},n.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),i=e.charCodeAt(1),s=e.charCodeAt(2),n=e.charCodeAt(3),r=this.readData(4);return t===r[0]&&i===r[1]&&s===r[2]&&n===r[3]},n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],18:[function(e,t,i){var s=e("../utils");function n(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}n.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(){},readInt:function(e){var t,i=0;for(this.checkOffset(e),t=this.index+e-1;t>=this.index;t--)i=(i<<8)+this.byteAt(t);return this.index+=e,i},readString:function(e){return s.transformTo("string",this.readData(e))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC(1980+(e>>25&127),(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(31&e)<<1))}},t.exports=n},{"../utils":32}],19:[function(e,t,i){var s=e("./Uint8ArrayReader");function n(e){s.call(this,e)}e("../utils").inherits(n,s),n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(e,t,i){var s=e("./DataReader");function n(e){s.call(this,e)}e("../utils").inherits(n,s),n.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)},n.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero},n.prototype.readAndCheckSignature=function(e){return e===this.readData(4)},n.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./DataReader":18}],21:[function(e,t,i){var s=e("./ArrayReader");function n(e){s.call(this,e)}e("../utils").inherits(n,s),n.prototype.readData=function(e){if(this.checkOffset(e),0===e)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t},t.exports=n},{"../utils":32,"./ArrayReader":17}],22:[function(e,t,i){var s=e("../utils"),n=e("../support"),r=e("./ArrayReader"),o=e("./StringReader"),a=e("./NodeBufferReader"),l=e("./Uint8ArrayReader");t.exports=function(e){var t=s.getTypeOf(e);return s.checkSupport(t),"string"!==t||n.uint8array?"nodebuffer"===t?new a(e):n.uint8array?new l(s.transformTo("uint8array",e)):new r(s.transformTo("array",e)):new o(e)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(e,t,i){i.LOCAL_FILE_HEADER="PK",i.CENTRAL_FILE_HEADER="PK",i.CENTRAL_DIRECTORY_END="PK",i.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK",i.ZIP64_CENTRAL_DIRECTORY_END="PK",i.DATA_DESCRIPTOR="PK\b"},{}],24:[function(e,t,i){var s=e("./GenericWorker"),n=e("../utils");function r(e){s.call(this,"ConvertWorker to "+e),this.destType=e}n.inherits(r,s),r.prototype.processChunk=function(e){this.push({data:n.transformTo(this.destType,e.data),meta:e.meta})},t.exports=r},{"../utils":32,"./GenericWorker":28}],25:[function(e,t,i){var s=e("./GenericWorker"),n=e("../crc32");function r(){s.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}e("../utils").inherits(r,s),r.prototype.processChunk=function(e){this.streamInfo.crc32=n(e.data,this.streamInfo.crc32||0),this.push(e)},t.exports=r},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(e,t,i){var s=e("../utils"),n=e("./GenericWorker");function r(e){n.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}s.inherits(r,n),r.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}n.prototype.processChunk.call(this,e)},t.exports=r},{"../utils":32,"./GenericWorker":28}],27:[function(e,t,i){var s=e("../utils"),n=e("./GenericWorker");function r(e){n.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then((function(e){t.dataIsReady=!0,t.data=e,t.max=e&&e.length||0,t.type=s.getTypeOf(e),t.isPaused||t._tickAndRepeat()}),(function(e){t.error(e)}))}s.inherits(r,n),r.prototype.cleanUp=function(){n.prototype.cleanUp.call(this),this.data=null},r.prototype.resume=function(){return!!n.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,s.delay(this._tickAndRepeat,[],this)),!0)},r.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(s.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},r.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=null,t=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":e=this.data.substring(this.index,t);break;case"uint8array":e=this.data.subarray(this.index,t);break;case"array":case"nodebuffer":e=this.data.slice(this.index,t)}return this.index=t,this.push({data:e,meta:{percent:this.max?this.index/this.max*100:0}})},t.exports=r},{"../utils":32,"./GenericWorker":28}],28:[function(e,t,i){function s(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}s.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return!this.isFinished&&(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var i=0;i<this._listeners[e].length;i++)this._listeners[e][i].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",(function(e){t.processChunk(e)})),e.on("end",(function(){t.end()})),e.on("error",(function(e){t.error(e)})),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var e=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,e)&&(this.streamInfo[e]=this.extraStreamInfo[e])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}},t.exports=s},{}],29:[function(e,t,i){var s=e("../utils"),n=e("./ConvertWorker"),r=e("./GenericWorker"),o=e("../base64"),a=e("../support"),l=e("../external"),c=null;if(a.nodestream)try{c=e("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(e,t){return new l.Promise((function(i,n){var r=[],a=e._internalType,l=e._outputType,c=e._mimeType;e.on("data",(function(e,i){r.push(e),t&&t(i)})).on("error",(function(e){r=[],n(e)})).on("end",(function(){try{var e=function(e,t,i){switch(e){case"blob":return s.newBlob(s.transformTo("arraybuffer",t),i);case"base64":return o.encode(t);default:return s.transformTo(e,t)}}(l,function(e,t){var i,s=0,n=null,r=0;for(i=0;i<t.length;i++)r+=t[i].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(n=new Uint8Array(r),i=0;i<t.length;i++)n.set(t[i],s),s+=t[i].length;return n;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}(a,r),c);i(e)}catch(e){n(e)}r=[]})).resume()}))}function d(e,t,i){var o=t;switch(t){case"blob":case"arraybuffer":o="uint8array";break;case"base64":o="string"}try{this._internalType=o,this._outputType=t,this._mimeType=i,s.checkSupport(o),this._worker=e.pipe(new n(o)),e.lock()}catch(e){this._worker=new r("error"),this._worker.error(e)}}d.prototype={accumulate:function(e){return h(this,e)},on:function(e,t){var i=this;return"data"===e?this._worker.on(e,(function(e){t.call(i,e.data,e.meta)})):this._worker.on(e,(function(){s.delay(t,arguments,i)})),this},resume:function(){return s.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(s.checkSupport("nodestream"),"nodebuffer"!==this._outputType)throw new Error(this._outputType+" is not supported by this method");return new c(this,{objectMode:"nodebuffer"!==this._outputType},e)}},t.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(e,t,i){if(i.base64=!0,i.array=!0,i.string=!0,i.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",i.nodebuffer=typeof Buffer<"u",i.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")i.blob=!1;else{var s=new ArrayBuffer(0);try{i.blob=0===new Blob([s],{type:"application/zip"}).size}catch{try{var n=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);n.append(s),i.blob=0===n.getBlob("application/zip").size}catch{i.blob=!1}}}try{i.nodestream=!!e("readable-stream").Readable}catch{i.nodestream=!1}},{"readable-stream":16}],31:[function(e,t,i){for(var s=e("./utils"),n=e("./support"),r=e("./nodejsUtils"),o=e("./stream/GenericWorker"),a=new Array(256),l=0;l<256;l++)a[l]=252<=l?6:248<=l?5:240<=l?4:224<=l?3:192<=l?2:1;function c(){o.call(this,"utf-8 decode"),this.leftOver=null}function h(){o.call(this,"utf-8 encode")}a[254]=a[254]=1,i.utf8encode=function(e){return n.nodebuffer?r.newBufferFrom(e,"utf-8"):function(e){var t,i,s,r,o,a=e.length,l=0;for(r=0;r<a;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=n.uint8array?new Uint8Array(l):new Array(l),r=o=0;o<l;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(s=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(s-56320),r++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t}(e)},i.utf8decode=function(e){return n.nodebuffer?s.transformTo("nodebuffer",e).toString("utf-8"):function(e){var t,i,n,r,o=e.length,l=new Array(2*o);for(t=i=0;t<o;)if((n=e[t++])<128)l[i++]=n;else if(4<(r=a[n]))l[i++]=65533,t+=r-1;else{for(n&=2===r?31:3===r?15:7;1<r&&t<o;)n=n<<6|63&e[t++],r--;1<r?l[i++]=65533:n<65536?l[i++]=n:(n-=65536,l[i++]=55296|n>>10&1023,l[i++]=56320|1023&n)}return l.length!==i&&(l.subarray?l=l.subarray(0,i):l.length=i),s.applyFromCharCode(l)}(e=s.transformTo(n.uint8array?"uint8array":"array",e))},s.inherits(c,o),c.prototype.processChunk=function(e){var t=s.transformTo(n.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(n.uint8array){var r=t;(t=new Uint8Array(r.length+this.leftOver.length)).set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var o=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+a[e[i]]>t?i:t}(t),l=t;o!==t.length&&(n.uint8array?(l=t.subarray(0,o),this.leftOver=t.subarray(o,t.length)):(l=t.slice(0,o),this.leftOver=t.slice(o,t.length))),this.push({data:i.utf8decode(l),meta:e.meta})},c.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:i.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},i.Utf8DecodeWorker=c,s.inherits(h,o),h.prototype.processChunk=function(e){this.push({data:i.utf8encode(e.data),meta:e.meta})},i.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(e,t,i){var s=e("./support"),n=e("./base64"),r=e("./nodejsUtils"),o=e("./external");function a(e){return e}function l(e,t){for(var i=0;i<e.length;++i)t[i]=255&e.charCodeAt(i);return t}e("setimmediate"),i.newBlob=function(e,t){i.checkSupport("blob");try{return new Blob([e],{type:t})}catch{try{var s=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return s.append(e),s.getBlob(t)}catch{throw new Error("Bug : can't construct the Blob.")}}};var c={stringifyByChunk:function(e,t,i){var s=[],n=0,r=e.length;if(r<=i)return String.fromCharCode.apply(null,e);for(;n<r;)"array"===t||"nodebuffer"===t?s.push(String.fromCharCode.apply(null,e.slice(n,Math.min(n+i,r)))):s.push(String.fromCharCode.apply(null,e.subarray(n,Math.min(n+i,r)))),n+=i;return s.join("")},stringifyByChar:function(e){for(var t="",i=0;i<e.length;i++)t+=String.fromCharCode(e[i]);return t},applyCanBeUsed:{uint8array:function(){try{return s.uint8array&&1===String.fromCharCode.apply(null,new Uint8Array(1)).length}catch{return!1}}(),nodebuffer:function(){try{return s.nodebuffer&&1===String.fromCharCode.apply(null,r.allocBuffer(1)).length}catch{return!1}}()}};function h(e){var t=65536,s=i.getTypeOf(e),n=!0;if("uint8array"===s?n=c.applyCanBeUsed.uint8array:"nodebuffer"===s&&(n=c.applyCanBeUsed.nodebuffer),n)for(;1<t;)try{return c.stringifyByChunk(e,s,t)}catch{t=Math.floor(t/2)}return c.stringifyByChar(e)}function d(e,t){for(var i=0;i<e.length;i++)t[i]=e[i];return t}i.applyFromCharCode=h;var u={};u.string={string:a,array:function(e){return l(e,new Array(e.length))},arraybuffer:function(e){return u.string.uint8array(e).buffer},uint8array:function(e){return l(e,new Uint8Array(e.length))},nodebuffer:function(e){return l(e,r.allocBuffer(e.length))}},u.array={string:h,array:a,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(e)}},u.arraybuffer={string:function(e){return h(new Uint8Array(e))},array:function(e){return d(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:a,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return r.newBufferFrom(new Uint8Array(e))}},u.uint8array={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:a,nodebuffer:function(e){return r.newBufferFrom(e)}},u.nodebuffer={string:h,array:function(e){return d(e,new Array(e.length))},arraybuffer:function(e){return u.nodebuffer.uint8array(e).buffer},uint8array:function(e){return d(e,new Uint8Array(e.length))},nodebuffer:a},i.transformTo=function(e,t){if(t=t||"",!e)return t;i.checkSupport(e);var s=i.getTypeOf(t);return u[s][e](t)},i.resolve=function(e){for(var t=e.split("/"),i=[],s=0;s<t.length;s++){var n=t[s];"."===n||""===n&&0!==s&&s!==t.length-1||(".."===n?i.pop():i.push(n))}return i.join("/")},i.getTypeOf=function(e){return"string"==typeof e?"string":"[object Array]"===Object.prototype.toString.call(e)?"array":s.nodebuffer&&r.isBuffer(e)?"nodebuffer":s.uint8array&&e instanceof Uint8Array?"uint8array":s.arraybuffer&&e instanceof ArrayBuffer?"arraybuffer":void 0},i.checkSupport=function(e){if(!s[e.toLowerCase()])throw new Error(e+" is not supported by this platform")},i.MAX_VALUE_16BITS=65535,i.MAX_VALUE_32BITS=-1,i.pretty=function(e){var t,i,s="";for(i=0;i<(e||"").length;i++)s+="\\x"+((t=e.charCodeAt(i))<16?"0":"")+t.toString(16).toUpperCase();return s},i.delay=function(e,t,i){setImmediate((function(){e.apply(i||null,t||[])}))},i.inherits=function(e,t){function i(){}i.prototype=t.prototype,e.prototype=new i},i.extend=function(){var e,t,i={};for(e=0;e<arguments.length;e++)for(t in arguments[e])Object.prototype.hasOwnProperty.call(arguments[e],t)&&void 0===i[t]&&(i[t]=arguments[e][t]);return i},i.prepareContent=function(e,t,r,a,c){return o.Promise.resolve(t).then((function(e){return s.blob&&(e instanceof Blob||-1!==["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(e)))&&typeof FileReader<"u"?new o.Promise((function(t,i){var s=new FileReader;s.onload=function(e){t(e.target.result)},s.onerror=function(e){i(e.target.error)},s.readAsArrayBuffer(e)})):e})).then((function(t){var h,d=i.getTypeOf(t);return d?("arraybuffer"===d?t=i.transformTo("uint8array",t):"string"===d&&(c?t=n.decode(t):r&&!0!==a&&(t=l(h=t,s.uint8array?new Uint8Array(h.length):new Array(h.length)))),t):o.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))}))}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(e,t,i){var s=e("./reader/readerFor"),n=e("./utils"),r=e("./signature"),o=e("./zipEntry"),a=e("./support");function l(e){this.files=[],this.loadOptions=e}l.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+n.pretty(t)+", expected "+n.pretty(e)+")")}},isSignature:function(e,t){var i=this.reader.index;this.reader.setIndex(e);var s=this.reader.readString(4)===t;return this.reader.setIndex(i),s},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=a.uint8array?"uint8array":"array",i=n.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(i)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e,t,i,s=this.zip64EndOfCentralSize-44;0<s;)e=this.reader.readInt(2),t=this.reader.readInt(4),i=this.reader.readData(t),this.zip64ExtensibleData[e]={id:e,length:t,value:i}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(r.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(r.CENTRAL_FILE_HEADER);)(e=new o({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&0!==this.centralDirRecords&&0===this.files.length)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(r.CENTRAL_DIRECTORY_END);if(e<0)throw this.isSignature(0,r.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(e);var t=e;if(this.checkSignature(r.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===n.MAX_VALUE_16BITS||this.diskWithCentralDirStart===n.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===n.MAX_VALUE_16BITS||this.centralDirRecords===n.MAX_VALUE_16BITS||this.centralDirSize===n.MAX_VALUE_32BITS||this.centralDirOffset===n.MAX_VALUE_32BITS){if(this.zip64=!0,(e=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,r.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(r.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var s=t-i;if(0<s)this.isSignature(t,r.CENTRAL_FILE_HEADER)||(this.reader.zero=s);else if(s<0)throw new Error("Corrupted zip: missing "+Math.abs(s)+" bytes.")},prepareReader:function(e){this.reader=s(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},t.exports=l},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(e,t,i){var s=e("./reader/readerFor"),n=e("./utils"),r=e("./compressedObject"),o=e("./crc32"),a=e("./utf8"),l=e("./compressions"),c=e("./support");function h(e,t){this.options=e,this.loadOptions=t}h.prototype={isEncrypted:function(){return!(1&~this.bitFlag)},useUTF8:function(){return!(2048&~this.bitFlag)},readLocalPart:function(e){var t,i;if(e.skip(22),this.fileNameLength=e.readInt(2),i=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(i),-1===this.compressedSize||-1===this.uncompressedSize)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(null===(t=function(e){for(var t in l)if(Object.prototype.hasOwnProperty.call(l,t)&&l[t].magic===e)return l[t];return null}(this.compressionMethod)))throw new Error("Corrupted zip : compression "+n.pretty(this.compressionMethod)+" unknown (inner file : "+n.transformTo("string",this.fileName)+")");this.decompressed=new r(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),0==e&&(this.dosPermissions=63&this.externalFileAttributes),3==e&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||"/"!==this.fileNameStr.slice(-1)||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var e=s(this.extraFields[1].value);this.uncompressedSize===n.MAX_VALUE_32BITS&&(this.uncompressedSize=e.readInt(8)),this.compressedSize===n.MAX_VALUE_32BITS&&(this.compressedSize=e.readInt(8)),this.localHeaderOffset===n.MAX_VALUE_32BITS&&(this.localHeaderOffset=e.readInt(8)),this.diskNumberStart===n.MAX_VALUE_32BITS&&(this.diskNumberStart=e.readInt(4))}},readExtraFields:function(e){var t,i,s,n=e.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});e.index+4<n;)t=e.readInt(2),i=e.readInt(2),s=e.readData(i),this.extraFields[t]={id:t,length:i,value:s};e.setIndex(n)},handleUTF8:function(){var e=c.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=a.utf8decode(this.fileName),this.fileCommentStr=a.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(null!==t)this.fileNameStr=t;else{var i=n.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(i)}var s=this.findExtraFieldUnicodeComment();if(null!==s)this.fileCommentStr=s;else{var r=n.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(r)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=s(e.value);return 1!==t.readInt(1)||o(this.fileName)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=s(e.value);return 1!==t.readInt(1)||o(this.fileComment)!==t.readInt(4)?null:a.utf8decode(t.readData(e.length-5))}return null}},t.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(e,t,i){function s(e,t,i){this.name=e,this.dir=i.dir,this.date=i.date,this.comment=i.comment,this.unixPermissions=i.unixPermissions,this.dosPermissions=i.dosPermissions,this._data=t,this._dataBinary=i.binary,this.options={compression:i.compression,compressionOptions:i.compressionOptions}}var n=e("./stream/StreamHelper"),r=e("./stream/DataWorker"),o=e("./utf8"),a=e("./compressedObject"),l=e("./stream/GenericWorker");s.prototype={internalStream:function(e){var t=null,i="string";try{if(!e)throw new Error("No output type specified.");var s="string"===(i=e.toLowerCase())||"text"===i;"binarystring"!==i&&"text"!==i||(i="string"),t=this._decompressWorker();var r=!this._dataBinary;r&&!s&&(t=t.pipe(new o.Utf8EncodeWorker)),!r&&s&&(t=t.pipe(new o.Utf8DecodeWorker))}catch(e){(t=new l("error")).error(e)}return new n(t,i,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof a&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var i=this._decompressWorker();return this._dataBinary||(i=i.pipe(new o.Utf8EncodeWorker)),a.createWorkerFrom(i,e,t)},_decompressWorker:function(){return this._data instanceof a?this._data.getContentWorker():this._data instanceof l?this._data:new r(this._data)}};for(var c=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<c.length;d++)s.prototype[c[d]]=h;t.exports=s},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(e,t,i){(function(e){var i,s,n=e.MutationObserver||e.WebKitMutationObserver;if(n){var r=0,o=new n(h),a=e.document.createTextNode("");o.observe(a,{characterData:!0}),i=function(){a.data=r=++r%2}}else if(e.setImmediate||void 0===e.MessageChannel)i="document"in e&&"onreadystatechange"in e.document.createElement("script")?function(){var t=e.document.createElement("script");t.onreadystatechange=function(){h(),t.onreadystatechange=null,t.parentNode.removeChild(t),t=null},e.document.documentElement.appendChild(t)}:function(){setTimeout(h,0)};else{var l=new e.MessageChannel;l.port1.onmessage=h,i=function(){l.port2.postMessage(0)}}var c=[];function h(){var e,t;s=!0;for(var i=c.length;i;){for(t=c,c=[],e=-1;++e<i;)t[e]();i=c.length}s=!1}t.exports=function(e){1!==c.push(e)||s||i()}}).call(this,typeof gs<"u"?gs:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(e,t,i){var s=e("immediate");function n(){}var r={},o=["REJECTED"],a=["FULFILLED"],l=["PENDING"];function c(e){if("function"!=typeof e)throw new TypeError("resolver must be a function");this.state=l,this.queue=[],this.outcome=void 0,e!==n&&f(this,e)}function h(e,t,i){this.promise=e,"function"==typeof t&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),"function"==typeof i&&(this.onRejected=i,this.callRejected=this.otherCallRejected)}function d(e,t,i){s((function(){var s;try{s=t(i)}catch(t){return r.reject(e,t)}s===e?r.reject(e,new TypeError("Cannot resolve promise with itself")):r.resolve(e,s)}))}function u(e){var t=e&&e.then;if(e&&("object"==typeof e||"function"==typeof e)&&"function"==typeof t)return function(){t.apply(e,arguments)}}function f(e,t){var i=!1;function s(t){i||(i=!0,r.reject(e,t))}function n(t){i||(i=!0,r.resolve(e,t))}var o=p((function(){t(n,s)}));"error"===o.status&&s(o.value)}function p(e,t){var i={};try{i.value=e(t),i.status="success"}catch(e){i.status="error",i.value=e}return i}(t.exports=c).prototype.finally=function(e){if("function"!=typeof e)return this;var t=this.constructor;return this.then((function(i){return t.resolve(e()).then((function(){return i}))}),(function(i){return t.resolve(e()).then((function(){throw i}))}))},c.prototype.catch=function(e){return this.then(null,e)},c.prototype.then=function(e,t){if("function"!=typeof e&&this.state===a||"function"!=typeof t&&this.state===o)return this;var i=new this.constructor(n);return this.state!==l?d(i,this.state===a?e:t,this.outcome):this.queue.push(new h(i,e,t)),i},h.prototype.callFulfilled=function(e){r.resolve(this.promise,e)},h.prototype.otherCallFulfilled=function(e){d(this.promise,this.onFulfilled,e)},h.prototype.callRejected=function(e){r.reject(this.promise,e)},h.prototype.otherCallRejected=function(e){d(this.promise,this.onRejected,e)},r.resolve=function(e,t){var i=p(u,t);if("error"===i.status)return r.reject(e,i.value);var s=i.value;if(s)f(e,s);else{e.state=a,e.outcome=t;for(var n=-1,o=e.queue.length;++n<o;)e.queue[n].callFulfilled(t)}return e},r.reject=function(e,t){e.state=o,e.outcome=t;for(var i=-1,s=e.queue.length;++i<s;)e.queue[i].callRejected(t);return e},c.resolve=function(e){return e instanceof this?e:r.resolve(new this(n),e)},c.reject=function(e){var t=new this(n);return r.reject(t,e)},c.all=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i=e.length,s=!1;if(!i)return this.resolve([]);for(var o=new Array(i),a=0,l=-1,c=new this(n);++l<i;)h(e[l],l);return c;function h(e,n){t.resolve(e).then((function(e){o[n]=e,++a!==i||s||(s=!0,r.resolve(c,o))}),(function(e){s||(s=!0,r.reject(c,e))}))}},c.race=function(e){var t=this;if("[object Array]"!==Object.prototype.toString.call(e))return this.reject(new TypeError("must be an array"));var i,s=e.length,o=!1;if(!s)return this.resolve([]);for(var a=-1,l=new this(n);++a<s;)i=e[a],t.resolve(i).then((function(e){o||(o=!0,r.resolve(l,e))}),(function(e){o||(o=!0,r.reject(l,e))}));return l}},{immediate:36}],38:[function(e,t,i){var s={};(0,e("./lib/utils/common").assign)(s,e("./lib/deflate"),e("./lib/inflate"),e("./lib/zlib/constants")),t.exports=s},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(e,t,i){var s=e("./zlib/deflate"),n=e("./utils/common"),r=e("./utils/strings"),o=e("./zlib/messages"),a=e("./zlib/zstream"),l=Object.prototype.toString,c=0,h=-1,d=0,u=8;function f(e){if(!(this instanceof f))return new f(e);this.options=n.assign({level:h,method:u,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},e||{});var t=this.options;t.raw&&0<t.windowBits?t.windowBits=-t.windowBits:t.gzip&&0<t.windowBits&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new a,this.strm.avail_out=0;var i=s.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(i!==c)throw new Error(o[i]);if(t.header&&s.deflateSetHeader(this.strm,t.header),t.dictionary){var p;if(p="string"==typeof t.dictionary?r.string2buf(t.dictionary):"[object ArrayBuffer]"===l.call(t.dictionary)?new Uint8Array(t.dictionary):t.dictionary,(i=s.deflateSetDictionary(this.strm,p))!==c)throw new Error(o[i]);this._dict_set=!0}}function p(e,t){var i=new f(t);if(i.push(e,!0),i.err)throw i.msg||o[i.err];return i.result}f.prototype.push=function(e,t){var i,o,a=this.strm,h=this.options.chunkSize;if(this.ended)return!1;o=t===~~t?t:!0===t?4:0,"string"==typeof e?a.input=r.string2buf(e):"[object ArrayBuffer]"===l.call(e)?a.input=new Uint8Array(e):a.input=e,a.next_in=0,a.avail_in=a.input.length;do{if(0===a.avail_out&&(a.output=new n.Buf8(h),a.next_out=0,a.avail_out=h),1!==(i=s.deflate(a,o))&&i!==c)return this.onEnd(i),!(this.ended=!0);0!==a.avail_out&&(0!==a.avail_in||4!==o&&2!==o)||("string"===this.options.to?this.onData(r.buf2binstring(n.shrinkBuf(a.output,a.next_out))):this.onData(n.shrinkBuf(a.output,a.next_out)))}while((0<a.avail_in||0===a.avail_out)&&1!==i);return 4===o?(i=s.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===c):2!==o||(this.onEnd(c),!(a.avail_out=0))},f.prototype.onData=function(e){this.chunks.push(e)},f.prototype.onEnd=function(e){e===c&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Deflate=f,i.deflate=p,i.deflateRaw=function(e,t){return(t=t||{}).raw=!0,p(e,t)},i.gzip=function(e,t){return(t=t||{}).gzip=!0,p(e,t)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(e,t,i){var s=e("./zlib/inflate"),n=e("./utils/common"),r=e("./utils/strings"),o=e("./zlib/constants"),a=e("./zlib/messages"),l=e("./zlib/zstream"),c=e("./zlib/gzheader"),h=Object.prototype.toString;function d(e){if(!(this instanceof d))return new d(e);this.options=n.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&0<=t.windowBits&&t.windowBits<16&&(t.windowBits=-t.windowBits,0===t.windowBits&&(t.windowBits=-15)),!(0<=t.windowBits&&t.windowBits<16)||e&&e.windowBits||(t.windowBits+=32),15<t.windowBits&&t.windowBits<48&&!(15&t.windowBits)&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new l,this.strm.avail_out=0;var i=s.inflateInit2(this.strm,t.windowBits);if(i!==o.Z_OK)throw new Error(a[i]);this.header=new c,s.inflateGetHeader(this.strm,this.header)}function u(e,t){var i=new d(t);if(i.push(e,!0),i.err)throw i.msg||a[i.err];return i.result}d.prototype.push=function(e,t){var i,a,l,c,d,u,f=this.strm,p=this.options.chunkSize,m=this.options.dictionary,I=!1;if(this.ended)return!1;a=t===~~t?t:!0===t?o.Z_FINISH:o.Z_NO_FLUSH,"string"==typeof e?f.input=r.binstring2buf(e):"[object ArrayBuffer]"===h.call(e)?f.input=new Uint8Array(e):f.input=e,f.next_in=0,f.avail_in=f.input.length;do{if(0===f.avail_out&&(f.output=new n.Buf8(p),f.next_out=0,f.avail_out=p),(i=s.inflate(f,o.Z_NO_FLUSH))===o.Z_NEED_DICT&&m&&(u="string"==typeof m?r.string2buf(m):"[object ArrayBuffer]"===h.call(m)?new Uint8Array(m):m,i=s.inflateSetDictionary(this.strm,u)),i===o.Z_BUF_ERROR&&!0===I&&(i=o.Z_OK,I=!1),i!==o.Z_STREAM_END&&i!==o.Z_OK)return this.onEnd(i),!(this.ended=!0);f.next_out&&(0!==f.avail_out&&i!==o.Z_STREAM_END&&(0!==f.avail_in||a!==o.Z_FINISH&&a!==o.Z_SYNC_FLUSH)||("string"===this.options.to?(l=r.utf8border(f.output,f.next_out),c=f.next_out-l,d=r.buf2string(f.output,l),f.next_out=c,f.avail_out=p-c,c&&n.arraySet(f.output,f.output,l,c,0),this.onData(d)):this.onData(n.shrinkBuf(f.output,f.next_out)))),0===f.avail_in&&0===f.avail_out&&(I=!0)}while((0<f.avail_in||0===f.avail_out)&&i!==o.Z_STREAM_END);return i===o.Z_STREAM_END&&(a=o.Z_FINISH),a===o.Z_FINISH?(i=s.inflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===o.Z_OK):a!==o.Z_SYNC_FLUSH||(this.onEnd(o.Z_OK),!(f.avail_out=0))},d.prototype.onData=function(e){this.chunks.push(e)},d.prototype.onEnd=function(e){e===o.Z_OK&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=n.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg},i.Inflate=d,i.inflate=u,i.inflateRaw=function(e,t){return(t=t||{}).raw=!0,u(e,t)},i.ungzip=u},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(e,t,i){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";i.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var i=t.shift();if(i){if("object"!=typeof i)throw new TypeError(i+"must be non-object");for(var s in i)i.hasOwnProperty(s)&&(e[s]=i[s])}}return e},i.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var n={arraySet:function(e,t,i,s,n){if(t.subarray&&e.subarray)e.set(t.subarray(i,i+s),n);else for(var r=0;r<s;r++)e[n+r]=t[i+r]},flattenChunks:function(e){var t,i,s,n,r,o;for(t=s=0,i=e.length;t<i;t++)s+=e[t].length;for(o=new Uint8Array(s),t=n=0,i=e.length;t<i;t++)r=e[t],o.set(r,n),n+=r.length;return o}},r={arraySet:function(e,t,i,s,n){for(var r=0;r<s;r++)e[n+r]=t[i+r]},flattenChunks:function(e){return[].concat.apply([],e)}};i.setTyped=function(e){e?(i.Buf8=Uint8Array,i.Buf16=Uint16Array,i.Buf32=Int32Array,i.assign(i,n)):(i.Buf8=Array,i.Buf16=Array,i.Buf32=Array,i.assign(i,r))},i.setTyped(s)},{}],42:[function(e,t,i){var s=e("./common"),n=!0,r=!0;try{String.fromCharCode.apply(null,[0])}catch{n=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{r=!1}for(var o=new s.Buf8(256),a=0;a<256;a++)o[a]=252<=a?6:248<=a?5:240<=a?4:224<=a?3:192<=a?2:1;function l(e,t){if(t<65537&&(e.subarray&&r||!e.subarray&&n))return String.fromCharCode.apply(null,s.shrinkBuf(e,t));for(var i="",o=0;o<t;o++)i+=String.fromCharCode(e[o]);return i}o[254]=o[254]=1,i.string2buf=function(e){var t,i,n,r,o,a=e.length,l=0;for(r=0;r<a;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),l+=i<128?1:i<2048?2:i<65536?3:4;for(t=new s.Buf8(l),r=o=0;o<l;r++)55296==(64512&(i=e.charCodeAt(r)))&&r+1<a&&56320==(64512&(n=e.charCodeAt(r+1)))&&(i=65536+(i-55296<<10)+(n-56320),r++),i<128?t[o++]=i:(i<2048?t[o++]=192|i>>>6:(i<65536?t[o++]=224|i>>>12:(t[o++]=240|i>>>18,t[o++]=128|i>>>12&63),t[o++]=128|i>>>6&63),t[o++]=128|63&i);return t},i.buf2binstring=function(e){return l(e,e.length)},i.binstring2buf=function(e){for(var t=new s.Buf8(e.length),i=0,n=t.length;i<n;i++)t[i]=e.charCodeAt(i);return t},i.buf2string=function(e,t){var i,s,n,r,a=t||e.length,c=new Array(2*a);for(i=s=0;i<a;)if((n=e[i++])<128)c[s++]=n;else if(4<(r=o[n]))c[s++]=65533,i+=r-1;else{for(n&=2===r?31:3===r?15:7;1<r&&i<a;)n=n<<6|63&e[i++],r--;1<r?c[s++]=65533:n<65536?c[s++]=n:(n-=65536,c[s++]=55296|n>>10&1023,c[s++]=56320|1023&n)}return l(c,s)},i.utf8border=function(e,t){var i;for((t=t||e.length)>e.length&&(t=e.length),i=t-1;0<=i&&128==(192&e[i]);)i--;return i<0||0===i?t:i+o[e[i]]>t?i:t}},{"./common":41}],43:[function(e,t,i){t.exports=function(e,t,i,s){for(var n=65535&e,r=e>>>16&65535,o=0;0!==i;){for(i-=o=2e3<i?2e3:i;r=r+(n=n+t[s++]|0)|0,--o;);n%=65521,r%=65521}return n|r<<16}},{}],44:[function(e,t,i){t.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(e,t,i){var s=function(){for(var e,t=[],i=0;i<256;i++){e=i;for(var s=0;s<8;s++)e=1&e?3988292384^e>>>1:e>>>1;t[i]=e}return t}();t.exports=function(e,t,i,n){var r=s,o=n+i;e^=-1;for(var a=n;a<o;a++)e=e>>>8^r[255&(e^t[a])];return~e}},{}],46:[function(e,t,i){var s,n=e("../utils/common"),r=e("./trees"),o=e("./adler32"),a=e("./crc32"),l=e("./messages"),c=0,h=4,d=0,u=-2,f=-1,p=4,m=2,I=8,E=9,g=286,C=30,T=19,R=2*g+1,v=15,S=3,y=258,w=y+S+1,A=42,F=113,O=1,N=2,P=3,x=4;function L(e,t){return e.msg=l[t],t}function b(e){return(e<<1)-(4<e?9:0)}function M(e){for(var t=e.length;0<=--t;)e[t]=0}function D(e){var t=e.state,i=t.pending;i>e.avail_out&&(i=e.avail_out),0!==i&&(n.arraySet(e.output,t.pending_buf,t.pending_out,i,e.next_out),e.next_out+=i,t.pending_out+=i,e.total_out+=i,e.avail_out-=i,t.pending-=i,0===t.pending&&(t.pending_out=0))}function _(e,t){r._tr_flush_block(e,0<=e.block_start?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,D(e.strm)}function U(e,t){e.pending_buf[e.pending++]=t}function B(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function V(e,t){var i,s,n=e.max_chain_length,r=e.strstart,o=e.prev_length,a=e.nice_match,l=e.strstart>e.w_size-w?e.strstart-(e.w_size-w):0,c=e.window,h=e.w_mask,d=e.prev,u=e.strstart+y,f=c[r+o-1],p=c[r+o];e.prev_length>=e.good_match&&(n>>=2),a>e.lookahead&&(a=e.lookahead);do{if(c[(i=t)+o]===p&&c[i+o-1]===f&&c[i]===c[r]&&c[++i]===c[r+1]){r+=2,i++;do{}while(c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&c[++r]===c[++i]&&r<u);if(s=y-(u-r),r=u-y,o<s){if(e.match_start=t,a<=(o=s))break;f=c[r+o-1],p=c[r+o]}}}while((t=d[t&h])>l&&0!=--n);return o<=e.lookahead?o:e.lookahead}function z(e){var t,i,s,r,l,c,h,d,u,f,p=e.w_size;do{if(r=e.window_size-e.lookahead-e.strstart,e.strstart>=p+(p-w)){for(n.arraySet(e.window,e.window,p,p,0),e.match_start-=p,e.strstart-=p,e.block_start-=p,t=i=e.hash_size;s=e.head[--t],e.head[t]=p<=s?s-p:0,--i;);for(t=i=p;s=e.prev[--t],e.prev[t]=p<=s?s-p:0,--i;);r+=p}if(0===e.strm.avail_in)break;if(c=e.strm,h=e.window,d=e.strstart+e.lookahead,f=void 0,(u=r)<(f=c.avail_in)&&(f=u),i=0===f?0:(c.avail_in-=f,n.arraySet(h,c.input,c.next_in,f,d),1===c.state.wrap?c.adler=o(c.adler,h,f,d):2===c.state.wrap&&(c.adler=a(c.adler,h,f,d)),c.next_in+=f,c.total_in+=f,f),e.lookahead+=i,e.lookahead+e.insert>=S)for(l=e.strstart-e.insert,e.ins_h=e.window[l],e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[l+S-1])&e.hash_mask,e.prev[l&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=l,l++,e.insert--,!(e.lookahead+e.insert<S)););}while(e.lookahead<w&&0!==e.strm.avail_in)}function k(e,t){for(var i,s;;){if(e.lookahead<w){if(z(e),e.lookahead<w&&t===c)return O;if(0===e.lookahead)break}if(i=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==i&&e.strstart-i<=e.w_size-w&&(e.match_length=V(e,i)),e.match_length>=S)if(s=r._tr_tally(e,e.strstart-e.match_start,e.match_length-S),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=S){for(e.match_length--;e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart,0!=--e.match_length;);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else s=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(s&&(_(e,!1),0===e.strm.avail_out))return O}return e.insert=e.strstart<S-1?e.strstart:S-1,t===h?(_(e,!0),0===e.strm.avail_out?P:x):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?O:N}function Y(e,t){for(var i,s,n;;){if(e.lookahead<w){if(z(e),e.lookahead<w&&t===c)return O;if(0===e.lookahead)break}if(i=0,e.lookahead>=S&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=S-1,0!==i&&e.prev_length<e.max_lazy_match&&e.strstart-i<=e.w_size-w&&(e.match_length=V(e,i),e.match_length<=5&&(1===e.strategy||e.match_length===S&&4096<e.strstart-e.match_start)&&(e.match_length=S-1)),e.prev_length>=S&&e.match_length<=e.prev_length){for(n=e.strstart+e.lookahead-S,s=r._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-S),e.lookahead-=e.prev_length-1,e.prev_length-=2;++e.strstart<=n&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+S-1])&e.hash_mask,i=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!=--e.prev_length;);if(e.match_available=0,e.match_length=S-1,e.strstart++,s&&(_(e,!1),0===e.strm.avail_out))return O}else if(e.match_available){if((s=r._tr_tally(e,0,e.window[e.strstart-1]))&&_(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return O}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(s=r._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<S-1?e.strstart:S-1,t===h?(_(e,!0),0===e.strm.avail_out?P:x):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?O:N}function G(e,t,i,s,n){this.good_length=e,this.max_lazy=t,this.nice_length=i,this.max_chain=s,this.func=n}function H(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=I,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new n.Buf16(2*R),this.dyn_dtree=new n.Buf16(2*(2*C+1)),this.bl_tree=new n.Buf16(2*(2*T+1)),M(this.dyn_ltree),M(this.dyn_dtree),M(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new n.Buf16(v+1),this.heap=new n.Buf16(2*g+1),M(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new n.Buf16(2*g+1),M(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function W(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=m,(t=e.state).pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?A:F,e.adler=2===t.wrap?0:1,t.last_flush=c,r._tr_init(t),d):L(e,u)}function X(e){var t,i=W(e);return i===d&&((t=e.state).window_size=2*t.w_size,M(t.head),t.max_lazy_match=s[t.level].max_lazy,t.good_match=s[t.level].good_length,t.nice_match=s[t.level].nice_length,t.max_chain_length=s[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=S-1,t.match_available=0,t.ins_h=0),i}function Z(e,t,i,s,r,o){if(!e)return u;var a=1;if(t===f&&(t=6),s<0?(a=0,s=-s):15<s&&(a=2,s-=16),r<1||E<r||i!==I||s<8||15<s||t<0||9<t||o<0||p<o)return L(e,u);8===s&&(s=9);var l=new H;return(e.state=l).strm=e,l.wrap=a,l.gzhead=null,l.w_bits=s,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=r+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+S-1)/S),l.window=new n.Buf8(2*l.w_size),l.head=new n.Buf16(l.hash_size),l.prev=new n.Buf16(l.w_size),l.lit_bufsize=1<<r+6,l.pending_buf_size=4*l.lit_bufsize,l.pending_buf=new n.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=3*l.lit_bufsize,l.level=t,l.strategy=o,l.method=i,X(e)}s=[new G(0,0,0,0,(function(e,t){var i=65535;for(i>e.pending_buf_size-5&&(i=e.pending_buf_size-5);;){if(e.lookahead<=1){if(z(e),0===e.lookahead&&t===c)return O;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var s=e.block_start+i;if((0===e.strstart||e.strstart>=s)&&(e.lookahead=e.strstart-s,e.strstart=s,_(e,!1),0===e.strm.avail_out)||e.strstart-e.block_start>=e.w_size-w&&(_(e,!1),0===e.strm.avail_out))return O}return e.insert=0,t===h?(_(e,!0),0===e.strm.avail_out?P:x):(e.strstart>e.block_start&&(_(e,!1),e.strm.avail_out),O)})),new G(4,4,8,4,k),new G(4,5,16,8,k),new G(4,6,32,32,k),new G(4,4,16,16,Y),new G(8,16,32,32,Y),new G(8,16,128,128,Y),new G(8,32,128,256,Y),new G(32,128,258,1024,Y),new G(32,258,258,4096,Y)],i.deflateInit=function(e,t){return Z(e,t,I,15,8,0)},i.deflateInit2=Z,i.deflateReset=X,i.deflateResetKeep=W,i.deflateSetHeader=function(e,t){return e&&e.state?2!==e.state.wrap?u:(e.state.gzhead=t,d):u},i.deflate=function(e,t){var i,n,o,l;if(!e||!e.state||5<t||t<0)return e?L(e,u):u;if(n=e.state,!e.output||!e.input&&0!==e.avail_in||666===n.status&&t!==h)return L(e,0===e.avail_out?-5:u);if(n.strm=e,i=n.last_flush,n.last_flush=t,n.status===A)if(2===n.wrap)e.adler=0,U(n,31),U(n,139),U(n,8),n.gzhead?(U(n,(n.gzhead.text?1:0)+(n.gzhead.hcrc?2:0)+(n.gzhead.extra?4:0)+(n.gzhead.name?8:0)+(n.gzhead.comment?16:0)),U(n,255&n.gzhead.time),U(n,n.gzhead.time>>8&255),U(n,n.gzhead.time>>16&255),U(n,n.gzhead.time>>24&255),U(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),U(n,255&n.gzhead.os),n.gzhead.extra&&n.gzhead.extra.length&&(U(n,255&n.gzhead.extra.length),U(n,n.gzhead.extra.length>>8&255)),n.gzhead.hcrc&&(e.adler=a(e.adler,n.pending_buf,n.pending,0)),n.gzindex=0,n.status=69):(U(n,0),U(n,0),U(n,0),U(n,0),U(n,0),U(n,9===n.level?2:2<=n.strategy||n.level<2?4:0),U(n,3),n.status=F);else{var f=I+(n.w_bits-8<<4)<<8;f|=(2<=n.strategy||n.level<2?0:n.level<6?1:6===n.level?2:3)<<6,0!==n.strstart&&(f|=32),f+=31-f%31,n.status=F,B(n,f),0!==n.strstart&&(B(n,e.adler>>>16),B(n,65535&e.adler)),e.adler=1}if(69===n.status)if(n.gzhead.extra){for(o=n.pending;n.gzindex<(65535&n.gzhead.extra.length)&&(n.pending!==n.pending_buf_size||(n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),D(e),o=n.pending,n.pending!==n.pending_buf_size));)U(n,255&n.gzhead.extra[n.gzindex]),n.gzindex++;n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),n.gzindex===n.gzhead.extra.length&&(n.gzindex=0,n.status=73)}else n.status=73;if(73===n.status)if(n.gzhead.name){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),D(e),o=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.name.length?255&n.gzhead.name.charCodeAt(n.gzindex++):0,U(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),0===l&&(n.gzindex=0,n.status=91)}else n.status=91;if(91===n.status)if(n.gzhead.comment){o=n.pending;do{if(n.pending===n.pending_buf_size&&(n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),D(e),o=n.pending,n.pending===n.pending_buf_size)){l=1;break}l=n.gzindex<n.gzhead.comment.length?255&n.gzhead.comment.charCodeAt(n.gzindex++):0,U(n,l)}while(0!==l);n.gzhead.hcrc&&n.pending>o&&(e.adler=a(e.adler,n.pending_buf,n.pending-o,o)),0===l&&(n.status=103)}else n.status=103;if(103===n.status&&(n.gzhead.hcrc?(n.pending+2>n.pending_buf_size&&D(e),n.pending+2<=n.pending_buf_size&&(U(n,255&e.adler),U(n,e.adler>>8&255),e.adler=0,n.status=F)):n.status=F),0!==n.pending){if(D(e),0===e.avail_out)return n.last_flush=-1,d}else if(0===e.avail_in&&b(t)<=b(i)&&t!==h)return L(e,-5);if(666===n.status&&0!==e.avail_in)return L(e,-5);if(0!==e.avail_in||0!==n.lookahead||t!==c&&666!==n.status){var p=2===n.strategy?function(e,t){for(var i;;){if(0===e.lookahead&&(z(e),0===e.lookahead)){if(t===c)return O;break}if(e.match_length=0,i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,i&&(_(e,!1),0===e.strm.avail_out))return O}return e.insert=0,t===h?(_(e,!0),0===e.strm.avail_out?P:x):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?O:N}(n,t):3===n.strategy?function(e,t){for(var i,s,n,o,a=e.window;;){if(e.lookahead<=y){if(z(e),e.lookahead<=y&&t===c)return O;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=S&&0<e.strstart&&(s=a[n=e.strstart-1])===a[++n]&&s===a[++n]&&s===a[++n]){o=e.strstart+y;do{}while(s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&s===a[++n]&&n<o);e.match_length=y-(o-n),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=S?(i=r._tr_tally(e,1,e.match_length-S),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(i=r._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),i&&(_(e,!1),0===e.strm.avail_out))return O}return e.insert=0,t===h?(_(e,!0),0===e.strm.avail_out?P:x):e.last_lit&&(_(e,!1),0===e.strm.avail_out)?O:N}(n,t):s[n.level].func(n,t);if(p!==P&&p!==x||(n.status=666),p===O||p===P)return 0===e.avail_out&&(n.last_flush=-1),d;if(p===N&&(1===t?r._tr_align(n):5!==t&&(r._tr_stored_block(n,0,0,!1),3===t&&(M(n.head),0===n.lookahead&&(n.strstart=0,n.block_start=0,n.insert=0))),D(e),0===e.avail_out))return n.last_flush=-1,d}return t!==h?d:n.wrap<=0?1:(2===n.wrap?(U(n,255&e.adler),U(n,e.adler>>8&255),U(n,e.adler>>16&255),U(n,e.adler>>24&255),U(n,255&e.total_in),U(n,e.total_in>>8&255),U(n,e.total_in>>16&255),U(n,e.total_in>>24&255)):(B(n,e.adler>>>16),B(n,65535&e.adler)),D(e),0<n.wrap&&(n.wrap=-n.wrap),0!==n.pending?d:1)},i.deflateEnd=function(e){var t;return e&&e.state?(t=e.state.status)!==A&&69!==t&&73!==t&&91!==t&&103!==t&&t!==F&&666!==t?L(e,u):(e.state=null,t===F?L(e,-3):d):u},i.deflateSetDictionary=function(e,t){var i,s,r,a,l,c,h,f,p=t.length;if(!e||!e.state||2===(a=(i=e.state).wrap)||1===a&&i.status!==A||i.lookahead)return u;for(1===a&&(e.adler=o(e.adler,t,p,0)),i.wrap=0,p>=i.w_size&&(0===a&&(M(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new n.Buf8(i.w_size),n.arraySet(f,t,p-i.w_size,i.w_size,0),t=f,p=i.w_size),l=e.avail_in,c=e.next_in,h=e.input,e.avail_in=p,e.next_in=0,e.input=t,z(i);i.lookahead>=S;){for(s=i.strstart,r=i.lookahead-(S-1);i.ins_h=(i.ins_h<<i.hash_shift^i.window[s+S-1])&i.hash_mask,i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++,--r;);i.strstart=s,i.lookahead=S-1,z(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=S-1,i.match_available=0,e.next_in=c,e.input=h,e.avail_in=l,i.wrap=a,d},i.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(e,t,i){t.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(e,t,i){t.exports=function(e,t){var i,s,n,r,o,a,l,c,h,d,u,f,p,m,I,E,g,C,T,R,v,S,y,w,A;i=e.state,s=e.next_in,w=e.input,n=s+(e.avail_in-5),r=e.next_out,A=e.output,o=r-(t-e.avail_out),a=r+(e.avail_out-257),l=i.dmax,c=i.wsize,h=i.whave,d=i.wnext,u=i.window,f=i.hold,p=i.bits,m=i.lencode,I=i.distcode,E=(1<<i.lenbits)-1,g=(1<<i.distbits)-1;e:do{p<15&&(f+=w[s++]<<p,p+=8,f+=w[s++]<<p,p+=8),C=m[f&E];t:for(;;){if(f>>>=T=C>>>24,p-=T,0==(T=C>>>16&255))A[r++]=65535&C;else{if(!(16&T)){if(!(64&T)){C=m[(65535&C)+(f&(1<<T)-1)];continue t}if(32&T){i.mode=12;break e}e.msg="invalid literal/length code",i.mode=30;break e}R=65535&C,(T&=15)&&(p<T&&(f+=w[s++]<<p,p+=8),R+=f&(1<<T)-1,f>>>=T,p-=T),p<15&&(f+=w[s++]<<p,p+=8,f+=w[s++]<<p,p+=8),C=I[f&g];i:for(;;){if(f>>>=T=C>>>24,p-=T,!(16&(T=C>>>16&255))){if(!(64&T)){C=I[(65535&C)+(f&(1<<T)-1)];continue i}e.msg="invalid distance code",i.mode=30;break e}if(v=65535&C,p<(T&=15)&&(f+=w[s++]<<p,(p+=8)<T&&(f+=w[s++]<<p,p+=8)),l<(v+=f&(1<<T)-1)){e.msg="invalid distance too far back",i.mode=30;break e}if(f>>>=T,p-=T,(T=r-o)<v){if(h<(T=v-T)&&i.sane){e.msg="invalid distance too far back",i.mode=30;break e}if(y=u,(S=0)===d){if(S+=c-T,T<R){for(R-=T;A[r++]=u[S++],--T;);S=r-v,y=A}}else if(d<T){if(S+=c+d-T,(T-=d)<R){for(R-=T;A[r++]=u[S++],--T;);if(S=0,d<R){for(R-=T=d;A[r++]=u[S++],--T;);S=r-v,y=A}}}else if(S+=d-T,T<R){for(R-=T;A[r++]=u[S++],--T;);S=r-v,y=A}for(;2<R;)A[r++]=y[S++],A[r++]=y[S++],A[r++]=y[S++],R-=3;R&&(A[r++]=y[S++],1<R&&(A[r++]=y[S++]))}else{for(S=r-v;A[r++]=A[S++],A[r++]=A[S++],A[r++]=A[S++],2<(R-=3););R&&(A[r++]=A[S++],1<R&&(A[r++]=A[S++]))}break}}break}}while(s<n&&r<a);s-=R=p>>3,f&=(1<<(p-=R<<3))-1,e.next_in=s,e.next_out=r,e.avail_in=s<n?n-s+5:5-(s-n),e.avail_out=r<a?a-r+257:257-(r-a),i.hold=f,i.bits=p}},{}],49:[function(e,t,i){var s=e("../utils/common"),n=e("./adler32"),r=e("./crc32"),o=e("./inffast"),a=e("./inftrees"),l=1,c=2,h=0,d=-2,u=1,f=852,p=592;function m(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function I(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new s.Buf16(320),this.work=new s.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function E(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=u,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new s.Buf32(f),t.distcode=t.distdyn=new s.Buf32(p),t.sane=1,t.back=-1,h):d}function g(e){var t;return e&&e.state?((t=e.state).wsize=0,t.whave=0,t.wnext=0,E(e)):d}function C(e,t){var i,s;return e&&e.state?(s=e.state,t<0?(i=0,t=-t):(i=1+(t>>4),t<48&&(t&=15)),t&&(t<8||15<t)?d:(null!==s.window&&s.wbits!==t&&(s.window=null),s.wrap=i,s.wbits=t,g(e))):d}function T(e,t){var i,s;return e?(s=new I,(e.state=s).window=null,(i=C(e,t))!==h&&(e.state=null),i):d}var R,v,S=!0;function y(e){if(S){var t;for(R=new s.Buf32(512),v=new s.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(a(l,e.lens,0,288,R,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;a(c,e.lens,0,32,v,0,e.work,{bits:5}),S=!1}e.lencode=R,e.lenbits=9,e.distcode=v,e.distbits=5}function w(e,t,i,n){var r,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new s.Buf8(o.wsize)),n>=o.wsize?(s.arraySet(o.window,t,i-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(n<(r=o.wsize-o.wnext)&&(r=n),s.arraySet(o.window,t,i-n,r,o.wnext),(n-=r)?(s.arraySet(o.window,t,i-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=r,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=r))),0}i.inflateReset=g,i.inflateReset2=C,i.inflateResetKeep=E,i.inflateInit=function(e){return T(e,15)},i.inflateInit2=T,i.inflate=function(e,t){var i,f,p,I,E,g,C,T,R,v,S,A,F,O,N,P,x,L,b,M,D,_,U,B,V=0,z=new s.Buf8(4),k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return d;12===(i=e.state).mode&&(i.mode=13),E=e.next_out,p=e.output,C=e.avail_out,I=e.next_in,f=e.input,g=e.avail_in,T=i.hold,R=i.bits,v=g,S=C,_=h;e:for(;;)switch(i.mode){case u:if(0===i.wrap){i.mode=13;break}for(;R<16;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(2&i.wrap&&35615===T){z[i.check=0]=255&T,z[1]=T>>>8&255,i.check=r(i.check,z,2,0),R=T=0,i.mode=2;break}if(i.flags=0,i.head&&(i.head.done=!1),!(1&i.wrap)||(((255&T)<<8)+(T>>8))%31){e.msg="incorrect header check",i.mode=30;break}if(8!=(15&T)){e.msg="unknown compression method",i.mode=30;break}if(R-=4,D=8+(15&(T>>>=4)),0===i.wbits)i.wbits=D;else if(D>i.wbits){e.msg="invalid window size",i.mode=30;break}i.dmax=1<<D,e.adler=i.check=1,i.mode=512&T?10:12,R=T=0;break;case 2:for(;R<16;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(i.flags=T,8!=(255&i.flags)){e.msg="unknown compression method",i.mode=30;break}if(57344&i.flags){e.msg="unknown header flags set",i.mode=30;break}i.head&&(i.head.text=T>>8&1),512&i.flags&&(z[0]=255&T,z[1]=T>>>8&255,i.check=r(i.check,z,2,0)),R=T=0,i.mode=3;case 3:for(;R<32;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}i.head&&(i.head.time=T),512&i.flags&&(z[0]=255&T,z[1]=T>>>8&255,z[2]=T>>>16&255,z[3]=T>>>24&255,i.check=r(i.check,z,4,0)),R=T=0,i.mode=4;case 4:for(;R<16;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}i.head&&(i.head.xflags=255&T,i.head.os=T>>8),512&i.flags&&(z[0]=255&T,z[1]=T>>>8&255,i.check=r(i.check,z,2,0)),R=T=0,i.mode=5;case 5:if(1024&i.flags){for(;R<16;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}i.length=T,i.head&&(i.head.extra_len=T),512&i.flags&&(z[0]=255&T,z[1]=T>>>8&255,i.check=r(i.check,z,2,0)),R=T=0}else i.head&&(i.head.extra=null);i.mode=6;case 6:if(1024&i.flags&&(g<(A=i.length)&&(A=g),A&&(i.head&&(D=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),s.arraySet(i.head.extra,f,I,A,D)),512&i.flags&&(i.check=r(i.check,f,A,I)),g-=A,I+=A,i.length-=A),i.length))break e;i.length=0,i.mode=7;case 7:if(2048&i.flags){if(0===g)break e;for(A=0;D=f[I+A++],i.head&&D&&i.length<65536&&(i.head.name+=String.fromCharCode(D)),D&&A<g;);if(512&i.flags&&(i.check=r(i.check,f,A,I)),g-=A,I+=A,D)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=8;case 8:if(4096&i.flags){if(0===g)break e;for(A=0;D=f[I+A++],i.head&&D&&i.length<65536&&(i.head.comment+=String.fromCharCode(D)),D&&A<g;);if(512&i.flags&&(i.check=r(i.check,f,A,I)),g-=A,I+=A,D)break e}else i.head&&(i.head.comment=null);i.mode=9;case 9:if(512&i.flags){for(;R<16;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(T!==(65535&i.check)){e.msg="header crc mismatch",i.mode=30;break}R=T=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),e.adler=i.check=0,i.mode=12;break;case 10:for(;R<32;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}e.adler=i.check=m(T),R=T=0,i.mode=11;case 11:if(0===i.havedict)return e.next_out=E,e.avail_out=C,e.next_in=I,e.avail_in=g,i.hold=T,i.bits=R,2;e.adler=i.check=1,i.mode=12;case 12:if(5===t||6===t)break e;case 13:if(i.last){T>>>=7&R,R-=7&R,i.mode=27;break}for(;R<3;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}switch(i.last=1&T,R-=1,3&(T>>>=1)){case 0:i.mode=14;break;case 1:if(y(i),i.mode=20,6!==t)break;T>>>=2,R-=2;break e;case 2:i.mode=17;break;case 3:e.msg="invalid block type",i.mode=30}T>>>=2,R-=2;break;case 14:for(T>>>=7&R,R-=7&R;R<32;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if((65535&T)!=(T>>>16^65535)){e.msg="invalid stored block lengths",i.mode=30;break}if(i.length=65535&T,R=T=0,i.mode=15,6===t)break e;case 15:i.mode=16;case 16:if(A=i.length){if(g<A&&(A=g),C<A&&(A=C),0===A)break e;s.arraySet(p,f,I,A,E),g-=A,I+=A,C-=A,E+=A,i.length-=A;break}i.mode=12;break;case 17:for(;R<14;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(i.nlen=257+(31&T),T>>>=5,R-=5,i.ndist=1+(31&T),T>>>=5,R-=5,i.ncode=4+(15&T),T>>>=4,R-=4,286<i.nlen||30<i.ndist){e.msg="too many length or distance symbols",i.mode=30;break}i.have=0,i.mode=18;case 18:for(;i.have<i.ncode;){for(;R<3;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}i.lens[k[i.have++]]=7&T,T>>>=3,R-=3}for(;i.have<19;)i.lens[k[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,U={bits:i.lenbits},_=a(0,i.lens,0,19,i.lencode,0,i.work,U),i.lenbits=U.bits,_){e.msg="invalid code lengths set",i.mode=30;break}i.have=0,i.mode=19;case 19:for(;i.have<i.nlen+i.ndist;){for(;P=(V=i.lencode[T&(1<<i.lenbits)-1])>>>16&255,x=65535&V,!((N=V>>>24)<=R);){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(x<16)T>>>=N,R-=N,i.lens[i.have++]=x;else{if(16===x){for(B=N+2;R<B;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(T>>>=N,R-=N,0===i.have){e.msg="invalid bit length repeat",i.mode=30;break}D=i.lens[i.have-1],A=3+(3&T),T>>>=2,R-=2}else if(17===x){for(B=N+3;R<B;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}R-=N,D=0,A=3+(7&(T>>>=N)),T>>>=3,R-=3}else{for(B=N+7;R<B;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}R-=N,D=0,A=11+(127&(T>>>=N)),T>>>=7,R-=7}if(i.have+A>i.nlen+i.ndist){e.msg="invalid bit length repeat",i.mode=30;break}for(;A--;)i.lens[i.have++]=D}}if(30===i.mode)break;if(0===i.lens[256]){e.msg="invalid code -- missing end-of-block",i.mode=30;break}if(i.lenbits=9,U={bits:i.lenbits},_=a(l,i.lens,0,i.nlen,i.lencode,0,i.work,U),i.lenbits=U.bits,_){e.msg="invalid literal/lengths set",i.mode=30;break}if(i.distbits=6,i.distcode=i.distdyn,U={bits:i.distbits},_=a(c,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,U),i.distbits=U.bits,_){e.msg="invalid distances set",i.mode=30;break}if(i.mode=20,6===t)break e;case 20:i.mode=21;case 21:if(6<=g&&258<=C){e.next_out=E,e.avail_out=C,e.next_in=I,e.avail_in=g,i.hold=T,i.bits=R,o(e,S),E=e.next_out,p=e.output,C=e.avail_out,I=e.next_in,f=e.input,g=e.avail_in,T=i.hold,R=i.bits,12===i.mode&&(i.back=-1);break}for(i.back=0;P=(V=i.lencode[T&(1<<i.lenbits)-1])>>>16&255,x=65535&V,!((N=V>>>24)<=R);){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(P&&!(240&P)){for(L=N,b=P,M=x;P=(V=i.lencode[M+((T&(1<<L+b)-1)>>L)])>>>16&255,x=65535&V,!(L+(N=V>>>24)<=R);){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}T>>>=L,R-=L,i.back+=L}if(T>>>=N,R-=N,i.back+=N,i.length=x,0===P){i.mode=26;break}if(32&P){i.back=-1,i.mode=12;break}if(64&P){e.msg="invalid literal/length code",i.mode=30;break}i.extra=15&P,i.mode=22;case 22:if(i.extra){for(B=i.extra;R<B;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}i.length+=T&(1<<i.extra)-1,T>>>=i.extra,R-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=23;case 23:for(;P=(V=i.distcode[T&(1<<i.distbits)-1])>>>16&255,x=65535&V,!((N=V>>>24)<=R);){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(!(240&P)){for(L=N,b=P,M=x;P=(V=i.distcode[M+((T&(1<<L+b)-1)>>L)])>>>16&255,x=65535&V,!(L+(N=V>>>24)<=R);){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}T>>>=L,R-=L,i.back+=L}if(T>>>=N,R-=N,i.back+=N,64&P){e.msg="invalid distance code",i.mode=30;break}i.offset=x,i.extra=15&P,i.mode=24;case 24:if(i.extra){for(B=i.extra;R<B;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}i.offset+=T&(1<<i.extra)-1,T>>>=i.extra,R-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){e.msg="invalid distance too far back",i.mode=30;break}i.mode=25;case 25:if(0===C)break e;if(A=S-C,i.offset>A){if((A=i.offset-A)>i.whave&&i.sane){e.msg="invalid distance too far back",i.mode=30;break}F=A>i.wnext?(A-=i.wnext,i.wsize-A):i.wnext-A,A>i.length&&(A=i.length),O=i.window}else O=p,F=E-i.offset,A=i.length;for(C<A&&(A=C),C-=A,i.length-=A;p[E++]=O[F++],--A;);0===i.length&&(i.mode=21);break;case 26:if(0===C)break e;p[E++]=i.length,C--,i.mode=21;break;case 27:if(i.wrap){for(;R<32;){if(0===g)break e;g--,T|=f[I++]<<R,R+=8}if(S-=C,e.total_out+=S,i.total+=S,S&&(e.adler=i.check=i.flags?r(i.check,p,S,E-S):n(i.check,p,S,E-S)),S=C,(i.flags?T:m(T))!==i.check){e.msg="incorrect data check",i.mode=30;break}R=T=0}i.mode=28;case 28:if(i.wrap&&i.flags){for(;R<32;){if(0===g)break e;g--,T+=f[I++]<<R,R+=8}if(T!==(4294967295&i.total)){e.msg="incorrect length check",i.mode=30;break}R=T=0}i.mode=29;case 29:_=1;break e;case 30:_=-3;break e;case 31:return-4;default:return d}return e.next_out=E,e.avail_out=C,e.next_in=I,e.avail_in=g,i.hold=T,i.bits=R,(i.wsize||S!==e.avail_out&&i.mode<30&&(i.mode<27||4!==t))&&w(e,e.output,e.next_out,S-e.avail_out)?(i.mode=31,-4):(v-=e.avail_in,S-=e.avail_out,e.total_in+=v,e.total_out+=S,i.total+=S,i.wrap&&S&&(e.adler=i.check=i.flags?r(i.check,p,S,e.next_out-S):n(i.check,p,S,e.next_out-S)),e.data_type=i.bits+(i.last?64:0)+(12===i.mode?128:0)+(20===i.mode||15===i.mode?256:0),(0==v&&0===S||4===t)&&_===h&&(_=-5),_)},i.inflateEnd=function(e){if(!e||!e.state)return d;var t=e.state;return t.window&&(t.window=null),e.state=null,h},i.inflateGetHeader=function(e,t){var i;return e&&e.state&&2&(i=e.state).wrap?((i.head=t).done=!1,h):d},i.inflateSetDictionary=function(e,t){var i,s=t.length;return e&&e.state?0!==(i=e.state).wrap&&11!==i.mode?d:11===i.mode&&n(1,t,s,0)!==i.check?-3:w(e,t,s,s)?(i.mode=31,-4):(i.havedict=1,h):d},i.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(e,t,i){var s=e("../utils/common"),n=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],r=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],o=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];t.exports=function(e,t,i,l,c,h,d,u){var f,p,m,I,E,g,C,T,R,v=u.bits,S=0,y=0,w=0,A=0,F=0,O=0,N=0,P=0,x=0,L=0,b=null,M=0,D=new s.Buf16(16),_=new s.Buf16(16),U=null,B=0;for(S=0;S<=15;S++)D[S]=0;for(y=0;y<l;y++)D[t[i+y]]++;for(F=v,A=15;1<=A&&0===D[A];A--);if(A<F&&(F=A),0===A)return c[h++]=20971520,c[h++]=20971520,u.bits=1,0;for(w=1;w<A&&0===D[w];w++);for(F<w&&(F=w),S=P=1;S<=15;S++)if(P<<=1,(P-=D[S])<0)return-1;if(0<P&&(0===e||1!==A))return-1;for(_[1]=0,S=1;S<15;S++)_[S+1]=_[S]+D[S];for(y=0;y<l;y++)0!==t[i+y]&&(d[_[t[i+y]]++]=y);if(g=0===e?(b=U=d,19):1===e?(b=n,M-=257,U=r,B-=257,256):(b=o,U=a,-1),S=w,E=h,N=y=L=0,m=-1,I=(x=1<<(O=F))-1,1===e&&852<x||2===e&&592<x)return 1;for(;;){for(C=S-N,R=d[y]<g?(T=0,d[y]):d[y]>g?(T=U[B+d[y]],b[M+d[y]]):(T=96,0),f=1<<S-N,w=p=1<<O;c[E+(L>>N)+(p-=f)]=C<<24|T<<16|R,0!==p;);for(f=1<<S-1;L&f;)f>>=1;if(0!==f?(L&=f-1,L+=f):L=0,y++,0==--D[S]){if(S===A)break;S=t[i+d[y]]}if(F<S&&(L&I)!==m){for(0===N&&(N=F),E+=w,P=1<<(O=S-N);O+N<A&&!((P-=D[O+N])<=0);)O++,P<<=1;if(x+=1<<O,1===e&&852<x||2===e&&592<x)return 1;c[m=L&I]=F<<24|O<<16|E-h}}return 0!==L&&(c[E+L]=S-N<<24|64<<16),u.bits=F,0}},{"../utils/common":41}],51:[function(e,t,i){t.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(e,t,i){var s=e("../utils/common"),n=0,r=1;function o(e){for(var t=e.length;0<=--t;)e[t]=0}var a=0,l=29,c=256,h=c+1+l,d=30,u=19,f=2*h+1,p=15,m=16,I=7,E=256,g=16,C=17,T=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],v=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],w=new Array(2*(h+2));o(w);var A=new Array(2*d);o(A);var F=new Array(512);o(F);var O=new Array(256);o(O);var N=new Array(l);o(N);var P,x,L,b=new Array(d);function M(e,t,i,s,n){this.static_tree=e,this.extra_bits=t,this.extra_base=i,this.elems=s,this.max_length=n,this.has_stree=e&&e.length}function D(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function _(e){return e<256?F[e]:F[256+(e>>>7)]}function U(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function B(e,t,i){e.bi_valid>m-i?(e.bi_buf|=t<<e.bi_valid&65535,U(e,e.bi_buf),e.bi_buf=t>>m-e.bi_valid,e.bi_valid+=i-m):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=i)}function V(e,t,i){B(e,i[2*t],i[2*t+1])}function z(e,t){for(var i=0;i|=1&e,e>>>=1,i<<=1,0<--t;);return i>>>1}function k(e,t,i){var s,n,r=new Array(p+1),o=0;for(s=1;s<=p;s++)r[s]=o=o+i[s-1]<<1;for(n=0;n<=t;n++){var a=e[2*n+1];0!==a&&(e[2*n]=z(r[a]++,a))}}function Y(e){var t;for(t=0;t<h;t++)e.dyn_ltree[2*t]=0;for(t=0;t<d;t++)e.dyn_dtree[2*t]=0;for(t=0;t<u;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*E]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function G(e){8<e.bi_valid?U(e,e.bi_buf):0<e.bi_valid&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function H(e,t,i,s){var n=2*t,r=2*i;return e[n]<e[r]||e[n]===e[r]&&s[t]<=s[i]}function W(e,t,i){for(var s=e.heap[i],n=i<<1;n<=e.heap_len&&(n<e.heap_len&&H(t,e.heap[n+1],e.heap[n],e.depth)&&n++,!H(t,s,e.heap[n],e.depth));)e.heap[i]=e.heap[n],i=n,n<<=1;e.heap[i]=s}function X(e,t,i){var s,n,r,o,a=0;if(0!==e.last_lit)for(;s=e.pending_buf[e.d_buf+2*a]<<8|e.pending_buf[e.d_buf+2*a+1],n=e.pending_buf[e.l_buf+a],a++,0===s?V(e,n,t):(V(e,(r=O[n])+c+1,t),0!==(o=R[r])&&B(e,n-=N[r],o),V(e,r=_(--s),i),0!==(o=v[r])&&B(e,s-=b[r],o)),a<e.last_lit;);V(e,E,t)}function Z(e,t){var i,s,n,r=t.dyn_tree,o=t.stat_desc.static_tree,a=t.stat_desc.has_stree,l=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=f,i=0;i<l;i++)0!==r[2*i]?(e.heap[++e.heap_len]=c=i,e.depth[i]=0):r[2*i+1]=0;for(;e.heap_len<2;)r[2*(n=e.heap[++e.heap_len]=c<2?++c:0)]=1,e.depth[n]=0,e.opt_len--,a&&(e.static_len-=o[2*n+1]);for(t.max_code=c,i=e.heap_len>>1;1<=i;i--)W(e,r,i);for(n=l;i=e.heap[1],e.heap[1]=e.heap[e.heap_len--],W(e,r,1),s=e.heap[1],e.heap[--e.heap_max]=i,e.heap[--e.heap_max]=s,r[2*n]=r[2*i]+r[2*s],e.depth[n]=(e.depth[i]>=e.depth[s]?e.depth[i]:e.depth[s])+1,r[2*i+1]=r[2*s+1]=n,e.heap[1]=n++,W(e,r,1),2<=e.heap_len;);e.heap[--e.heap_max]=e.heap[1],function(e,t){var i,s,n,r,o,a,l=t.dyn_tree,c=t.max_code,h=t.stat_desc.static_tree,d=t.stat_desc.has_stree,u=t.stat_desc.extra_bits,m=t.stat_desc.extra_base,I=t.stat_desc.max_length,E=0;for(r=0;r<=p;r++)e.bl_count[r]=0;for(l[2*e.heap[e.heap_max]+1]=0,i=e.heap_max+1;i<f;i++)I<(r=l[2*l[2*(s=e.heap[i])+1]+1]+1)&&(r=I,E++),l[2*s+1]=r,c<s||(e.bl_count[r]++,o=0,m<=s&&(o=u[s-m]),a=l[2*s],e.opt_len+=a*(r+o),d&&(e.static_len+=a*(h[2*s+1]+o)));if(0!==E){do{for(r=I-1;0===e.bl_count[r];)r--;e.bl_count[r]--,e.bl_count[r+1]+=2,e.bl_count[I]--,E-=2}while(0<E);for(r=I;0!==r;r--)for(s=e.bl_count[r];0!==s;)c<(n=e.heap[--i])||(l[2*n+1]!==r&&(e.opt_len+=(r-l[2*n+1])*l[2*n],l[2*n+1]=r),s--)}}(e,t),k(r,c,e.bl_count)}function j(e,t,i){var s,n,r=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),t[2*(i+1)+1]=65535,s=0;s<=i;s++)n=o,o=t[2*(s+1)+1],++a<l&&n===o||(a<c?e.bl_tree[2*n]+=a:0!==n?(n!==r&&e.bl_tree[2*n]++,e.bl_tree[2*g]++):a<=10?e.bl_tree[2*C]++:e.bl_tree[2*T]++,r=n,c=(a=0)===o?(l=138,3):n===o?(l=6,3):(l=7,4))}function K(e,t,i){var s,n,r=-1,o=t[1],a=0,l=7,c=4;for(0===o&&(l=138,c=3),s=0;s<=i;s++)if(n=o,o=t[2*(s+1)+1],!(++a<l&&n===o)){if(a<c)for(;V(e,n,e.bl_tree),0!=--a;);else 0!==n?(n!==r&&(V(e,n,e.bl_tree),a--),V(e,g,e.bl_tree),B(e,a-3,2)):a<=10?(V(e,C,e.bl_tree),B(e,a-3,3)):(V(e,T,e.bl_tree),B(e,a-11,7));r=n,c=(a=0)===o?(l=138,3):n===o?(l=6,3):(l=7,4)}}o(b);var Q=!1;function q(e,t,i,n){var r,o,l;B(e,(a<<1)+(n?1:0),3),o=t,l=i,G(r=e),U(r,l),U(r,~l),s.arraySet(r.pending_buf,r.window,o,l,r.pending),r.pending+=l}i._tr_init=function(e){Q||(function(){var e,t,i,s,n,r=new Array(p+1);for(s=i=0;s<l-1;s++)for(N[s]=i,e=0;e<1<<R[s];e++)O[i++]=s;for(O[i-1]=s,s=n=0;s<16;s++)for(b[s]=n,e=0;e<1<<v[s];e++)F[n++]=s;for(n>>=7;s<d;s++)for(b[s]=n<<7,e=0;e<1<<v[s]-7;e++)F[256+n++]=s;for(t=0;t<=p;t++)r[t]=0;for(e=0;e<=143;)w[2*e+1]=8,e++,r[8]++;for(;e<=255;)w[2*e+1]=9,e++,r[9]++;for(;e<=279;)w[2*e+1]=7,e++,r[7]++;for(;e<=287;)w[2*e+1]=8,e++,r[8]++;for(k(w,h+1,r),e=0;e<d;e++)A[2*e+1]=5,A[2*e]=z(e,5);P=new M(w,R,c+1,h,p),x=new M(A,v,0,d,p),L=new M(new Array(0),S,0,u,I)}(),Q=!0),e.l_desc=new D(e.dyn_ltree,P),e.d_desc=new D(e.dyn_dtree,x),e.bl_desc=new D(e.bl_tree,L),e.bi_buf=0,e.bi_valid=0,Y(e)},i._tr_stored_block=q,i._tr_flush_block=function(e,t,i,s){var o,a,l=0;0<e.level?(2===e.strm.data_type&&(e.strm.data_type=function(e){var t,i=4093624447;for(t=0;t<=31;t++,i>>>=1)if(1&i&&0!==e.dyn_ltree[2*t])return n;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return r;for(t=32;t<c;t++)if(0!==e.dyn_ltree[2*t])return r;return n}(e)),Z(e,e.l_desc),Z(e,e.d_desc),l=function(e){var t;for(j(e,e.dyn_ltree,e.l_desc.max_code),j(e,e.dyn_dtree,e.d_desc.max_code),Z(e,e.bl_desc),t=u-1;3<=t&&0===e.bl_tree[2*y[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}(e),o=e.opt_len+3+7>>>3,(a=e.static_len+3+7>>>3)<=o&&(o=a)):o=a=i+5,i+4<=o&&-1!==t?q(e,t,i,s):4===e.strategy||a===o?(B(e,2+(s?1:0),3),X(e,w,A)):(B(e,4+(s?1:0),3),function(e,t,i,s){var n;for(B(e,t-257,5),B(e,i-1,5),B(e,s-4,4),n=0;n<s;n++)B(e,e.bl_tree[2*y[n]+1],3);K(e,e.dyn_ltree,t-1),K(e,e.dyn_dtree,i-1)}(e,e.l_desc.max_code+1,e.d_desc.max_code+1,l+1),X(e,e.dyn_ltree,e.dyn_dtree)),Y(e),s&&G(e)},i._tr_tally=function(e,t,i){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&i,e.last_lit++,0===t?e.dyn_ltree[2*i]++:(e.matches++,t--,e.dyn_ltree[2*(O[i]+c+1)]++,e.dyn_dtree[2*_(t)]++),e.last_lit===e.lit_bufsize-1},i._tr_align=function(e){var t;B(e,2,3),V(e,E,w),16===(t=e).bi_valid?(U(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):8<=t.bi_valid&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)}},{"../utils/common":41}],53:[function(e,t,i){t.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(e,t,i){(function(e){!function(e,t){if(!e.setImmediate){var i,s,n,r,o=1,a={},l=!1,c=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,i="[object process]"==={}.toString.call(e.process)?function(e){process.nextTick((function(){u(e)}))}:function(){if(e.postMessage&&!e.importScripts){var t=!0,i=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=i,t}}()?(r="setImmediate$"+Math.random()+"$",e.addEventListener?e.addEventListener("message",f,!1):e.attachEvent("onmessage",f),function(t){e.postMessage(r+t,"*")}):e.MessageChannel?((n=new MessageChannel).port1.onmessage=function(e){u(e.data)},function(e){n.port2.postMessage(e)}):c&&"onreadystatechange"in c.createElement("script")?(s=c.documentElement,function(e){var t=c.createElement("script");t.onreadystatechange=function(){u(e),t.onreadystatechange=null,s.removeChild(t),t=null},s.appendChild(t)}):function(e){setTimeout(u,0,e)},h.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),s=0;s<t.length;s++)t[s]=arguments[s+1];var n={callback:e,args:t};return a[o]=n,i(o),o++},h.clearImmediate=d}function d(e){delete a[e]}function u(e){if(l)setTimeout(u,0,e);else{var i=a[e];if(i){l=!0;try{!function(e){var i=e.callback,s=e.args;switch(s.length){case 0:i();break;case 1:i(s[0]);break;case 2:i(s[0],s[1]);break;case 3:i(s[0],s[1],s[2]);break;default:i.apply(t,s)}}(i)}finally{d(e),l=!1}}}}function f(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(r)&&u(+t.data.slice(r.length))}}(typeof self>"u"?void 0===e?this:e:self)}).call(this,typeof gs<"u"?gs:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10));var No={},Po={};!function(e){const t=":A-Za-z_\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",i="["+t+"]["+(t+"\\-.\\d\\u00B7\\u0300-\\u036F\\u203F-\\u2040")+"]*",s=new RegExp("^"+i+"$");e.isExist=function(e){return typeof e<"u"},e.isEmptyObject=function(e){return 0===Object.keys(e).length},e.merge=function(e,t,i){if(t){const s=Object.keys(t),n=s.length;for(let r=0;r<n;r++)e[s[r]]="strict"===i?[t[s[r]]]:t[s[r]]}},e.getValue=function(t){return e.isExist(t)?t:""},e.isName=function(e){const t=s.exec(e);return!(null===t||typeof t>"u")},e.getAllMatches=function(e,t){const i=[];let s=t.exec(e);for(;s;){const n=[];n.startIndex=t.lastIndex-s[0].length;const r=s.length;for(let e=0;e<r;e++)n.push(s[e]);i.push(n),s=t.exec(e)}return i},e.nameRegexp=i}(Po);const xo=Po,Lo={allowBooleanAttributes:!1,unpairedTags:[]};function bo(e){return" "===e||"\t"===e||"\n"===e||"\r"===e}function Mo(e,t){const i=t;for(;t<e.length;t++)if("?"==e[t]||" "==e[t]){const s=e.substr(i,t-i);if(t>5&&"xml"===s)return Yo("InvalidXml","XML declaration allowed only at the start of the document.",Wo(e,t));if("?"==e[t]&&">"==e[t+1]){t++;break}continue}return t}function Do(e,t){if(e.length>t+5&&"-"===e[t+1]&&"-"===e[t+2]){for(t+=3;t<e.length;t++)if("-"===e[t]&&"-"===e[t+1]&&">"===e[t+2]){t+=2;break}}else if(e.length>t+8&&"D"===e[t+1]&&"O"===e[t+2]&&"C"===e[t+3]&&"T"===e[t+4]&&"Y"===e[t+5]&&"P"===e[t+6]&&"E"===e[t+7]){let i=1;for(t+=8;t<e.length;t++)if("<"===e[t])i++;else if(">"===e[t]&&(i--,0===i))break}else if(e.length>t+9&&"["===e[t+1]&&"C"===e[t+2]&&"D"===e[t+3]&&"A"===e[t+4]&&"T"===e[t+5]&&"A"===e[t+6]&&"["===e[t+7])for(t+=8;t<e.length;t++)if("]"===e[t]&&"]"===e[t+1]&&">"===e[t+2]){t+=2;break}return t}No.validate=function(e,t){t=Object.assign({},Lo,t);const i=[];let s=!1,n=!1;"\ufeff"===e[0]&&(e=e.substr(1));for(let r=0;r<e.length;r++)if("<"===e[r]&&"?"===e[r+1]){if(r+=2,r=Mo(e,r),r.err)return r}else{if("<"!==e[r]){if(bo(e[r]))continue;return Yo("InvalidChar","char '"+e[r]+"' is not expected.",Wo(e,r))}{let o=r;if(r++,"!"===e[r]){r=Do(e,r);continue}{let a=!1;"/"===e[r]&&(a=!0,r++);let l="";for(;r<e.length&&">"!==e[r]&&" "!==e[r]&&"\t"!==e[r]&&"\n"!==e[r]&&"\r"!==e[r];r++)l+=e[r];if(l=l.trim(),"/"===l[l.length-1]&&(l=l.substring(0,l.length-1),r--),!Ho(l)){let t;return t=0===l.trim().length?"Invalid space after '<'.":"Tag '"+l+"' is an invalid name.",Yo("InvalidTag",t,Wo(e,r))}const c=Bo(e,r);if(!1===c)return Yo("InvalidAttr","Attributes for '"+l+"' have open quote.",Wo(e,r));let h=c.value;if(r=c.index,"/"===h[h.length-1]){const i=r-h.length;h=h.substring(0,h.length-1);const n=zo(h,t);if(!0!==n)return Yo(n.err.code,n.err.msg,Wo(e,i+n.err.line));s=!0}else if(a){if(!c.tagClosed)return Yo("InvalidTag","Closing tag '"+l+"' doesn't have proper closing.",Wo(e,r));if(h.trim().length>0)return Yo("InvalidTag","Closing tag '"+l+"' can't have attributes or invalid starting.",Wo(e,o));if(0===i.length)return Yo("InvalidTag","Closing tag '"+l+"' has not been opened.",Wo(e,o));{const t=i.pop();if(l!==t.tagName){let i=Wo(e,t.tagStartPos);return Yo("InvalidTag","Expected closing tag '"+t.tagName+"' (opened in line "+i.line+", col "+i.col+") instead of closing tag '"+l+"'.",Wo(e,o))}0==i.length&&(n=!0)}}else{const a=zo(h,t);if(!0!==a)return Yo(a.err.code,a.err.msg,Wo(e,r-h.length+a.err.line));if(!0===n)return Yo("InvalidXml","Multiple possible root nodes found.",Wo(e,r));-1!==t.unpairedTags.indexOf(l)||i.push({tagName:l,tagStartPos:o}),s=!0}for(r++;r<e.length;r++)if("<"===e[r]){if("!"===e[r+1]){r++,r=Do(e,r);continue}if("?"!==e[r+1])break;if(r=Mo(e,++r),r.err)return r}else if("&"===e[r]){const t=ko(e,r);if(-1==t)return Yo("InvalidChar","char '&' is not expected.",Wo(e,r));r=t}else if(!0===n&&!bo(e[r]))return Yo("InvalidXml","Extra text at the end",Wo(e,r));"<"===e[r]&&r--}}}return s?1==i.length?Yo("InvalidTag","Unclosed tag '"+i[0].tagName+"'.",Wo(e,i[0].tagStartPos)):!(i.length>0)||Yo("InvalidXml","Invalid '"+JSON.stringify(i.map((e=>e.tagName)),null,4).replace(/\r?\n/g,"")+"' found.",{line:1,col:1}):Yo("InvalidXml","Start tag expected.",1)};const _o='"',Uo="'";function Bo(e,t){let i="",s="",n=!1;for(;t<e.length;t++){if(e[t]===_o||e[t]===Uo)""===s?s=e[t]:s!==e[t]||(s="");else if(">"===e[t]&&""===s){n=!0;break}i+=e[t]}return""===s&&{value:i,index:t,tagClosed:n}}const Vo=new RegExp("(\\s*)([^\\s=]+)(\\s*=)?(\\s*(['\"])(([\\s\\S])*?)\\5)?","g");function zo(e,t){const i=xo.getAllMatches(e,Vo),s={};for(let e=0;e<i.length;e++){if(0===i[e][1].length)return Yo("InvalidAttr","Attribute '"+i[e][2]+"' has no space in starting.",Xo(i[e]));if(void 0!==i[e][3]&&void 0===i[e][4])return Yo("InvalidAttr","Attribute '"+i[e][2]+"' is without value.",Xo(i[e]));if(void 0===i[e][3]&&!t.allowBooleanAttributes)return Yo("InvalidAttr","boolean attribute '"+i[e][2]+"' is not allowed.",Xo(i[e]));const n=i[e][2];if(!Go(n))return Yo("InvalidAttr","Attribute '"+n+"' is an invalid name.",Xo(i[e]));if(s.hasOwnProperty(n))return Yo("InvalidAttr","Attribute '"+n+"' is repeated.",Xo(i[e]));s[n]=1}return!0}function ko(e,t){if(";"===e[++t])return-1;if("#"===e[t])return function(e,t){let i=/\d/;for("x"===e[t]&&(t++,i=/[\da-fA-F]/);t<e.length;t++){if(";"===e[t])return t;if(!e[t].match(i))break}return-1}(e,++t);let i=0;for(;t<e.length;t++,i++)if(!(e[t].match(/\w/)&&i<20)){if(";"===e[t])break;return-1}return t}function Yo(e,t,i){return{err:{code:e,msg:t,line:i.line||i,col:i.col}}}function Go(e){return xo.isName(e)}function Ho(e){return xo.isName(e)}function Wo(e,t){const i=e.substring(0,t).split(/\r?\n/);return{line:i.length,col:i[i.length-1].length+1}}function Xo(e){return e.startIndex+e[1].length}var Zo={};const jo={preserveOrder:!1,attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,removeNSPrefix:!1,allowBooleanAttributes:!1,parseTagValue:!0,parseAttributeValue:!1,trimValues:!0,cdataPropName:!1,numberParseOptions:{hex:!0,leadingZeros:!0,eNotation:!0},tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},stopNodes:[],alwaysCreateTextNode:!1,isArray:()=>!1,commentPropName:!1,unpairedTags:[],processEntities:!0,htmlEntities:!1,ignoreDeclaration:!1,ignorePiTags:!1,transformTagName:!1,transformAttributeName:!1,updateTag:function(e,t,i){return e}};Zo.buildOptions=function(e){return Object.assign({},jo,e)},Zo.defaultOptions=jo;var Ko=class{constructor(e){this.tagname=e,this.child=[],this[":@"]={}}add(e,t){"__proto__"===e&&(e="#__proto__"),this.child.push({[e]:t})}addChild(e){"__proto__"===e.tagname&&(e.tagname="#__proto__"),e[":@"]&&Object.keys(e[":@"]).length>0?this.child.push({[e.tagname]:e.child,":@":e[":@"]}):this.child.push({[e.tagname]:e.child})}};const Qo=Po;function qo(e,t){let i="";for(;t<e.length&&"'"!==e[t]&&'"'!==e[t];t++)i+=e[t];if(i=i.trim(),-1!==i.indexOf(" "))throw new Error("External entites are not supported");const s=e[t++];let n="";for(;t<e.length&&e[t]!==s;t++)n+=e[t];return[i,n,t]}function Jo(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"N"===e[t+3]&&"T"===e[t+4]&&"I"===e[t+5]&&"T"===e[t+6]&&"Y"===e[t+7]}function $o(e,t){return"!"===e[t+1]&&"E"===e[t+2]&&"L"===e[t+3]&&"E"===e[t+4]&&"M"===e[t+5]&&"E"===e[t+6]&&"N"===e[t+7]&&"T"===e[t+8]}function ea(e,t){return"!"===e[t+1]&&"A"===e[t+2]&&"T"===e[t+3]&&"T"===e[t+4]&&"L"===e[t+5]&&"I"===e[t+6]&&"S"===e[t+7]&&"T"===e[t+8]}function ta(e,t){return"!"===e[t+1]&&"N"===e[t+2]&&"O"===e[t+3]&&"T"===e[t+4]&&"A"===e[t+5]&&"T"===e[t+6]&&"I"===e[t+7]&&"O"===e[t+8]&&"N"===e[t+9]}function ia(e){if(Qo.isName(e))return e;throw new Error(`Invalid entity name ${e}`)}var sa=function(e,t){const i={};if("O"!==e[t+3]||"C"!==e[t+4]||"T"!==e[t+5]||"Y"!==e[t+6]||"P"!==e[t+7]||"E"!==e[t+8])throw new Error("Invalid Tag instead of DOCTYPE");{t+=9;let s=1,n=!1,r=!1,o="";for(;t<e.length;t++)if("<"!==e[t]||r)if(">"===e[t]){if(r?"-"===e[t-1]&&"-"===e[t-2]&&(r=!1,s--):s--,0===s)break}else"["===e[t]?n=!0:o+=e[t];else n&&Jo(e,t)?(t+=7,[entityName,val,t]=qo(e,t+1),-1===val.indexOf("&")&&(i[ia(entityName)]={regx:RegExp(`&${entityName};`,"g"),val:val})):n&&$o(e,t)||n&&ea(e,t)?t+=8:n&&ta(e,t)?t+=9:r=!0,s++,o="";if(0!==s)throw new Error("Unclosed DOCTYPE")}return{entities:i,i:t}};const na=/^[-+]?0x[a-fA-F0-9]+$/,ra=/^([\-\+])?(0*)(\.[0-9]+([eE]\-?[0-9]+)?|[0-9]+(\.[0-9]+([eE]\-?[0-9]+)?)?)$/;!Number.parseInt&&window.parseInt&&(Number.parseInt=window.parseInt),!Number.parseFloat&&window.parseFloat&&(Number.parseFloat=window.parseFloat);const oa={hex:!0,leadingZeros:!0,decimalPoint:".",eNotation:!0};const aa=Po,la=Ko,ca=sa,ha=function(e,t={}){if(t=Object.assign({},oa,t),!e||"string"!=typeof e)return e;let i=e.trim();if(void 0!==t.skipLike&&t.skipLike.test(i))return e;if(t.hex&&na.test(i))return Number.parseInt(i,16);{const s=ra.exec(i);if(s){const n=s[1],r=s[2];let o=function(e){return e&&-1!==e.indexOf(".")&&(e=e.replace(/0+$/,""),"."===e?e="0":"."===e[0]?e="0"+e:"."===e[e.length-1]&&(e=e.substr(0,e.length-1))),e}(s[3]);const a=s[4]||s[6];if(!t.leadingZeros&&r.length>0&&n&&"."!==i[2])return e;if(!t.leadingZeros&&r.length>0&&!n&&"."!==i[1])return e;{const s=Number(i),l=""+s;return-1!==l.search(/[eE]/)||a?t.eNotation?s:e:-1!==i.indexOf(".")?"0"===l&&""===o||l===o||n&&l==="-"+o?s:e:r?o===l||n+o===l?s:e:i===l||i===n+l?s:e}}return e}};function da(e){const t=Object.keys(e);for(let i=0;i<t.length;i++){const s=t[i];this.lastEntities[s]={regex:new RegExp("&"+s+";","g"),val:e[s]}}}function ua(e,t,i,s,n,r,o){if(void 0!==e&&(this.options.trimValues&&!s&&(e=e.trim()),e.length>0)){o||(e=this.replaceEntitiesValue(e));const s=this.options.tagValueProcessor(t,e,i,n,r);return null==s?e:typeof s!=typeof e||s!==e?s:this.options.trimValues||e.trim()===e?ya(e,this.options.parseTagValue,this.options.numberParseOptions):e}}function fa(e){if(this.options.removeNSPrefix){const t=e.split(":"),i="/"===e.charAt(0)?"/":"";if("xmlns"===t[0])return"";2===t.length&&(e=i+t[1])}return e}const pa=new RegExp("([^\\s=]+)\\s*(=\\s*(['\"])([\\s\\S]*?)\\3)?","gm");function ma(e,t,i){if(!this.options.ignoreAttributes&&"string"==typeof e){const i=aa.getAllMatches(e,pa),s=i.length,n={};for(let e=0;e<s;e++){const s=this.resolveNameSpace(i[e][1]);let r=i[e][4],o=this.options.attributeNamePrefix+s;if(s.length)if(this.options.transformAttributeName&&(o=this.options.transformAttributeName(o)),"__proto__"===o&&(o="#__proto__"),void 0!==r){this.options.trimValues&&(r=r.trim()),r=this.replaceEntitiesValue(r);const e=this.options.attributeValueProcessor(s,r,t);n[o]=null==e?r:typeof e!=typeof r||e!==r?e:ya(r,this.options.parseAttributeValue,this.options.numberParseOptions)}else this.options.allowBooleanAttributes&&(n[o]=!0)}if(!Object.keys(n).length)return;if(this.options.attributesGroupName){const e={};return e[this.options.attributesGroupName]=n,e}return n}}const Ia=function(e){e=e.replace(/\r\n?/g,"\n");const t=new la("!xml");let i=t,s="",n="";for(let r=0;r<e.length;r++)if("<"===e[r])if("/"===e[r+1]){const t=Ra(e,">",r,"Closing Tag is not closed.");let o=e.substring(r+2,t).trim();if(this.options.removeNSPrefix){const e=o.indexOf(":");-1!==e&&(o=o.substr(e+1))}this.options.transformTagName&&(o=this.options.transformTagName(o)),i&&(s=this.saveTextToParentTag(s,i,n));const a=n.substring(n.lastIndexOf(".")+1);if(o&&-1!==this.options.unpairedTags.indexOf(o))throw new Error(`Unpaired tag can not be used as closing tag: </${o}>`);let l=0;a&&-1!==this.options.unpairedTags.indexOf(a)?(l=n.lastIndexOf(".",n.lastIndexOf(".")-1),this.tagsNodeStack.pop()):l=n.lastIndexOf("."),n=n.substring(0,l),i=this.tagsNodeStack.pop(),s="",r=t}else if("?"===e[r+1]){let t=va(e,r,!1,"?>");if(!t)throw new Error("Pi Tag is not closed.");if(s=this.saveTextToParentTag(s,i,n),!(this.options.ignoreDeclaration&&"?xml"===t.tagName||this.options.ignorePiTags)){const e=new la(t.tagName);e.add(this.options.textNodeName,""),t.tagName!==t.tagExp&&t.attrExpPresent&&(e[":@"]=this.buildAttributesMap(t.tagExp,n,t.tagName)),this.addChild(i,e,n)}r=t.closeIndex+1}else if("!--"===e.substr(r+1,3)){const t=Ra(e,"--\x3e",r+4,"Comment is not closed.");if(this.options.commentPropName){const o=e.substring(r+4,t-2);s=this.saveTextToParentTag(s,i,n),i.add(this.options.commentPropName,[{[this.options.textNodeName]:o}])}r=t}else if("!D"===e.substr(r+1,2)){const t=ca(e,r);this.docTypeEntities=t.entities,r=t.i}else if("!["===e.substr(r+1,2)){const t=Ra(e,"]]>",r,"CDATA is not closed.")-2,o=e.substring(r+9,t);s=this.saveTextToParentTag(s,i,n);let a=this.parseTextData(o,i.tagname,n,!0,!1,!0,!0);null==a&&(a=""),this.options.cdataPropName?i.add(this.options.cdataPropName,[{[this.options.textNodeName]:o}]):i.add(this.options.textNodeName,a),r=t+2}else{let o=va(e,r,this.options.removeNSPrefix),a=o.tagName;const l=o.rawTagName;let c=o.tagExp,h=o.attrExpPresent,d=o.closeIndex;this.options.transformTagName&&(a=this.options.transformTagName(a)),i&&s&&"!xml"!==i.tagname&&(s=this.saveTextToParentTag(s,i,n,!1));const u=i;if(u&&-1!==this.options.unpairedTags.indexOf(u.tagname)&&(i=this.tagsNodeStack.pop(),n=n.substring(0,n.lastIndexOf("."))),a!==t.tagname&&(n+=n?"."+a:a),this.isItStopNode(this.options.stopNodes,n,a)){let t="";if(c.length>0&&c.lastIndexOf("/")===c.length-1)"/"===a[a.length-1]?(a=a.substr(0,a.length-1),n=n.substr(0,n.length-1),c=a):c=c.substr(0,c.length-1),r=o.closeIndex;else if(-1!==this.options.unpairedTags.indexOf(a))r=o.closeIndex;else{const i=this.readStopNodeData(e,l,d+1);if(!i)throw new Error(`Unexpected end of ${l}`);r=i.i,t=i.tagContent}const s=new la(a);a!==c&&h&&(s[":@"]=this.buildAttributesMap(c,n,a)),t&&(t=this.parseTextData(t,a,n,!0,h,!0,!0)),n=n.substr(0,n.lastIndexOf(".")),s.add(this.options.textNodeName,t),this.addChild(i,s,n)}else{if(c.length>0&&c.lastIndexOf("/")===c.length-1){"/"===a[a.length-1]?(a=a.substr(0,a.length-1),n=n.substr(0,n.length-1),c=a):c=c.substr(0,c.length-1),this.options.transformTagName&&(a=this.options.transformTagName(a));const e=new la(a);a!==c&&h&&(e[":@"]=this.buildAttributesMap(c,n,a)),this.addChild(i,e,n),n=n.substr(0,n.lastIndexOf("."))}else{const e=new la(a);this.tagsNodeStack.push(i),a!==c&&h&&(e[":@"]=this.buildAttributesMap(c,n,a)),this.addChild(i,e,n),i=e}s="",r=d}}else s+=e[r];return t.child};function Ea(e,t,i){const s=this.options.updateTag(t.tagname,i,t[":@"]);!1===s||("string"==typeof s&&(t.tagname=s),e.addChild(t))}const ga=function(e){if(this.options.processEntities){for(let t in this.docTypeEntities){const i=this.docTypeEntities[t];e=e.replace(i.regx,i.val)}for(let t in this.lastEntities){const i=this.lastEntities[t];e=e.replace(i.regex,i.val)}if(this.options.htmlEntities)for(let t in this.htmlEntities){const i=this.htmlEntities[t];e=e.replace(i.regex,i.val)}e=e.replace(this.ampEntity.regex,this.ampEntity.val)}return e};function Ca(e,t,i,s){return e&&(void 0===s&&(s=0===Object.keys(t.child).length),void 0!==(e=this.parseTextData(e,t.tagname,i,!1,!!t[":@"]&&0!==Object.keys(t[":@"]).length,s))&&""!==e&&t.add(this.options.textNodeName,e),e=""),e}function Ta(e,t,i){const s="*."+i;for(const i in e){const n=e[i];if(s===n||t===n)return!0}return!1}function Ra(e,t,i,s){const n=e.indexOf(t,i);if(-1===n)throw new Error(s);return n+t.length-1}function va(e,t,i,s=">"){const n=function(e,t,i=">"){let s,n="";for(let r=t;r<e.length;r++){let t=e[r];if(s)t===s&&(s="");else if('"'===t||"'"===t)s=t;else if(t===i[0]){if(!i[1])return{data:n,index:r};if(e[r+1]===i[1])return{data:n,index:r}}else"\t"===t&&(t=" ");n+=t}}(e,t+1,s);if(!n)return;let r=n.data;const o=n.index,a=r.search(/\s/);let l=r,c=!0;-1!==a&&(l=r.substring(0,a),r=r.substring(a+1).trimStart());const h=l;if(i){const e=l.indexOf(":");-1!==e&&(l=l.substr(e+1),c=l!==n.data.substr(e+1))}return{tagName:l,tagExp:r,closeIndex:o,attrExpPresent:c,rawTagName:h}}function Sa(e,t,i){const s=i;let n=1;for(;i<e.length;i++)if("<"===e[i])if("/"===e[i+1]){const r=Ra(e,">",i,`${t} is not closed`);if(e.substring(i+2,r).trim()===t&&(n--,0===n))return{tagContent:e.substring(s,i),i:r};i=r}else if("?"===e[i+1])i=Ra(e,"?>",i+1,"StopNode is not closed.");else if("!--"===e.substr(i+1,3))i=Ra(e,"--\x3e",i+3,"StopNode is not closed.");else if("!["===e.substr(i+1,2))i=Ra(e,"]]>",i,"StopNode is not closed.")-2;else{const s=va(e,i,">");s&&((s&&s.tagName)===t&&"/"!==s.tagExp[s.tagExp.length-1]&&n++,i=s.closeIndex)}}function ya(e,t,i){if(t&&"string"==typeof e){const t=e.trim();return"true"===t||"false"!==t&&ha(e,i)}return aa.isExist(e)?e:""}var wa=class{constructor(e){this.options=e,this.currentNode=null,this.tagsNodeStack=[],this.docTypeEntities={},this.lastEntities={apos:{regex:/&(apos|#39|#x27);/g,val:"'"},gt:{regex:/&(gt|#62|#x3E);/g,val:">"},lt:{regex:/&(lt|#60|#x3C);/g,val:"<"},quot:{regex:/&(quot|#34|#x22);/g,val:'"'}},this.ampEntity={regex:/&(amp|#38|#x26);/g,val:"&"},this.htmlEntities={space:{regex:/&(nbsp|#160);/g,val:" "},cent:{regex:/&(cent|#162);/g,val:"¢"},pound:{regex:/&(pound|#163);/g,val:"£"},yen:{regex:/&(yen|#165);/g,val:"¥"},euro:{regex:/&(euro|#8364);/g,val:"€"},copyright:{regex:/&(copy|#169);/g,val:"©"},reg:{regex:/&(reg|#174);/g,val:"®"},inr:{regex:/&(inr|#8377);/g,val:"₹"},num_dec:{regex:/&#([0-9]{1,7});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,10))},num_hex:{regex:/&#x([0-9a-fA-F]{1,6});/g,val:(e,t)=>String.fromCharCode(Number.parseInt(t,16))}},this.addExternalEntities=da,this.parseXml=Ia,this.parseTextData=ua,this.resolveNameSpace=fa,this.buildAttributesMap=ma,this.isItStopNode=Ta,this.replaceEntitiesValue=ga,this.readStopNodeData=Sa,this.saveTextToParentTag=Ca,this.addChild=Ea}},Aa={};function Fa(e,t,i){let s;const n={};for(let r=0;r<e.length;r++){const o=e[r],a=Oa(o);let l="";if(l=void 0===i?a:i+"."+a,a===t.textNodeName)void 0===s?s=o[a]:s+=""+o[a];else{if(void 0===a)continue;if(o[a]){let e=Fa(o[a],t,l);const i=Pa(e,t);o[":@"]?Na(e,o[":@"],l,t):1!==Object.keys(e).length||void 0===e[t.textNodeName]||t.alwaysCreateTextNode?0===Object.keys(e).length&&(t.alwaysCreateTextNode?e[t.textNodeName]="":e=""):e=e[t.textNodeName],void 0!==n[a]&&n.hasOwnProperty(a)?(Array.isArray(n[a])||(n[a]=[n[a]]),n[a].push(e)):t.isArray(a,l,i)?n[a]=[e]:n[a]=e}}}return"string"==typeof s?s.length>0&&(n[t.textNodeName]=s):void 0!==s&&(n[t.textNodeName]=s),n}function Oa(e){const t=Object.keys(e);for(let e=0;e<t.length;e++){const i=t[e];if(":@"!==i)return i}}function Na(e,t,i,s){if(t){const n=Object.keys(t),r=n.length;for(let o=0;o<r;o++){const r=n[o];s.isArray(r,i+"."+r,!0,!0)?e[r]=[t[r]]:e[r]=t[r]}}}function Pa(e,t){const{textNodeName:i}=t,s=Object.keys(e).length;return!(0!==s&&(1!==s||!e[i]&&"boolean"!=typeof e[i]&&0!==e[i]))}Aa.prettify=function(e,t){return Fa(e,t)};const{buildOptions:xa}=Zo,La=wa,{prettify:ba}=Aa,Ma=No;var Da=class{constructor(e){this.externalEntities={},this.options=xa(e)}parse(e,t){if("string"!=typeof e){if(!e.toString)throw new Error("XML data is accepted in String or Bytes[] form.");e=e.toString()}if(t){!0===t&&(t={});const i=Ma.validate(e,t);if(!0!==i)throw Error(`${i.err.msg}:${i.err.line}:${i.err.col}`)}const i=new La(this.options);i.addExternalEntities(this.externalEntities);const s=i.parseXml(e);return this.options.preserveOrder||void 0===s?s:ba(s,this.options)}addEntity(e,t){if(-1!==t.indexOf("&"))throw new Error("Entity value can't have '&'");if(-1!==e.indexOf("&")||-1!==e.indexOf(";"))throw new Error("An entity must be set without '&' and ';'. Eg. use '#xD' for '&#xD;'");if("&"===t)throw new Error("An entity with value '&' is not permitted");this.externalEntities[e]=t}};function _a(e,t,i,s){let n="",r=!1;for(let o=0;o<e.length;o++){const a=e[o],l=Ua(a);if(void 0===l)continue;let c="";if(c=0===i.length?l:`${i}.${l}`,l===t.textNodeName){let e=a[l];Va(c,t)||(e=t.tagValueProcessor(l,e),e=za(e,t)),r&&(n+=s),n+=e,r=!1;continue}if(l===t.cdataPropName){r&&(n+=s),n+=`<![CDATA[${a[l][0][t.textNodeName]}]]>`,r=!1;continue}if(l===t.commentPropName){n+=s+`\x3c!--${a[l][0][t.textNodeName]}--\x3e`,r=!0;continue}if("?"===l[0]){const e=Ba(a[":@"],t),i="?xml"===l?"":s;let o=a[l][0][t.textNodeName];o=0!==o.length?" "+o:"",n+=i+`<${l}${o}${e}?>`,r=!0;continue}let h=s;""!==h&&(h+=t.indentBy);const d=s+`<${l}${Ba(a[":@"],t)}`,u=_a(a[l],t,c,h);-1!==t.unpairedTags.indexOf(l)?t.suppressUnpairedNode?n+=d+">":n+=d+"/>":u&&0!==u.length||!t.suppressEmptyNode?u&&u.endsWith(">")?n+=d+`>${u}${s}</${l}>`:(n+=d+">",u&&""!==s&&(u.includes("/>")||u.includes("</"))?n+=s+t.indentBy+u+s:n+=u,n+=`</${l}>`):n+=d+"/>",r=!0}return n}function Ua(e){const t=Object.keys(e);for(let i=0;i<t.length;i++){const s=t[i];if(e.hasOwnProperty(s)&&":@"!==s)return s}}function Ba(e,t){let i="";if(e&&!t.ignoreAttributes)for(let s in e){if(!e.hasOwnProperty(s))continue;let n=t.attributeValueProcessor(s,e[s]);n=za(n,t),!0===n&&t.suppressBooleanAttributes?i+=` ${s.substr(t.attributeNamePrefix.length)}`:i+=` ${s.substr(t.attributeNamePrefix.length)}="${n}"`}return i}function Va(e,t){let i=(e=e.substr(0,e.length-t.textNodeName.length-1)).substr(e.lastIndexOf(".")+1);for(let s in t.stopNodes)if(t.stopNodes[s]===e||t.stopNodes[s]==="*."+i)return!0;return!1}function za(e,t){if(e&&e.length>0&&t.processEntities)for(let i=0;i<t.entities.length;i++){const s=t.entities[i];e=e.replace(s.regex,s.val)}return e}const ka=function(e,t){let i="";return t.format&&t.indentBy.length>0&&(i="\n"),_a(e,t,"",i)},Ya={attributeNamePrefix:"@_",attributesGroupName:!1,textNodeName:"#text",ignoreAttributes:!0,cdataPropName:!1,format:!1,indentBy:"  ",suppressEmptyNode:!1,suppressUnpairedNode:!0,suppressBooleanAttributes:!0,tagValueProcessor:function(e,t){return t},attributeValueProcessor:function(e,t){return t},preserveOrder:!1,commentPropName:!1,unpairedTags:[],entities:[{regex:new RegExp("&","g"),val:"&amp;"},{regex:new RegExp(">","g"),val:"&gt;"},{regex:new RegExp("<","g"),val:"&lt;"},{regex:new RegExp("'","g"),val:"&apos;"},{regex:new RegExp('"',"g"),val:"&quot;"}],processEntities:!0,stopNodes:[],oneListGroup:!1};function Ga(e){this.options=Object.assign({},Ya,e),this.options.ignoreAttributes||this.options.attributesGroupName?this.isAttribute=function(){return!1}:(this.attrPrefixLen=this.options.attributeNamePrefix.length,this.isAttribute=Xa),this.processTextOrObjNode=Ha,this.options.format?(this.indentate=Wa,this.tagEndChar=">\n",this.newLine="\n"):(this.indentate=function(){return""},this.tagEndChar=">",this.newLine="")}function Ha(e,t,i){const s=this.j2x(e,i+1);return void 0!==e[this.options.textNodeName]&&1===Object.keys(e).length?this.buildTextValNode(e[this.options.textNodeName],t,s.attrStr,i):this.buildObjectNode(s.val,t,s.attrStr,i)}function Wa(e){return this.options.indentBy.repeat(e)}function Xa(e){return!(!e.startsWith(this.options.attributeNamePrefix)||e===this.options.textNodeName)&&e.substr(this.attrPrefixLen)}Ga.prototype.build=function(e){return this.options.preserveOrder?ka(e,this.options):(Array.isArray(e)&&this.options.arrayNodeName&&this.options.arrayNodeName.length>1&&(e={[this.options.arrayNodeName]:e}),this.j2x(e,0).val)},Ga.prototype.j2x=function(e,t){let i="",s="";for(let n in e)if(Object.prototype.hasOwnProperty.call(e,n))if(typeof e[n]>"u")this.isAttribute(n)&&(s+="");else if(null===e[n])this.isAttribute(n)?s+="":"?"===n[0]?s+=this.indentate(t)+"<"+n+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+n+"/"+this.tagEndChar;else if(e[n]instanceof Date)s+=this.buildTextValNode(e[n],n,"",t);else if("object"!=typeof e[n]){const r=this.isAttribute(n);if(r)i+=this.buildAttrPairStr(r,""+e[n]);else if(n===this.options.textNodeName){let t=this.options.tagValueProcessor(n,""+e[n]);s+=this.replaceEntitiesValue(t)}else s+=this.buildTextValNode(e[n],n,"",t)}else if(Array.isArray(e[n])){const i=e[n].length;let r="",o="";for(let a=0;a<i;a++){const i=e[n][a];if(!(typeof i>"u"))if(null===i)"?"===n[0]?s+=this.indentate(t)+"<"+n+"?"+this.tagEndChar:s+=this.indentate(t)+"<"+n+"/"+this.tagEndChar;else if("object"==typeof i)if(this.options.oneListGroup){const e=this.j2x(i,t+1);r+=e.val,this.options.attributesGroupName&&i.hasOwnProperty(this.options.attributesGroupName)&&(o+=e.attrStr)}else r+=this.processTextOrObjNode(i,n,t);else if(this.options.oneListGroup){let e=this.options.tagValueProcessor(n,i);e=this.replaceEntitiesValue(e),r+=e}else r+=this.buildTextValNode(i,n,"",t)}this.options.oneListGroup&&(r=this.buildObjectNode(r,n,o,t)),s+=r}else if(this.options.attributesGroupName&&n===this.options.attributesGroupName){const t=Object.keys(e[n]),s=t.length;for(let r=0;r<s;r++)i+=this.buildAttrPairStr(t[r],""+e[n][t[r]])}else s+=this.processTextOrObjNode(e[n],n,t);return{attrStr:i,val:s}},Ga.prototype.buildAttrPairStr=function(e,t){return t=this.options.attributeValueProcessor(e,""+t),t=this.replaceEntitiesValue(t),this.options.suppressBooleanAttributes&&"true"===t?" "+e:" "+e+'="'+t+'"'},Ga.prototype.buildObjectNode=function(e,t,i,s){if(""===e)return"?"===t[0]?this.indentate(s)+"<"+t+i+"?"+this.tagEndChar:this.indentate(s)+"<"+t+i+this.closeTag(t)+this.tagEndChar;{let n="</"+t+this.tagEndChar,r="";return"?"===t[0]&&(r="?",n=""),!i&&""!==i||-1!==e.indexOf("<")?!1!==this.options.commentPropName&&t===this.options.commentPropName&&0===r.length?this.indentate(s)+`\x3c!--${e}--\x3e`+this.newLine:this.indentate(s)+"<"+t+i+r+this.tagEndChar+e+this.indentate(s)+n:this.indentate(s)+"<"+t+i+r+">"+e+n}},Ga.prototype.closeTag=function(e){let t="";return-1!==this.options.unpairedTags.indexOf(e)?this.options.suppressUnpairedNode||(t="/"):t=this.options.suppressEmptyNode?"/":`></${e}`,t},Ga.prototype.buildTextValNode=function(e,t,i,s){if(!1!==this.options.cdataPropName&&t===this.options.cdataPropName)return this.indentate(s)+`<![CDATA[${e}]]>`+this.newLine;if(!1!==this.options.commentPropName&&t===this.options.commentPropName)return this.indentate(s)+`\x3c!--${e}--\x3e`+this.newLine;if("?"===t[0])return this.indentate(s)+"<"+t+i+"?"+this.tagEndChar;{let n=this.options.tagValueProcessor(t,e);return n=this.replaceEntitiesValue(n),""===n?this.indentate(s)+"<"+t+i+this.closeTag(t)+this.tagEndChar:this.indentate(s)+"<"+t+i+">"+n+"</"+t+this.tagEndChar}},Ga.prototype.replaceEntitiesValue=function(e){if(e&&e.length>0&&this.options.processEntities)for(let t=0;t<this.options.entities.length;t++){const i=this.options.entities[t];e=e.replace(i.regex,i.val)}return e};var Za={XMLParser:Da,XMLValidator:No,XMLBuilder:Ga};class ja{constructor(e,t){ue(this,"date",new Date),ue(this,"author"),ue(this,"guid",Is.create()),ue(this,"viewpoint"),ue(this,"modifiedAuthor"),ue(this,"modifiedDate"),ue(this,"topic"),ue(this,"_components"),ue(this,"_comment",""),this._components=e,this._comment=t;const i=this._components.get($a);this.author=i.config.author}set comment(e){var t;const i=this._components.get($a);this._comment=e,this.modifiedDate=new Date,this.modifiedAuthor=i.config.author,null==(t=this.topic)||t.comments.set(this.guid,this)}get comment(){return this._comment}serialize(){let e=null;this.viewpoint&&(e=`<Viewpoint Guid="${this.viewpoint.guid}"/>`);let t=null;this.modifiedDate&&(t=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let i=null;return this.modifiedAuthor&&(i=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`),`\n      <Comment Guid="${this.guid}">\n        <Date>${this.date.toISOString()}</Date>\n        <Author>${this.author}</Author>\n        <Comment>${this.comment}</Comment>\n        ${e??""}\n        ${i??""}\n        ${t??""}\n      </Comment>\n    `}}const Ka=class e{constructor(t){ue(this,"guid",Is.create()),ue(this,"title",e.default.title),ue(this,"creationDate",new Date),ue(this,"creationAuthor",""),ue(this,"viewpoints",new Zi),ue(this,"relatedTopics",new Zi),ue(this,"comments",new ji),ue(this,"customData",{}),ue(this,"description"),ue(this,"serverAssignedId"),ue(this,"dueDate"),ue(this,"modifiedAuthor"),ue(this,"modifiedDate"),ue(this,"index"),ue(this,"_type",e.default.type),ue(this,"_status",e.default.status),ue(this,"_priority",e.default.priority),ue(this,"_stage",e.default.stage),ue(this,"_assignedTo",e.default.assignedTo),ue(this,"_labels",e.default.labels??new Set),ue(this,"_components"),this._components=t;const i=t.get($a);this.creationAuthor=i.config.author,this.relatedTopics.guard=e=>e!==this.guid}set type(e){const t=this._components.get($a),{strict:i,types:s}=t.config;(!i||s.has(e))&&(this._type=e)}get type(){return this._type}set status(e){const t=this._components.get($a),{strict:i,statuses:s}=t.config;(!i||s.has(e))&&(this._status=e)}get status(){return this._status}set priority(e){const t=this._components.get($a);if(e){const{strict:i,priorities:s}=t.config;if(i&&!s.has(e))return;this._priority=e}else this._priority=e}get priority(){return this._priority}set stage(e){const t=this._components.get($a);if(e){const{strict:i,stages:s}=t.config;if(i&&!s.has(e))return;this._stage=e}else this._stage=e}get stage(){return this._stage}set assignedTo(e){const t=this._components.get($a);if(e){const{strict:i,users:s}=t.config;if(i&&!s.has(e))return;this._assignedTo=e}else this._assignedTo=e}get assignedTo(){return this._assignedTo}set labels(e){const t=this._components.get($a),{strict:i,labels:s}=t.config;if(i){const t=new Set;for(const n of e)(!i||s.has(n))&&t.add(n);this._labels=t}else this._labels=e}get labels(){return this._labels}get _managerVersion(){return this._components.get($a).config.version}set(e){const t=e,i=this;for(const s in e){if("guid"===s)continue;const e=t[s];s in this&&(i[s]=e)}return this._components.get($a).list.set(this.guid,this),this}createComment(e,t){const i=new ja(this._components,e);return i.viewpoint=t,i.topic=this,this.comments.set(i.guid,i),i}createLabelTags(e=this._managerVersion){let t="Labels";"2.1"===e&&(t="Labels"),"3"===e&&(t="Label");let i=[...this.labels].map((e=>`<${t}>${e}</${t}>`)).join("\n");for(const e in this.customData){const s=this.customData[e];"string"==typeof s&&(i+=`\n<${t}>${s}</${t}>`)}return"2.1"===e?i:"3"===e?0!==i.length?`<Labels>\n${i}\n</Labels>`:"<Labels/>":i}createCommentTags(e=this._managerVersion){const t=[...this.comments.values()].map((e=>e.serialize())).join("\n");return"2.1"===e?t:"3"===e?0!==t.length?`<Comments>\n${t}\n</Comments>`:"<Comments/>":t}createViewpointTags(e=this._managerVersion){let t="Viewpoints";"2.1"===e&&(t="Viewpoints"),"3"===e&&(t="ViewPoint");const i=this._components.get(gl),s=[...this.viewpoints].map((e=>i.list.get(e))).filter((e=>e)).map((e=>`<${t} Guid="${e.guid}">\n          <Viewpoint>${e.guid}.bcfv</Viewpoint>\n          <Snapshot>${e.guid}.jpeg</Snapshot>\n        </${t}>\n      `)).join("\n");return"2.1"===e?s:"3"===e?0!==s.length?`<Viewpoints>\n${s}\n</Viewpoints>`:"<Viewpoints />":s}createRelatedTopicTags(e=this._managerVersion){const t=[...this.relatedTopics].map((e=>`<RelatedTopic Guid="${e}"></RelatedTopic>\n      `)).join("\n");return"2.1"===e?t:"3"===e?0!==t.length?`<RelatedTopics>\n${t}\n</RelatedTopics>`:"<RelatedTopics />":t}serialize(){const e=this._managerVersion;let t=null;this.serverAssignedId&&(t=`ServerAssignedId="${this.serverAssignedId}"`);let i=null;this.priority&&(i=`<Priority>${this.priority}</Priority>`);let s=null;this.index&&"2.1"===e&&(s=`<Index>${this.index}</Index>`);let n=null;this.modifiedDate&&(n=`<ModifiedDate>${this.modifiedDate.toISOString()}</ModifiedDate>`);let r=null;this.modifiedAuthor&&(r=`<ModifiedAuthor>${this.modifiedAuthor}</ModifiedAuthor>`);let o=null;this.dueDate&&(o=`<DueDate>${this.dueDate.toISOString()}</DueDate>`);let a=null;this.assignedTo&&(a=`<AssignedTo>${this.assignedTo}</AssignedTo>`);let l=null;this.description&&(l=`<Description>${this.description}</Description>`);let c=null;this.stage&&(c=`<Stage>${this.stage}</Stage>`);const h=this.createCommentTags(e),d=this.createViewpointTags(e),u=this.createLabelTags(e),f=this.createRelatedTopicTags(e);return`\n      <?xml version="1.0" encoding="UTF-8"?>\n      <Markup>\n        <Topic Guid="${this.guid}" TopicType="${this.type}" TopicStatus="${this.status}" ${t??""}>\n          <Title>${this.title}</Title>\n          <CreationDate>${this.creationDate.toISOString()}</CreationDate>\n          <CreationAuthor>${this.creationAuthor}</CreationAuthor>\n          ${i??""}\n          ${s??""}\n          ${n??""}\n          ${r??""}\n          ${o??""}\n          ${a??""}\n          ${l??""}\n          ${c??""}\n          ${u}\n          ${f}\n          ${"3"===e?h:""}\n          ${"3"===e?d:""}\n        </Topic>\n        ${"2.1"===e?h:""}\n        ${"2.1"===e?d:""}\n      </Markup>\n    `}};ue(Ka,"default",{title:"BCF Topic",type:"Issue",status:"Active"});let Qa=Ka;class qa extends qs{constructor(){super(...arguments),ue(this,"_config",{version:{type:"Select",options:new Set(["2.1","3"]),multiple:!1,value:""},author:{type:"Text",value:""},types:{type:"TextSet",value:new Set},statuses:{type:"TextSet",value:new Set},priorities:{type:"TextSet",value:new Set},labels:{type:"TextSet",value:new Set},stages:{type:"TextSet",value:new Set},users:{type:"TextSet",value:new Set},includeSelectionTag:{type:"Boolean",value:!1},updateExtensionsOnImport:{type:"Boolean",value:!1},strict:{type:"Boolean",value:!1},includeAllExtensionsOnExport:{type:"Boolean",value:!1},fallbackVersionOnImport:{type:"Select",multiple:!1,options:new Set(["2.1","3"]),value:""},ignoreIncompleteTopicsOnImport:{type:"Boolean",value:!1}})}get version(){return this._config.version.value}set version(e){this._config.version.value=e}get author(){return this._config.author.value}set author(e){this._config.author.value=e}get types(){return this._config.types.value}set types(e){this._config.types.value=e}get statuses(){return this._config.statuses.value}set statuses(e){this._config.statuses.value=e}get priorities(){return this._config.priorities.value}set priorities(e){this._config.priorities.value=e}get labels(){return this._config.labels.value}set labels(e){this._config.labels.value=e}get stages(){return this._config.stages.value}set stages(e){this._config.stages.value=e}get users(){return this._config.users.value}set users(e){this._config.users.value=e}get includeSelectionTag(){return this._config.includeSelectionTag.value}set includeSelectionTag(e){this._config.includeSelectionTag.value=e}get updateExtensionsOnImport(){return this._config.updateExtensionsOnImport.value}set updateExtensionsOnImport(e){this._config.updateExtensionsOnImport.value=e}get strict(){return this._config.strict.value}set strict(e){this._config.strict.value=e}get includeAllExtensionsOnExport(){return this._config.includeAllExtensionsOnExport.value}set includeAllExtensionsOnExport(e){this._config.includeAllExtensionsOnExport.value=e}get fallbackVersionOnImport(){return this._config.fallbackVersionOnImport.value}set fallbackVersionOnImport(e){this._config.fallbackVersionOnImport.value=e}get ignoreIncompleteTopicsOnImport(){return this._config.ignoreIncompleteTopicsOnImport.value}set ignoreIncompleteTopicsOnImport(e){this._config.ignoreIncompleteTopicsOnImport.value=e}}const Ja=class e extends ki{constructor(){super(...arguments),ue(this,"enabled",!1),ue(this,"_defaultConfig",{author:"jhon.doe@example.com",version:"2.1",types:new Set(["Clash","Failure","Fault","Inquiry","Issue","Remark","Request"]),statuses:new Set(["Active","In Progress","Done","In Review","Closed"]),priorities:new Set(["On hold","Minor","Normal","Major","Critical"]),labels:new Set,stages:new Set,users:new Set,includeSelectionTag:!1,updateExtensionsOnImport:!0,strict:!1,includeAllExtensionsOnExport:!0,fallbackVersionOnImport:"2.1",ignoreIncompleteTopicsOnImport:!1}),ue(this,"config",new qa(this,this.components,"BCF Topics",e.uuid)),ue(this,"list",new ji),ue(this,"onSetup",new Bi),ue(this,"isSetup",!1),ue(this,"onBCFImported",new Bi),ue(this,"onDisposed",new Bi)}setup(e){if(this.isSetup)return;const t={...this._defaultConfig,...e};this.config.version=t.version,this.config.author=t.author,this.config.types=t.types,this.config.statuses=t.statuses,this.config.priorities=t.priorities,this.config.labels=t.labels,this.config.stages=t.stages,this.config.users=t.users,this.config.includeSelectionTag=t.includeSelectionTag,this.config.updateExtensionsOnImport=t.updateExtensionsOnImport,this.config.strict=t.strict,this.config.includeAllExtensionsOnExport=t.includeAllExtensionsOnExport,this.config.fallbackVersionOnImport=t.fallbackVersionOnImport||"",this.config.ignoreIncompleteTopicsOnImport=t.ignoreIncompleteTopicsOnImport,this.isSetup=!0,this.enabled=!0,this.onSetup.trigger()}create(e){const t=new Qa(this.components);return e?(t.guid=e.guid??t.guid,t.set(e)):this.list.set(t.guid,t),t}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get usedTypes(){const e=[...this.list].map((([e,t])=>t.type));return new Set(e)}get usedStatuses(){const e=[...this.list].map((([e,t])=>t.status));return new Set(e)}get usedPriorities(){const e=[...this.list].map((([e,t])=>t.priority)).filter((e=>e));return new Set(e)}get usedStages(){const e=[...this.list].map((([e,t])=>t.stage)).filter((e=>e));return new Set(e)}get usedUsers(){const e=[];for(const[t,i]of this.list){e.push(i.creationAuthor),i.assignedTo&&e.push(i.assignedTo),i.modifiedAuthor&&e.push(i.modifiedAuthor);for(const[t,s]of i.comments)e.push(s.author),s.modifiedAuthor&&e.push(s.modifiedAuthor)}return new Set(e)}get usedLabels(){const e=[];for(const[t,i]of this.list)e.push(...i.labels);return new Set(e)}updateExtensions(){for(const[e,t]of this.list){for(const e of t.labels)this.config.labels.add(e);this.config.types.add(t.type),t.priority&&this.config.priorities.add(t.priority),t.stage&&this.config.stages.add(t.stage),this.config.statuses.add(t.status),this.config.users.add(t.creationAuthor),t.assignedTo&&this.config.users.add(t.assignedTo),t.modifiedAuthor&&this.config.users.add(t.modifiedAuthor);for(const[e,i]of t.comments)this.config.users.add(i.author),i.modifiedAuthor&&this.config.users.add(i.modifiedAuthor)}}updateViewpointReferences(){const e=this.components.get(gl);for(const[t,i]of this.list)for(const t of i.viewpoints)e.list.has(t)||i.viewpoints.delete(t)}async export(e=this.list.values()){const t=new Oo;t.file("bcf.version",`<?xml version="1.0" encoding="UTF-8"?>\n    <Version VersionId="${this.config.version}" xsi:noNamespaceSchemaLocation="https://raw.githubusercontent.com/buildingSMART/BCF-XML/release_3_0/Schemas/version.xsd"\n    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">\n    </Version>`),t.file("bcf.extensions",this.serializeExtensions());const i=await(await fetch("https://thatopen.github.io/engine_components/resources/favicon.ico")).arrayBuffer(),s=this.components.get(gl);for(const n of e){const e=t.folder(n.guid);e.file("markup.bcf",n.serialize());for(const t of n.viewpoints){const n=s.list.get(t);n&&(e.file(`${t}.jpeg`,i,{binary:!0}),e.file(`${t}.bcfv`,await n.serialize()))}}return await t.generateAsync({type:"blob"})}serializeExtensions(){const e=[...this.config.types].map((e=>`<TopicType>${e}</TopicType>`)).join("\n"),t=[...this.config.statuses].map((e=>`<TopicStatus>${e}</TopicStatus>`)).join("\n"),i=[...this.config.priorities].map((e=>`<Priority>${e}</Priority>`)).join("\n"),s=[...this.config.labels].map((e=>`<TopicLabel>${e}</TopicLabel>`)).join("\n"),n=[...this.config.stages].map((e=>`<Stage>${e}</Stage>`)).join("\n"),r=[...this.config.users].map((e=>`<User>${e}</User>`)).join("\n");return`\n      <?xml version="1.0" encoding="UTF-8"?>\n      <Extensions xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:noNamespaceSchemaLocation="your-schema-location.xsd">\n        ${0!==e.length?`<TopicTypes>\n${e}\n</TopicTypes>`:""}\n        ${0!==t.length?`<TopicStatuses>\n${t}\n</TopicStatuses>`:""}\n        ${0!==i.length?`<Priorities>\n${i}\n</Priorities>`:""}\n        ${0!==s.length?`<TopicLabels>\n${s}\n</TopicLabels>`:""}\n        ${0!==n.length?`<Stages>\n${n}\n</Stages>`:""}\n        ${0!==r.length?`<Users>\n${r}\n</Users>`:""}\n      </Extensions>\n    `}processMarkupComment(e){const{Guid:t,Date:i,Author:s,Comment:n,Viewpoint:r}=e;if(!(t&&i&&s&&ja))return null;const o=this.components.get(gl),a=new ja(this.components,n??"");return a.guid=t,a.date=new Date(i),a.author=s,a.viewpoint=null!=r&&r.Guid?o.list.get(r.Guid):void 0,a.modifiedAuthor=e.ModifiedAuthor,a.modifiedDate=e.ModifiedDate?new Date(e.ModifiedDate):void 0,a}getMarkupComments(e,t){var i;let s;if("2.1"===t&&(s=e.Comment),"3"===t&&(s=null==(i=e.Topic.Comments)?void 0:i.Comment),!s)return[];s=Array.isArray(s)?s:[s];const n=s.map((e=>this.processMarkupComment(e))).filter((e=>e));return Array.isArray(n)?n:[n]}getMarkupLabels(e,t){var i;let s;return"2.1"===t&&(s=e.Topic.Labels),"3"===t&&(s=null==(i=e.Topic.Labels)?void 0:i.Label),s?Array.isArray(s)?s:[s]:[]}getMarkupViewpoints(e,t){var i;let s;return"2.1"===t&&(s=e.Viewpoints),"3"===t&&(s=null==(i=e.Topic.Viewpoints)?void 0:i.ViewPoint),s?(s=Array.isArray(s)?s:[s],s):[]}getMarkupRelatedTopics(e,t){var i;let s;return"2.1"===t&&(s=e.Topic.RelatedTopic),"3"===t&&(s=null==(i=e.Topic.RelatedTopics)?void 0:i.RelatedTopic),s?(Array.isArray(s)?s:[s]).map((e=>e.Guid)):[]}async load(t,s){var n;const{fallbackVersionOnImport:r,ignoreIncompleteTopicsOnImport:o,updateExtensionsOnImport:a}=this.config,l=new Oo;await l.loadAsync(t);const c=Object.values(l.files);let h=r;const d=c.find((e=>e.name.endsWith(".version")));if(d){const t=await d.async("string"),i=e.xmlParser.parse(t).Version.VersionId;h=String(i)}if(!h||"2.1"!==h&&"3"!==h)throw new Error(`BCFTopics: ${h} is not supported.`);const u=c.find((e=>e.name.endsWith(".extensions")));if(a&&u){((e,t)=>{if(""===t.trim())return;const i=$a.xmlParser.parse(t).Extensions;if(!i)return;const{Priorities:s,TopicStatuses:n,TopicTypes:r,Users:o}=i;if(s&&s.Priority){const t=Array.isArray(s.Priority)?s.Priority:[s.Priority];for(const i of t)e.config.priorities.add(i)}if(n&&n.TopicStatus){const t=Array.isArray(n.TopicStatus)?n.TopicStatus:[n.TopicStatus];for(const i of t)e.config.statuses.add(i)}if(r&&r.TopicType){const t=Array.isArray(r.TopicType)?r.TopicType:[r.TopicType];for(const i of t)e.config.types.add(i)}if(o&&o.User){const t=Array.isArray(o.User)?o.User:[o.User];for(const i of t)e.config.users.add(i)}})(this,await u.async("string"))}const f=[],p=this.components.get(gl),m=c.filter((e=>e.name.endsWith(".bcfv")));for(const t of m){const r=await t.async("string"),o=e.xmlParser.parse(r).VisualizationInfo;if(!o){console.warn("Missing VisualizationInfo in Viewpoint");continue}const a={},{Guid:l,ClippingPlanes:c,Components:d,OrthogonalCamera:u,PerspectiveCamera:p}=o;if(l&&(a.guid=l),d){const{Selection:e,Visibility:t}=d;if(e&&e.Component){const t=Array.isArray(e.Component)?e.Component:[e.Component];a.selectionComponents=t.map((e=>e.IfcGuid)).filter((e=>e))}if(t&&"DefaultVisibility"in t&&(a.defaultVisibility=t.DefaultVisibility),t&&t.Exceptions&&"Component"in t.Exceptions){const{Component:e}=t.Exceptions,i=Array.isArray(e)?e:[e];a.exceptionComponents=i.map((e=>e.IfcGuid)).filter((e=>e))}let i;"2.1"===h&&(i=d.ViewSetupHints),"3"===h&&(i=null==(n=d.Visibility)?void 0:n.ViewSetupHints),i&&("OpeningsVisible"in i&&(a.openingsVisible=i.OpeningsVisible),"SpacesVisible"in i&&(a.spacesVisible=i.SpacesVisible),"SpaceBoundariesVisible"in i&&(a.spaceBoundariesVisible=i.SpaceBoundariesVisible))}if(u||p){const e=o.PerspectiveCamera??o.OrthogonalCamera,{CameraViewPoint:t,CameraDirection:s}=e,n=new i.Vector3(Number(t.X),Number(t.Z),Number(-t.Y)),r=new i.Vector3(Number(s.X),Number(s.Z),Number(-s.Y)),l={position:{x:n.x,y:n.y,z:n.z},direction:{x:r.x,y:r.y,z:r.z},aspectRatio:"AspectRatio"in e?e.AspectRatio:1};"ViewToWorldScale"in e&&(a.camera={...l,viewToWorldScale:e.ViewToWorldScale}),"FieldOfView"in e&&(a.camera={...l,fov:e.FieldOfView})}const m=new ml(this.components,s,{data:a,setCamera:!1});if(d){const{Coloring:e}=d;if(e&&e.Color){const t=Array.isArray(e.Color)?e.Color:[e.Color];for(const e of t){const{Color:t,Component:i}=e,s=(Array.isArray(i)?i:[i]).map((e=>e.IfcGuid));m.componentColors.set(t,s)}}}if(f.push(m),c){const e=this.components.get(Qr),t=Array.isArray(c.ClippingPlane)?c.ClippingPlane:[c.ClippingPlane];for(const n of t){const{Location:t,Direction:r}=n;if(!t||!r)continue;const o=new i.Vector3(t.X,t.Z,-t.Y),a=new i.Vector3(r.X,-r.Z,r.Y),l=e.createFromNormalAndCoplanarPoint(s,a,o);l.visible=!1,l.enabled=!1,m.clippingPlanes.add(l)}}}const I={},E=[],g=c.filter((e=>e.name.endsWith(".bcf")));for(const t of g){const i=await t.async("string"),s=e.xmlParser.parse(i).Markup,n=s.Topic,{Guid:r,TopicType:a,TopicStatus:l,Title:c,CreationDate:d,CreationAuthor:u}=n;if(o&&!(r&&a&&l&&c&&d&&u))continue;const f=new Qa(this.components);f.guid=r??f.guid;const m=this.getMarkupRelatedTopics(s,h);I[f.guid]=new Set(m),f.type=a??f.type,f.status=l??f.status,f.title=c??f.title,f.creationDate=d?new Date(d):f.creationDate,f.creationAuthor=u??f.creationAuthor,f.serverAssignedId=n.ServerAssignedId,f.priority=n.Priority,f.index=n.Index,f.modifiedDate=n.ModifiedDate?new Date(n.ModifiedDate):void 0,f.modifiedAuthor=n.ModifiedAuthor,f.dueDate=n.DueDate?new Date(n.DueDate):void 0,f.assignedTo=n.AssignedTo,f.description=n.Description,f.stage=n.Stage;const g=this.getMarkupLabels(s,h);for(const e of g)f.labels.add(e);const C=this.getMarkupComments(s,h);for(const e of C)f.comments.set(e.guid,e);const T=this.getMarkupViewpoints(s,h);for(const e of T){if(!e||!e.Guid)continue;const t=p.list.get(e.Guid);t&&f.viewpoints.add(t.guid)}this.list.set(f.guid,f),E.push(f)}for(const e in I){const t=this.list.get(e);if(!t)continue;const i=I[e];for(const e of i)t.relatedTopics.add(e)}return this.onBCFImported.trigger(E),{viewpoints:f,topics:E}}};ue(Ja,"uuid","de977976-e4f6-4e4f-a01a-204727839802"),ue(Ja,"xmlParser",new Za.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let $a=Ja;const el=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),ue(this,"onDisposed",new Bi),ue(this,"_absoluteMin"),ue(this,"_absoluteMax"),ue(this,"_meshes",[]),this.components.add(e.uuid,this),this._absoluteMin=e.newBound(!0),this._absoluteMax=e.newBound(!1)}static getDimensions(e){const{min:t,max:s}=e,n=Math.abs(s.x-t.x),r=Math.abs(s.y-t.y),o=Math.abs(s.z-t.z),a=new i.Vector3;return a.subVectors(s,t).divideScalar(2).add(t),{width:n,height:r,depth:o,center:a}}static newBound(e){const t=e?1:-1;return new i.Vector3(t*Number.MAX_VALUE,t*Number.MAX_VALUE,t*Number.MAX_VALUE)}static getBounds(e,t,s){const n=s||this.newBound(!1),r=t||this.newBound(!0);for(const t of e)t.x<r.x&&(r.x=t.x),t.y<r.y&&(r.y=t.y),t.z<r.z&&(r.z=t.z),t.x>n.x&&(n.x=t.x),t.y>n.y&&(n.y=t.y),t.z>n.z&&(n.z=t.z);return new i.Box3(t,s)}dispose(){const t=this.components.get(Xi);for(const e of this._meshes)t.destroy(e);this._meshes=[],this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}get(){const e=this._absoluteMin.clone(),t=this._absoluteMax.clone();return new i.Box3(e,t)}getSphere(){const e=this._absoluteMin.clone(),t=this._absoluteMax.clone(),s=Math.abs((t.x-e.x)/2),n=Math.abs((t.y-e.y)/2),r=Math.abs((t.z-e.z)/2),o=new i.Vector3(e.x+s,e.y+n,e.z+r),a=o.distanceTo(e);return new i.Sphere(o,a)}getMesh(){const t=new i.Box3(this._absoluteMin,this._absoluteMax),s=e.getDimensions(t),{width:n,height:r,depth:o,center:a}=s,l=new i.BoxGeometry(n,r,o),c=new i.Mesh(l);return this._meshes.push(c),c.position.copy(a),c}reset(){this._absoluteMin=e.newBound(!0),this._absoluteMax=e.newBound(!1)}add(e){for(const t of e.items)this.addMesh(t.mesh)}addMesh(t,s){if(!t.geometry.index)return;const n=e.getFragmentBounds(t);t.updateMatrixWorld();const r=t.matrixWorld,o=new i.Matrix4,a=t instanceof i.InstancedMesh,l=new Set;if(t instanceof oe.FragmentMesh){s||(s=t.fragment.ids);for(const e of s){const i=t.fragment.getInstancesIDs(e);if(i)for(const e of i)l.add(e)}}else l.add(0);for(const e of l){const i=n.min.clone(),s=n.max.clone();a&&(t.getMatrixAt(e,o),i.applyMatrix4(o),s.applyMatrix4(o)),i.applyMatrix4(r),s.applyMatrix4(r),i.x<this._absoluteMin.x&&(this._absoluteMin.x=i.x),i.y<this._absoluteMin.y&&(this._absoluteMin.y=i.y),i.z<this._absoluteMin.z&&(this._absoluteMin.z=i.z),i.x>this._absoluteMax.x&&(this._absoluteMax.x=i.x),i.y>this._absoluteMax.y&&(this._absoluteMax.y=i.y),i.z>this._absoluteMax.z&&(this._absoluteMax.z=i.z),s.x>this._absoluteMax.x&&(this._absoluteMax.x=s.x),s.y>this._absoluteMax.y&&(this._absoluteMax.y=s.y),s.z>this._absoluteMax.z&&(this._absoluteMax.z=s.z),s.x<this._absoluteMin.x&&(this._absoluteMin.x=s.x),s.y<this._absoluteMin.y&&(this._absoluteMin.y=s.y),s.z<this._absoluteMin.z&&(this._absoluteMin.z=s.z)}}addFragmentIdMap(e){const t=this.components.get(wo);for(const i in e){const s=t.list.get(i);if(!s)continue;const n=e[i];this.addMesh(s.mesh,n)}}static getFragmentBounds(e){const t=e.geometry.attributes.position,s=Number.MAX_VALUE,n=-s,r=new i.Vector3(s,s,s),o=new i.Vector3(n,n,n);if(!e.geometry.index)throw new Error("Geometry must be indexed!");const a=Array.from(e.geometry.index.array);for(let e=0;e<a.length;e++){if(e%3==0&&0===a[e]&&0===a[e+1]&&0===a[e+2]){e+=2;continue}const i=a[e],s=t.getX(i),n=t.getY(i),l=t.getZ(i);s<r.x&&(r.x=s),n<r.y&&(r.y=n),l<r.z&&(r.z=l),s>o.x&&(o.x=s),n>o.y&&(o.y=n),l>o.z&&(o.z=l)}return new i.Box3(r,o)}};ue(el,"uuid","d1444724-dba6-4cdd-a0c7-68ee1450d166");let tl=el;ue(class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),t.add(e.uuid,this)}async getIsolatedElements(e,t,i){const s=new Set;function n(i){if(s.has(i))return;const r=e.GetLine(t,i);if(r){s.add(i);for(const e in r){const t=r[e];t&&"Handle"===t.constructor.name&&t.value>0?n(t.value):Array.isArray(t)&&t.forEach((e=>{e&&"Handle"===e.constructor.name&&e.value>0&&n(e.value)}))}}}for(const e of i)n(e);const r=[];for(const e of s)r.push(e);r.sort(((e,t)=>e-t));const o=[];return r.forEach((i=>{const s=e.GetLine(t,i);o.push(s)})),o}async export(e,t,i){return i.forEach((i=>{e.WriteLine(t,i)})),e.SaveModel(t)}async splitIfc(e,t,i){const s=new Uint8Array(t),n=e.OpenModel(s),r=await this.getIsolatedElements(e,n,i),o=e.CreateModel({schema:he.Schemas.IFC2X3});return await this.export(e,o,r)}},"uuid","6eb0ba2f-71c0-464e-bcec-2d7c335186b2");const il=class e{constructor(e){ue(this,"onProgress",new Bi),ue(this,"inclusive",!1),ue(this,"rules",[]),ue(this,"ids",{}),ue(this,"needsUpdate",new Map),ue(this,"components"),this.components=e}static import(t,i){const s=e.importers.get(i.type);return s?s(t,i):(console.warn("Invalid query data:.",i),null)}static importRules(e){const t=[];for(const i of e){const e={};for(const t in i){const s=i[t];s.regexp?e[t]=new RegExp(s.value):e[t]=s}t.push(e)}return t}static importIds(e){const t={};for(const i in e.ids)t[i]=new Set(e.ids[i]);return t}clear(e){if(void 0===e)return this.ids={},void this.needsUpdate.clear();delete this.ids[e],this.needsUpdate.delete(e)}addID(e,t){this.ids[e]||(this.ids[e]=new Set),this.ids[e].add(t)}getData(){const e={};for(const t in this.ids)e[t]=Array.from(this.ids[t]);const t=this.exportRules();return{name:this.name,inclusive:this.inclusive,type:"IfcFinderQuery",ids:e,rules:t}}exportRules(){const e=[];for(const t of this.rules){const i={};for(const e in t){const s=t[e];s instanceof RegExp?i[e]={regexp:!0,value:s.source}:i[e]=s}e.push(i)}return e}findInFile(e,t){return new Promise((i=>{const s=new FileReader,n=new TextDecoder("utf-8"),r=1024e4;let o=0;const a=/;/,l=()=>{if(o>=t.size)return void i();const e=Math.min(o+r+1e3,t.size),n=t.slice(o,e);s.readAsArrayBuffer(n)};s.onload=()=>{if(!(s.result instanceof ArrayBuffer))return;const i=new Uint8Array(s.result),c=n.decode(i).split(a);c.shift(),this.findInLines(e,c),this.onProgress.trigger(o/t.size),o+=r,l()},l()}))}getIdFromLine(e){const t=e.slice(e.indexOf("#")+1,e.indexOf("="));return parseInt(t,10)}testRules(e){let t=null,i=null,s=null,n=!1;for(const r of this.rules)if("category"!==r.type){if(null===i&&(i=this.getAttributesFromLine(e),null===i)){if(this.inclusive)continue;n=!1;break}if(null===t&&(t=this.getCategoryFromLine(e),null===t)){if(this.inclusive)continue;n=!1;break}if(null===s&&(s=Object.keys(new he.IFC4[t]),s=s.slice(2),null===s)){if(this.inclusive)continue;n=!1;break}if("property"===r.type){const{name:t,value:o}=r;if(!o.test(e)){if(this.inclusive)continue;n=!1;break}let a=!1;for(let e=0;e<i.length;e++){const n=i[e],r=s[e];if(o.test(n)&&t.test(r)){a=!0;break}}if(a)n=!0;else if(!this.inclusive){n=!1;break}}if("operator"===r.type){const{name:e,value:t,operator:o}=r;let a=!1;for(let n=0;n<i.length;n++){const r=s[n],l=i[n].replace(/IFCLENGTHMEASURE\(|IFCVOLUMEMEASURE\(|\)/g,"");if(e.test(r)){if("="===o&&parseFloat(l)===t){a=!0;break}if("<"===o&&parseFloat(l)<t){a=!0;break}if(">"===o&&parseFloat(l)>t){a=!0;break}if(">="===o&&parseFloat(l)>=t){a=!0;break}if("<="===o&&parseFloat(l)<=t){a=!0;break}}}if(a)n=!0;else if(!this.inclusive){n=!1;break}}}else{if(null===t&&(t=this.getCategoryFromLine(e),null===t)){if(this.inclusive)continue;break}if(!r.value.test(t)){if(this.inclusive)continue;n=!1;break}n=!0}return n}getCategoryFromLine(e){const t=e.indexOf("=")+1,i=e.indexOf("("),s=e.slice(t,i).trim();return ro[s]||null}getAttributesFromLine(e){const t=e.match(/\((.*)\)/);if(!t||!t[1])return null;return t[1].split(/,(?![^()]*\))/g).map((e=>e.trim()))}};ue(il,"importers",new Map);let sl=il;class nl{constructor(e){ue(this,"list",new Map),ue(this,"id",i.MathUtils.generateUUID()),ue(this,"mode","intersect"),ue(this,"_components"),this._components=e}get queries(){return new Set(this.list.values())}get items(){const e=[];for(const t of this.queries)e.push(t.items);return"combine"===this.mode?oe.FragmentUtils.combine(e):oe.FragmentUtils.intersect(e)}add(e){if(this.list.has(e.name))throw new Error(`This group already has a query with the name ${e.name}.`);this.list.set(e.name,e)}clear(e){for(const t of this.queries)t.clear(e)}import(e){this.mode=e.mode,this.id=e.id;for(const t in e.queries){const i=sl.import(this._components,e.queries[t]);i&&this.list.set(t,i)}}export(){const e={};for(const[t,i]of this.list)e[t]=i.export();return{mode:this.mode,id:this.id,queries:e}}async update(e,t){for(const i of this.queries){const s=i.needsUpdate.get(e);(void 0===s||s)&&await i.update(e,t)}}}const rl=class e extends sl{constructor(e,t){super(e),ue(this,"name"),this.name=t.name,this.rules=t.rules,this.inclusive=t.inclusive}get items(){const e=this.components.get(wo),t=[];for(const i in this.ids){const s=this.ids[i],n=e.groups.get(i);if(!n){console.warn(`Model ${i} not found!`);continue}const r=n.getFragmentMap(s);t.push(r)}return oe.FragmentUtils.combine(t)}export(){const t=this.getData();return t.type=e.type,t}async update(e,t){this.ids[e]=new Set,await this.findInFile(e,t),this.needsUpdate.set(e,!1)}findInLines(e,t){for(const i of t)if(this.testRules(i)){const t=this.getIdFromLine(i);this.addID(e,t)}}};ue(rl,"type","IfcBasicQuery");let ol=rl;sl.importers.set(ol.type,((e,t)=>{const i=new ol(e,{name:t.name,rules:sl.importRules(t.rules),inclusive:t.inclusive});return i.ids=sl.importIds(t),i}));const al=class e extends sl{constructor(e,t){super(e),ue(this,"name"),ue(this,"psets",[]),this.name=t.name,this.rules=t.rules,this.inclusive=t.inclusive}get items(){const e=this.components.get(So),t=this.components.get(wo),i=[];for(const s in this.ids){const n=t.groups.get(s);if(!n){console.log(`Model not found: ${s}.`);continue}const r=this.ids[s];for(const t of r){const r=e.getEntityRelations(s,t,"DefinesOcurrence");if(r){const e=n.getFragmentMap(r);i.push(e)}}}return oe.FragmentUtils.combine(i)}export(){const t=this.getData();return t.type=e.type,t}async update(e,t){await this.findInFile(e,t);const i=new Set;for(const t of this.psets){const s=this.getAttributesFromLine(t);if(null===s)continue;const n=s[4].replace("(","[").replace(")","]").replace(/#/g,""),r=JSON.parse(n);for(const s of r){const n=this.ids[e];if(n&&n.has(s)){const e=this.getIdFromLine(t);i.add(e);break}}}this.ids[e]=i,this.psets=[],this.needsUpdate.set(e,!1)}findInLines(e,t){for(const i of t){const t=this.getCategoryFromLine(i);if("IfcPropertySet"!==t){if("IfcPropertySingleValue"===t&&this.testRules(i)){const t=this.getIdFromLine(i);this.addID(e,t)}}else this.psets.push(i)}}};ue(al,"type","IfcPropertyQuery");let ll=al;sl.importers.set(ll.type,((e,t)=>{const i=new ll(e,{name:t.name,inclusive:t.inclusive,rules:sl.importRules(t.rules)});return i.ids=sl.importIds(t),i}));ue(class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),ue(this,"list",new Map),t.add(e.uuid,this)}get queries(){const e=new Set;for(const[,t]of this.list)for(const i of t.queries)e.add(i);return e}import(e){for(const t in e){const i=new nl(this.components);i.import(e[t]),this.list.set(t,i)}}export(){const e={};for(const[t,i]of this.list)e[t]=i.export();return e}create(){const e=new nl(this.components);return this.list.set(e.id,e),e}delete(e){this.list.delete(e)}clear(){this.list.clear()}},"uuid","0da7ad77-f734-42ca-942f-a074adfd1e3a");const cl=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),ue(this,"list",{}),ue(this,"onDisposed",new Bi),ue(this,"onFragmentsDisposed",(e=>{const{groupID:t,fragmentIDs:i}=e;for(const e in this.list){const s=this.list[e],n=Object.keys(s);if(n.includes(t))delete s[t],0===Object.values(s).length&&delete this.list[e];else for(const e of n){const t=s[e];for(const e of i)delete t.map[e];0===Object.values(t).length&&delete s[e]}}})),t.add(e.uuid,this),t.get(wo).onFragmentsDisposed.add(this.onFragmentsDisposed)}dispose(){this.list={},this.components.get(wo).onFragmentsDisposed.remove(this.onFragmentsDisposed),this.onDisposed.trigger(),this.onDisposed.reset()}remove(e){for(const t in this.list){const i=this.list[t];for(const t in i){delete i[t].map[e]}}}find(e){const t=this.components.get(wo);if(!e){const e={};for(const[i,s]of t.list)e[i]=new Set(s.ids);return e}const i=Object.keys(e).length,s={};for(const t in e){const i=e[t];if(this.list[t])for(const e of i){const i=this.list[t][e];if(i)for(const e in i.map){s[e]||(s[e]=new Map);for(const t of i.map[e]){const i=s[e].get(t);void 0===i?s[e].set(t,1):s[e].set(t,i+1)}}}else console.warn(`Classification ${t} does not exist.`)}const n={};for(const e in s){const t=s[e];for(const[s,r]of t){if(void 0===r)throw new Error("Malformed fragments map!");r===i&&(n[e]||(n[e]=new Set),n[e].add(s))}}return n}byModel(e,t){this.list.models||(this.list.models={});const i=this.list.models;i[e]||(i[e]={map:{},id:null,name:e});const s=i[e];for(const[e,i]of t.data){const n=i[0];for(const i of n){const n=t.keyFragments.get(i);n&&(s.map[n]||(s.map[n]=new Set),s.map[n].add(e))}}}async byPredefinedType(e){var t;this.list.predefinedTypes||(this.list.predefinedTypes={});const i=this.list.predefinedTypes,s=e.getAllPropertiesIDs();for(const n of s){const s=await e.getProperties(n);if(!s)continue;const r=String(null==(t=s.PredefinedType)?void 0:t.value).toUpperCase();i[r]||(i[r]={map:{},id:null,name:r});const o=i[r];for(const[t,i]of e.data){const t=i[0];for(const i of t){const t=e.keyFragments.get(i);if(!t)throw new Error("Fragment ID not found!");o.map[t]||(o.map[t]=new Set),o.map[t].add(s.expressID)}}}}byEntity(e){this.list.entities||(this.list.entities={});for(const[t,i]of e.data){const s=i[1][1],n=so[s];this.saveItem(e,"entities",n,t)}}async byIfcRel(e,t,i){no.isRel(t)&&await no.getRelationMap(e,t,(async(t,s)=>{const{name:n}=await no.getEntityName(e,t);for(const t of s)this.saveItem(e,i,n??"NO REL NAME",t)}))}async bySpatialStructure(e,t={}){var i,s;const n=this.components.get(So),r=n.relationMaps[e.uuid];if(!r)throw new Error(`Classifier: model relations of ${e.name||e.uuid} have to exists to group by spatial structure.`);const o=t.systemName??"spatialStructures",a=void 0===t.useProperties||t.useProperties;for(const[l]of r){if(t.isolate){const i=e.data.get(l);if(!i)continue;const s=i[1][1];if(void 0===s||!t.isolate.has(s))continue}const r=n.getEntityRelations(e,l,"Decomposes");if(r)for(const t of r){let s=t.toString();if(a){const n=await e.getProperties(t);if(!n)continue;s=null==(i=n.Name)?void 0:i.value}this.saveItem(e,o,s,l,t)}const c=n.getEntityRelations(e,l,"ContainsElements");if(!c)continue;let h=l.toString();if(a){const t=await e.getProperties(l);if(!t)continue;h=null==(s=t.Name)?void 0:s.value}for(const t of c){this.saveItem(e,o,h,t,l);const i=n.getEntityRelations(e,Number(t),"IsDecomposedBy");if(i)for(const t of i)this.saveItem(e,o,h,t,l)}}}setColor(e,t,i=!1){const s=this.components.get(wo);for(const n in e){const r=s.list.get(n);if(!r)continue;const o=e[n];r.setColor(t,o,i)}}resetColor(e){const t=this.components.get(wo);for(const i in e){const s=t.list.get(i);if(!s)continue;const n=e[i];s.resetColor(n)}}export(){const e={};for(const t in this.list){e[t]={};const i=this.list[t];for(const s in i){const n=i[s];e[t][s]={map:oe.FragmentUtils.export(n.map),name:n.name,id:n.id}}}return e}import(e){for(const t in e){this.list[t]||(this.list[t]={});const i=e[t];for(const e in i){const s=i[e];this.list[t][e]={map:oe.FragmentUtils.import(s.map),name:s.name,id:s.id}}}}saveItem(e,t,i,s,n=null){this.list[t]||(this.list[t]={});const r=e.data.get(s);if(r)for(const o of r[0]){const r=e.keyFragments.get(o);if(r){const e=this.list[t];e[i]||(e[i]={map:{},id:n,name:i}),e[i].map[r]||(e[i].map[r]=new Set),e[i].map[r].add(s)}}}};ue(cl,"uuid","e25a7f3c-46c4-4a14-9d3d-5115f24ebeb7");let hl=cl;ue(class e extends ki{constructor(t){super(t),ue(this,"onDisposed",new Bi),ue(this,"enabled",!0),ue(this,"height",10),ue(this,"groupName","spatialStructures"),ue(this,"list",new Set),t.add(e.uuid,this)}dispose(){this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}set(e){if(!this.enabled)return;const t=this.components.get(hl),s=this.components.get(wo),n=e?1:-1;let r=0;const o=t.list[this.groupName],a=new i.Matrix4;for(const t in o){a.elements[13]=r*n*this.height;for(const i in o[t].map){const n=s.list.get(i),r=t+i,l=this.list.has(r);if(!n||e&&l||!e&&!l)continue;e?this.list.add(r):this.list.delete(r);const c=o[t].map[i];n.applyTransform(c,a),n.mesh.computeBoundingSphere(),n.mesh.computeBoundingBox()}r++}}},"uuid","d260618b-ce88-4c7d-826c-6debb91de3e2");const dl=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),this.components.add(e.uuid,this)}set(e,t){const i=this.components.get(wo);if(t)for(const s in t){const n=t[s],r=i.list.get(s);r&&(r.setVisibility(e,n),this.updateCulledVisibility(r))}else for(const[t,s]of i.list)s&&(s.setVisibility(e),this.updateCulledVisibility(s))}isolate(e){this.set(!1),this.set(!0,e)}updateCulledVisibility(e){const t=this.components.get(lr);for(const[i,s]of t.list){const t=s.colorMeshes.get(e.id);t&&(t.count=e.mesh.count)}}};ue(dl,"uuid","dd9ccf2d-8a21-4821-b7f6-2949add16a29");let ul=dl;class fl extends lo{constructor(){super(...arguments),ue(this,"minGeometrySize",10),ue(this,"minAssetsSize",1e3),ue(this,"maxTriangles",null)}}ue(class e extends ki{constructor(t){super(t),ue(this,"onGeometryStreamed",new Vi),ue(this,"onAssetStreamed",new Vi),ue(this,"onProgress",new Vi),ue(this,"onIfcLoaded",new Vi),ue(this,"onDisposed",new Bi),ue(this,"settings",new fl),ue(this,"enabled",!0),ue(this,"webIfc",new he.IfcAPI),ue(this,"_nextAvailableID",0),ue(this,"_splittedGeometries",new Map),ue(this,"_spatialTree",new ao),ue(this,"_metaData",new ho),ue(this,"_visitedGeometries",new Map),ue(this,"_streamSerializer",new oe.StreamSerializer),ue(this,"_geometries",new Map),ue(this,"_geometryCount",0),ue(this,"_civil",new co),ue(this,"_groupSerializer",new oe.Serializer),ue(this,"_assets",[]),ue(this,"_meshesWithHoles",new Set),this.components.add(e.uuid,this),this.settings.excludedCategories.add(he.IFCOPENINGELEMENT)}dispose(){this.onIfcLoaded.reset(),this.onGeometryStreamed.reset(),this.onAssetStreamed.reset(),this.webIfc=null,this.onDisposed.trigger(),this.onDisposed.reset()}async streamFromBuffer(e){await this.readIfcFile(e),await this.streamAllGeometries(),this.cleanUp()}async streamFromCallBack(e){await this.streamIfcFile(e),await this.streamAllGeometries(),this.cleanUp()}async readIfcFile(e){const{path:t,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(e,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamIfcFile(e){const{path:t,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModelFromCallback(e,this.settings.webIfc),this._nextAvailableID=this.webIfc.GetMaxExpressID(0)}async streamAllGeometries(){console.log("Converting geometries to tiles...");const{minGeometrySize:e,minAssetsSize:t}=this.settings;this._spatialTree.setUp(this.webIfc);const i=this.webIfc.GetIfcEntityList(0),s=[[]],n=new oe.FragmentsGroup;n.ifcMetadata={name:"",description:"",...this._metaData.getNameInfo(this.webIfc),...this._metaData.getDescriptionInfo(this.webIfc),schema:this.webIfc.GetModelSchema(0)||"IFC2X3",maxExpressID:this.webIfc.GetMaxExpressID(0)};let r=0,o=0;for(const t of i){if(!this.webIfc.IsIfcElement(t)&&t!==he.IFCSPACE||this.settings.excludedCategories.has(t))continue;const i=this.webIfc.GetLineIDsWithType(0,t),a=i.size();for(let l=0;l<a;l++){r>e&&(r=0,o++,s.push([]));const a=i.get(l);s[o].push(a);const c=this.webIfc.GetLine(0,a);if(c.GlobalId){const e=(null==c?void 0:c.GlobalId.value)||(null==c?void 0:c.GlobalId);n.globalToExpressIDs.set(e,a)}const h=this._spatialTree.itemsByFloor[a]||0;n.data.set(a,[[],[h,t]]),r++}}this._spatialTree.cleanUp();let a=.01,l=0;for(const e of s){l++,this.webIfc.StreamMeshes(0,e,(e=>{this.getMesh(this.webIfc,e,n)})),this._geometryCount>this.settings.minGeometrySize&&await this.streamGeometries(),this._assets.length>t&&await this.streamAssets();const i=l/s.length;i>a&&(a+=.01,a=Math.max(a,i),await this.onProgress.trigger(Math.round(100*a)/100))}this._geometryCount&&await this.streamGeometries(),this._assets.length&&await this.streamAssets();const{opaque:c,transparent:h}=n.geometryIDs;for(const[e,{index:t,uuid:i}]of this._visitedGeometries)n.keyFragments.set(t,i),(e>1?c:h).set(e,t);uo.get(n,this.webIfc);const d=this.webIfc.GetCoordinationMatrix(0);n.coordinationMatrix.fromArray(d),n.civilData=this._civil.read(this.webIfc);const u=this._groupSerializer.export(n);await this.onIfcLoaded.trigger(u),n.dispose(!0)}cleanUp(){try{this.webIfc.Dispose()}catch{}this.webIfc=null,this.webIfc=new he.IfcAPI,this._visitedGeometries.clear(),this._geometries.clear(),this._assets=[],this._meshesWithHoles.clear()}getMesh(e,t,i){const s=t.geometries.size(),n=t.expressID,r={id:n,geometries:[]};for(let o=0;o<s;o++){const s=t.geometries.get(o),a=s.geometryExpressID,l=1===s.color.w,c=a*(l?1:-1);this._visitedGeometries.has(c)||this.getGeometry(e,a,l),this.registerGeometryData(i,n,s,r,a,c);const h=this._splittedGeometries.get(a);if(h)for(const e of h)this.registerGeometryData(i,n,s,r,e,e)}this._assets.push(r)}getGeometry(e,t,s){const n=e.GetGeometry(0,t),r=e.GetIndexArray(n.GetIndexData(),n.GetIndexDataSize()),o=e.GetVertexArray(n.GetVertexData(),n.GetVertexDataSize()),a=new Float32Array(o.length/2),l=new Float32Array(o.length/2);for(let e=0;e<o.length;e+=6)a[e/2]=o[e],a[e/2+1]=o[e+1],a[e/2+2]=o[e+2],l[e/2]=o[e+3],l[e/2+1]=o[e+4],l[e/2+2]=o[e+5];const c=s?1:-1;if(0===r.length){const e=new Float32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1]);this._geometries.set(t,{position:a,normal:l,index:r,boundingBox:e,hasHoles:!1});const s=this._visitedGeometries.size,o=i.MathUtils.generateUUID(),h=t*c;return this._visitedGeometries.set(h,{uuid:o,index:s}),this._geometryCount++,void n.delete()}const h=3*(this.settings.maxTriangles||r.length/3);let d=!0;for(let e=0;e<r.length;e+=h){const s=r.length-e,n=e+Math.min(s,h),o=[],u=[],f=[];let p=0;for(let t=e;t<n;t++){o.push(p++);const e=r[t];u.push(a[3*e]),u.push(a[3*e+1]),u.push(a[3*e+2]),f.push(l[3*e]),f.push(l[3*e+1]),f.push(l[3*e+2])}const m=new Uint32Array(o),I=new Float32Array(u),E=new Float32Array(f),g=fs(I),C=new Float32Array(g.transformation.elements),T=!1,R=d?t:this._nextAvailableID++;this._geometries.set(R,{position:I,normal:E,index:m,boundingBox:C,hasHoles:T}),d||(this._splittedGeometries.has(t)||this._splittedGeometries.set(t,new Set),this._splittedGeometries.get(t).add(R));const v=this._visitedGeometries.size,S=i.MathUtils.generateUUID(),y=R*c;this._visitedGeometries.set(y,{uuid:S,index:v}),this._geometryCount++,d=!1}n.delete()}async streamAssets(){await this.onAssetStreamed.trigger(this._assets),this._assets=null,this._assets=[]}async streamGeometries(){const e=new Map;for(const[t,i]of this._geometries)e.set(t,i),e.size>this.settings.minGeometrySize&&await this.outputGeometries(e);await this.outputGeometries(e),this._geometries.clear(),this._geometryCount=0}async outputGeometries(e){let t=this._streamSerializer.export(e),i={};for(const[t,{boundingBox:s,hasHoles:n}]of e)i[t]={boundingBox:s,hasHoles:n};await this.onGeometryStreamed.trigger({data:i,buffer:t}),i=null,t=null,e.clear()}registerGeometryData(e,t,i,s,n,r){const o=this._visitedGeometries.get(r);if(void 0===o)throw new Error("Error getting geometry data for streaming!");const a=e.data.get(t);if(!a)throw new Error("Data not found!");a[0].push(o.index);const{x:l,y:c,z:h,w:d}=i.color,u=[l,c,h,d],f=i.flatTransformation;s.geometries.push({color:u,geometryID:n,transformation:f})}},"uuid","d9999a00-e1f5-4d3f-8cfe-c56e08609764");class pl extends lo{constructor(){super(...arguments),ue(this,"propertiesSize",100)}}ue(class extends ki{constructor(){super(...arguments),ue(this,"onPropertiesStreamed",new Vi),ue(this,"onProgress",new Vi),ue(this,"onIndicesStreamed",new Vi),ue(this,"onDisposed",new Bi),ue(this,"enabled",!0),ue(this,"settings",new pl),ue(this,"webIfc",new he.IfcAPI)}async dispose(){this.onIndicesStreamed.reset(),this.onPropertiesStreamed.reset(),this.webIfc=null,this.onDisposed.reset()}async streamFromBuffer(e){await this.readIfcFile(e),await this.streamAllProperties(),this.cleanUp()}async streamFromCallBack(e){await this.streamIfcFile(e),await this.streamAllProperties(),this.cleanUp()}async readIfcFile(e){const{path:t,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModel(e,this.settings.webIfc)}async streamIfcFile(e){const{path:t,absolute:i,logLevel:s}=this.settings.wasm;this.webIfc.SetWasmPath(t,i),await this.webIfc.Init(),s&&this.webIfc.SetLogLevel(s),this.webIfc.OpenModelFromCallback(e,this.settings.webIfc)}async streamAllProperties(){const{propertiesSize:e}=this.settings,t=new Set(this.webIfc.GetIfcEntityList(0)),i=new Set([he.IFCPROJECT,he.IFCSITE,he.IFCBUILDING,he.IFCBUILDINGSTOREY,he.IFCSPACE]);for(const e of i)t.add(e);let s=.01,n=0;for(const r of t){if(n++,fo.has(r))continue;const o=i.has(r),a=this.webIfc.GetLineIDsWithType(0,r),l=a.size();let c=0;for(let t=0;t<l-e;t+=e){const i={};for(let s=0;s<e;s++){c++;const e=a.get(t+s);try{const t=this.webIfc.GetLine(0,e,o);i[t.expressID]=t}catch{console.log(`Could not get property: ${e}`)}}await this.onPropertiesStreamed.trigger({type:r,data:i})}if(c!==l){const e={};for(let t=c;t<l;t++){const i=a.get(t);try{const t=this.webIfc.GetLine(0,i,o);e[t.expressID]=t}catch{console.log(`Could not get property: ${i}`)}}await this.onPropertiesStreamed.trigger({type:r,data:e})}n/t.size>s&&(s=Math.round(100*s)/100,await this.onProgress.trigger(s),s+=.01)}await this.onProgress.trigger(1);const r=await this.components.get(So).processFromWebIfc(this.webIfc,0);await this.onIndicesStreamed.trigger(r)}cleanUp(){this.webIfc.Dispose(),this.webIfc=null,this.webIfc=new he.IfcAPI}},"uuid","88d2c89c-ce32-47d7-8cb6-d51e4b311a0b");class ml{constructor(e,t,i){ue(this,"title"),ue(this,"guid",Is.create()),ue(this,"clippingPlanes",new Zi),ue(this,"camera",{aspectRatio:1,fov:60,direction:{x:0,y:0,z:0},position:{x:0,y:0,z:0}}),ue(this,"exceptionComponents",new Zi),ue(this,"selectionComponents",new Zi),ue(this,"componentColors",new ji),ue(this,"spacesVisible",!1),ue(this,"spaceBoundariesVisible",!1),ue(this,"openingsVisible",!1),ue(this,"defaultVisibility",!0),ue(this,"_components"),ue(this,"world");const s={setCamera:!0,...i},{data:n,setCamera:r}=s;this._components=e,this.world=t,n&&(this.guid=n.guid??this.guid,this.set(n)),r&&this.updateCamera()}get _selectionModelIdMap(){const e=this._components.get(wo),t={};for(const[i,s]of e.groups){i in t||(t[i]=new Set);for(const e of this.selectionComponents){const n=s.globalToExpressIDs.get(e);n&&t[i].add(n)}}return t}get _exceptionModelIdMap(){const e=this._components.get(wo),t={};for(const[i,s]of e.groups){i in t||(t[i]=new Set);for(const e of this.exceptionComponents){const n=s.globalToExpressIDs.get(e);n&&t[i].add(n)}}return t}get selection(){return this._components.get(wo).modelIdToFragmentIdMap(this._selectionModelIdMap)}get exception(){return this._components.get(wo).modelIdToFragmentIdMap(this._exceptionModelIdMap)}get projection(){return"fov"in this.camera?"Perspective":"Orthographic"}get position(){const e=this._components.get(wo),{position:t}=this.camera,{x:s,y:n,z:r}=t,o=new i.Vector3(s,n,r);return e.applyBaseCoordinateSystem(o,new i.Matrix4),o}get direction(){const{direction:e}=this.camera,{x:t,y:s,z:n}=e;return new i.Vector3(t,s,n)}get _managerVersion(){return this._components.get($a).config.version}get topics(){return[...this._components.get($a).list.values()].filter((e=>e.viewpoints.has(this.guid)))}addComponentsFromMap(e){const t=this._components.get(wo).fragmentIdMapToGuids(e);this.selectionComponents.add(...t),this._components.get(gl).list.set(this.guid,this)}set(e){const t=e,i=this;for(const s in e){if("guid"===s)continue;const e=t[s];"selectionComponents"!==s?"exceptionComponents"!==s?s in this&&(i[s]=e):(this.exceptionComponents.clear(),this.exceptionComponents.add(...e)):(this.selectionComponents.clear(),this.selectionComponents.add(...e))}return this._components.get(gl).list.set(this.guid,this),this}async go(e,t=!0){const{camera:s}=e??this.world;if(!s.hasCameraControls())throw new Error("Viewpoint: the world's camera need controls to set the viewpoint.");s instanceof to&&s.projection.set(this.projection);const n=new i.Vector3(this.camera.position.x,this.camera.position.y,this.camera.position.z),r=new i.Vector3(this.camera.direction.x,this.camera.direction.y,this.camera.direction.z);if(n.equals(new i.Vector3)&&r.equals(new i.Vector3))return;const o=this.position,a=this.direction;let l={x:o.x+80*a.x,y:o.y+80*a.y,z:o.z+80*a.z};const c=this.selection;if(0===Object.keys(c).length){const e=this._components.get(ur).get(this.world).castRayFromVector(o,this.direction);e&&(l=e.point)}else{const e=this._components.get(tl);e.reset(),e.addFragmentIdMap(c),l=e.getSphere().center,e.reset()}await s.controls.setLookAt(o.x,o.y,o.z,l.x,l.y,l.z,t)}updateCamera(e){const{camera:t,renderer:s}=e??this.world;if(!s)throw new Error("Viewpoint: the world needs to have a renderer!");if(!t.hasCameraControls())throw new Error("Viewpoint: world's camera need camera controls!");const n=new i.Vector3;t.controls.getPosition(n);const r=t.three,o=new i.Vector3(0,0,-1).applyEuler(r.rotation),{width:a,height:l}=s.getSize();let c=a/l;Number.isNaN(c)&&(c=1);const h=this._components.get(wo);n.applyMatrix4(h.baseCoordinationMatrix.clone().invert());const d={aspectRatio:c,position:{x:n.x,y:n.y,z:n.z},direction:{x:o.x,y:o.y,z:o.z}};r instanceof i.PerspectiveCamera?this.camera={...d,fov:r.fov}:r instanceof i.OrthographicCamera&&(this.camera={...d,viewToWorldScale:r.top-r.bottom}),this._components.get(gl).list.set(this.guid,this)}applyVisibility(){const e=this._components.get(ul);e.set(this.defaultVisibility),e.set(!this.defaultVisibility,this.exception),e.set(!0,this.selection)}applyColors(){const e=this._components.get(gl),t=this._components.get(wo),i=this._components.get(hl);for(const[s,n]of this.componentColors){const r=t.guidToFragmentIdMap(n);i.setColor(r,s,e.config.overwriteColors)}}resetColors(){const e=this._components.get(wo),t=this._components.get(hl);for(const[i,s]of this.componentColors){const i=e.guidToFragmentIdMap(s);t.resetColor(i)}}async createComponentTags(e){var t,i;const s=this._components.get(wo);let n="";if(this._components.get($a).config.includeSelectionTag){const r="selection"===e?this._selectionModelIdMap:this._exceptionModelIdMap;for(const e in r){const o=s.groups.get(e);if(!o)continue;const a=r[e];for(const e of a){const s=await o.getProperties(e);if(!s)continue;const r=null==(t=s.GlobalId)?void 0:t.value;if(!r)continue;const a=null==(i=s.Tag)?void 0:i.value;let l=null;a&&(l=`AuthoringToolId="${a}"`),n+=`\n<Component IfcGuid="${r}" ${l??""} />`}}}else n=[...this.selectionComponents].map((e=>`<Component IfcGuid="${e}" />`)).join("\n");return n}createColorTags(){let e="";for(const[t,i]of this.componentColors.entries()){e+=`<Color Color="${`#${t.getHexString()}`}">\n${i.map((e=>`\n<Component IfcGuid="${e}" />`)).join("\n")}\n</Color>`}return 0!==e.length?`<Coloring>\n${e}\n</Coloring>`:"<Coloring />"}async serialize(e=this._managerVersion){const t=this._components.get(wo),s=this.position;s.applyMatrix4(t.baseCoordinationMatrix.clone().invert());const n=this.direction;n.normalize();const r=(new i.Matrix4).makeRotationX(Math.PI/2),o=n.clone().applyMatrix4(r);o.normalize();const a=`<CameraViewPoint>\n      <X>${s.x}</X>\n      <Y>${-s.z}</Y>\n      <Z>${s.y}</Z>\n    </CameraViewPoint>`,l=`<CameraDirection>\n      <X>${n.x}</X>\n      <Y>${-n.z}</Y>\n      <Z>${n.y}</Z>\n    </CameraDirection>`,c=`<CameraUpVector>\n      <X>${o.x}</X>\n      <Y>${-o.z}</Y>\n      <Z>${o.y}</Z>\n    </CameraUpVector>`,h=`<AspectRatio>${this.camera.aspectRatio}</AspectRatio>`;let d="";"viewToWorld"in this.camera?d=`<OrthogonalCamera>\n        ${a}\n        ${l}\n        ${c}\n        ${h}\n        <ViewToWorldScale>${this.camera.viewToWorld}</ViewToWorldScale>\n      </OrthogonalCamera>`:"fov"in this.camera&&(d=`<PerspectiveCamera>\n        ${a}\n        ${l}\n        ${c}\n        ${h}\n        <FieldOfView>${this.camera.fov}</FieldOfView>\n      </PerspectiveCamera>`);const u=`<ViewSetupHints SpacesVisible="${this.spacesVisible??!1}" SpaceBoundariesVisible="${this.spaceBoundariesVisible??!1}" OpeningsVisible="${this.openingsVisible??!1}" />`,f=(await this.createComponentTags("selection")).trim(),p=(await this.createComponentTags("exception")).trim(),m=this.createColorTags();return`<?xml version="1.0" encoding="UTF-8"?>\n    <VisualizationInfo Guid="${this.guid}">\n      <Components>\n        ${"2.1"===e?u:""}\n        ${0!==f.length?`<Selection>${f}</Selection>`:""}\n        <Visibility DefaultVisibility="${this.defaultVisibility}">\n          ${"3"===e?u:""}\n          ${0!==p.length?`<Exceptions>${p}</Exceptions>`:""}\n        </Visibility>\n        ${m}\n      </Components>\n      ${d}\n    </VisualizationInfo>`}}class Il extends qs{constructor(){super(...arguments),ue(this,"_config",{overwriteColors:{value:!1,type:"Boolean"}})}get overwriteColors(){return this._config.overwriteColors.value}set overwriteColors(e){this._config.overwriteColors.value=e}}const El=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),ue(this,"list",new ji),ue(this,"isSetup",!1),ue(this,"onSetup",new Bi),ue(this,"config",new Il(this,this.components,"Viewpoints",e.uuid)),ue(this,"onDisposed",new Bi),t.add(e.uuid,this)}create(e,t){const i=new ml(this.components,e,{data:t});return t||this.list.set(i.guid,i),i}setup(){}dispose(){this.list.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}};ue(El,"uuid","ee867824-a796-408d-8aa0-4e5962a83c66");let gl=El;class Cl extends qs{constructor(){super(...arguments),ue(this,"_config",{visible:{value:!0,type:"Boolean"},lockRotation:{value:!0,type:"Boolean"},zoom:{type:"Number",interpolable:!0,value:.05,min:.001,max:5},frontOffset:{type:"Number",interpolable:!0,value:0,min:0,max:100},sizeX:{type:"Number",interpolable:!0,value:320,min:20,max:5e3},sizeY:{type:"Number",interpolable:!0,value:160,min:20,max:5e3},backgroundColor:{value:new i.Color,type:"Color"}})}get visible(){return this._config.visible.value}set visible(e){this._config.visible.value=e;this._component.renderer.domElement.style.display=e?"block":"none"}get lockRotation(){return this._config.lockRotation.value}set lockRotation(e){this._config.lockRotation.value=e,this._component.lockRotation=e}get zoom(){return this._config.zoom.value}set zoom(e){this._config.zoom.value=e,this._component.zoom=e}get frontOffset(){return this._config.frontOffset.value}set frontOffset(e){this._config.frontOffset.value=e,this._component.frontOffset=e}get sizeX(){return this._config.sizeX.value}set sizeX(e){this._config.sizeX.value=e;const{sizeX:t,sizeY:s}=this._config,n=new i.Vector2(t.value,s.value);this._component.resize(n)}get sizeY(){return this._config.sizeY.value}set sizeY(e){this._config.sizeY.value=e;const{sizeX:t,sizeY:s}=this._config,n=new i.Vector2(t.value,s.value);this._component.resize(n)}get backgroundColor(){return this._config.backgroundColor.value}set backgroundColor(e){this._config.backgroundColor.value=e,this._component.backgroundColor=e}}class Tl{constructor(e,t){if(ue(this,"onDisposed",new Bi),ue(this,"onAfterUpdate",new Bi),ue(this,"onBeforeUpdate",new Bi),ue(this,"onResize",new Bi),ue(this,"onSetup",new Bi),ue(this,"frontOffset",0),ue(this,"overrideMaterial",new i.MeshDepthMaterial),ue(this,"backgroundColor",new i.Color(395274)),ue(this,"renderer"),ue(this,"enabled",!0),ue(this,"world"),ue(this,"config"),ue(this,"isSetup",!1),ue(this,"_defaultConfig",{visible:!0,lockRotation:!1,zoom:.05,frontOffset:0,sizeX:320,sizeY:160,backgroundColor:new i.Color(395274)}),ue(this,"_lockRotation",!0),ue(this,"_size",new i.Vector2(320,160)),ue(this,"_camera"),ue(this,"_plane"),ue(this,"_tempVector1",new i.Vector3),ue(this,"_tempVector2",new i.Vector3),ue(this,"_tempTarget",new i.Vector3),ue(this,"down",new i.Vector3(0,-1,0)),ue(this,"updatePlanes",(()=>{if(!this.world.renderer)throw new Error("The given world must have a renderer!");const e=[],t=this.world.renderer.three;for(const i of t.clippingPlanes)e.push(i);e.push(this._plane),this.renderer.clippingPlanes=e})),this.world=e,!this.world.renderer)throw new Error("The given world must have a renderer!");this.renderer=new i.WebGLRenderer,this.renderer.setSize(this._size.x,this._size.y);const s=this._size.x/this._size.y;this._camera=new i.OrthographicCamera(1*s/-2,1*s/2,.5,-.5),this.world.renderer.onClippingPlanesUpdated.add(this.updatePlanes),this._camera.position.set(0,200,0),this._camera.zoom=.1,this._camera.rotation.x=-Math.PI/2,this._plane=new i.Plane(this.down,200),this.updatePlanes(),this.config=new Cl(this,t,"MiniMap")}get lockRotation(){return this._lockRotation}set lockRotation(e){this._lockRotation=e,e&&(this._camera.rotation.z=0)}get zoom(){return this._camera.zoom}set zoom(e){this._camera.zoom=e,this._camera.updateProjectionMatrix()}dispose(){this.enabled=!1,this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.onResize.reset(),this.overrideMaterial.dispose(),this.renderer.forceContextLoss(),this.renderer.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return this._camera}update(){if(!this.enabled)return;this.onBeforeUpdate.trigger();const e=this.world.scene.three,t=this.world.camera;if(!t.hasCameraControls())throw new Error("The given world must use camera controls!");if(!(e instanceof i.Scene))throw new Error("The given world must have a THREE.Scene as a root!");const s=t.controls;if(s.getPosition(this._tempVector1),this._camera.position.x=this._tempVector1.x,this._camera.position.z=this._tempVector1.z,0!==this.frontOffset&&(s.getTarget(this._tempVector2),this._tempVector2.sub(this._tempVector1),this._tempVector2.normalize().multiplyScalar(this.frontOffset),this._camera.position.x+=this._tempVector2.x,this._camera.position.z+=this._tempVector2.z),!this._lockRotation){s.getTarget(this._tempTarget);const e=Math.atan2(this._tempTarget.x-this._tempVector1.x,this._tempTarget.z-this._tempVector1.z);this._camera.rotation.z=e+Math.PI}this._plane.set(this.down,this._tempVector1.y);const n=e.background;e.background=this.backgroundColor,this.renderer.render(e,this._camera),e.background=n,this.onAfterUpdate.trigger()}getSize(){return this._size}resize(e=this._size){this._size.copy(e),this.renderer.setSize(e.x,e.y);const t=e.x/e.y;this._camera.left=1*t/-2,this._camera.right=1*t/2,this._camera.top=.5,this._camera.bottom=-.5,this._camera.updateProjectionMatrix(),this.onResize.trigger(e)}setup(e){const t={...this._defaultConfig,...e};this.config.visible=!0,this.config.lockRotation=t.lockRotation,this.config.zoom=t.zoom,this.config.frontOffset=t.frontOffset,this.config.sizeX=t.sizeX,this.config.sizeY=t.sizeY,this.config.backgroundColor=t.backgroundColor,this.isSetup=!0,this.onSetup.trigger()}}ue(class e extends ki{constructor(t){super(t),ue(this,"onAfterUpdate",new Bi),ue(this,"onBeforeUpdate",new Bi),ue(this,"onDisposed",new Bi),ue(this,"onSetup",new Bi),ue(this,"enabled",!0),ue(this,"list",new Map),this.components.add(e.uuid,this)}create(e){if(this.list.has(e.uuid))throw new Error("This world already has a minimap!");const t=new Tl(e,this.components);return this.list.set(e.uuid,t),t}delete(e){const t=this.list.get(e);t&&t.dispose(),this.list.delete(e)}dispose(){for(const[e,t]of this.list)t.dispose();this.list.clear(),this.onDisposed.trigger()}update(){for(const[e,t]of this.list)t.update()}},"uuid","39ad6aad-84c8-4adf-a1e0-7f25313a9e7f");const Rl=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),t.add(e.uuid,this)}static distanceFromPointToLine(e,t,s,n=!1){const r=new i.Line3,o=new i.Vector3;return r.set(t,s),r.closestPointToPoint(e,n,o),o.distanceTo(e)}getFace(e,t,i){if(!e.geometry.index)throw new Error("Geometry must be indexed!");const s=new Map,n=e.geometry.index.array,{plane:r}=this.getFaceData(t,i,e),o=[];for(let t=0;t<n.length/3;t++){const{plane:n,edges:a}=this.getFaceData(t,i,e);if(n.equals(r)){o.push({index:t,edges:a});for(const{id:e,points:t,distance:i}of a)s.set(e,{points:t,distance:i})}}let a=0;const l=new Map,c=new Map;for(const{index:e,edges:t}of o){const i=new Map;for(const{id:e}of t)if(l.has(e)){const t=l.get(e);i.set(e,t)}const s=t.map((e=>e.id));if(!i.size){const i=a++;for(const{id:e}of t)l.set(e,i);c.set(i,{edges:new Set(s),indices:new Set([e])});continue}let n=null;const r=new Set,o=new Set(s);for(const[e,t]of i){null===n?n=t:t!==n&&r.add(t),l.delete(e);const{edges:i}=c.get(t);i.delete(e),o.delete(e)}if(null===n)throw new Error("Error computing face!");const h=c.get(n),{indices:d}=h;d.add(e);for(const e of o){l.set(e,n);const{edges:t}=h;t.add(e)}for(const e of r){const t=c.get(e),{edges:i,indices:s}=t,r=c.get(n),{edges:o,indices:a}=r;for(const e of i)o.add(e),l.set(e,n);for(const e of s)a.add(e);c.delete(e)}}for(const[e,{indices:i,edges:n}]of c)if(i.has(t)){const e=[];for(const t of n){const i=s.get(t);e.push(i)}return{edges:e,indices:i}}return null}getVerticesAndNormal(e,t,s){if(!e.geometry.index)throw new Error("Geometry must be indexed!");const n=e.geometry.index.array,r=e.geometry.attributes.position.array,o=e.geometry.attributes.normal.array,a=3*n[3*t],l=3*n[3*t+1],c=3*n[3*t+2],h=new i.Vector3(r[a],r[a+1],r[a+2]),d=new i.Vector3(r[l],r[l+1],r[l+2]),u=new i.Vector3(r[c],r[c+1],r[c+2]),f=new i.Vector3(o[a],o[a+1],o[a+2]),p=new i.Vector3(o[l],o[l+1],o[l+2]),m=new i.Vector3(o[c],o[c+1],o[c+2]),I=(f.x+p.x+m.x)/3,E=(f.y+p.y+m.y)/3,g=(f.z+p.z+m.z)/3,C=new i.Vector3(I,E,g);if(void 0!==s&&e instanceof i.InstancedMesh){const t=new i.Matrix4;e.getMatrixAt(s,t);const n=new i.Matrix4;n.extractRotation(t),C.applyMatrix4(n),h.applyMatrix4(t),d.applyMatrix4(t),u.applyMatrix4(t)}return{p1:h,p2:d,p3:u,faceNormal:C}}round(e){e.x=Math.trunc(1e3*e.x)/1e3,e.y=Math.trunc(1e3*e.y)/1e3,e.z=Math.trunc(1e3*e.z)/1e3}getVolumeFromFragments(e){const t=this.components.get(wo),s=new i.Matrix4,n=[];for(const r in e){const o=t.list.get(r);if(!o)continue;const a=e[r];let l=0;for(const e of a){const t=o.getInstancesIDs(e);t&&(l+=t.size)}const c=new i.InstancedMesh(o.mesh.geometry,void 0,l);let h=0;for(const e of a){const t=o.getInstancesIDs(e);if(t)for(const e of t)o.mesh.getMatrixAt(e,s),c.setMatrixAt(h++,s)}n.push(c)}const r=this.getVolumeFromMeshes(n);for(const e of n)e.geometry=null,e.material=[],e.dispose();return r}getVolumeFromMeshes(e){let t=0;for(const i of e)t+=this.getVolumeOfMesh(i);return t}getFaceData(e,t,s){const n=this.getVerticesAndNormal(s,e,t),{p1:r,p2:o,p3:a,faceNormal:l}=n;this.round(r),this.round(o),this.round(a),this.round(l);const c=[{id:`${r.x}|${r.y}|${r.z}`,value:r},{id:`${o.x}|${o.y}|${o.z}`,value:o},{id:`${a.x}|${a.y}|${a.z}`,value:a}];c.sort(((e,t)=>e.id<t.id?-1:e.id>t.id?1:0));const[{id:h,value:d},{id:u,value:f},{id:p,value:m}]=c,I=[{id:`${h}|${u}`,distance:d.distanceTo(f),points:[d,f]},{id:`${u}|${p}`,distance:f.distanceTo(m),points:[f,m]},{id:`${h}|${p}`,distance:d.distanceTo(m),points:[d,m]}],E=new i.Plane;return E.setFromNormalAndCoplanarPoint(l,r),E.constant=Math.round(10*E.constant)/10,{plane:E,edges:I}}getVolumeOfMesh(e){let t=0;const s=new i.Vector3,n=new i.Vector3,r=new i.Vector3,{index:o}=e.geometry,a=e.geometry.attributes.position.array;if(!o)return console.warn("Geometry must be indexed to compute its volume!"),0;const l=[];if(e instanceof i.InstancedMesh)for(let t=0;t<e.count;t++){const s=new i.Matrix4;e.getMatrixAt(t,s),l.push(s)}else l.push((new i.Matrix4).identity());const{matrixWorld:c}=e;for(let e=0;e<o.array.length-2;e+=3)for(const i of l){const l=i.multiply(c),h=3*o.array[e],d=3*o.array[e+1],u=3*o.array[e+2];s.set(a[h],a[h+1],a[h+2]).applyMatrix4(l),n.set(a[d],a[d+1],a[d+2]).applyMatrix4(l),r.set(a[u],a[u+1],a[u+2]).applyMatrix4(l),t+=this.getSignedVolumeOfTriangle(s,n,r)}return Math.abs(t)}getSignedVolumeOfTriangle(e,t,i){return 1/6*(-(i.x*t.y*e.z)+t.x*i.y*e.z+i.x*e.y*t.z-e.x*i.y*t.z-t.x*e.y*i.z+e.x*t.y*i.z)}};ue(Rl,"uuid","267ca032-672f-4cb0-afa9-d24e904f39d6");let vl=Rl;class Sl{constructor(e){ue(this,"cardinality","required"),ue(this,"instructions"),ue(this,"evalRequirement",((e,t,i,s)=>{const n={parameter:i,currentValue:e,requiredValue:t.parameter,pass:!1};s&&this.addCheckResult(n,s);let r=!1;if("simple"===t.type&&(r=e===t.parameter),"enumeration"===t.type&&(r=t.parameter.includes(e)),"pattern"===t.type&&(r=new RegExp(t.parameter).test(String(e))),"length"===t.type){const{min:i,length:s,max:n}=t.parameter;void 0!==s&&(r=String(e).length===s),void 0!==i&&(r=String(e).length>=i),void 0!==n&&(r=String(e).length<=n)}if("bounds"===t.type&&"number"==typeof e){const{min:i,minInclusive:s,max:n,maxInclusive:o}=t.parameter;let a=!0,l=!0;void 0!==i&&(a=s?e>=i:e>i),void 0!==n&&(l=o?e<=n:e<n),r=a&&l}return"prohibited"===this.cardinality&&(r=!r),"optional"===this.cardinality&&(r=!0),n.pass=r,n.pass})),ue(this,"testResult",[]),this.components=e}addCheckResult(e,t){const i=t.findIndex((({parameter:t})=>t===e.parameter));-1!==i?t[i]=e:t.push(e)}saveResult(e,t){const{GlobalId:i}=e;if(!i)return;const{value:s}=i,n={expressID:s,pass:t,checks:[],cardinality:this.cardinality};this.testResult.push(n)}}const yl=(e,t)=>{let i="";if(!t)return i;if("simple"===t.type&&(i=`<simpleValue>${t.parameter}</simpleValue>`),"enumeration"===t.type&&(i=`<xs:restriction base="xs:string">\n    ${t.parameter.map((e=>`<xs:enumeration value="${e}" />`)).join("\n")}\n    </xs:restriction>`),"pattern"===t.type&&(i=`<xs:restriction base="xs:string">\n      <xs:pattern value="${t.parameter}" />\n    </xs:restriction>`),"bounds"===t.type){const{min:e,minInclusive:s,max:n,maxInclusive:r}=t.parameter;let o="";void 0!==e&&(o=`<xs:min${s?"Inclusive":"Exclusive"} value="${e}">`);let a="";void 0!==n&&(a=`<xs:max${r?"Inclusive":"Exclusive"} value="${n}">`),i=`<xs:restriction base="xs:double">\n      ${o}\n      ${a}\n    </xs:restriction>`}if("length"===t.type){const{length:e,min:s,max:n}=t.parameter;let r="";void 0!==e&&void 0===s&&void 0===n&&(r=`<xs:length value="${e}" />`);let o="";void 0!==s&&void 0===e&&(o=`<xs:minLength value="${s}" />`);let a="";void 0!==n&&void 0===e&&(a=`<xs:maxLength value="${n}" />`),i=`<xs:restriction base="xs:string">\n      ${r}\n      ${o}\n      ${a}\n    </xs:restriction>`}return`<${e[0].toLowerCase()+e.slice(1)}>\n    ${i}\n  </${e[0].toLowerCase()+e.slice(1)}>`};class wl extends Sl{constructor(e,t){super(e),ue(this,"facetType","Attribute"),ue(this,"name"),ue(this,"value"),this.name=t}serialize(e){const t=yl("Name",this.name),i=yl("Value",this.value);let s="";return"requirement"===e&&(s+=`cardinality="${this.cardinality}"`,s+=this.instructions?`instructions="${this.instructions}"`:""),`<attribute ${s}>\n  ${t}\n  ${i}\n</attribute>`}async getEntities(){return[]}async test(e){var t;this.testResult=[];for(const i in e){const s=Number(i),n=e[s],r=[],o={guid:null==(t=n.GlobalId)?void 0:t.value,expressID:s,pass:!1,checks:r,cardinality:this.cardinality};this.testResult.push(o);const a=Object.keys(n).filter((e=>{const t=this.evalRequirement(e,this.name,"Name"),i=n[e];return t&&null===i?"optional"===this.cardinality||"prohibited"===this.cardinality:!(t&&3===(null==i?void 0:i.type)&&2===i.value||t&&Array.isArray(i)&&0===i.length||t&&1===(null==i?void 0:i.type)&&""===i.value.trim())&&t})),l=a.length>0;if(r.push({parameter:"Name",currentValue:l?a[0]:null,requiredValue:this.name.parameter,pass:"prohibited"===this.cardinality?!l:l}),this.value)if(a[0]){const e=n[a[0]];5===(null==e?void 0:e.type)?r.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:"prohibited"===this.cardinality}):this.evalRequirement(e?e.value:null,this.value,"Value",r)}else r.push({parameter:"Value",currentValue:null,requiredValue:this.value.parameter,pass:"prohibited"===this.cardinality});o.pass=r.every((({pass:e})=>e))}const i=[...this.testResult];return this.testResult=[],i}}class Al extends Sl{constructor(e,t){super(e),ue(this,"facetType","Classification"),ue(this,"system"),ue(this,"value"),ue(this,"uri"),this.system=t}serialize(e){const t=yl("System",this.system),i=yl("Value",this.value);let s="";return"requirement"===e&&(s+=`cardinality="${this.cardinality}"`,s+=this.uri?`uri=${this.uri}`:"",s+=this.instructions?`instructions="${this.instructions}"`:""),`<classification ${s}>\n  ${t}\n  ${i}\n</classification>`}async getEntities(e,t={}){var i;const s=[],n={...await e.getAllPropertiesOfType(he.IFCCLASSIFICATIONREFERENCE),...await e.getAllPropertiesOfType(he.IFCCLASSIFICATION)},r=[];for(const t in n){const s=Number(t),n=await e.getProperties(s);if(!n)continue;const o=null==(i=n.ReferencedSource)?void 0:i.value;if(!o)continue;const a=await e.getProperties(o);!a||!this.evalSystem(a)||!this.evalValue(n)||!this.evalURI(n)||r.push(s)}const o=this.components.get(So);for(const i of r){const n=o.getEntitiesWithRelation(e,"HasAssociations",i);for(const i of n){if(i in t)continue;const n=await e.getProperties(i);n&&(t[i]=n,s.push(i))}}return s}async test(e,t){var i;this.testResult=[];for(const s in e){const n=Number(s),r=[],o={guid:null==(i=e[n].GlobalId)?void 0:i.value,expressID:n,pass:!1,checks:r,cardinality:this.cardinality};this.testResult.push(o);let a=!0;const l=await this.getSystems(t,n),c=l.map((e=>this.getSystemName(e))).filter((e=>e));for(const e of l){if(!this.evalSystem(e,r))continue;if(a=!1,!this.value||!this.system)break;if(e.type!==he.IFCCLASSIFICATIONREFERENCE)continue;const t=!this.value||this.evalValue(e,r),i=!this.uri||this.evalURI(e,r);if(t&&i)break}a&&this.addCheckResult({parameter:"System",currentValue:c,requiredValue:this.system,pass:"optional"===this.cardinality},r),o.pass=r.every((({pass:e})=>e))}const s=[...this.testResult];return this.testResult=[],s}async processReferencedSource(e,t){var i;const s=null==(i=t.ReferencedSource)?void 0:i.value;if(!s)return null;const n=await e.getProperties(s);return n?(n.type===he.IFCCLASSIFICATIONREFERENCE&&(n.ReferencedSource=await this.processReferencedSource(e,n)),n):null}async getSystems(e,t){var i;const s=[],n=this.components.get(So),r=n.getEntityRelations(e,t,"HasAssociations");if(r)for(const t of r){const i=await e.getProperties(t);i&&(i.type===he.IFCCLASSIFICATION&&s.push(i),i.type===he.IFCCLASSIFICATIONREFERENCE&&(i.ReferencedSource=await this.processReferencedSource(e,i),i.ReferencedSource&&s.push(i)))}const o=s.map((e=>{var t,i,s;return e.type===he.IFCCLASSIFICATION?null==(t=e.Name)?void 0:t.value:e.type===he.IFCCLASSIFICATIONREFERENCE?null==(s=null==(i=e.ReferencedSource)?void 0:i.Name)?void 0:s.value:null})).filter((e=>e)),a=n.getEntityRelations(e,t,"IsTypedBy");if(!a||!a[0])return s;const l=a[0],c=n.getEntityRelations(e,l,"HasAssociations");if(c)for(const t of c){const n=await e.getProperties(t);if(n){if(n.type===he.IFCCLASSIFICATION){if(o.includes(null==(i=n.Name)?void 0:i.value))continue;s.push(n)}n.type===he.IFCCLASSIFICATIONREFERENCE&&(n.ReferencedSource=await this.processReferencedSource(e,n),n.ReferencedSource&&s.push(n))}}return s}getSystemName(e){var t,i,s,n;if(e.type===he.IFCCLASSIFICATION)return null==(t=e.Name)?void 0:t.value;if(e.type===he.IFCCLASSIFICATIONREFERENCE){if((null==(i=e.ReferencedSource)?void 0:i.type)===he.IFCCLASSIFICATIONREFERENCE)return this.getSystemName(e.ReferencedSource);if((null==(s=e.ReferencedSource)?void 0:s.type)===he.IFCCLASSIFICATION)return null==(n=e.ReferencedSource.Name)?void 0:n.value}return null}getAllReferenceIdentifications(e){if(e.type!==he.IFCCLASSIFICATIONREFERENCE)return null;const t=[];if(e.Identification&&t.push(e.Identification.value),e.ReferencedSource){const i=this.getAllReferenceIdentifications(e.ReferencedSource);i&&t.push(...i)}return t}evalSystem(e,t){const i=this.getSystemName(e);return this.evalRequirement(i,this.system,"System",t)}evalValue(e,t){if(!this.value)return!0;const i=this.getAllReferenceIdentifications(e);if(!i)return!1;const s=i.find((e=>!!this.value&&this.evalRequirement(e,this.value,"Value")));return t&&this.addCheckResult({parameter:"Value",currentValue:s??null,requiredValue:this.value,pass:!!s},t),!!s}evalURI(e,t){var i;return!this.uri||this.evalRequirement(null==(i=e.Location)?void 0:i.value,{type:"simple",parameter:this.uri},"URI",t)}}class Fl extends Sl{constructor(e,t){super(e),ue(this,"facetType","Entity"),ue(this,"name"),ue(this,"predefinedType"),this.name=t}serialize(e){const t=yl("Name",this.name),i=yl("Name",this.predefinedType);let s="";return"requirement"===e&&(s+=`cardinality="${this.cardinality}"`,s+=this.instructions?`instructions="${this.instructions}"`:""),`<entity ${s}>\n  ${t}\n  ${i}\n</entity>`}async getEntities(e,t={}){const i=Object.entries(so),s=[];for(const[e]of i)await this.evalName({type:e})&&s.push(Number(e));let n={};for(const t of s){const i=await e.getAllPropertiesOfType(t);i&&(n={...n,...i})}if(!this.predefinedType){for(const e in n)e in t||(t[e]=n[e]);return Object.keys(n).map(Number)}const r=[];for(const i in n){const s=Number(i);if(s in t)continue;const o=n[s];await this.evalPredefinedType(e,o)&&(t[s]=o,r.push(s))}return r}async test(e,t){var i;this.testResult=[];for(const s in e){const n=Number(s),r=e[n],o=[],a={guid:null==(i=r.GlobalId)?void 0:i.value,expressID:n,pass:!1,checks:o,cardinality:this.cardinality};this.testResult.push(a),await this.evalName(r,o),await this.evalPredefinedType(t,r,o),a.pass=o.every((({pass:e})=>e))}return this.testResult}async evalName(e,t){const i=so[e.type];return this.evalRequirement(i,this.name,"Name",t)}async evalPredefinedType(e,t,i){var s,n,r,o;if(!this.predefinedType)return null;const a=this.components.get(So),l="string"==typeof this.predefinedType.parameter&&"USERDEFINED"===this.predefinedType.parameter;let c=null==(s=t.PredefinedType)?void 0:s.value;if("USERDEFINED"===c&&!l){const e=Object.keys(t).find((e=>/^((?!Predefined).)*Type$/.test(e)));c=e?null==(n=t[e])?void 0:n.value:"USERDEFINED"}if(!c){const i=a.getEntityRelations(e,t.expressID,"IsTypedBy");if(i&&i[0]){const t=await e.getProperties(i[0]);if(t&&(c=null==(r=t.PredefinedType)?void 0:r.value,"USERDEFINED"===c&&!l)){const e=Object.keys(t).find((e=>/^((?!Predefined).)*Type$/.test(e)));c=e?null==(o=t[e])?void 0:o.value:"USERDEFINED"}}}return this.evalRequirement(c,this.predefinedType,"PredefinedType",i)}}class Ol extends Sl{constructor(e,t,i){super(e),ue(this,"facetType","Property"),ue(this,"propertySet"),ue(this,"baseName"),ue(this,"value"),ue(this,"dataType"),ue(this,"uri"),ue(this,"_unsupportedTypes",[he.IFCCOMPLEXPROPERTY,he.IFCPHYSICALCOMPLEXQUANTITY]),this.propertySet=t,this.baseName=i}serialize(e){const t=yl("PropertySet",this.propertySet),i=yl("BaseName",this.baseName),s=yl("Value",this.value),n=this.dataType?`dataType=${this.dataType}`:"";let r="";return"requirement"===e&&(r+=`cardinality="${this.cardinality}"`,r+=this.uri?`uri=${this.uri}`:"",r+=this.instructions?`instructions="${this.instructions}"`:""),`<property ${n} ${r}>\n  ${t}\n  ${i}\n  ${s}\n</property>`}async getEntities(e,t={}){var i,s;let n={};const r=await e.getAllPropertiesOfType(he.IFCPROPERTYSET);n={...n,...r};const o=await e.getAllPropertiesOfType(he.IFCELEMENTQUANTITY);if(n={...n,...o},0===Object.keys(n).length)return[];const a=[];for(const t in n){const n=Number(t),r=await e.getProperties(n);if(!r||(null==(i=r.Name)?void 0:i.value)!==this.propertySet.parameter)continue;let o;if(r.type===he.IFCPROPERTYSET&&(o="HasProperties"),r.type===he.IFCELEMENTQUANTITY&&(o="Quantities"),o)for(const t of r[o]){const i=await e.getProperties(t.value);if(i&&(null==(s=i.Name)?void 0:s.value)===this.baseName.parameter){if(this.value){const e=Object.keys(i).find((e=>e.endsWith("Value")));if(!e||i[e].value!==this.value.parameter)continue}a.push(n)}}}const l=this.components.get(So);for(const i of a){const s=l.getEntitiesWithRelation(e,"IsDefinedBy",i);for(const i of s){if(i in t)continue;const s=await e.getProperties(i);s&&(t[i]=s)}}return[]}async test(e,t){var i;this.testResult=[];for(const s in e){const n=Number(s),r=e[n],o=[],a={guid:null==(i=r.GlobalId)?void 0:i.value,expressID:n,pass:!1,checks:o,cardinality:this.cardinality};this.testResult.push(a);const l=(await this.getPsets(t,n)).filter((e=>!!this.evalRequirement(e.Name??null,this.propertySet,"PropertySet")&&(o.push({currentValue:e.Name,parameter:"PropertySet",pass:!0,requiredValue:this.propertySet.parameter}),!0)));if(0!==l.length){for(const e of l){if(!("Properties"in e)){o.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter});continue}const t=e.Properties.filter((e=>{var t;return!(this._unsupportedTypes.includes(e.type)||!this.evalRequirement((null==(t=e.Name)?void 0:t.value)??null,this.baseName,"BaseName"))&&(o.push({currentValue:e.Name.value,parameter:"BaseName",pass:!0,requiredValue:this.baseName.parameter}),!0)}));if(0!==t.length)for(const e of t)this.evalValue(e,o),this.evalDataType(e,o),this.evalURI();else o.push({currentValue:null,parameter:"BaseName",pass:!1,requiredValue:this.baseName.parameter})}a.pass=o.every((({pass:e})=>e))}else o.push({currentValue:null,parameter:"PropertySet",pass:!1,requiredValue:this.propertySet.parameter})}const s=[...this.testResult];return this.testResult=[],s}getItemsAttrName(e){let t;return e===he.IFCPROPERTYSET&&(t="HasProperties"),e===he.IFCELEMENTQUANTITY&&(t="Quantities"),t}getValueKey(e){return Object.keys(e).find((e=>e.endsWith("Value")||e.endsWith("Values")))}async simplifyPset(e,t,i){var s;const n=[],r=t[i];if(!r)return t;for(const{value:t}of r){const i=await e.getProperties(t);i&&n.push(i)}return{Name:null==(s=t.Name)?void 0:s.value,Properties:n,type:t.type}}async getTypePsets(e,t){const i=[],s=this.components.get(So).getEntityRelations(e,t,"IsTypedBy");if(!s||!s[0])return i;const n=await e.getProperties(s[0]);if(!(n&&"HasPropertySets"in n&&Array.isArray(n.HasPropertySets)))return i;for(const{value:t}of n.HasPropertySets){const s=await e.getProperties(t);if(!(s&&"HasProperties"in s&&Array.isArray(s.HasProperties)))continue;const n=await this.simplifyPset(e,s,"HasProperties");i.push(n)}return i}async getPsets(e,t){var i;const s=await this.getTypePsets(e,t),n=this.components.get(So).getEntityRelations(e,t,"IsDefinedBy");if(!n)return s;const r=[];for(const t of n){const n=await e.getProperties(t);if(!n)continue;const o=this.getItemsAttrName(n.type);if(!o)continue;const a=await this.simplifyPset(e,n,o),l=s.find((({Name:e})=>e===a.Name));if(l)for(const e of l.Properties){const t=null==(i=e.Name)?void 0:i.value;a.Properties.find((({Name:e})=>e.value===t))||a.Properties.push(e)}r.push(a)}return r}evalValue(e,t){const i=this.getValueKey(e),s=e[i];if(this.value){if(!s)return null==t||t.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:this.value.parameter}),!1;const i=structuredClone(this.value);if("IFCLABEL"===s.name&&"simple"===i.type&&(i.parameter=String(i.parameter)),(e.type===he.IFCPROPERTYLISTVALUE||e.type===he.IFCPROPERTYENUMERATEDVALUE)&&Array.isArray(s)){const e=s.map((e=>e.value)),n=s.find((e=>!!i&&this.evalRequirement(e.value,i,"Value")));return null==t||t.push({currentValue:e,pass:!!n,parameter:"Value",requiredValue:i.parameter}),!!n}return this.evalRequirement(s.value,i,"Value",t)}return!i||(3===s.type&&2===s.value?(null==t||t.push({parameter:"Value",currentValue:null,pass:!1,requiredValue:null}),!1):1!==s.type||""!==s.value.trim()||(null==t||t.push({parameter:"Value",currentValue:"",pass:!1,requiredValue:null}),!1))}evalDataType(e,t){if(!this.dataType)return!0;const i=e[this.getValueKey(e)];if(!i)return null==t||t.push({parameter:"DataType",currentValue:null,pass:!1,requiredValue:this.dataType}),!1;if((e.type===he.IFCPROPERTYLISTVALUE||e.type===he.IFCPROPERTYENUMERATEDVALUE)&&Array.isArray(i)&&i[0]){const e=i[0].name;return this.evalRequirement(e,{type:"simple",parameter:this.dataType},"DataType",t)}return this.evalRequirement(i.name,{type:"simple",parameter:this.dataType},"DataType",t)}evalURI(){return!0}}class Nl{constructor(e,t,i){ue(this,"name"),ue(this,"ifcVersion",new Set),ue(this,"identifier",Is.create()),ue(this,"description"),ue(this,"instructions"),ue(this,"requirementsDescription"),ue(this,"applicability",new Zi),ue(this,"requirements",new Zi),ue(this,"components"),this.components=e,this.name=t;for(const e of i)this.ifcVersion.add(e)}set(e){const t=e,i=this;for(const s in e){if("identifier"===s)continue;const e=t[s];s in this&&(i[s]=e)}return this.components.get(_l).list.set(this.identifier,this),this}async test(e){let t=[];if(0===this.requirements.size)return t;const i={};for(const t of this.applicability)await t.getEntities(e,i);return t=await[...this.requirements][0].test(i,e),t}serialize(){const e=`name="${this.name}"`,t=this.identifier?`identifier="${this.identifier}"`:"",i=this.description?`description="${this.description}"`:"",s=this.instructions?`instructions="${this.instructions}"`:"";return`<specification ifcVersion="${[...this.ifcVersion].join(" ")}" ${e} ${t} ${i} ${s}>\n      <applicability minOccurs="1" maxOccurs="unbounded">\n        ${[...this.applicability].map((e=>e.serialize("applicability"))).join("\n")}\n      </applicability>\n      <requirements>\n        ${[...this.requirements].map((e=>e.serialize("requirement"))).join("\n")}\n      </requirements>\n    </specification>`}}const Pl=e=>{if(!e)return;const t={};if("simpleValue"in e&&(t.type="simple",t.parameter=e.simpleValue),"restriction"in e){const i=e.restriction;if("pattern"in i&&(t.type="pattern",t.parameter=i.pattern.value),"enumeration"in i){t.type="enumeration";const e=i.enumeration.map((({value:e})=>e));t.parameter=e}}return void 0!==t.parameter?t:void 0},xl=(e,t)=>{const i=[];for(const s of t){const t=s.name,n=Pl(t);if(!n)continue;const r=new Fl(e,n);s.cardinality&&(r.cardinality=s.cardinality),r.predefinedType=Pl(s.predefinedType),r.instructions=s.instructions,i.push(r)}return i},Ll=(e,t)=>{const i=[];for(const s of t){const t=s.name,n=Pl(t);if(!n)continue;const r=new wl(e,n);s.cardinality&&(r.cardinality=s.cardinality),r.value=Pl(s.value),r.instructions=s.instructions,i.push(r)}return i},bl=(e,t)=>{const i=[];for(const s of t){const t=s.system,n=Pl(t);if(!n)continue;const r=new Al(e,n);s.cardinality&&(r.cardinality=s.cardinality);const o=Pl(s.value);"simple"===(null==o?void 0:o.type)&&(o.parameter=String(o.parameter)),"enumeration"===(null==o?void 0:o.type)&&Array.isArray(o.parameter)&&(o.parameter=o.parameter.map(String)),r.value=o,r.uri=s.uri,r.instructions=s.instructions,i.push(r)}return i},Ml=(e,t)=>{const i=[];for(const s of t){const t=s.propertySet,n=s.baseName,r=Pl(t),o=Pl(n);if(!o||!r)continue;const a=new Ol(e,r,o);s.cardinality&&(a.cardinality=s.cardinality);const l=Pl(s.value);"enumeration"===(null==l?void 0:l.type)&&Array.isArray(l.parameter)&&(l.parameter=l.parameter.map(String)),a.value=l,a.dataType=s.dataType,a.uri=s.uri,a.instructions=s.instructions,i.push(a)}return i},Dl=class e extends ki{constructor(t){super(t),ue(this,"enabled",!0),ue(this,"list",new ji),t.add(e.uuid,this)}getFragmentIdMap(e,t){const i=t.filter((e=>e.pass)).map((e=>e.expressID)),s=e.getFragmentMap(i),n=t.filter((e=>!e.pass)).map((e=>e.expressID));return{pass:s,fail:e.getFragmentMap(n)}}create(e,t,i){const s=new Nl(this.components,e,t);return i&&(s.identifier=i),this.list.set(s.identifier,s),s}load(t){const i=[],s=e.xmlParser.parse(t).ids,{specifications:n}=s;if(n&&n.specification){const e=Array.isArray(n.specification)?n.specification:[n.specification];for(const t of e){const{name:e,ifcVersion:s,description:n,instructions:r,identifier:o}=t;if(!e||!s)continue;const a=[],l=[],{applicability:c,requirements:h}=t;if(c){const{maxOccurs:e,...t}=c,i=Array.isArray(t)?t:[t];for(const e of i)for(const t in e){const i=Array.isArray(e[t])?e[t]:[e[t]];if("entity"===t){const e=xl(this.components,i);a.push(...e)}}}let d;if(h){const{maxOccurs:e,...t}=h;d=h.description;const i=Array.isArray(t)?t:[t];for(const e of i)for(const t in e){const i=Array.isArray(e[t])?e[t]:[e[t]];if("entity"===t){const e=xl(this.components,i);l.push(...e)}if("attribute"===t){const e=Ll(this.components,i);l.push(...e)}if("classification"===t){const e=bl(this.components,i);l.push(...e)}if("property"===t){const e=Ml(this.components,i);l.push(...e)}}}if(a.length>0&&l.length>0){const t=this.create(e,s.split(/\s+/),o);t.description=n,t.instructions=r,t.requirementsDescription=d,t.applicability.add(...a),t.requirements.add(...l),i.push(t)}}}return i}export(e,t=this.list.values()){const i=t??this.list;return`<ids xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://standards.buildingsmart.org/IDS http://standards.buildingsmart.org/IDS/1.0/ids.xsd" xmlns:ids="http://standards.buildingsmart.org/IDS">\n  \x3c!-- Made with That Open Engine ${Ks.release} (https://github.com/thatopen/engine_components) --\x3e\n  <info>\n    <title>${e.title}</title>\n    ${e.copyright?`<copyright>${e.copyright}</copyright>`:""}\n    ${e.version?`<version>${e.version}</version>`:""}\n    ${e.description?`<description>${e.description}</description>`:""}\n    ${e.author?`<author>${e.author}</author>`:""}\n    ${e.date?`<date>${e.date.toISOString().split("T")[0]}</date>`:""}\n    ${e.purpose?`<purpose>${e.purpose}</purpose>`:""}\n    ${e.milestone?`<milestone>${e.milestone}</milestone>`:""}\n  </info>\n  <specifications>\n    ${[...i].map((e=>e.serialize())).join("\n")}\n  </specifications>\n</ids>`}};ue(Dl,"uuid","9f0b9f78-9b2e-481a-b766-2fbfd01f342c"),ue(Dl,"xmlParser",new Za.XMLParser({allowBooleanAttributes:!0,attributeNamePrefix:"",ignoreAttributes:!1,ignoreDeclaration:!0,ignorePiTags:!0,numberParseOptions:{leadingZeros:!0,hex:!0},parseAttributeValue:!0,preserveOrder:!1,processEntities:!1,removeNSPrefix:!0,trimValues:!0}));let _l=Dl;const Ul=new a,Bl=new s;class Vl extends L{constructor(){super(),this.isLineSegmentsGeometry=!0,this.type="LineSegmentsGeometry";this.setIndex([0,2,1,2,3,1,2,4,3,4,5,3,4,6,5,6,7,5]),this.setAttribute("position",new R([-1,2,0,1,2,0,-1,1,0,1,1,0,-1,0,0,1,0,0,-1,-1,0,1,-1,0],3)),this.setAttribute("uv",new R([-1,2,1,2,-1,1,1,1,-1,-1,1,-1,-1,-2,1,-2],2))}applyMatrix4(e){const t=this.attributes.instanceStart,i=this.attributes.instanceEnd;return void 0!==t&&(t.applyMatrix4(e),i.applyMatrix4(e),t.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}setPositions(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new b(t,6,1);return this.setAttribute("instanceStart",new M(i,3,0)),this.setAttribute("instanceEnd",new M(i,3,3)),this.computeBoundingBox(),this.computeBoundingSphere(),this}setColors(e){let t;e instanceof Float32Array?t=e:Array.isArray(e)&&(t=new Float32Array(e));const i=new b(t,6,1);return this.setAttribute("instanceColorStart",new M(i,3,0)),this.setAttribute("instanceColorEnd",new M(i,3,3)),this}fromWireframeGeometry(e){return this.setPositions(e.attributes.position.array),this}fromEdgesGeometry(e){return this.setPositions(e.attributes.position.array),this}fromMesh(e){return this.fromWireframeGeometry(new D(e.geometry)),this}fromLineSegments(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new a);const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;void 0!==e&&void 0!==t&&(this.boundingBox.setFromBufferAttribute(e),Ul.setFromBufferAttribute(t),this.boundingBox.union(Ul))}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new p),null===this.boundingBox&&this.computeBoundingBox();const e=this.attributes.instanceStart,t=this.attributes.instanceEnd;if(void 0!==e&&void 0!==t){const i=this.boundingSphere.center;this.boundingBox.getCenter(i);let s=0;for(let n=0,r=e.count;n<r;n++)Bl.fromBufferAttribute(e,n),s=Math.max(s,i.distanceToSquared(Bl)),Bl.fromBufferAttribute(t,n),s=Math.max(s,i.distanceToSquared(Bl));this.boundingSphere.radius=Math.sqrt(s),isNaN(this.boundingSphere.radius)&&console.error("THREE.LineSegmentsGeometry.computeBoundingSphere(): Computed radius is NaN. The instanced position data is likely to have NaN values.",this)}}toJSON(){}applyMatrix(e){return console.warn("THREE.LineSegmentsGeometry: applyMatrix() has been renamed to applyMatrix4()."),this.applyMatrix4(e)}}_.line={worldUnits:{value:1},linewidth:{value:1},resolution:{value:new n(1,1)},dashOffset:{value:0},dashScale:{value:1},dashSize:{value:1},gapSize:{value:1}},U.line={uniforms:B.merge([_.common,_.fog,_.line]),vertexShader:"\n\t\t#include <common>\n\t\t#include <color_pars_vertex>\n\t\t#include <fog_pars_vertex>\n\t\t#include <logdepthbuf_pars_vertex>\n\t\t#include <clipping_planes_pars_vertex>\n\n\t\tuniform float linewidth;\n\t\tuniform vec2 resolution;\n\n\t\tattribute vec3 instanceStart;\n\t\tattribute vec3 instanceEnd;\n\n\t\tattribute vec3 instanceColorStart;\n\t\tattribute vec3 instanceColorEnd;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashScale;\n\t\t\tattribute float instanceDistanceStart;\n\t\t\tattribute float instanceDistanceEnd;\n\t\t\tvarying float vLineDistance;\n\n\t\t#endif\n\n\t\tvoid trimSegment( const in vec4 start, inout vec4 end ) {\n\n\t\t\t// trim end segment so it terminates between the camera plane and the near plane\n\n\t\t\t// conservative estimate of the near plane\n\t\t\tfloat a = projectionMatrix[ 2 ][ 2 ]; // 3nd entry in 3th column\n\t\t\tfloat b = projectionMatrix[ 3 ][ 2 ]; // 3nd entry in 4th column\n\t\t\tfloat nearEstimate = - 0.5 * b / a;\n\n\t\t\tfloat alpha = ( nearEstimate - start.z ) / ( end.z - start.z );\n\n\t\t\tend.xyz = mix( start.xyz, end.xyz, alpha );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#ifdef USE_COLOR\n\n\t\t\t\tvColor.xyz = ( position.y < 0.5 ) ? instanceColorStart : instanceColorEnd;\n\n\t\t\t#endif\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvLineDistance = ( position.y < 0.5 ) ? dashScale * instanceDistanceStart : dashScale * instanceDistanceEnd;\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\tfloat aspect = resolution.x / resolution.y;\n\n\t\t\t// camera space\n\t\t\tvec4 start = modelViewMatrix * vec4( instanceStart, 1.0 );\n\t\t\tvec4 end = modelViewMatrix * vec4( instanceEnd, 1.0 );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tworldStart = start.xyz;\n\t\t\t\tworldEnd = end.xyz;\n\n\t\t\t#else\n\n\t\t\t\tvUv = uv;\n\n\t\t\t#endif\n\n\t\t\t// special case for perspective projection, and segments that terminate either in, or behind, the camera plane\n\t\t\t// clearly the gpu firmware has a way of addressing this issue when projecting into ndc space\n\t\t\t// but we need to perform ndc-space calculations in the shader, so we must address this issue directly\n\t\t\t// perhaps there is a more elegant solution -- WestLangley\n\n\t\t\tbool perspective = ( projectionMatrix[ 2 ][ 3 ] == - 1.0 ); // 4th entry in the 3rd column\n\n\t\t\tif ( perspective ) {\n\n\t\t\t\tif ( start.z < 0.0 && end.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( start, end );\n\n\t\t\t\t} else if ( end.z < 0.0 && start.z >= 0.0 ) {\n\n\t\t\t\t\ttrimSegment( end, start );\n\n\t\t\t\t}\n\n\t\t\t}\n\n\t\t\t// clip space\n\t\t\tvec4 clipStart = projectionMatrix * start;\n\t\t\tvec4 clipEnd = projectionMatrix * end;\n\n\t\t\t// ndc space\n\t\t\tvec3 ndcStart = clipStart.xyz / clipStart.w;\n\t\t\tvec3 ndcEnd = clipEnd.xyz / clipEnd.w;\n\n\t\t\t// direction\n\t\t\tvec2 dir = ndcEnd.xy - ndcStart.xy;\n\n\t\t\t// account for clip-space aspect ratio\n\t\t\tdir.x *= aspect;\n\t\t\tdir = normalize( dir );\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\tvec3 worldDir = normalize( end.xyz - start.xyz );\n\t\t\t\tvec3 tmpFwd = normalize( mix( start.xyz, end.xyz, 0.5 ) );\n\t\t\t\tvec3 worldUp = normalize( cross( worldDir, tmpFwd ) );\n\t\t\t\tvec3 worldFwd = cross( worldDir, worldUp );\n\t\t\t\tworldPos = position.y < 0.5 ? start: end;\n\n\t\t\t\t// height offset\n\t\t\t\tfloat hw = linewidth * 0.5;\n\t\t\t\tworldPos.xyz += position.x < 0.0 ? hw * worldUp : - hw * worldUp;\n\n\t\t\t\t// don't extend the line if we're rendering dashes because we\n\t\t\t\t// won't be rendering the endcaps\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t// cap extension\n\t\t\t\t\tworldPos.xyz += position.y < 0.5 ? - hw * worldDir : hw * worldDir;\n\n\t\t\t\t\t// add width to the box\n\t\t\t\t\tworldPos.xyz += worldFwd * hw;\n\n\t\t\t\t\t// endcaps\n\t\t\t\t\tif ( position.y > 1.0 || position.y < 0.0 ) {\n\n\t\t\t\t\t\tworldPos.xyz -= worldFwd * 2.0 * hw;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t\t// project the worldpos\n\t\t\t\tvec4 clip = projectionMatrix * worldPos;\n\n\t\t\t\t// shift the depth of the projected points so the line\n\t\t\t\t// segments overlap neatly\n\t\t\t\tvec3 clipPose = ( position.y < 0.5 ) ? ndcStart : ndcEnd;\n\t\t\t\tclip.z = clipPose.z * clip.w;\n\n\t\t\t#else\n\n\t\t\t\tvec2 offset = vec2( dir.y, - dir.x );\n\t\t\t\t// undo aspect ratio adjustment\n\t\t\t\tdir.x /= aspect;\n\t\t\t\toffset.x /= aspect;\n\n\t\t\t\t// sign flip\n\t\t\t\tif ( position.x < 0.0 ) offset *= - 1.0;\n\n\t\t\t\t// endcaps\n\t\t\t\tif ( position.y < 0.0 ) {\n\n\t\t\t\t\toffset += - dir;\n\n\t\t\t\t} else if ( position.y > 1.0 ) {\n\n\t\t\t\t\toffset += dir;\n\n\t\t\t\t}\n\n\t\t\t\t// adjust for linewidth\n\t\t\t\toffset *= linewidth;\n\n\t\t\t\t// adjust for clip-space to screen-space conversion // maybe resolution should be based on viewport ...\n\t\t\t\toffset /= resolution.y;\n\n\t\t\t\t// select end\n\t\t\t\tvec4 clip = ( position.y < 0.5 ) ? clipStart : clipEnd;\n\n\t\t\t\t// back to clip space\n\t\t\t\toffset *= clip.w;\n\n\t\t\t\tclip.xy += offset;\n\n\t\t\t#endif\n\n\t\t\tgl_Position = clip;\n\n\t\t\tvec4 mvPosition = ( position.y < 0.5 ) ? start : end; // this is an approximation\n\n\t\t\t#include <logdepthbuf_vertex>\n\t\t\t#include <clipping_planes_vertex>\n\t\t\t#include <fog_vertex>\n\n\t\t}\n\t\t",fragmentShader:"\n\t\tuniform vec3 diffuse;\n\t\tuniform float opacity;\n\t\tuniform float linewidth;\n\n\t\t#ifdef USE_DASH\n\n\t\t\tuniform float dashOffset;\n\t\t\tuniform float dashSize;\n\t\t\tuniform float gapSize;\n\n\t\t#endif\n\n\t\tvarying float vLineDistance;\n\n\t\t#ifdef WORLD_UNITS\n\n\t\t\tvarying vec4 worldPos;\n\t\t\tvarying vec3 worldStart;\n\t\t\tvarying vec3 worldEnd;\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tvarying vec2 vUv;\n\n\t\t\t#endif\n\n\t\t#else\n\n\t\t\tvarying vec2 vUv;\n\n\t\t#endif\n\n\t\t#include <common>\n\t\t#include <color_pars_fragment>\n\t\t#include <fog_pars_fragment>\n\t\t#include <logdepthbuf_pars_fragment>\n\t\t#include <clipping_planes_pars_fragment>\n\n\t\tvec2 closestLineToLine(vec3 p1, vec3 p2, vec3 p3, vec3 p4) {\n\n\t\t\tfloat mua;\n\t\t\tfloat mub;\n\n\t\t\tvec3 p13 = p1 - p3;\n\t\t\tvec3 p43 = p4 - p3;\n\n\t\t\tvec3 p21 = p2 - p1;\n\n\t\t\tfloat d1343 = dot( p13, p43 );\n\t\t\tfloat d4321 = dot( p43, p21 );\n\t\t\tfloat d1321 = dot( p13, p21 );\n\t\t\tfloat d4343 = dot( p43, p43 );\n\t\t\tfloat d2121 = dot( p21, p21 );\n\n\t\t\tfloat denom = d2121 * d4343 - d4321 * d4321;\n\n\t\t\tfloat numer = d1343 * d4321 - d1321 * d4343;\n\n\t\t\tmua = numer / denom;\n\t\t\tmua = clamp( mua, 0.0, 1.0 );\n\t\t\tmub = ( d1343 + d4321 * ( mua ) ) / d4343;\n\t\t\tmub = clamp( mub, 0.0, 1.0 );\n\n\t\t\treturn vec2( mua, mub );\n\n\t\t}\n\n\t\tvoid main() {\n\n\t\t\t#include <clipping_planes_fragment>\n\n\t\t\t#ifdef USE_DASH\n\n\t\t\t\tif ( vUv.y < - 1.0 || vUv.y > 1.0 ) discard; // discard endcaps\n\n\t\t\t\tif ( mod( vLineDistance + dashOffset, dashSize + gapSize ) > dashSize ) discard; // todo - FIX\n\n\t\t\t#endif\n\n\t\t\tfloat alpha = opacity;\n\n\t\t\t#ifdef WORLD_UNITS\n\n\t\t\t\t// Find the closest points on the view ray and the line segment\n\t\t\t\tvec3 rayEnd = normalize( worldPos.xyz ) * 1e5;\n\t\t\t\tvec3 lineDir = worldEnd - worldStart;\n\t\t\t\tvec2 params = closestLineToLine( worldStart, worldEnd, vec3( 0.0, 0.0, 0.0 ), rayEnd );\n\n\t\t\t\tvec3 p1 = worldStart + lineDir * params.x;\n\t\t\t\tvec3 p2 = rayEnd * params.y;\n\t\t\t\tvec3 delta = p1 - p2;\n\t\t\t\tfloat len = length( delta );\n\t\t\t\tfloat norm = len / linewidth;\n\n\t\t\t\t#ifndef USE_DASH\n\n\t\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t\tfloat dnorm = fwidth( norm );\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 0.5 - dnorm, 0.5 + dnorm, norm );\n\n\t\t\t\t\t#else\n\n\t\t\t\t\t\tif ( norm > 0.5 ) {\n\n\t\t\t\t\t\t\tdiscard;\n\n\t\t\t\t\t\t}\n\n\t\t\t\t\t#endif\n\n\t\t\t\t#endif\n\n\t\t\t#else\n\n\t\t\t\t#ifdef USE_ALPHA_TO_COVERAGE\n\n\t\t\t\t\t// artifacts appear on some hardware if a derivative is taken within a conditional\n\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\tfloat len2 = a * a + b * b;\n\t\t\t\t\tfloat dlen = fwidth( len2 );\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\talpha = 1.0 - smoothstep( 1.0 - dlen, 1.0 + dlen, len2 );\n\n\t\t\t\t\t}\n\n\t\t\t\t#else\n\n\t\t\t\t\tif ( abs( vUv.y ) > 1.0 ) {\n\n\t\t\t\t\t\tfloat a = vUv.x;\n\t\t\t\t\t\tfloat b = ( vUv.y > 0.0 ) ? vUv.y - 1.0 : vUv.y + 1.0;\n\t\t\t\t\t\tfloat len2 = a * a + b * b;\n\n\t\t\t\t\t\tif ( len2 > 1.0 ) discard;\n\n\t\t\t\t\t}\n\n\t\t\t\t#endif\n\n\t\t\t#endif\n\n\t\t\tvec4 diffuseColor = vec4( diffuse, alpha );\n\n\t\t\t#include <logdepthbuf_fragment>\n\t\t\t#include <color_fragment>\n\n\t\t\tgl_FragColor = vec4( diffuseColor.rgb, alpha );\n\n\t\t\t#include <tonemapping_fragment>\n\t\t\t#include <colorspace_fragment>\n\t\t\t#include <fog_fragment>\n\t\t\t#include <premultiplied_alpha_fragment>\n\n\t\t}\n\t\t"};class zl extends V{constructor(e){super({type:"LineMaterial",uniforms:B.clone(U.line.uniforms),vertexShader:U.line.vertexShader,fragmentShader:U.line.fragmentShader,clipping:!0}),this.isLineMaterial=!0,this.setValues(e)}get color(){return this.uniforms.diffuse.value}set color(e){this.uniforms.diffuse.value=e}get worldUnits(){return"WORLD_UNITS"in this.defines}set worldUnits(e){!0===e?this.defines.WORLD_UNITS="":delete this.defines.WORLD_UNITS}get linewidth(){return this.uniforms.linewidth.value}set linewidth(e){this.uniforms.linewidth&&(this.uniforms.linewidth.value=e)}get dashed(){return"USE_DASH"in this.defines}set dashed(e){!0===e!==this.dashed&&(this.needsUpdate=!0),!0===e?this.defines.USE_DASH="":delete this.defines.USE_DASH}get dashScale(){return this.uniforms.dashScale.value}set dashScale(e){this.uniforms.dashScale.value=e}get dashSize(){return this.uniforms.dashSize.value}set dashSize(e){this.uniforms.dashSize.value=e}get dashOffset(){return this.uniforms.dashOffset.value}set dashOffset(e){this.uniforms.dashOffset.value=e}get gapSize(){return this.uniforms.gapSize.value}set gapSize(e){this.uniforms.gapSize.value=e}get opacity(){return this.uniforms.opacity.value}set opacity(e){this.uniforms&&(this.uniforms.opacity.value=e)}get resolution(){return this.uniforms.resolution.value}set resolution(e){this.uniforms.resolution.value.copy(e)}get alphaToCoverage(){return"USE_ALPHA_TO_COVERAGE"in this.defines}set alphaToCoverage(e){this.defines&&(!0===e!==this.alphaToCoverage&&(this.needsUpdate=!0),!0===e?(this.defines.USE_ALPHA_TO_COVERAGE="",this.extensions.derivatives=!0):(delete this.defines.USE_ALPHA_TO_COVERAGE,this.extensions.derivatives=!1))}}const kl=new s,Yl=new s,Gl=new z,Hl=new z,Wl=new z,Xl=new s,Zl=new f,jl=new o,Kl=new s,Ql=new a,ql=new p,Jl=new z;let $l,ec;function tc(e,t,i){return Jl.set(0,0,-t,1).applyMatrix4(e.projectionMatrix),Jl.multiplyScalar(1/Jl.w),Jl.x=ec/i.width,Jl.y=ec/i.height,Jl.applyMatrix4(e.projectionMatrixInverse),Jl.multiplyScalar(1/Jl.w),Math.abs(Math.max(Jl.x,Jl.y))}class ic extends l{constructor(e=new Vl,t=new zl({color:16777215*Math.random()})){super(e,t),this.isLineSegments2=!0,this.type="LineSegments2"}computeLineDistances(){const e=this.geometry,t=e.attributes.instanceStart,i=e.attributes.instanceEnd,s=new Float32Array(2*t.count);for(let e=0,n=0,r=t.count;e<r;e++,n+=2)kl.fromBufferAttribute(t,e),Yl.fromBufferAttribute(i,e),s[n]=0===n?0:s[n-1],s[n+1]=s[n]+kl.distanceTo(Yl);const n=new b(s,2,1);return e.setAttribute("instanceDistanceStart",new M(n,1,0)),e.setAttribute("instanceDistanceEnd",new M(n,1,1)),this}raycast(e,t){const i=this.material.worldUnits,n=e.camera;null===n&&!i&&console.error('LineSegments2: "Raycaster.camera" needs to be set in order to raycast against LineSegments2 while worldUnits is set to false.');const r=void 0!==e.params.Line2&&e.params.Line2.threshold||0;$l=e.ray;const o=this.matrixWorld,a=this.geometry,l=this.material;let c,h;if(ec=l.linewidth+r,null===a.boundingSphere&&a.computeBoundingSphere(),ql.copy(a.boundingSphere).applyMatrix4(o),i)c=.5*ec;else{c=tc(n,Math.max(n.near,ql.distanceToPoint($l.origin)),l.resolution)}if(ql.radius+=c,!1!==$l.intersectsSphere(ql)){if(null===a.boundingBox&&a.computeBoundingBox(),Ql.copy(a.boundingBox).applyMatrix4(o),i)h=.5*ec;else{h=tc(n,Math.max(n.near,Ql.distanceToPoint($l.origin)),l.resolution)}Ql.expandByScalar(h),!1!==$l.intersectsBox(Ql)&&(i?function(e,t){const i=e.matrixWorld,n=e.geometry,r=n.attributes.instanceStart,o=n.attributes.instanceEnd;for(let a=0,l=Math.min(n.instanceCount,r.count);a<l;a++){jl.start.fromBufferAttribute(r,a),jl.end.fromBufferAttribute(o,a),jl.applyMatrix4(i);const n=new s,l=new s;$l.distanceSqToSegment(jl.start,jl.end,l,n),l.distanceTo(n)<.5*ec&&t.push({point:l,pointOnLine:n,distance:$l.origin.distanceTo(l),object:e,face:null,faceIndex:a,uv:null,uv1:null})}}(this,t):function(e,t,i){const n=t.projectionMatrix,r=e.material.resolution,o=e.matrixWorld,a=e.geometry,l=a.attributes.instanceStart,c=a.attributes.instanceEnd,h=Math.min(a.instanceCount,l.count),d=-t.near;$l.at(1,Wl),Wl.w=1,Wl.applyMatrix4(t.matrixWorldInverse),Wl.applyMatrix4(n),Wl.multiplyScalar(1/Wl.w),Wl.x*=r.x/2,Wl.y*=r.y/2,Wl.z=0,Xl.copy(Wl),Zl.multiplyMatrices(t.matrixWorldInverse,o);for(let t=0,a=h;t<a;t++){if(Gl.fromBufferAttribute(l,t),Hl.fromBufferAttribute(c,t),Gl.w=1,Hl.w=1,Gl.applyMatrix4(Zl),Hl.applyMatrix4(Zl),Gl.z>d&&Hl.z>d)continue;if(Gl.z>d){const e=Gl.z-Hl.z,t=(Gl.z-d)/e;Gl.lerp(Hl,t)}else if(Hl.z>d){const e=Hl.z-Gl.z,t=(Hl.z-d)/e;Hl.lerp(Gl,t)}Gl.applyMatrix4(n),Hl.applyMatrix4(n),Gl.multiplyScalar(1/Gl.w),Hl.multiplyScalar(1/Hl.w),Gl.x*=r.x/2,Gl.y*=r.y/2,Hl.x*=r.x/2,Hl.y*=r.y/2,jl.start.copy(Gl),jl.start.z=0,jl.end.copy(Hl),jl.end.z=0;const a=jl.closestPointToPointParameter(Xl,!0);jl.at(a,Kl);const h=k.lerp(Gl.z,Hl.z,a),u=h>=-1&&h<=1,f=Xl.distanceTo(Kl)<.5*ec;if(u&&f){jl.start.fromBufferAttribute(l,t),jl.end.fromBufferAttribute(c,t),jl.start.applyMatrix4(o),jl.end.applyMatrix4(o);const n=new s,r=new s;$l.distanceSqToSegment(jl.start,jl.end,r,n),i.push({point:r,pointOnLine:n,distance:$l.origin.distanceTo(r),object:e,face:null,faceIndex:t,uv:null,uv1:null})}}}(this,n,t))}}}class sc extends Vl{constructor(){super(),this.isLineGeometry=!0,this.type="LineGeometry"}setPositions(e){const t=e.length-3,i=new Float32Array(2*t);for(let s=0;s<t;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return super.setPositions(i),this}setColors(e){const t=e.length-3,i=new Float32Array(2*t);for(let s=0;s<t;s+=3)i[2*s]=e[s],i[2*s+1]=e[s+1],i[2*s+2]=e[s+2],i[2*s+3]=e[s+3],i[2*s+4]=e[s+4],i[2*s+5]=e[s+5];return super.setColors(i),this}fromLine(e){const t=e.geometry;return this.setPositions(t.attributes.position.array),this}}class nc extends ic{constructor(e=new sc,t=new zl({color:16777215*Math.random()})){super(e,t),this.isLine2=!0,this.type="Line2"}}const rc=class e{constructor(e,s){t(this,"scene"),t(this,"onSelect",new Bi),t(this,"type"),t(this,"selectCurve"),t(this,"selectPoints"),t(this,"hoverCurve"),t(this,"hoverPoints"),t(this,"caster",new i.Raycaster),this.scene=e,this.type=s,this.hoverCurve=this.newCurve(.003,4473924,!1),this.hoverPoints=this.newPoints(5,4473924),this.selectCurve=this.newCurve(.005,16777215,!0),this.selectPoints=this.newPoints(7,16777215)}dispose(){this.selectCurve&&this.scene.remove(this.selectCurve),this.selectCurve.material.dispose(),this.selectCurve.geometry.dispose(),this.selectCurve=null,this.hoverCurve.material.dispose(),this.hoverCurve.geometry.dispose(),this.hoverCurve=null,this.hoverPoints.material.dispose(),this.hoverPoints.geometry.dispose(),this.selectPoints.material.dispose(),this.selectPoints.geometry.dispose(),this.scene=null}castRay(e,t,s,n){const r=new i.Vector2,o=s.getBoundingClientRect();r.x=(e.clientX-o.left)/o.width*2-1,r.y=-(e.clientY-o.top)/o.height*2+1,this.caster.setFromCamera(r,t);const a=this.caster.intersectObjects(n);return a.length?a[0]:null}select(e){this.highlight(e,this.selectCurve,this.selectPoints,!0),this.onSelect.trigger(e)}unSelect(){this.selectCurve.removeFromParent(),this.selectPoints.removeFromParent()}hover(e){this.highlight(e,this.hoverCurve,this.hoverPoints,!1)}unHover(){this.hoverCurve.removeFromParent(),this.hoverPoints.removeFromParent()}setResolution({x:e,y:t}){this.selectCurve.material.resolution.set(e/t,1),this.hoverCurve.material.resolution.set(e/t,1)}highlight(t,s,n,r){const{alignment:o}=t.curve;this.scene.add(s),this.scene.add(n);const a=[],l=[],c=[];for(const t of o[this.type]){const s=t.mesh.geometry.attributes.position;for(const e of s.array)a.push(e);if(r){let i;if("absolute"===this.type){const{horizontal:e}=t.alignment;i=e[t.index].data.TYPE}else i=t.data.TYPE;const n=e.settings.colors[i]||[1,1,1];for(let e=0;e<s.count;e++)l.push(...n)}const[n,o,h]=s.array;c.push(new i.Vector3(n,o,h))}const h=a[a.length-3],d=a[a.length-2],u=a[a.length-1];c.push(new i.Vector3(h,d,u)),a.length/3>s.geometry.attributes.position.count&&(s.geometry.dispose(),s.geometry=new sc),s.geometry.setPositions(a),r&&s.geometry.setColors(l),n.geometry.setFromPoints(c)}newCurve(e,t,i){const s=new sc,n=new zl({color:t,linewidth:e,vertexColors:i,worldUnits:!1,depthTest:!1}),r=new nc(s,n);return this.scene.add(r),r}newPoints(e,t){const s=new i.BufferGeometry,n=new i.BufferAttribute(new Float32Array,3);s.setAttribute("position",n);const r=new i.PointsMaterial({size:e,color:t,sizeAttenuation:!1,depthTest:!1}),o=new i.Points(s,r);return o.frustumCulled=!1,this.scene.add(o),o}};t(rc,"settings",{colors:{LINE:[213/255,0,1],CIRCULARARC:[0,46,1],CLOTHOID:[0,1,0],PARABOLICARC:[0,1,72/255],CONSTANTGRADIENT:[213/255,0,1]}});let oc=rc;class ac extends m{constructor(e=document.createElement("div")){super(),this.isCSS2DObject=!0,this.element=e,this.element.style.position="absolute",this.element.style.userSelect="none",this.element.setAttribute("draggable",!1),this.center=new n(.5,.5),this.addEventListener("removed",(function(){this.traverse((function(e){e.element instanceof Element&&null!==e.element.parentNode&&e.element.parentNode.removeChild(e.element)}))}))}copy(e,t){return super.copy(e,t),this.element=e.element.cloneNode(!0),this.center=e.center,this}}const lc=new s,cc=new f,hc=new f,dc=new s,uc=new s;class fc{constructor(e={}){const t=this;let i,s,n,r;const o={objects:new WeakMap},a=void 0!==e.element?e.element:document.createElement("div");function l(e,i,s){if(e.isCSS2DObject){lc.setFromMatrixPosition(e.matrixWorld),lc.applyMatrix4(hc);const l=!0===e.visible&&lc.z>=-1&&lc.z<=1&&!0===e.layers.test(s.layers);if(e.element.style.display=!0===l?"":"none",!0===l){e.onBeforeRender(t,i,s);const o=e.element;o.style.transform="translate("+-100*e.center.x+"%,"+-100*e.center.y+"%)translate("+(lc.x*n+n)+"px,"+(-lc.y*r+r)+"px)",o.parentNode!==a&&a.appendChild(o),e.onAfterRender(t,i,s)}const h={distanceToCameraSquared:c(s,e)};o.objects.set(e,h)}for(let t=0,n=e.children.length;t<n;t++)l(e.children[t],i,s)}function c(e,t){return dc.setFromMatrixPosition(e.matrixWorld),uc.setFromMatrixPosition(t.matrixWorld),dc.distanceToSquared(uc)}a.style.overflow="hidden",this.domElement=a,this.getSize=function(){return{width:i,height:s}},this.render=function(e,t){!0===e.matrixWorldAutoUpdate&&e.updateMatrixWorld(),null===t.parent&&!0===t.matrixWorldAutoUpdate&&t.updateMatrixWorld(),cc.copy(t.matrixWorldInverse),hc.multiplyMatrices(t.projectionMatrix,cc),l(e,e,t),function(e){const t=function(e){const t=[];return e.traverse((function(e){e.isCSS2DObject&&t.push(e)})),t}(e).sort((function(e,t){if(e.renderOrder!==t.renderOrder)return t.renderOrder-e.renderOrder;return o.objects.get(e).distanceToCameraSquared-o.objects.get(t).distanceToCameraSquared})),i=t.length;for(let e=0,s=t.length;e<s;e++)t[e].element.style.zIndex=i-e}(e)},this.setSize=function(e,t){i=e,s=t,n=i/2,r=s/2,a.style.width=e+"px",a.style.height=t+"px"}}}class pc{constructor(e,i,s){let n;t(this,"three"),t(this,"world"),t(this,"onDisposed",new Bi),this.world=e,i?n=i:(n=document.createElement("div"),n.style.width="15px",n.style.height="15px",n.style.border="5px solid red"),this.three=new ac(n),(s||e.scene.three).add(this.three),this.visible=!0}set visible(e){this.three.visible=e}get visible(){return this.three.visible}toggleVisibility(){this.visible=!this.visible}dispose(){this.three.removeFromParent(),this.three.element.remove(),this.onDisposed.trigger(),this.onDisposed.reset()}}class mc extends en{constructor(e,s,n){super(e,s,n),t(this,"three2D",new fc),this.onAfterUpdate.add((()=>{if(this.onBeforeUpdate.trigger(this),!this.enabled||!this.currentWorld)return;const e=this.currentWorld.scene.three,t=this.currentWorld.camera.three;e instanceof i.Scene&&this.three2D.render(e,t)})),this.onDisposed.add((()=>{this.three2D.domElement.remove()})),this.onResize.add((({x:e,y:t})=>{this.three2D.setSize(e,t)})),this.setupHtmlRenderer(),this.resize()}setupHtmlRenderer(){this.three2D.domElement.style.position="absolute",this.three2D.domElement.style.top="0px",this.three2D.domElement.style.pointerEvents="none",this.container&&this.container.appendChild(this.three2D.domElement)}}const Ic=class e extends ki{constructor(i){super(i),t(this,"onDisposed",new Bi),t(this,"enabled",!0),t(this,"threshold",50),t(this,"autoCluster",!0),t(this,"list",new Map),t(this,"clusterLabels",new Set),t(this,"currentKeys",new Set),t(this,"_color","white"),t(this,"_markerKey",0),t(this,"_clusterKey",0),t(this,"_worldEvents",new Map),t(this,"_setupWorlds",new Set),i.add(e.uuid,this)}get color(){return this._color}set color(e){this._color=e;for(const[t,i]of this.list)for(const[t,s]of i)s.label.three.element.style.color=e}create(e,t,i,s=!1){this.setupEvents(e,!0);const n=this._markerKey.toString(),r=this.getWorldMarkerList(e);if(r.has(n))return;const o=document.createElement("span");o.innerHTML=t,o.style.color=this._color;const a=new pc(e,o);return a.three.position.copy(i),r.set(n,{key:n,label:a,merged:!1,static:s}),this._markerKey++,n}delete(e){for(const[t,i]of this.list){const t=i.get(e);t&&t.label.dispose(),i.delete(e)}}getWorldMarkerList(e){return this.list.has(e.uuid)||this.list.set(e.uuid,new Map),this.list.get(e.uuid)}dispose(e){for(const[t,i]of this.list){const t=[...i.keys()];for(const s of t){const t=i.get(s);e&&t.type!==e||(t.label.dispose(),i.delete(s))}}if(!e){this.list.clear(),this._markerKey=0;for(const e of this.clusterLabels)e.label.dispose();this.clusterLabels.clear(),this._clusterKey=0,this.currentKeys.clear()}this.onDisposed.trigger()}setupEvents(e,t){if(t&&this._setupWorlds.has(e.uuid)||!e.camera.hasCameraControls())return;const i=this.getWorldEvent(e);e.camera.controls.removeEventListener("sleep",i),e.camera.controls.removeEventListener("rest",i),t&&(e.camera.controls.addEventListener("sleep",i),e.camera.controls.addEventListener("rest",i))}cluster(e){if(!this.autoCluster)return;this.resetMarkers();const t=this.list.get(e.uuid);if(t){for(const[e,i]of t)if(!i.merged&&!i.static){this.currentKeys.clear();for(const[e,s]of t)s.static||i.key!==s.key&&!s.merged&&this.distance(i.label,s.label)<this.threshold&&(this.currentKeys.add(s.key),s.merged=!0);if(this.currentKeys.size>0){this.currentKeys.add(i.key),i.merged=!0;const e=Array.from(this.currentKeys),t=this.getAveragePositionFromLabels(e),s=new pc(i.label.world,this.createClusterElement(this._clusterKey.toString())),{element:n}=s.three;n.textContent=e.length.toString(),s.three.position.copy(t),this.clusterLabels.add({key:this._clusterKey.toString(),markerKeys:e,label:s}),this._clusterKey++}}this.removeMergeMarkers(e)}}getWorldEvent(e){if(!this._worldEvents.has(e.uuid)){const t=()=>{this.cluster(e)};this._worldEvents.set(e.uuid,t)}return this._worldEvents.get(e.uuid)}resetMarkers(){for(const[e,t]of this.list)for(const[e,i]of t)i.merged=!1;for(const e of this.clusterLabels)e.label.dispose();this.clusterLabels.clear(),this._clusterKey=0}removeMergeMarkers(e){const t=this.list.get(e.uuid);if(t){for(const[e,i]of t)i.merged?i.label.dispose():i.label.world.scene.three.add(i.label.three);for(const e of this.clusterLabels)if(1===e.markerKeys.length){for(const[t,i]of this.list){const t=i.get(e.markerKeys[0]);t&&(t.label.world.scene.three.add(t.label.three),t.merged=!1)}e.label.dispose(),this.clusterLabels.delete(e)}}}getAveragePositionFromLabels(e){const t=e.map((e=>{for(const[t,i]of this.list){const t=i.get(e);if(t)return t.label.three.position}return new i.Vector3}));return t.reduce(((e,t)=>e.add(t)),new i.Vector3).divideScalar(t.length)}createClusterElement(e){const t=document.createElement("div");return t.textContent=e,t.style.color="#000000",t.style.background="#FFFFFF",t.style.fontSize="1.2rem",t.style.fontWeight="500",t.style.pointerEvents="auto",t.style.borderRadius="50%",t.style.padding="5px 11px",t.style.textAlign="center",t.style.cursor="pointer",t.addEventListener("pointerdown",(()=>{this.navigateToCluster(e)})),t.addEventListener("pointerover",(()=>{t.style.background="#BCF124"})),t.addEventListener("pointerout",(()=>{t.style.background="#FFFFFF"})),t}getScreenPosition(e){const t=new i.Vector3;if(!e.world.renderer)throw new Error("Renderer not found!");const s=e.three.position.clone();s.project(e.world.camera.three);const n=e.world.renderer.getSize();return t.x=s.x*n.x/2+n.x/2,t.y=-s.y*n.y/2+n.y/2,t}distance(e,t){const i=this.getScreenPosition(e),s=this.getScreenPosition(t),n=i.x-s.x,r=i.y-s.y,o=.5*Math.sqrt(n*n+r*r);return 0===o?this.threshold+1:o}navigateToCluster(e){const t=[],s=Array.from(this.clusterLabels).find((t=>t.key===e));if(!s)return;const n=s.label.world.camera;if(!n.hasCameraControls())return void console.warn("Zoom to clusters only supported with Camera Controls!");for(const e of s.markerKeys)for(const[i,s]of this.list){const i=s.get(e);if(i){const{x:e,y:s,z:n}=i.label.three.position;t.push(e,s,n)}}s.label.dispose(),this.clusterLabels.delete(s);const r=new i.BufferGeometry,o=new Float32Array(t),a=new i.BufferAttribute(o,3);r.setAttribute("position",a);const l=new i.Mesh(r);l.geometry.computeBoundingSphere(),l.geometry.boundingSphere&&n.controls.fitToSphere(l,!0),r.dispose(),l.clear(),t.length=0}};t(Ic,"uuid","4079eb91-79b0-4ede-bcf2-15b837129236");let Ec=Ic;function gc(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Cc={exports:{}};function Tc(e,t,i){i=i||2;var s,n,r,o,a,l,c,h=t&&t.length,d=h?t[0]*i:e.length,u=Rc(e,0,d,i,!0),f=[];if(!u||u.next===u.prev)return f;if(h&&(u=function(e,t,i,s){var n,r,o,a,l,c=[];for(n=0,r=t.length;n<r;n++)o=t[n]*s,a=n<r-1?t[n+1]*s:e.length,(l=Rc(e,o,a,s,!1))===l.next&&(l.steiner=!0),c.push(Lc(l));for(c.sort(Oc),n=0;n<c.length;n++)i=Nc(c[n],i);return i}(e,t,u,i)),e.length>80*i){s=r=e[0],n=o=e[1];for(var p=i;p<d;p+=i)(a=e[p])<s&&(s=a),(l=e[p+1])<n&&(n=l),a>r&&(r=a),l>o&&(o=l);c=0!==(c=Math.max(r-s,o-n))?32767/c:0}return Sc(u,f,i,s,n,c,0),f}function Rc(e,t,i,s,n){var r,o;if(n===Wc(e,t,i,s)>0)for(r=t;r<i;r+=s)o=Yc(r,e[r],e[r+1],o);else for(r=i-s;r>=t;r-=s)o=Yc(r,e[r],e[r+1],o);return o&&_c(o,o.next)&&(Gc(o),o=o.next),o}function vc(e,t){if(!e)return e;t||(t=e);var i,s=e;do{if(i=!1,s.steiner||!_c(s,s.next)&&0!==Dc(s.prev,s,s.next))s=s.next;else{if(Gc(s),(s=t=s.prev)===s.next)break;i=!0}}while(i||s!==t);return t}function Sc(e,t,i,s,n,r,o){if(e){!o&&r&&function(e,t,i,s){var n=e;do{0===n.z&&(n.z=xc(n.x,n.y,t,i,s)),n.prevZ=n.prev,n.nextZ=n.next,n=n.next}while(n!==e);n.prevZ.nextZ=null,n.prevZ=null,function(e){var t,i,s,n,r,o,a,l,c=1;do{for(i=e,e=null,r=null,o=0;i;){for(o++,s=i,a=0,t=0;t<c&&(a++,s=s.nextZ);t++);for(l=c;a>0||l>0&&s;)0!==a&&(0===l||!s||i.z<=s.z)?(n=i,i=i.nextZ,a--):(n=s,s=s.nextZ,l--),r?r.nextZ=n:e=n,n.prevZ=r,r=n;i=s}r.nextZ=null,c*=2}while(o>1)}(n)}(e,s,n,r);for(var a,l,c=e;e.prev!==e.next;)if(a=e.prev,l=e.next,r?wc(e,s,n,r):yc(e))t.push(a.i/i|0),t.push(e.i/i|0),t.push(l.i/i|0),Gc(e),e=l.next,c=l.next;else if((e=l)===c){o?1===o?Sc(e=Ac(vc(e),t,i),t,i,s,n,r,2):2===o&&Fc(e,t,i,s,n,r):Sc(vc(e),t,i,s,n,r,1);break}}}function yc(e){var t=e.prev,i=e,s=e.next;if(Dc(t,i,s)>=0)return!1;for(var n=t.x,r=i.x,o=s.x,a=t.y,l=i.y,c=s.y,h=n<r?n<o?n:o:r<o?r:o,d=a<l?a<c?a:c:l<c?l:c,u=n>r?n>o?n:o:r>o?r:o,f=a>l?a>c?a:c:l>c?l:c,p=s.next;p!==t;){if(p.x>=h&&p.x<=u&&p.y>=d&&p.y<=f&&bc(n,a,r,l,o,c,p.x,p.y)&&Dc(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}function wc(e,t,i,s){var n=e.prev,r=e,o=e.next;if(Dc(n,r,o)>=0)return!1;for(var a=n.x,l=r.x,c=o.x,h=n.y,d=r.y,u=o.y,f=a<l?a<c?a:c:l<c?l:c,p=h<d?h<u?h:u:d<u?d:u,m=a>l?a>c?a:c:l>c?l:c,I=h>d?h>u?h:u:d>u?d:u,E=xc(f,p,t,i,s),g=xc(m,I,t,i,s),C=e.prevZ,T=e.nextZ;C&&C.z>=E&&T&&T.z<=g;){if(C.x>=f&&C.x<=m&&C.y>=p&&C.y<=I&&C!==n&&C!==o&&bc(a,h,l,d,c,u,C.x,C.y)&&Dc(C.prev,C,C.next)>=0||(C=C.prevZ,T.x>=f&&T.x<=m&&T.y>=p&&T.y<=I&&T!==n&&T!==o&&bc(a,h,l,d,c,u,T.x,T.y)&&Dc(T.prev,T,T.next)>=0))return!1;T=T.nextZ}for(;C&&C.z>=E;){if(C.x>=f&&C.x<=m&&C.y>=p&&C.y<=I&&C!==n&&C!==o&&bc(a,h,l,d,c,u,C.x,C.y)&&Dc(C.prev,C,C.next)>=0)return!1;C=C.prevZ}for(;T&&T.z<=g;){if(T.x>=f&&T.x<=m&&T.y>=p&&T.y<=I&&T!==n&&T!==o&&bc(a,h,l,d,c,u,T.x,T.y)&&Dc(T.prev,T,T.next)>=0)return!1;T=T.nextZ}return!0}function Ac(e,t,i){var s=e;do{var n=s.prev,r=s.next.next;!_c(n,r)&&Uc(n,s,s.next,r)&&zc(n,r)&&zc(r,n)&&(t.push(n.i/i|0),t.push(s.i/i|0),t.push(r.i/i|0),Gc(s),Gc(s.next),s=e=r),s=s.next}while(s!==e);return vc(s)}function Fc(e,t,i,s,n,r){var o=e;do{for(var a=o.next.next;a!==o.prev;){if(o.i!==a.i&&Mc(o,a)){var l=kc(o,a);return o=vc(o,o.next),l=vc(l,l.next),Sc(o,t,i,s,n,r,0),void Sc(l,t,i,s,n,r,0)}a=a.next}o=o.next}while(o!==e)}function Oc(e,t){return e.x-t.x}function Nc(e,t){var i=function(e,t){var i,s=t,n=e.x,r=e.y,o=-1/0;do{if(r<=s.y&&r>=s.next.y&&s.next.y!==s.y){var a=s.x+(r-s.y)*(s.next.x-s.x)/(s.next.y-s.y);if(a<=n&&a>o&&(o=a,i=s.x<s.next.x?s:s.next,a===n))return i}s=s.next}while(s!==t);if(!i)return null;var l,c=i,h=i.x,d=i.y,u=1/0;s=i;do{n>=s.x&&s.x>=h&&n!==s.x&&bc(r<d?n:o,r,h,d,r<d?o:n,r,s.x,s.y)&&(l=Math.abs(r-s.y)/(n-s.x),zc(s,e)&&(l<u||l===u&&(s.x>i.x||s.x===i.x&&Pc(i,s)))&&(i=s,u=l)),s=s.next}while(s!==c);return i}(e,t);if(!i)return t;var s=kc(i,e);return vc(s,s.next),vc(i,i.next)}function Pc(e,t){return Dc(e.prev,e,t.prev)<0&&Dc(t.next,e,e.next)<0}function xc(e,t,i,s,n){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=(e-i)*n|0)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=(t-s)*n|0)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function Lc(e){var t=e,i=e;do{(t.x<i.x||t.x===i.x&&t.y<i.y)&&(i=t),t=t.next}while(t!==e);return i}function bc(e,t,i,s,n,r,o,a){return(n-o)*(t-a)>=(e-o)*(r-a)&&(e-o)*(s-a)>=(i-o)*(t-a)&&(i-o)*(r-a)>=(n-o)*(s-a)}function Mc(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var i=e;do{if(i.i!==e.i&&i.next.i!==e.i&&i.i!==t.i&&i.next.i!==t.i&&Uc(i,i.next,e,t))return!0;i=i.next}while(i!==e);return!1}(e,t)&&(zc(e,t)&&zc(t,e)&&function(e,t){var i=e,s=!1,n=(e.x+t.x)/2,r=(e.y+t.y)/2;do{i.y>r!=i.next.y>r&&i.next.y!==i.y&&n<(i.next.x-i.x)*(r-i.y)/(i.next.y-i.y)+i.x&&(s=!s),i=i.next}while(i!==e);return s}(e,t)&&(Dc(e.prev,e,t.prev)||Dc(e,t.prev,t))||_c(e,t)&&Dc(e.prev,e,e.next)>0&&Dc(t.prev,t,t.next)>0)}function Dc(e,t,i){return(t.y-e.y)*(i.x-t.x)-(t.x-e.x)*(i.y-t.y)}function _c(e,t){return e.x===t.x&&e.y===t.y}function Uc(e,t,i,s){var n=Vc(Dc(e,t,i)),r=Vc(Dc(e,t,s)),o=Vc(Dc(i,s,e)),a=Vc(Dc(i,s,t));return!!(n!==r&&o!==a||0===n&&Bc(e,i,t)||0===r&&Bc(e,s,t)||0===o&&Bc(i,e,s)||0===a&&Bc(i,t,s))}function Bc(e,t,i){return t.x<=Math.max(e.x,i.x)&&t.x>=Math.min(e.x,i.x)&&t.y<=Math.max(e.y,i.y)&&t.y>=Math.min(e.y,i.y)}function Vc(e){return e>0?1:e<0?-1:0}function zc(e,t){return Dc(e.prev,e,e.next)<0?Dc(e,t,e.next)>=0&&Dc(e,e.prev,t)>=0:Dc(e,t,e.prev)<0||Dc(e,e.next,t)<0}function kc(e,t){var i=new Hc(e.i,e.x,e.y),s=new Hc(t.i,t.x,t.y),n=e.next,r=t.prev;return e.next=t,t.prev=e,i.next=n,n.prev=i,s.next=i,i.prev=s,r.next=s,s.prev=r,s}function Yc(e,t,i,s){var n=new Hc(e,t,i);return s?(n.next=s.next,n.prev=s,s.next.prev=n,s.next=n):(n.prev=n,n.next=n),n}function Gc(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Hc(e,t,i){this.i=e,this.x=t,this.y=i,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Wc(e,t,i,s){for(var n=0,r=t,o=i-s;r<i;r+=s)n+=(e[o]-e[r])*(e[r+1]+e[o+1]),o=r;return n}Cc.exports=Tc,Cc.exports.default=Tc,Tc.deviation=function(e,t,i,s){var n=t&&t.length,r=n?t[0]*i:e.length,o=Math.abs(Wc(e,0,r,i));if(n)for(var a=0,l=t.length;a<l;a++){var c=t[a]*i,h=a<l-1?t[a+1]*i:e.length;o-=Math.abs(Wc(e,c,h,i))}var d=0;for(a=0;a<s.length;a+=3){var u=s[a]*i,f=s[a+1]*i,p=s[a+2]*i;d+=Math.abs((e[u]-e[p])*(e[f+1]-e[u+1])-(e[u]-e[f])*(e[p+1]-e[u+1]))}return 0===o&&0===d?0:Math.abs((d-o)/o)},Tc.flatten=function(e){for(var t=e[0][0].length,i={vertices:[],holes:[],dimensions:t},s=0,n=0;n<e.length;n++){for(var r=0;r<e[n].length;r++)for(var o=0;o<t;o++)i.vertices.push(e[n][r][o]);n>0&&(s+=e[n-1].length,i.holes.push(s))}return i};const Xc=gc(Cc.exports),Zc={name:"CopyShader",uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform float opacity;\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 texel = texture2D( tDiffuse, vUv );\n\t\t\tgl_FragColor = opacity * texel;\n\n\n\t\t}"};class jc{constructor(){this.isPass=!0,this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}setSize(){}render(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}dispose(){}}const Kc=new Y(-1,1,1,-1,0,1);const Qc=new class extends T{constructor(){super(),this.setAttribute("position",new R([-1,3,0,-1,-1,0,3,-1,0],3)),this.setAttribute("uv",new R([0,2,0,0,2,0],2))}};class qc{constructor(e){this._mesh=new l(Qc,e)}dispose(){this._mesh.geometry.dispose()}render(e){e.render(this._mesh,Kc)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}}class Jc extends jc{constructor(e,t){super(),this.textureID=void 0!==t?t:"tDiffuse",e instanceof V?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=B.clone(e.uniforms),this.material=new V({name:void 0!==e.name?e.name:"unspecified",defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new qc(this.material)}render(e,t,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=i.texture),this.fsQuad.material=this.material,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),this.fsQuad.render(e))}dispose(){this.material.dispose(),this.fsQuad.dispose()}}class $c extends jc{constructor(e,t){super(),this.scene=e,this.camera=t,this.clear=!0,this.needsSwap=!1,this.inverse=!1}render(e,t,i){const s=e.getContext(),n=e.state;let r,o;n.buffers.color.setMask(!1),n.buffers.depth.setMask(!1),n.buffers.color.setLocked(!0),n.buffers.depth.setLocked(!0),this.inverse?(r=0,o=1):(r=1,o=0),n.buffers.stencil.setTest(!0),n.buffers.stencil.setOp(s.REPLACE,s.REPLACE,s.REPLACE),n.buffers.stencil.setFunc(s.ALWAYS,r,4294967295),n.buffers.stencil.setClear(o),n.buffers.stencil.setLocked(!0),e.setRenderTarget(i),this.clear&&e.clear(),e.render(this.scene,this.camera),e.setRenderTarget(t),this.clear&&e.clear(),e.render(this.scene,this.camera),n.buffers.color.setLocked(!1),n.buffers.depth.setLocked(!1),n.buffers.color.setMask(!0),n.buffers.depth.setMask(!0),n.buffers.stencil.setLocked(!1),n.buffers.stencil.setFunc(s.EQUAL,1,4294967295),n.buffers.stencil.setOp(s.KEEP,s.KEEP,s.KEEP),n.buffers.stencil.setLocked(!0)}}class eh extends jc{constructor(){super(),this.needsSwap=!1}render(e){e.state.buffers.stencil.setLocked(!1),e.state.buffers.stencil.setTest(!1)}}class th{constructor(e,t){if(this.renderer=e,this._pixelRatio=e.getPixelRatio(),void 0===t){const i=e.getSize(new n);this._width=i.width,this._height=i.height,(t=new G(this._width*this._pixelRatio,this._height*this._pixelRatio,{type:H})).texture.name="EffectComposer.rt1"}else this._width=t.width,this._height=t.height;this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],this.copyPass=new Jc(Zc),this.copyPass.material.blending=W,this.clock=new X}swapBuffers(){const e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e}addPass(e){this.passes.push(e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}insertPass(e,t){this.passes.splice(t,0,e),e.setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}removePass(e){const t=this.passes.indexOf(e);-1!==t&&this.passes.splice(t,1)}isLastEnabledPass(e){for(let t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0}render(e){void 0===e&&(e=this.clock.getDelta());const t=this.renderer.getRenderTarget();let i=!1;for(let t=0,s=this.passes.length;t<s;t++){const s=this.passes[t];if(!1!==s.enabled){if(s.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(t),s.render(this.renderer,this.writeBuffer,this.readBuffer,e,i),s.needsSwap){if(i){const t=this.renderer.getContext(),i=this.renderer.state.buffers.stencil;i.setFunc(t.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),i.setFunc(t.EQUAL,1,4294967295)}this.swapBuffers()}void 0!==$c&&(s instanceof $c?i=!0:s instanceof eh&&(i=!1))}}this.renderer.setRenderTarget(t)}reset(e){if(void 0===e){const t=this.renderer.getSize(new n);this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2}setSize(e,t){this._width=e,this._height=t;const i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(let e=0;e<this.passes.length;e++)this.passes[e].setSize(i,s)}setPixelRatio(e){this._pixelRatio=e,this.setSize(this._width,this._height)}dispose(){this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.copyPass.dispose()}}class ih extends jc{constructor(e,t,i=null,s=null,n=null){super(),this.scene=e,this.camera=t,this.overrideMaterial=i,this.clearColor=s,this.clearAlpha=n,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1,this._oldClearColor=new Z}render(e,t,i){const s=e.autoClear;let n,r;e.autoClear=!1,null!==this.overrideMaterial&&(r=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),null!==this.clearColor&&(e.getClearColor(this._oldClearColor),e.setClearColor(this.clearColor)),null!==this.clearAlpha&&(n=e.getClearAlpha(),e.setClearAlpha(this.clearAlpha)),1==this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:i),!0===this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),null!==this.clearColor&&e.setClearColor(this._oldClearColor),null!==this.clearAlpha&&e.setClearAlpha(n),null!==this.overrideMaterial&&(this.scene.overrideMaterial=r),e.autoClear=s}}const sh=new T;sh.setAttribute("position",new O(new Float32Array([-1,-1,3,-1,-1,3]),2)),sh.setAttribute("uv",new O(new Float32Array([0,0,2,0,0,2]),2)),sh.boundingSphere=new p,sh.computeBoundingSphere=function(){};const nh=new Y;class rh{constructor(e){this._mesh=new l(sh,e),this._mesh.frustumCulled=!1}render(e){e.render(this._mesh,nh)}get material(){return this._mesh.material}set material(e){this._mesh.material=e}dispose(){this._mesh.material.dispose(),this._mesh.geometry.dispose()}}const oh={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},sceneNormal:{value:null},projMat:{value:new f},viewMat:{value:new f},projViewMat:{value:new f},projectionMatrixInv:{value:new f},viewMatrixInv:{value:new f},cameraPos:{value:new s},resolution:{value:new n},time:{value:0},samples:{value:[]},samplesR:{value:[]},bluenoise:{value:null},distanceFalloff:{value:1},radius:{value:5},near:{value:.1},far:{value:1e3},logDepth:{value:!1},ortho:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:"\nvarying vec2 vUv;\nvoid main() {\n  vUv = uv;\n  gl_Position = vec4(position, 1);\n}",fragmentShader:"\n    #define SAMPLES 16\n    #define FSAMPLES 16.0\nuniform sampler2D sceneDiffuse;\nuniform sampler2D sceneNormal;\nuniform highp sampler2D sceneDepth;\nuniform mat4 projectionMatrixInv;\nuniform mat4 viewMatrixInv;\nuniform mat4 projMat;\nuniform mat4 viewMat;\nuniform mat4 projViewMat;\nuniform vec3 cameraPos;\nuniform vec2 resolution;\nuniform float time;\nuniform vec3[SAMPLES] samples;\nuniform float[SAMPLES] samplesR;\nuniform float radius;\nuniform float distanceFalloff;\nuniform float near;\nuniform float far;\nuniform bool logDepth;\nuniform bool ortho;\nuniform bool screenSpaceRadius;\nuniform sampler2D bluenoise;\n    varying vec2 vUv;\n    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)\n    {\n        return (zFar * zNear) / (zFar - d * (zFar - zNear));\n    }\n    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {\n      return nearZ + (farZ - nearZ) * d;\n    }\n    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {\n      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;\n      float a = farZ / (farZ - nearZ);\n      float b = farZ * nearZ / (nearZ - farZ);\n      float linDepth = a + b / depth;\n      return ortho ? linearize_depth_ortho(\n        linDepth,\n        nearZ,\n        farZ\n      ) :linearize_depth(linDepth, nearZ, farZ);\n    }\n\n    vec3 getWorldPosLog(vec3 posS) {\n      vec2 uv = posS.xy;\n      float z = posS.z;\n      float nearZ =near;\n      float farZ = far;\n      float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n      float a = farZ / (farZ - nearZ);\n      float b = farZ * nearZ / (nearZ - farZ);\n      float linDepth = a + b / depth;\n      vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n      vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;\n      return wpos.xyz / wpos.w;\n    }\n    vec3 getWorldPos(float depth, vec2 coord) {\n      #ifdef LOGDEPTH\n        return getWorldPosLog(vec3(coord, depth));\n      #endif\n      float z = depth * 2.0 - 1.0;\n      vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n      vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n      // Perspective division\n     vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;\n     worldSpacePosition.xyz /= worldSpacePosition.w;\n      return worldSpacePosition.xyz;\n  }\n\n  vec3 computeNormal(vec3 worldPos, vec2 vUv) {\n    ivec2 p = ivec2(vUv * resolution);\n    float c0 = texelFetch(sceneDepth, p, 0).x;\n    float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;\n    float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;\n    float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;\n    float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;\n    float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;\n    float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;\n    float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;\n    float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;\n\n    float dl = abs((2.0 * l1 - l2) - c0);\n    float dr = abs((2.0 * r1 - r2) - c0);\n    float db = abs((2.0 * b1 - b2) - c0);\n    float dt = abs((2.0 * t1 - t2) - c0);\n\n    vec3 ce = getWorldPos(c0, vUv).xyz;\n\n    vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz\n                          : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;\n    vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz\n                          : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;\n\n    return normalize(cross(dpdx, dpdy));\n}\n\nvoid main() {\n      vec4 diffuse = texture2D(sceneDiffuse, vUv);\n      float depth = texture2D(sceneDepth, vUv).x;\n      if (depth == 1.0) {\n        gl_FragColor = vec4(vec3(1.0), 1.0);\n        return;\n      }\n      vec3 worldPos = getWorldPos(depth, vUv);\n    //  vec3 normal = texture2D(sceneNormal, vUv).rgb;//computeNormal(worldPos, vUv);\n      #ifdef HALFRES\n        vec3 normal = texture2D(sceneNormal, vUv).rgb;\n      #else\n        vec3 normal = computeNormal(worldPos, vUv);\n      #endif\n      vec4 noise = texture2D(bluenoise, gl_FragCoord.xy / 128.0);\n      vec3 randomVec = normalize(noise.rgb * 2.0 - 1.0);\n      vec3 tangent = normalize(randomVec - normal * dot(randomVec, normal));\n      vec3 bitangent = cross(normal, tangent);\n      mat3 tbn = mat3(tangent, bitangent, normal);\n      float occluded = 0.0;\n      float totalWeight = 0.0;\n     /* float radiusScreen = distance(\n        worldPos,\n        getWorldPos(depth, vUv + \n          vec2(48.0, 0.0) / resolution)\n      );/*vUv.x < 0.5 ? radius : min(distance(\n        worldPos,\n        getWorldPos(depth, vUv + \n          vec2(100.0, 0.0) / resolution)\n      ), radius);\n      float distanceFalloffScreen = radiusScreen * 0.2;*/\n      float radiusToUse = screenSpaceRadius ? distance(\n        worldPos,\n        getWorldPos(depth, vUv +\n          vec2(radius, 0.0) / resolution)\n      ) : radius;\n      float distanceFalloffToUse =screenSpaceRadius ?\n          radiusToUse * distanceFalloff\n      : distanceFalloff;\n      float bias = (0.1 / near) * fwidth(distance(worldPos, cameraPos)) / radiusToUse;\n      for(float i = 0.0; i < FSAMPLES; i++) {\n        vec3 sampleDirection = \n        tbn * \n        samples[int(i)];\n        ;\n        float moveAmt = samplesR[int(mod(i + noise.a * FSAMPLES, FSAMPLES))];\n        vec3 samplePos = worldPos + radiusToUse * moveAmt * sampleDirection;\n        vec4 offset = projViewMat * vec4(samplePos, 1.0);\n        offset.xyz /= offset.w;\n        offset.xyz = offset.xyz * 0.5 + 0.5;\n        float sampleDepth = textureLod(sceneDepth, offset.xy, 0.0).x;\n        /*float distSample = logDepth ? linearize_depth_log(sampleDepth, near, far) \n         (ortho ?  linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far));*/\n        #ifdef LOGDEPTH\n        float distSample = linearize_depth_log(sampleDepth, near, far);\n        #else\n        float distSample = ortho ? linearize_depth_ortho(sampleDepth, near, far) : linearize_depth(sampleDepth, near, far);\n        #endif\n        float distWorld = ortho ? linearize_depth_ortho(offset.z, near, far) : linearize_depth(offset.z, near, far);\n        float rangeCheck = smoothstep(0.0, 1.0, distanceFalloffToUse / (abs(distSample - distWorld)));\n        vec2 diff = gl_FragCoord.xy - ( offset.xy * resolution);\n        float weight = dot(sampleDirection, normal);\n          occluded += rangeCheck * weight * \n            (distSample + bias\n               < distWorld ? 1.0 : 0.0) * (\n          (dot(\n            diff,\n            diff\n             \n            ) < 1.0 || (sampleDepth == depth) || (\n              offset.x < 0.0 || offset.x > 1.0 || offset.y < 0.0 || offset.y > 1.0\n            ) ? 0.0 : 1.0)\n          );\n          totalWeight += weight;\n      }\n      float occ = clamp(1.0 - occluded / totalWeight, 0.0, 1.0);\n      gl_FragColor = vec4(0.5 + 0.5 * normal, occ);\n}"},ah={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new f},viewMat:{value:new f},projectionMatrixInv:{value:new f},viewMatrixInv:{value:new f},cameraPos:{value:new s},resolution:{value:new n},color:{value:new s(0,0,0)},blueNoise:{value:null},downsampledDepth:{value:null},time:{value:0},intensity:{value:10},renderMode:{value:0},gammaCorrection:{value:!1},logDepth:{value:!1},ortho:{value:!1},near:{value:.1},far:{value:1e3},screenSpaceRadius:{value:!1},radius:{value:0},distanceFalloff:{value:1}},vertexShader:"\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = vec4(position, 1);\n\t\t}",fragmentShader:"\n\t\tuniform sampler2D sceneDiffuse;\n    uniform sampler2D sceneDepth;\n    uniform sampler2D downsampledDepth;\n    uniform sampler2D tDiffuse;\n    uniform sampler2D blueNoise;\n    uniform vec2 resolution;\n    uniform vec3 color;\n    uniform mat4 projectionMatrixInv;\n    uniform mat4 viewMatrixInv;\n    uniform float intensity;\n    uniform float renderMode;\n    uniform float near;\n    uniform float far;\n    uniform bool gammaCorrection;\n    uniform bool logDepth;\n    uniform bool ortho;\n    uniform bool screenSpaceRadius;\n    uniform float radius;\n    uniform float distanceFalloff;\n    varying vec2 vUv;\n    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)\n    {\n        return (zFar * zNear) / (zFar - d * (zFar - zNear));\n    }\n    highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {\n      return nearZ + (farZ - nearZ) * d;\n    }\n    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {\n      float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;\n      float a = farZ / (farZ - nearZ);\n      float b = farZ * nearZ / (nearZ - farZ);\n      float linDepth = a + b / depth;\n      return ortho ? linearize_depth_ortho(\n        linDepth,\n        nearZ,\n        farZ\n      ) :linearize_depth(linDepth, nearZ, farZ);\n    }\n    vec3 getWorldPosLog(vec3 posS) {\n        vec2 uv = posS.xy;\n        float z = posS.z;\n        float nearZ =near;\n        float farZ = far;\n        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n        float a = farZ / (farZ - nearZ);\n        float b = farZ * nearZ / (nearZ - farZ);\n        float linDepth = a + b / depth;\n        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n        vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;\n        return wpos.xyz / wpos.w;\n      }\n      vec3 getWorldPos(float depth, vec2 coord) {\n       // if (logDepth) {\n        #ifdef LOGDEPTH\n          return getWorldPosLog(vec3(coord, depth));\n        #endif\n      //  }\n        float z = depth * 2.0 - 1.0;\n        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n        // Perspective division\n       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;\n       worldSpacePosition.xyz /= worldSpacePosition.w;\n        return worldSpacePosition.xyz;\n    }\n  \n    vec3 computeNormal(vec3 worldPos, vec2 vUv) {\n      ivec2 p = ivec2(vUv * resolution);\n      float c0 = texelFetch(sceneDepth, p, 0).x;\n      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;\n      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;\n      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;\n      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;\n      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;\n      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;\n      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;\n      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;\n  \n      float dl = abs((2.0 * l1 - l2) - c0);\n      float dr = abs((2.0 * r1 - r2) - c0);\n      float db = abs((2.0 * b1 - b2) - c0);\n      float dt = abs((2.0 * t1 - t2) - c0);\n  \n      vec3 ce = getWorldPos(c0, vUv).xyz;\n  \n      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz\n                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;\n      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz\n                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;\n  \n      return normalize(cross(dpdx, dpdy));\n  }\n\n    #include <common>\n    #include <dithering_pars_fragment>\n    void main() {\n        //vec4 texel = texture2D(tDiffuse, vUv);//vec3(0.0);\n        vec4 sceneTexel = texture2D(sceneDiffuse, vUv);\n\n        #ifdef HALFRES \n        float depth = texture2D(\n            sceneDepth,\n            vUv\n        ).x;\n        vec4 texel;\n        if (depth == 1.0) {\n            texel = vec4(0.0, 0.0, 0.0, 1.0);\n        } else {\n        vec3 worldPos = getWorldPos(depth, vUv);\n        vec3 normal = computeNormal(getWorldPos(depth, vUv), vUv);\n       // vec4 texel = texture2D(tDiffuse, vUv);\n       // Find closest depth;\n       float totalWeight = 0.0;\n       float radiusToUse = screenSpaceRadius ? distance(\n        worldPos,\n        getWorldPos(depth, vUv +\n          vec2(radius, 0.0) / resolution)\n      ) : radius;\n      float distanceFalloffToUse =screenSpaceRadius ?\n          radiusToUse * distanceFalloff\n      : distanceFalloff;\n        for(float x = -1.0; x <= 1.0; x++) {\n            for(float y = -1.0; y <= 1.0; y++) {\n                vec2 offset = vec2(x, y);\n                ivec2 p = ivec2(\n                    (vUv * resolution * 0.5) + offset\n                );\n                vec2 pUv = vec2(p) / (resolution * 0.5);\n                float sampleDepth = texelFetch(downsampledDepth,p, 0).x;\n                vec4 sampleInfo = texelFetch(tDiffuse, p, 0);\n                vec3 normalSample = sampleInfo.xyz * 2.0 - 1.0;\n                vec3 worldPosSample = getWorldPos(sampleDepth, pUv);\n                float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));\n                float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0);\n                float weight = rangeCheck;\n                totalWeight += weight;\n                texel += sampleInfo * weight;\n            }\n        }\n        if (totalWeight == 0.0) {\n            texel = texture2D(tDiffuse, vUv);\n        } else {\n            texel /= totalWeight;\n        }\n    }\n        #else\n        vec4 texel = texture2D(tDiffuse, vUv);\n        #endif\n\n     \n        float finalAo = pow(texel.a, intensity);\n        if (renderMode == 0.0) {\n            gl_FragColor = vec4( mix(sceneTexel.rgb, color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);\n        } else if (renderMode == 1.0) {\n            gl_FragColor = vec4( mix(vec3(1.0), color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);\n        } else if (renderMode == 2.0) {\n            gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);\n        } else if (renderMode == 3.0) {\n            if (vUv.x < 0.5) {\n                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);\n            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {\n                gl_FragColor = vec4(1.0);\n            } else {\n                gl_FragColor = vec4( mix(sceneTexel.rgb, color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);\n            }\n        } else if (renderMode == 4.0) {\n            if (vUv.x < 0.5) {\n                gl_FragColor = vec4( sceneTexel.rgb, sceneTexel.a);\n            } else if (abs(vUv.x - 0.5) < 1.0 / resolution.x) {\n                gl_FragColor = vec4(1.0);\n            } else {\n                gl_FragColor = vec4( mix(vec3(1.0), color * sceneTexel.rgb, 1.0 - finalAo), sceneTexel.a);\n            }\n        }\n        #include <dithering_fragment>\n        if (gammaCorrection) {\n            gl_FragColor = LinearTosRGB(gl_FragColor);\n        }\n    }\n    "},lh={uniforms:{sceneDiffuse:{value:null},sceneDepth:{value:null},tDiffuse:{value:null},projMat:{value:new f},viewMat:{value:new f},projectionMatrixInv:{value:new f},viewMatrixInv:{value:new f},cameraPos:{value:new s},resolution:{value:new n},time:{value:0},r:{value:5},blueNoise:{value:null},radius:{value:12},worldRadius:{value:5},index:{value:0},poissonDisk:{value:[]},distanceFalloff:{value:1},near:{value:.1},far:{value:1e3},logDepth:{value:!1},screenSpaceRadius:{value:!1}},vertexShader:"\n\t\tvarying vec2 vUv;\n\t\tvoid main() {\n\t\t\tvUv = uv;\n\t\t\tgl_Position = vec4(position, 1.0);\n\t\t}",fragmentShader:"\n\t\tuniform sampler2D sceneDiffuse;\n    uniform highp sampler2D sceneDepth;\n    uniform sampler2D tDiffuse;\n    uniform sampler2D blueNoise;\n    uniform mat4 projectionMatrixInv;\n    uniform mat4 viewMatrixInv;\n    uniform vec2 resolution;\n    uniform float r;\n    uniform float radius;\n     uniform float worldRadius;\n    uniform float index;\n     uniform float near;\n     uniform float far;\n     uniform float distanceFalloff;\n     uniform bool logDepth;\n     uniform bool screenSpaceRadius;\n    varying vec2 vUv;\n\n    highp float linearize_depth(highp float d, highp float zNear,highp float zFar)\n    {\n        highp float z_n = 2.0 * d - 1.0;\n        return 2.0 * zNear * zFar / (zFar + zNear - z_n * (zFar - zNear));\n    }\n    highp float linearize_depth_log(highp float d, highp float nearZ,highp float farZ) {\n     float depth = pow(2.0, d * log2(farZ + 1.0)) - 1.0;\n     float a = farZ / (farZ - nearZ);\n     float b = farZ * nearZ / (nearZ - farZ);\n     float linDepth = a + b / depth;\n     return linearize_depth(linDepth, nearZ, farZ);\n   }\n   highp float linearize_depth_ortho(highp float d, highp float nearZ, highp float farZ) {\n     return nearZ + (farZ - nearZ) * d;\n   }\n   vec3 getWorldPosLog(vec3 posS) {\n     vec2 uv = posS.xy;\n     float z = posS.z;\n     float nearZ =near;\n     float farZ = far;\n     float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n     float a = farZ / (farZ - nearZ);\n     float b = farZ * nearZ / (nearZ - farZ);\n     float linDepth = a + b / depth;\n     vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n     vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;\n     return wpos.xyz / wpos.w;\n   }\n    vec3 getWorldPos(float depth, vec2 coord) {\n     #ifdef LOGDEPTH\n          return getWorldPosLog(vec3(coord, depth));\n     #endif\n        \n        float z = depth * 2.0 - 1.0;\n        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n        // Perspective division\n       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;\n       worldSpacePosition.xyz /= worldSpacePosition.w;\n        return worldSpacePosition.xyz;\n    }\n    #include <common>\n    #define NUM_SAMPLES 16\n    uniform vec2 poissonDisk[NUM_SAMPLES];\n    void main() {\n        const float pi = 3.14159;\n        vec2 texelSize = vec2(1.0 / resolution.x, 1.0 / resolution.y);\n        vec2 uv = vUv;\n        vec4 data = texture2D(tDiffuse, vUv);\n        float occlusion = data.a;\n        float baseOcc = data.a;\n        vec3 normal = data.rgb * 2.0 - 1.0;\n        float count = 1.0;\n        float d = texture2D(sceneDepth, vUv).x;\n        vec3 worldPos = getWorldPos(d, vUv);\n        float size = radius;\n        float angle;\n        if (index == 0.0) {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).x * PI2;\n        } else if (index == 1.0) {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).y * PI2;\n        } else if (index == 2.0) {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).z * PI2;\n        } else {\n             angle = texture2D(blueNoise, gl_FragCoord.xy / 128.0).w * PI2;\n        }\n\n        mat2 rotationMatrix = mat2(cos(angle), -sin(angle), sin(angle), cos(angle));\n        float radiusToUse = screenSpaceRadius ? distance(\n          worldPos,\n          getWorldPos(d, vUv +\n            vec2(worldRadius, 0.0) / resolution)\n        ) : worldRadius;\n        float distanceFalloffToUse =screenSpaceRadius ?\n            radiusToUse * distanceFalloff\n        : distanceFalloff;\n\n\n        for(int i = 0; i < NUM_SAMPLES; i++) {\n            vec2 offset = (rotationMatrix * poissonDisk[i]) * texelSize * size;\n            vec4 dataSample = texture2D(tDiffuse, uv + offset);\n            float occSample = dataSample.a;\n            vec3 normalSample = dataSample.rgb * 2.0 - 1.0;\n            float dSample = texture2D(sceneDepth, uv + offset).x;\n            vec3 worldPosSample = getWorldPos(dSample, uv + offset);\n            float tangentPlaneDist = abs(dot(worldPos - worldPosSample, normal));\n            float rangeCheck = exp(-1.0 * tangentPlaneDist * (1.0 / distanceFalloffToUse)) * max(dot(normal, normalSample), 0.0) * (1.0 - abs(occSample - baseOcc));\n            occlusion += occSample * rangeCheck;\n            count += rangeCheck;\n        }\n        occlusion /= count;\n        gl_FragColor = vec4(0.5 + 0.5 * normal, occlusion);\n    }\n    "},ch={uniforms:{sceneDepth:{value:null},resolution:{value:new n},near:{value:.1},far:{value:1e3},viewMatrixInv:{value:new f},projectionMatrixInv:{value:new f},logDepth:{value:!1}},vertexShader:"\n    varying vec2 vUv;\n    void main() {\n        vUv = uv;\n        gl_Position = vec4(position, 1);\n    }",fragmentShader:"\n    uniform sampler2D sceneDepth;\n    uniform vec2 resolution;\n    uniform float near;\n    uniform float far;\n    uniform bool logDepth;\n    uniform mat4 viewMatrixInv;\n    uniform mat4 projectionMatrixInv;\n    varying vec2 vUv;\n    layout(location = 1) out vec4 gNormal;\n    vec3 getWorldPosLog(vec3 posS) {\n        vec2 uv = posS.xy;\n        float z = posS.z;\n        float nearZ =near;\n        float farZ = far;\n        float depth = pow(2.0, z * log2(farZ + 1.0)) - 1.0;\n        float a = farZ / (farZ - nearZ);\n        float b = farZ * nearZ / (nearZ - farZ);\n        float linDepth = a + b / depth;\n        vec4 clipVec = vec4(uv, linDepth, 1.0) * 2.0 - 1.0;\n        vec4 wpos = viewMatrixInv * projectionMatrixInv * clipVec;\n        return wpos.xyz / wpos.w;\n      }\n      vec3 getWorldPos(float depth, vec2 coord) {\n        if (logDepth) {\n          return getWorldPosLog(vec3(coord, depth));\n        }\n        float z = depth * 2.0 - 1.0;\n        vec4 clipSpacePosition = vec4(coord * 2.0 - 1.0, z, 1.0);\n        vec4 viewSpacePosition = projectionMatrixInv * clipSpacePosition;\n        // Perspective division\n       vec4 worldSpacePosition = viewMatrixInv * viewSpacePosition;\n       worldSpacePosition.xyz /= worldSpacePosition.w;\n        return worldSpacePosition.xyz;\n    }\n  \n    vec3 computeNormal(vec3 worldPos, vec2 vUv) {\n      ivec2 p = ivec2(vUv * resolution);\n      float c0 = texelFetch(sceneDepth, p, 0).x;\n      float l2 = texelFetch(sceneDepth, p - ivec2(2, 0), 0).x;\n      float l1 = texelFetch(sceneDepth, p - ivec2(1, 0), 0).x;\n      float r1 = texelFetch(sceneDepth, p + ivec2(1, 0), 0).x;\n      float r2 = texelFetch(sceneDepth, p + ivec2(2, 0), 0).x;\n      float b2 = texelFetch(sceneDepth, p - ivec2(0, 2), 0).x;\n      float b1 = texelFetch(sceneDepth, p - ivec2(0, 1), 0).x;\n      float t1 = texelFetch(sceneDepth, p + ivec2(0, 1), 0).x;\n      float t2 = texelFetch(sceneDepth, p + ivec2(0, 2), 0).x;\n  \n      float dl = abs((2.0 * l1 - l2) - c0);\n      float dr = abs((2.0 * r1 - r2) - c0);\n      float db = abs((2.0 * b1 - b2) - c0);\n      float dt = abs((2.0 * t1 - t2) - c0);\n  \n      vec3 ce = getWorldPos(c0, vUv).xyz;\n  \n      vec3 dpdx = (dl < dr) ? ce - getWorldPos(l1, (vUv - vec2(1.0 / resolution.x, 0.0))).xyz\n                            : -ce + getWorldPos(r1, (vUv + vec2(1.0 / resolution.x, 0.0))).xyz;\n      vec3 dpdy = (db < dt) ? ce - getWorldPos(b1, (vUv - vec2(0.0, 1.0 / resolution.y))).xyz\n                            : -ce + getWorldPos(t1, (vUv + vec2(0.0, 1.0 / resolution.y))).xyz;\n  \n      return normalize(cross(dpdx, dpdy));\n  }\n    void main() {\n        vec2 uv = vUv - vec2(0.5) / resolution;\n        vec2 pixelSize = vec2(1.0) / resolution;\n        vec2[] uvSamples = vec2[4](\n            uv,\n            uv + vec2(pixelSize.x, 0.0),\n            uv + vec2(0.0, pixelSize.y),\n            uv + pixelSize\n        );\n        float depth00 = texture2D(sceneDepth, uvSamples[0]).r;\n        float depth10 = texture2D(sceneDepth, uvSamples[1]).r;\n        float depth01 = texture2D(sceneDepth, uvSamples[2]).r;\n        float depth11 = texture2D(sceneDepth, uvSamples[3]).r;\n        float minDepth = min(min(depth00, depth10), min(depth01, depth11));\n        float maxDepth = max(max(depth00, depth10), max(depth01, depth11));\n        float targetDepth = minDepth;\n        // Checkerboard pattern to avoid artifacts\n        if (mod(gl_FragCoord.x + gl_FragCoord.y, 2.0) > 0.5) { \n            targetDepth = maxDepth;\n        }\n        int chosenIndex = 0;\n        float[] samples = float[4](depth00, depth10, depth01, depth11);\n        for(int i = 0; i < 4; ++i) {\n            if (samples[i] == targetDepth) {\n                chosenIndex = i;\n                break;\n            }\n        }\n        gl_FragColor = vec4(samples[chosenIndex], 0.0, 0.0, 1.0);\n        gNormal = vec4(computeNormal(\n            getWorldPos(samples[chosenIndex], uvSamples[chosenIndex]), uvSamples[chosenIndex]\n        ), 0.0);\n       /* float[] samples = float[4](depth00, depth10, depth01, depth11);\n        float c = 0.25 * (depth00 + depth10 + depth01 + depth11);\n        float[] distances = float[4](depth00, depth10, depth01, depth11);\n        float maxDistance = max(max(distances[0], distances[1]), max(distances[2], distances[3]));\n\n        int remaining[3];\n        int rejected[3];\n        int i, j, k;\n\n        for(i = 0, j = 0, k = 0; i < 4; ++i) {\n            if (distances[i] < maxDistance) {\n                remaining[j++] = i;\n            } else {\n                rejected[k++] = i;\n            }\n        }\n        for(;j < 3;++j) {\n            remaining[j] = rejected[--k];\n        }\n        vec3 s = vec3(\n            samples[remaining[0]],\n            samples[remaining[1]],\n            samples[remaining[2]]\n        );\n        c = (s.x + s.y + s.z) / 3.0;\n\n        distances[0] = abs(c - s.x);\n        distances[1] = abs(c - s.y);\n        distances[2] = abs(c - s.z);\n\n        float minDistance = min(min(distances[0], distances[1]), distances[2]);\n\n        for(i = 0; i < 3; ++i) {\n            if (distances[i] == minDistance) {\n                break;\n            }\n        }*/\n      /*  gl_FragColor = vec4(samples[remaining[i]], 0.0, 0.0, 0.0);\n        gNormal = vec4(computeNormal(\n            getWorldPos(samples[remaining[i]], uvSamples[remaining[i]]), uvSamples[remaining[i]]\n        ), 0.0);*/\n    }"};var hh="5L7pP4UXrOIr/VZ1G3f6p89FIWU7lqc7J3DPxKjJUXODJoHQzf/aNVM+ABlvhXeBGN7iC0WkmTjEaAqOItBfBdaK5KSGV1ET5SOKl3x9JOX5w2sAl6+6KjDhVUHgbqq7DZ5EeYzbdSNxtrQLW/KkPJoOTG4u5CBUZkCKHniY9l7DUgjuz708zG1HIC8qfohi1vPjPH9Lq47ksjRrjwXD4MlVCjdAqYFGodQ8tRmHkOfq4wVRIAHvoavPHvN1lpk3X4Y1yzAPGe8S9KBs3crc4GwlU1dEOXiWol/mgQqxkNqB1xd04+0Bmpwj0GcCc4NUi+c731FUxjvaexCkCJ0qhrJJ++htWqetNC4NewClu8aFRSwrqiJEGe+qtTg4CYCHaF1wJI0sy/ZBQAI0qAMyBvVjWZlv2pdkCaro9eWDLK5I4mbb8E4d7hZr9dDJiTJm6Bmb5S+2F7yal/JPdeLUfwq7jmVLaQfhv4tWMJAt7V4sG9LuAv2oPJgSj1nnlBvPibfHM2TrlWHwGCLGxW/5Jm2TotaDL+pHDM5pn1r0UuTZ24N8S5k68bLHW9tfD+2k4zGev23ExJb4YTRKWrj82N5LjJ26lj1BkGZ0CsXLGGELoPaYQomjTqPxYqhfwOwDliNGVqux9ffuybqOKgsbB51B1GbZfG8vHDBE2JQGib1mnCmWOWAMJcHN0cKeDHYTflbDTVXajtr68mwfRje6WueQ/6yWqmZMLWNH7P27zGFhMFqaqfg11Q88g/9UA/FROe9yfq0yOO0pnNAxvepFy2BpEbcgG+mCyjCC01JWlOZlIPdf1TtlyOt7L94ToYGCukoFt4OqwOrofamjECpSgKLLmrRM+sNRAw12eaqk8KtdFk7pn2IcDQiPXCh16t1a+psi+w9towHTKPyQM0StKr61b2BnN1HU+aezFNBLfHTiXwhGTbdxLLmrsAGIVSiNAeCGE8GlB0iOv2v78kP0CTmAPUEqnHYRSDlP+L6m/rYjEK6Q85GRDJi2W20/7NLPpSOaMR++IFvpkcwRuc59j8hh9tYlc1xjdt2jmp9KJczB7U9P43inuxLOv11P5/HYH5d6gLB0CsbGC8APjh+EcCP0zFWqlaACZweLhVfv3yiyd8R3bdVg8sRKsxPvhDaPpiFp9+MN+0Ua0bsPr+lhxfZhMhlevkLbR4ZvcSRP6ApQLy3+eMh9ehCB3z5DVAaN3P6J8pi5Qa88ZQsOuCTWyH6q8yMfBw8y8nm6jaOxJhPH6Hf0I4jmALUBsWKH4gWBnyijHh7z3/1HhQzFLRDRrIQwUtu11yk7U0gDw/FatOIZOJaBx3UqbUxSZ6dboFPm5pAyyXC2wYdSWlpZx/D2C6hDO2sJM4HT9IKWWmDkZIO2si/6BKHruXIEDpfAtz3xDlIdKnnlqnkfCyy6vNOPyuoWsSWBeiN0mcfIrnOtp2j7bxjOkr25skfS/lwOC692cEp7TKSlymbsyzoWg/0AN66SvQYo6BqpNwPpTaUu25zMWlwVUdfu1EEdc0O06TI0JmHk4f6GZQbfOs//OdgtGPO6uLoadJycR8Z80rkd88QoNmimZd8vcpQKScCFkxH1RMTkPlN3K7CL/NSMOiXEvxrn9VyUPFee63uRflgaPMSsafvqMgzTt3T1RaHNLLFatQbD0Vha4YXZ/6Ake7onM65nC9cyLkteYkDfHoJtef7wCrWXTK0+vH38VUBcFJP0+uUXpkiK0gDXNA39HL/qdVcaOA16kd2gzq8aHpNSaKtgMLJC6fdLLS/I/4lUWV2+djY9Rc3QuJOUrlHFQERtXN4xJaAHZERCUQZ9ND2pEtZg8dsnilcnqmqYn3c1sRyK0ziKpHNytEyi2gmzxEFchvT1uBWxZUikkAlWuyqvvhteSG9kFhTLNM97s3X1iS2UbE6cvApgbmeJ/KqtP0NNT3bZiG9TURInCZtVsNZzYus6On0wcdMlVfqo8XLhT5ojaOk4DtCyeoQkBt1mf5luFNaLFjI/1cnPefyCQwcq5ia/4pN4NB+xE/3SEPsliJypS964SI6o5fDVa0IERR8DoeQ+1iyRLU1qGYexB61ph4pkG1rf3c2YD6By1pFCmww9B0r2VjFeaubkIdgWx4RKLQRPLENdGo8ezI5mkNtdCws19aP1uHhenD+HKa8GDeLulb2fiMRhU2xJzzz9e4yOMPvEnGEfbCiQ17nUDpcFDWthr68mhZ4WiHUkRpaVWJNExuULcGkuyVLsQj59pf6OHFR7tofhy9FMrWPCEvX1d5sCVJt8yBFiB6NoOuwMy4wlso9I2G4E5/5B2c6vIZUUY9fFujT3hpkdTuVhbhBwLCtnlIjBpN4cq+waZ0wXSrmebcl+dcrb7sPh9jKxFINkScDTBgjSUfLkC3huJJs/M4M8AOFxbbSIVpBUarYFmLpGsv+V6TJnWNTwI41tubwo7QSI1VOdRKT/Pp8U3oK2ciDbeuWnAGAANvQjGfcewdAdo6H83XzqlK/4yudtFHJSv9Y+qJskwnVToH1I0+tJ3vsLBXtlvMzLIxUj/8LcqZnrNHfVRgabFNXW0qpUvDgxnP3f54KooR3NI+2Q/VHAYFigMkQE5dLH6C6fGs/TKeE6E2jOhZQcP9/rrJjJKcLYdn5cw6XLCUe9F7quk5Yhac+nYL5HOXvp6Q/5qbiQHkuebanX77YSNx34YaWYpcEHuY1u/lEVTCQ7taPaw3oNcn/qJhMzGPZUs3XAq48wj/hCIO2d5aFdfXnS0yg57/jxzDJBwkdOgeVnyyh19Iz1UqiysT4J1eeKwUuWEYln23ydtP7g3R1BnvnxqFPAnOMgOIop2dkXPfUh/9ZKV3ZQbZNactPD4ql5Qg9CxSBnIwzlj/tseQKWRstwNbf17neGwDFFWdm/8f+nDWt/WlKV3MUiAm3ci6xXMDSL5ubPXBg/gKEE7TsZVGUcrIbdXILcMngvGs7unvlPJh6oadeBDqiAviIZ/iyiUMdQZAuf/YBAY0VP1hcgInuWoKbx31AOjyTN2OOHrlthB3ny9JKHOAc8BMvqopikPldcwIQoFxTccKKIeI815GcwaKDLsMbCsxegrzXl8E0bpic/xffU9y1DCgeKZoF2PIY77RIn6kSRdBiGd8NtNwT74dyeFBMkYraPkudN26x9NPuBt4iCOAnBFaNSKVgKiZQruw22kM1fgBKG7cPYAxdHJ8M4V/jzBn2jEJg+jk/jjV4oMmMNOpKB5oVpVh7tK529Z+5vKZ0NSY2A4YdcT0x4BdkoNEDrpsTmekSTjvx9ZBiTHrm9M/n/hGmgpjz4WEjttRfAEy5DYH5vCK/9GuVPa4hoApFaNlrFD/n2PpKOw24iKujKhVIz41p1E0HwsCd/c17OA0H0RjZi1V/rjJLexUzpmXTMIMuzaOBbU4dxvQMgyvxJvR6DyF3BaHkaqT4P3FRYlm+zh8EEGgmkNqD1WRUubDW62VqLoH8UEelIpL7C8CguWWGGCAIDPma9bnh+7IJSt0Cn6ACER2mYk8dLsrN70RUVLiE0ig+08yPY9IOtuqHf/KYsT84BwhMcVq7t8q1WVjpJGNyXdtIPIjhAzabtrX03Itn29QO3TCixE9WpkHIOdAoGvqCrw1D3x9g9Px8u0yZZuulZuGy0veSY34KDSlhsO1zx2ZMrpDBzCHPB4niwApk6NevIvmBxU3+4yaewDvgEQDJ6Of5iRxjAIpp9UO8EzNY4blj4qh8SCSZTqbe/lShE6tNU9Y5IoWHeJxPcHF9KwYQD7lFcIpcscHrcfkHJfL2lL1zczKywEF7BwkjXEirgBcvNWayatqdTVT5oLbzTmED3EOYBSXFyb2VIYk3t0dOZWJdG1nP+W7Qfyeb8MSIyUGKEA57ptPxrPHKYGZPHsuBqQuVSrn0i8KJX+rlzAqo8AawchsJ26FckxTf5+joTcw+2y8c8bushpRYEbgrdr64ltEYPV2AbVgKXV3XACoD1gbs01CExbJALkuItjfYN3+6I8kbiTYmdzBLaNC+xu9z/eXcRQV1Lo8cJoSsKyWJPuTncu5vcmfMUAWmuwhjymK1rhYR8pQMXNQg9X+5ha5fEnap+LhUL1d5SURZz9rGdOWLhrMcMKSaU3LhOQ/6a6qSCwgzQxCW2gFs53fpvfWxhH+xDHdKRV6w29nQ6rNqd9by+zm1OpzYyJwvFyOkrVXQUwt4HaapnweCa7Tj2Mp/tT4YcY3Q/tk1czgkzlV5mpDrdp1spOYB8ionAwxujjdhj5y9qEHu0uc36PAKAYsKLaEoiwPnob0pdluPWdv4sNSlG8GWViI+x/Z4DkW/kSs2iE3ADFjg4TCvgCbX3v0Hz0KZkerrpzEIukAusidDs2g/w0zgmLnZXvVr5kkpwQTLZ0L6uaTHl0LVikIuNIVPmL3fOQJqIdfzymUN0zucIrDintBn6ICl/inj5zteISv5hEMGMqtHc2ghcFJvmH3ZhIZi34vqqTFCb9pltTYz582Y3dwYaHb9khdfve1YryzEwEKbI8qm62qv+NyllC+WxLLAJjz0ZaEF2aTn35qeFmkbP6LDYcbwqWxA0WKsteB7vy8bRHE4r8LhubWDc0pbe90XckSDDAkRej0TQlmWsWwaz18Tx2phykVvwuIRzf4kt9srT8N7gsMjMs0NLAAldabFf2tiMoaaxHcZSX51WPc1BrwApMxih227qTZkcgtkdK1h314XvZKUKh/XysWYnk1ST4kiBI1B9OlfTjB3WHzTAReFLofsGtikwpIXzQBc/gOjz2Thlj36WN0sxyf4RmAFtrYt64fwm+ThjbhlmUTZzebLl4yAkAqzJSfjPBZS2H/IvkkTUdVh0qdB6EuiHEjEil5lk9BTPzxmoW4Jx543hiyy4ASdYA2DNoprsR9iwGFwFG3F2vIROy4L5CZrl230+k733JwboSNBKngsaFPtqo+q3mFFSjC1k0kIAFmKihaYSwaSF7konmYHZWmchuaq15TpneA2ADSRvA07I7US0lTOOfKrgxhzRl0uJihcEZhhYWxObjvNTJ/5sR4Aa5wOQhGClGLb746cJhQ2E6Jie1hbGgWxUH7YSKETptrTeR/xfcMNk2WM12S0XElC9klR8O7jLYekEOZdscP0ypSdoCVZAoK+2ju2PHE869Q9rxCs9DVQco4BriiPbCjN/8tBjsah4IuboR5QbmbyDpcdXVxGMxvWKIjocBuKbjb+B4HvkunbG0wX0IFCjQKoNMFIKcJSJXtkP3EO+J16uh4img0LQlBAOYwBLupu5r1NALMo0g3xkd9b4f7KoCBWHeyk24FmYUCy/PGLv0xErOTyORp8TJ5nnc2k1dOVBTJok7iHye9dwxwRVP3c7eAS8pMmJYHGpzIHz6ii2WJm8HMTPAZdA4q+ugj3PNCL/N45kyglqvQV4f/+ryDDG5RPy5HVoV9FVuJcq2dxF9Y0heVoipV6q1LyfAeuMzbsUV+rsSBmCSV+1CdKlxy0T0Y6Om0X6701URm2Ml6DIQgJ/3KO6kwcMYRrmKsY7TfxWhSXZll+1PfyRXe9HS0t1IKTQMZL7ZqQ8D/o+en57Y9XAQ9C+kZYykNr0xOMxEwu2+Cppm69mQyTm3H7QX6kHvXF201r+KVAf354qypJC5OHSeBU47bM1bTaVmdVEWQ+9CcvvHdu8Ue5UndHM+EeukmR82voQpetZ7WJjyXs+tPS60nk09gymuORoHNtbm0VuvyigiEvOsyHiRBW7V6FyTCppLPEHvesan91SlEh1/QEunq+qgREFXByDwNKcAH5s8/RFg8hP4wcPmFqX0xXGSKY087bqRLsBZe52jThx0XLkhKQUWPvI18WQQS3g2Ra1pzQ1oNFKdfJJjyaH5tJH6w0/upJobwB8KZ5cIs9LnVGxfBaHXBfvLkNpab7dpU6TdcbBIc+A4bqXE/Xt8/xsGQOdoXra4Us5nDAM6v2BNBQaGMmgMfQQV+ikTteSHvyl8wUxULiYRIEKaiDxpBJnyf9OoqQdZVJ8ahqOvuwqq5mnDUAUzUr/Lvs1wLu2F+r4eZMfJPL4gV5mKLkITmozRnTvA7VABaxZmFRtkhvU5iH9RQ1z26ku7aABokvptx7RKZBVL6dveLKOzg0NC7HAxcg5kE1wuyJiEQLOpO0ma3AtWD2Q2Wmn2oPZeDYAwVyEpxuwDy7ivmdUDSL95ol3h2JByTMovOCgxZ1q4E5nwwa7+4WtDAse6bDdr27XgAi5Px3IWbyZ/vRiECKwOMeJSuIl8A4Ds0emI3SgKVVWVO5uyiEUET+ucEq0casA+DQyhzRc8j+Plo0pxKynB/t0uXod1FVV4fX1sC4kDfwFaUDGQ4p9HYgaMqIWX3OF/S8+vcR0JS0bDapWKJwAIIQiRUzvh5YwtzkjccbbrT9Ky/qt5X7MAGA0lzh43mDF9EB6lCGuO/aFCMhdOqNryvd73KdJNy3mxtT8AqgmG4xq7eE1jKu6rV0g8UGyMatzyIMjiOCf4lIJFzAfwDbIfC72TJ/TK+cGsLR8blpjlEILjD8Mxr7IffhbFhgo12CzXRQ2O8JqBJ70+t12385tSmFC8Or+U8svOaoGoojT1/EmjRMT7x2iTUZ7Ny02VGeMZTtGy029tGN1/9k7x3mFu63lYnaWjfJT1m1zpWO3HSXpGkFqVd/m3kDMv4X9rmLOpwEeu8r6TI6C2zUG+MT6v90OU3y5hKqLhpyFLGtkZhDmUg/W1JGSmA8N1TapR4Kny+P6+DuMadZ9+xBbv06nfOjMwkoTsjG0zFmNbvlxEjw+Pl5QYK+V8Qyb+nknZ0Nb/Ofi9+V0eoNtTrtD1/0wzUGGG5u2D/J1ouO/PjXFJVx6LurVnPOyFVbZx7s3ZSjSq+7YN3wzTbFbUvP8GBh7cKieJt56SIowQ2I577+UEXrxUKMFO+XaLLCALuiJWB2vUdpsT+kQ+adoeTfwOulXhd/KZ7ygjj6PhvGT1xzfT7hTwd6dzSB4xV70CesHC0dsg2VyujlMGBKjg5snbrHHX/LNj3SsoLGSX+bZNTDDCNTXh+dCVPlj4K8+hJ/kVddrbtZw26Hx5qYiv3oNNg5blHRSPtmojhZmBQAz8sLC9nAuWNSz1dIofFtlryEKklbdkhBCcx5dhj7pinXDNlCeatCeTCEjYCpZ3HRf5QzUcRR1Tdb3gwtYtpPdgMxmWfJGoZSu1EsCJbIhS16Ed97+8br4Ar1mB1GcnZVx/HPtJl4CgbHXrrDPwlE4od8deRQYLt9IlsvCqgesMmLAVxB+igH7WGTcY/e3lLHJ4rkBgh2p1QpUBRb/cSQsJCbosFDkalbJigimldVK7TIHKSq2w8mezku9hgw8fXJxGdXoL1ggma52kXzjP78l0d0zMwtTVlt0FqnRyGLPGEjmICzgSp7XPFlUr7AeMclQ4opqwBFInziM5F8oJJ8qeuckGOnAcZZOLl1+ZhGF17pfIuujipwFJL7ChIIB2vlo0IQZGTJPNa2YjNcGUw+a/gWYLkCp+bOGIYhWr08UIE709ZEHlUoEbumzgpJv1D0+hWYNEpj+laoZIK5weO2DFwLL6UBYNrXTm9YvvxeN9U9oKsB3zKBwzFFwDgid5ESMhy68xBnVa55sCZd+l5AnzT8etYjIwF/BGwEx1jjzFv32bk6EeJulESARh8RZ48o7rKw67UZpudPa15SDnL8AL8xMV2SC0D1P53p190zhCFkMmEiir2olwxcJppl/kLm6/0QSUQLNaxi1AC3Pg1CTosX2YQr73PjEIxIlg4mJ62vP7ZyoHE55B0SX9YrrrCPtNsrJEwtn6KOSt7nLT3n3DLJTPbLulcqQ1kETP6Huts29oP+JLEqRGWgnrqMD+mhCl1XCZifjgQ39AeudE8pyu2DqnYU3PyPbJhStq1HbP+VxgseWL+hQ+4w1okADlA9WqoaRuoS7IY77Cm40cJiE6FLomUMltT+xO3Upcv5dzSh9F57hodSBnMHukcH1kd9tqlpprBQ/Ij9E+wMQXrZG5PlzwYJ6jmRdnQtRj64wC/7vsDaaMFteBOUDR4ebRrNZJHhwlNEK9Bz3k7jqOV5KJpL74p2sQnd7vLE374Jz+G7H3RUbX17SobYOe9wKkL/Ja/zeiKExOBmPo0X29bURQMxJkN4ddbrHnOkn6+M1zTZHo0efsB23WSSsByfmye2ZuTEZ12J3Y8ffT6Fcv8XVfA/k+p+xJGreKHJRVUIBqfEIlRt987/QXkssXuvLkECSpVEBs+gE1meB6Xn1RWISG6sV3+KOVjiE9wGdRHS8rmTERRnk0mDNU/+kOQYN/6jdeq0IHeh9c6xlSNICo9OcX1MmAiEuvGay43xCZgxHeZqD7etZMigoJI5V2q7xDcXcPort7AEjLwWlEf4ouzy2iPa3lxpcJWdIcHjhLZf1zg/Kv3/yN1voOmCLrI1Fe0MuFbB0TFSUt+t4Wqe2Mj1o2KS0TFQPGRlFm26IvVP9OXKIQkjfueRtMPoqLfVgDhplKvWWJA673+52FgEEgm+HwEgzOjaTuBz639XtCTwaQL/DrCeRdXun0VU3HDmNmTkc6YrNR6tTVWnbqHwykSBswchFLnvouR0KRhDhZiTYYYNWdvXzY+61Jz5IBcTJavGXr9BcHdk/3tqaLbwCbfpwjxCFSUs1xfFcRzRfMAl+QYuCpsYGz9H01poc1LyzhXwmODmUSg/xFq/RosgYikz4Om/ni9QCcr28ZPISaKrY7O+CspM/s+sHtnA9o9WgFWhcBX2LDN2/AL5uB6UxL/RaBp7EI+JHGz6MeLfvSNJnBgI9THFdUwmg1AXb9pvd7ccLqRdmcHLRT1I2VuEAghBduBm7pHNrZIjb2UVrijpZPlGL68hr+SDlC31mdis0BjP4aZFEOcw+uB17y5u7WOnho60Vcy7gRr7BZ9z5zY1uIwo+tW1YKpuQpdR0Vi7AxKmaIa4jXTjUh7MRlNM0W/Ut/CSD7atFd4soMsX7QbcrUZZaWuN0KOVCL9E09UcJlX+esWK56mre/s6UO9ks0owQ+foaVopkuKG+HZYbE1L1e0VwY2J53aCpwC77HqtpyNtoIlBVzOPtFvzBpDV9TjiP3CcTTGqLKh+m7urHvtHSB/+cGuRk4SsTma9sPCVJ19UPvaAv5WB8u57lNeUewwKpXmmKm5XZV91+FqCCT6nVrrrOgXfYmGFlVjqsSn3/yufkGIdtmdD0yVBcYFR3hDx43e3E4iuiEtP3Me9gcsBqveQdKojKR//qD2nEDY0IktMgFvH+SqVWi9mAorym92NEGbY8MeDjp553MiTXCRSASPt+Ga5q7pB9vwFQCTpaoevx0yEfrq9rMs3eU6wclBMJ9Ve8m6QuLYZ58J41YG3jW/khW92h6M/vbFIUPuopZ6VVtpciesU74Ef7ic8iSymDohGeUn4ubT0vRsXmbsjaJaYhL8f+8I5EiD5l680MJbxX/4GYrOg4iPQqpKp0qddSu/HKtznHeVyxgTwhfEORMCwnaqetVSzvidaWN9P+fXtGXfEP9cTdwx2gKVfDdICq7hecgRhIs0qlCt6+5pGlCc6kWoplHa/KjP+FJdXBU/IDoKMxRjFhSYkggIkhvRKiN/b2ud8URPF+lB87AGAwyMjr/Wju2Uj5IrppXZWjI3d14BdKE2fhALyQPmHqqA+AXd2LwvRHcBq4mhOQ4oNRWH7wpzc6Pggfcbv9kqhLxrJKEaJqA6Rxi+TDNOJstd5DoRVCDjmVspCVyHJsFEWPg9+NA8l1e4X2PDvOd5MPZAGw6LRhWqeZoSQcPf9/dGJYAyzCmttlRnx0BfrKQ/G9i5DVJft9fuJwMi3OD/0Dv1bRoxcXAyZ0wMJ6rwk9RjRTF4ZK8JviCCNuVt/BqQYiphOzWCpnbwOZt6qXuiAabQWrS4mNXQ7cEErXR/yJcbdFp5nWE1bPBjD0fmG3ovMxmOq5blpcOs0DtNQpci1t+9DKERWAO53IVV/S4yhMklvIp0j0FIQgwjdUptqmoMYGVWSI5YkTKLHZdXRDv9zs+HdFZt1QVcdlGOgATro3fg6ticCrDQKUJC7bYX50wdvetilEwVenHhlr85HMLRLTD6nDXWId4ORLwwe5IXiOhpuZTVTv+xdkTxJofqeCRM/jcZqQlU0gFVTlYlfwMi6HKR2YG4fQ8TOtgR+yV+BMZb6L5OwDc/28/xdfD7GXFaVA2ZSObiIxBwT2Zev637EuvpM6rxcogdM4FJFa0ZhF7nrqtNsqWg5M7hZMORpjd4szf/wS+Ahs1shY54Ct5J1dOBO4sdEtSnRc0P9PhgyOCt6aQW98R22DpAcNTDe72AHK40vutKTPfpokghRPuGvz0dulBPKfC3O4KVDCyWrJGO7Ikdu06A0keKlVfi0tGcpO0NhzXEh75NHyMysAMV19fq7//sPC0For1k2uFEvq8lwrMAfmP7afR69U2RqaILHe7glpc8HmVf87Qb2ohsw+Di9U+ePdHLecS66MhB/0OwdcXR5WBcWTZLGq/kiAaT+bzkjR8GIpWdv6pfIgQ+Q0xdiKvo+gNB7/Nf9knNJGxnh7LeZEFtMn517tNc74PPS0M4K3I6HHZqNPA+VZcBc/g5a2ARyqKrJ4Z3krsuA+VOJJz2KJpBMgCCWFln3u7k6/q3DETAubKG/pt3ObaNT0NI0Qug90L2ip5dHnZJUjPTvK5E96aX/4mRU2u8n8kh6MKbY7ANBro3huF06U+JvfyELQP25oIaj+n0ITQ4KT9rXZD4EtBIOj95fYNldDN3io/VMIvWNj9P/b95WEMq8UAVfG2XG0N6fSYdnBEC7sUEbatbDICH9qA8TTuW9kEt9DlFOZFP7bdfYLa/khSY8W5K/AkIIAPXtMvyVKyESjKx9nfragssxC0jFMVY94d8lOAwRocdS/l/P43cBGa3IqDa0ihGPcmwS8O8Vj16Uy55rOrnN0shhRJZdW8I7F0Q0KeHc35GFo4aJOFc25gNafBu1V/VO0qS4Qkb6wjRrnlepUWjtYyaDABZceValuOMtoDdeIITWKOJiwGPpB12lQgwkmXh9M86podb0D117mNQ8ElluFvbaS8RTKQ6lyj88dUwoJU/ofOeubhoXWBF8eNumkVJu+As3ED/AvLlrV91UowIWI2m8HBG+a3k247ZKAGYsOcWe7fTWqL8eqwM5ZFuoXbeugPKuMOAtOsN+4dSwkhrSAlfGNTzFwEmCNWtzpa9CgPbYNcmoHtO8pj8qMvlGET6nrkJoQ2lp5MEUV1E2A4ZH70JUlCLXvqTIpZlzyxdr5p/GZiD1/BuFOGbyfFzhuxaC/l3lC2jjt6GNRBa06AqqPlYtdA7kiidYa5Qi0/XpXiMDyMXNOj3kmJEaXufW0GO8+DF8OoMULX1vvjCePKNis4AmxQKLCF+cjf/wyilCJvuiyLVPSdsuRTPZ0AhpdDF/1uFmDwG7iP3qYwNsKzqd3sYdnMolCOuQOIHWy1eQpWhuV+jmSeAC5zCc0/KsOIXkZPdiw8vtB33jEBpezpGDBP4JLY2wH1J7Fzp8y8RICqVd25mDT2tDb/L1mh4fv9TOfDH5dTeATqu+diOZi+/sIt18hiTovPsVQVaqXLPRx/4R/uH/86tBMcF+WBkThKLfblcVCIECc8DgNRVX97KdrsCeIK+CvJZMfwrftcDZDZyp7G8HeKl7bPYnTKX88dXAwAyz66O2chkPDHy/2K2XcT/61XnlAKgPwtI8yP9Vu45yh55KHhJu93mL4nfo8szp/IyDjmFHtSMqqoWsj8WaVhbjXgzZxcqZcyOe7pUK6aXF/Y32LnBOt0WN28UmHRiOpL525C63I2JQPX8vvOU0fz2ij74OeJ1Apgu3JRObfdo9xGDpp7cv3TdULEfNS6Gu3EJu7drBsBsogUqUc6wAUW3ux0/1hLVI/JEKJrAGm8g72C2aJSsGAsKFW4CBvBXVlNIKa5r7HvT1BeGYBfxTR1vhNlFFNN8WQYwr39yT/13XzRGiF2IsfE8HcN0+lN1zN/OnzekVBKkFY11GgrK5CLxrE/2HCEMwQb9yOuP2rTXiZzTEETp/ismFGcTWmbM9G1Sn2D/x3G74uWYZY4rgKB2Zo2bTKS6QnM5x1Yee66Y1L7K44AyiY5K2MH5wrTwxMFh+S8LzNQ25z6sunWZyiRwFIIvSnioltUXNiOr+XMZ6O9h9HcHxZJkfF0tUm6QkU7iJ2ozXARitiL86aqVsMOpmvdIBROhUoanPtCjgft8up3hAaKpw9Qs9MzYtBA2ijHXotzarkV3zKEK0dFFQUwT74NgCmGGuSCEDmFCezXPC9BhyGhmzNa6rQeQQz+r9CmGUZjIQEPsHwe86oCOQhWaHERsv5ia9rZvJ//7UXO7B329YUkLLAiqpLRsVV5XpcfdawlJqi/BVcCqO6dr9YJTFFRMVGhfUbB9YWNvYPY6RyaydAFYq1YIBQxuNAGfYWLMAHtt2XRHoOKCLz+qf5HCVBDOPOktQ3SdJBfxUkaiD585bmTzMwU3oeXUHZ55EC99Kz9kk4ZXMIENwVVpqW2JmGIcUiutIMj2KkpjE2QD+dIZUCxcX57kH7hiuUPnKCTdaw4KN95XPeFRvMcvo5L8LexWqvaJPECzwXCs/4XPAlSMpWUzBBjK3pEnkbueMkMJQrYcnXf7PjbAoJra1VLX4YuscQLpaeYWbT+h24hCFrfcHjxxx6WTSe4AGY/KHRZCQKqTuFWt0D8RmGWmvXSdg1ptIefYPshuIVZT7CV4Ny67fvjJugy0TNYHqoCO45CB88kxrvIsih19DqjD0UqiJsTFPcGW3P/ULOG3nb8CjpgVTIoa5nO9ZYEX4uEHu8hLXrJPjV1lTQ5xTdZVagg+Wj8V0EE4yPsTc345KM6lVXqLiHtm+G6edC4GVEiPgd98g+twSYm18gCsPnjqlLcFm9e72CLJbYD+ocIZOxuVjrX6IKh9fh7WqdIZ66x9PWkDGOVVGkx7jM76Ywe16DX9ng205kg5eq+R2q2MguTJxYv/wWHliD9mOYpzZKNXYC3Wr4iBGkm54hBwkPzFhiX/VBHdVH/KJ1ZIMOHxIN6arKdxrm6EBsgwDt0mPe0MX1HRUMq8ctcmysU6xX0bzM1J07kAvq33jw1q0Pq2cyMWme8F7aVkfhzZEFdyi8fVBQav0YZqvAjZ83WKH726rBx5Bn7GHFthR6H4lFsltu+jWmsAibJ3kpWMG/QbncU7n9skIBL0MuXXtj9sJg+4Dl0XhKJ1LcrMydaIgyrgZgScP4k8YQvcsBmD26X1iYXKLzMYfZn2IfRjznsrJ1e5cnl/3a5xiNoI6n1x1U36FWckJbyx+hiSZg0QqAqeeSvzFYMlZ2REnO/a6yoQhu7PdHMYEPFIvfyGeyCU8e7rpju4DrlOhszj9rOIpNsvCkuD+TLyf5J7D/wsPkBpscFVI1q7oUSU9bN30vH5AqnO7bsf+9rGhtVjOJQ32H9hHSAzR2ape4L0Cz4WxaySm4jvuGXwkFp5NMMLrgZ8LdA+5uLuyxO5SMOmJNDBcbbLefv7z6LyxBwltnfQLd7qqpG1MmNcoLUcx73BkNF/xpdS0cKd6G646ntChXSeTZJJTFYGw39T7fqXDPKoG2cF7/ZcTvME42gXLVjTqzAER1Rt5m7GYsh0X0+XgOeW9MJqE5j/rpGzY6vUu6ACcCTzDMdZHiWELpDnvgE1hmztLcSYz0MtNyUBLqvylUJJnJu79Sku9NMHCTkgqozTnhMFfduV2NLCSYvAI5HUvQp1h/M02vKFD6eosIkGTg6mujUo1W8hy5Knf/erkBQC9LzNqPAYCgR+hczgevta88NNqSlBZryq9QNeUK7RpbvHjoNhUKAAeNYH55LeTW36KyFaXdAkBvyNP9xmRuBokPi2OhqDby6IZ61mwfzG+GmACkS+G80A4WGON5izgJWeeDK91jzusfOi0RmEsVJXwbVUr8u/J2LCQaMnHhi+wJTEPN9tS2b6W4GRGCNmtjAMgPsP357nOeD3H2tcDAPu5xQBKMHf/j4ZhXlkvvy3YmBJsjsd4pSOlfPZCnw5JvzxEXM5JIc+E2mU4CgB0mdJnH4NEsCHYNeVRDXFNuyZUE4nuvaJf1h+11AWLdAZ72D9XNRcxfb2+XHZN/SN48U7yl+sNZhg5gn/PD8wkBtnRj1zBUPIWnoMP6yGUEEzuT+VaX3x2jEIZAZsr3rs9wCfY1Ss0EdIFFzBbyruUup4EPanbSYew5tf16/ZWVup5iykttuqL4xoC/jdZWsAZeSfDSd3fP9kbyAFYXkf0Q2lmxaTkKRZrCo9XCoiUG4yP1URJ5G7+HSOhhJp0Anz0N07QZtyFUye6rcgiOFbtyoO1lkuV0iQ602MTyFK9xLqNHtNy4cJaTO6hjtiwNynVc34ZA6H7k8ai6S6eF6jIG0xJx+JfP97lzuCZr8vU5SIzImaNpiQhyvDbz23//PJcOk7hD4iIvJzfIgOGIR6ZPEJpWHZQoacbF+omeHw8aWHaNOfaIyGeG4lEryMfhtNmWh4RAIpn8dLs7ZE2eTVDwK++xDoSUgh47WDmKlZ/k6OosEUoQjk7Q+Kp7OxwgMFShAv6z4pTW8loVj2+qXLQ0T3hmIue8qHy1o/HXjm089m71t6mrrUyDftqMYtmfvQXKDlZ+K1HR/FkqPSqcjGlcPPIwbMw3wIFKBdVMJ4pFLt+oOIkWZMw8pkoYZ3byw4LmAF+7BdicGXFcb5PWtDw5XNNVc6eB9dv0rAEpgr5J+bLr010bpfGw+IkRoxDbkDFmQdEQUSElP5bViLo1ur/23KN0jEwl+rGC6AUMKxHcv+T9F1Ktpn8jSSrKxJnVkK8UD/tH5DN6nXB8mjUdFU539e9ywLtLYCwmHYVEVqnFmdubduaSd1ivIo4pTsX+mJcOAkrR1D60RIoocCBIdwJhCBM1rOE2XSlPo0U+khALvw+zfxYzwzd4roWlLJkZheFRR8QB8v4USwmAcDswUZ2P/7v7Xa51Fs7orYebYyww4YW5869Y/c6Kq2eTR9HLSjYuChTkXaDygoo8nz/yJ0KzfX8oowaNAwz8HvQdlLU9V9hjqYMURyYvPzZ60G0itmUdZwB+sY6rUkMAZZtWStbDFmnk/dQorhwr3121XQWffrK3as0g29ASwxbsZ3dZAq/96b7/XWckbjmo8+jwdE680DzoEUUivnBgowMuBQxHXoGyp+w/cSGY88rWtmwoyNNIvChs/QsZRnbdV7y8x7t2RkliJV/j8e6qfctrTsMV22zoqgQuTSNFh7U7p/Q49L0kygXNnEYXCBDgi5BeNWxu7VjULcUHI+lGj+OTCEATzWrDmaynq3wT9IAejtvh3esCu6sEu9JOsXxMDpqxm4Tzl+pt2Wa5Bq3TM5TKH4N7KLir8FGIPA569+uJ1VEL3fW8Jyigz/nEUjAVYrdCWq2MnS4hQVgcvXq9aF7Xke/k++rAtIQqckPNwjKrV2t7HCOrA1ps88Y5Rw1Zp+9itnB71j8tNiQc7mV1kUCQXkoi5fOsq1uC6hUPUL7Z69NAM6lg0c/aeiifHoi35v+pVBh7CDM1XfvYpiK5JIbIQFHafmnhHfRTnMagKcjdE7zzgtxkTPKVrObTySTT51g9bB5ro/dzn/sB24fNM2LGJuRQsmC49PLi1jTRfZaLpo8Txxxczij5Pl2vur+S1wQW3W5qyVcIUySZHtFDQHv+EYDoZG1T1J7D91vEIV8dHzUBzW1UyuxRbP+M/CM/vsas6RzmS5traXnQ0Jzv9hYXxKHcs15TQCP744XsLjzFjILYURXFnhM+nnV0iO6nwls9TR4tlz1J9/NvE8FGg5mgpZA4htS05AK0NnU2gxuqf2vjCyWlm3ypKvaX4vxh8Um1MHGB2NTeAFhbDyGm+5w2zqJAWxVlj6dVePb5yR+aMhuz05YubCQJ0BOtoYQ6PoDoW5fCwCtXj5SHvCgL/3B5z2mcXWaRTf8/GsFAfX/ntdWZWFc2xg8MJeenwZ4dZUToce43If4zVb1ex3BMAWGhgkPwR5EgktZhW3Yi+nsnZTUr9FYI160YhAraB0zMV+ouHz6hYm25/ETDM0MTmcypoGgZISSkfwYAQaHGY45yZ91K4A4Mm4fnbMk8GTc4orypT3NLBqAxYdcY/qCH82PpIkmVOEHi1NoYaUymuImLLcib5pmd2MHTB3JR+4rLdRc3gtQ9zeFdciciRiWviu3HkqaLSxJeI2rgc7OKQslItumACQow89elXmi4P3gTZeCauvMH5nF4VrBcLjjwGD+KlKqe/RWIEgT2wGqAgSuL6b+RTTPnQZzxZ5y5HQJkEEKJp5NfoB8hJBM8qn6xbOFtyzBjVBrwSS1zCJR3lEc9ODQ5Wu/xct9/2Q6qLHnmNx6XwZus/i8rEd6UsVxGtoDrm+Br0L5oUojlwdcqyVV4PIMsR60JhZwJtgX7izQWj+GOeF9DA8Wexdmv6DWjgR8LEBp9YuPAM8tJDu3uCumNqHnF2ATYX/tuVO55OgQuiUhmDmJbF9jJyifBRtxOVI9DCNLUY71IXZYTuiYcnILQ/XHuVJ8aHDStL0N+3eYNvXwHi2vEiTPnBqzsC4TsPnFVnYY042j5i7C11AVdBZ1pGSa52jM9dIL119rry0mgGxFzI8xPs+7bmMfYKh37A4HtA081olG1m9S4Zch2hoNCGVvVhd6UL7C2d5hKIBHoB+Uxarq/4aQXhh7IWjSj+ca7Vhqb4+ZwY3nHXh2S9JH4XZxQojbe/eINxYlozTYtT2rpU/xbj+W2hXjFQ+z+dQ8wh9751MP0UpjutQdxz3/FJYAEG5BF400JXWCBs7KrCRf/l+F+d9EuwVk6thOPDB+HNS9iWlLmDgXvY6K0vgiyoeA3An+jWufdAG1suUMBuJT+/w0FNJZbObUT8c5q5WtQxASQF6E+/u8UwVBs1eo8jTamCrcdhZJlADJbqn3crcDHQlBQNGq7btcGKiJXW6q0cn3F0xzf+k1JJS2testB3rx15ZPTDXm8QV5XE2qxBOdM2n6t5YbxyNOmEdsHx+hMp+y9pWkcgw1NikeXuafJvzcjaNwE1Ad6gG79S68aO7jWpKgBETYLmV4ONHhBk7Be8tjf2WVvWMDQvQdOnk448yeMv1tQKU1xev0L171e/qxkMZbmkfKnd29XRCK2hgNNJhwt1qiYWZGKz7Di6K3fGDT7DO2YQ7WU33svE/WKGbWQEvzUV2w+VNYDocI4yxQ6i3i4zU2TjmjCwu5Pk+Ja9HSwLpEoUswq3tFJ1jimthgMXd7KjSl6Qd0K+vxWT8G4/+xITHsWDGSfQTSdFQth5uVVfa8wrkDZHTGVgpJys2ik+3I0dSf6TNo6A/sVptyY/kx1hdAWKPI6t/xj6s+fPMU3hg1vkEB0RRHq/tCy3KUUhzU/d0JKxTyjvUms5iy1GbOFco0NA4t83SK9sBmtLWm4kOLLflyxqgQYP08iyXwYXzKnlQ6VTipuaspSJ9g5H5Lu3eLMnPKbhcwuEg0VZ80ppJWjUnhS3rL35erzysp+fJhxsUs86m28/UwW+IgrS5Y0zWaxlFJ8xML5wk8sg1ragF+eNajyI0Y4mwStxt1RZH2BjaAhvu+SnNNIK88thEgZEsoHv+ii+OMmXJL7dnAiINVDz3tCnqDgpQX9OguNGgZj3axcjq1UgxDw785yNIpqNiLgv57399jVmJ0/RStNswaFIs6FtnkilFZldxj6m562jL4p5g3Y9XCiXRJX6nq2PGJFifFR7EyPG4jDMnBM4t+O8ZpEp3th7TCxEw+ZG4afHl4sNFaqxyLh6+979tt0Aq9BrqI+CS2U7HJoKiGmyVU1lFa3/0O5mNC1bzRgNMy+GXyifLwJP7FwUSUmxmVRpn+gnXWoIuswPutsiciurvN6lsMG7yqEc2Y5ZI3jrPgPq0xEKPZpF7teJa0TQn8BQL4Th+hjv2ByfwKookyXEmj0d1KMcsmfKaeKK3cZZubiYqmSCrnGpYTwgPk5itKucVtjViuswQsDR6TuyGSIHYvlz7wkLg1Rr0K9kV1o8RgABlhbLrN74cVWJW6TnfXN0q12JFMpUbEa8t1+j440FA+17o8qa8PQ9igkctVROVIfB3jU5vtGm5pYYHYSDvU2TEc15pIz19ka1q6c/7WXfF8+POkApdOw7nn7Kqz6V4tru7NXgnA/u0g6+fPRT3hp/QrDQwMsjwNCZxdWrR6pgCBDJNc7/KAlwC0UZ4yWQs0KsuwbbOgcTxQPK54wiXr7s+221hzZ8RVxfoRUKM3e4lpxHC83JllxlrV760tl06f7/65qhE1jhMfivAUXIXfRMe3uY/G2TpWYzDrw5Cm5cS062Bx9lhHq9gtJp8xZwAtSdSuW/Kd7+orEAiswA76N8ezmVGYgNaYlQ/xk930LAWAtKVBC4U6R08L45IohB1kFia7XJs0TcaT2zBZoLFuOGu4iJaoAnfjL3uS6gnRH7G7A+aT6ETlmkYUfgrBuaSLLDJfhPJe01PfN0oqBTeQURasl3N8BZiQSgdr0aDv3hPTiog4NSyfAUyy98WP7dnTDWQTY+Qwzgk1uxwRqHl5MpC/84Cuw1TXfRlgJrwPop10kCHjmffnFdxCe2J3R3J5j+3H/sZn3IUu3Suy+I+dAOMWvzwExNR3RRPVelZAhtarKlXPWNjPRIVP4JsAFSRXs3o/fSYAPaV/zP8q6DltH47/rYhCLdy/LrpOsbaLf09eACcClJosNefetNElkSFSuCgeY7oTAAl+8Y2zOXJb/bgEDpoDXfQqc6lnlBr/WsmVznkBS1M7ufiqpxvKXjwvR4WxLbh5NbMNy8LsnX4UiuAi8XonbSUcVZKQOWBYUecSOMj6jMG8gHu7WNreBHY90lV7FocDprSrSbexkAtMW9KlXcnrOyLnZdodGYdxz8aw71HztIqLhRdCOB6NyzHPoS2hDy6wLk0I5Jr2t+U0A+A7EsgSn/Ih03A5CspHnVF4MOic+Lck3m61Um+GHDEe4DrHBhmgtDlRQl1XJ/V/VumCHtUDDcZCkgjVMBOmVOGYW0Rcdi1ahdjhBcFlfjA+5cRjBop1aNDvdrf7CxkLVgxiCxhRctW8wczM8+kVmIrGtkaHGlr8y2D098HXE23r7fnJFUU68zyeyM265igNOGPzFG0dIgUDWN6S3ZcfMERJdWVvpGhVEHXNLeWqHiTcF3wOt0FbJY4XHEpmkoG9MQPJJ4ueQ01+MB+SR0rCSGzlE8zod19q75LlLWgzogpnJoD4gPxUYcX+Gpc5Ly4nk+Zm8LDXcNR7SNVxLh6NAcx8ekjb/AC7ADlRnfuHaHJaBodZr7RBX9FLTvocY6kY8bavdAkQicE9bbwGLkZu6whTCJ56lOvM39ijehpTOFqR3V53nQx4hfOvwRPU2y2w7UU8yiRbcyaX6jGJ9CRvl9ybV1tebTp5MMuMnwLcx/lven0w9T0atJuiUE2WtYGiVMaP3EchABl5AsyaCpu/BKAWDFvU2vaCL2/fJBKCKLjxG6xzT4Mh4wHhH3/EqsGSoQAHu2wbHmXHj2LvoW19GXDa2oyeKRwGG1PU+S7mE/S+UmjHiDF1oqJ0R5QsdjAZYN1MzpNX5YDqWYfhfdjAXyFQaVyGKkp1oEGTR8MK6jaGfRDFd41u2Ex8ac8jKPYu3pXsk8gu+m9tr1RVzTTuDsACW4S1h32yFHX7qpXSmA0QVEcR8W9j2Juu0pcYqTmdis88VgT3gq7iYue5Hx/3K6hFQa9rZrNSDcjaSQlNn4LSqs20bypnKqpzvnnxjMdz5StbzvoAJKgVZa4DLCVoJW765/KyTF4s4YztmAT1c0pTmKJHTpa106FegDo8p2zD6uOnwpYi0vJlRMDe9wPT6964UfAf6lq3qWypUOx9q6BbKEYt7K3gWMXDNN6wAm1fNnSOnZ4JkbPq7jLQrl0wL1V7QwO/sXneKGfTgUL28I5iPVG9dA2gS7Ki005JUR7Vmw4gX4TJvy1WS74cIXD08LCF5obqcZwamuoZ+FPMJEck0TLHjyH1baPr55/Cy0ptDfRJ7d89pbP48tLMHG5dO11Z8xSSpPGQSgXDWmpsNsmm+MvxJjMCi7OFDHxxpmTtjgnOCq+c7Fi1DybfhAntviKccz+sj+OPKPYOKeYYPLvq6MpUx/chSvBccg9dfbeqetQNCs3eiCFZTU1mrDido/mib64STMgsa+IKLk9PyxGGbVSQB9GsHto6f5prAFIbRDSItDedz3t5+Nn69FFS0nEfmkF7hKBmNVce5xv65USKGBoHYxJyutSGnRIq7vMDsAMvirOEJOzNi5Kt7fypuSU2c2Npo6UH5jMOkePH0TwgpammO3Fb2FX6f11309z/mqRmQ949HHRj/wMzKNx95M9pwKf+UQkMEwisL3YVotvHhCv4y00Ui0Ql8dR7tGqFcSdYtmoAOuAodkBNs4PZSjAAF7S/szwLddFMdCyB/dWPgFUiUE+WmUUCjYrKfJLQfNNpQ4NKaF57w7Kp/isZVwQPUJyjJavN3fQNKU+F74jVBJYQEcEdw0Niinyea0l9PJ1/AcTm/LI91RZjDvLI81pnat7RKU2P4/TnIAa3hIEfeg4iGQ+wTDlURK6YjNpN5s5VkQW9w7sDYKU4XmjyZsCQLxztqd4SDQvLyuPDhURAJXKfR1c7tq3mRu4usFHPqz7HgS0X7kNxiWWR3fb3uVwbgKpmgLYkwKrXKt09COw4MjhxeZlDXKy7nNLHXAIKPtferWQnZLboonQXK81x+BB3oUidBehK1swSXxVbscj/LsfONu/xYEXYPM3aMqIYd+2hAnFvDHbdrJLhGEd3sG5PyxqhzejhQJo9wauFK3xmPYqxB99J8zYU9/yzrEZNzzbvPoR9vUlE3Ha4zspVDzHHffPZMJ1VLZkKqGCf8ZqupqMt6T+NRPfmPm2xeDgvzMrRJEL4/zzlu7Z35smvzbgeC25VP2CUrZkRxEi15A0769ojdO1d7C9OG+swj1ROMM3NgKdeBADoRMeJkRZcZ1FbQu6C0BS9NNSaoxtFzYT4lX7+PQ7BKa84yrN+ujVVef+SgnEie1G0N+eOtbZF/UU+wkeerWjloYqFiqo0vBnmxh+TwNMo9I/8lfU2XTCT0K4OoWE08ipyNHjxHvfhY6qa3x4HzdQ8+jkiO5+j91YkihS5memfpFREHP/2veN5XcRue2zCVuAub8V6vDlOvyP+PBm+owyRhMmng5wwGGIXsOkQekXrXpE/6dFjkHwwoFoj5bIFiqp+4wHpSWRbv2xGrRpd2c87FzMP6Hfj/3LWIBqFiNOAxBw+AAP1XqUBszdZhzOSQrQS4Ein4fyV7MaGsB0VsMF4bPb4lx/foTGQRJv45LpoxDd84xCawHaX7jpXUrOdkFxx2oUvY2xqpgIvcVufwd+zAnaaVTnEyDXD7S/o/xrrk4mgTjXhcjj5Rzrbr23NmuZQvpdNzny5MCR9bwvIRIqzOZZLsstZSCDYa56JTvzxgBs20dYTtTUbe21uljlWqGfSh2bYAzOpf6UguK30ZxNXgLHs6Y6urtxFA5iLYvlue5mDONW0MOtQjhqr8fRbCkYneiDkvzHkQVT4F9v9vxh2SIGPBH8bZb8ugo/BSgXojeSdNXbBAIDsB6DUNSXnwlu/bFLaCqSbvu4+YLplwO1JbtrMf9ZUfsxerAZjB7E/zl3qwgK27FswemUmSM4i37YAVhQSocuV8AcDI/CSeCDNPavESshDQ8A/lVIrAJAMdP/rHXouiNU8RL/TIvfQiuZEb6dkIKMGGOW5kT8vO8pivWnT4v7qmwuJo52AS1r/RyQ2g/7c9ZJgmMIzf0GvJJRfMNu1utRNuLWHOm9JIMcJK3qiDtVpGCDP45W1oTTMUnMC91kYhP0GHjhCW8V38xhjHgFFBfuWMsmSQ9MvNqKXiqtUhDAkIy0PW7YSKaKUv6zctAiIk+Jt17kG6LpNVOeMvJnlVBaJSkKe0HTJJUMvf8R2zna35/yh2wNlWLzIP3BJR5aRNxkV94ICOlycI1/JYRZtzvWMNoIpQrdNvyBuBydhSwhRwPo079Xk/XQZpbhzN/KK4NbdJQV0JIMP+Y5UBIM3TTYlFGYVjcvA5yVozkimco91Fx/eo+ydgAx1gMezTh+bYxCtXPYkMoPdtaElRusxlmdSV9zgF4Np+iylun3LVxCycAFxGCFsmARf6y4I6zXY0tx81aQyalr3/ih+ZjxGNWdhItgNLdEZ/BOIJpPoAveh2bKbEFxU/M0+4xqDo3Ox8MnNn8Lmv15NJigSvJV+y2W/ZogEXNiv0/nuFzZGr0pKujOShzcdkEVlMw8mNZXZCbtM9V+mfawtLxCTvo+enFWhJcFv8LVTFycDjPGBXRQKNN+z68HJtYdpH++g5WdhQpCO+DE7Qdu6TmZgtetrpU2ZlgpslOx+4hb3aXaqbdc92LCh51er8vm1GQ9uWD9+fAPRV50ixhgc5zi2Jsg1xQVxzlaELRWJ5biyF+eCwNV0oFnTbBHr3Glm9qlGVOpoOsQC8hlNG88fxeAekkCGnHFn6i5WzyO7ShDYbZ2KM4eqndyy01v+6TFhmkxgc0dndt7EzRCcEfBxSaWZwcev6MDZcuvSZQ9CNSd4Tx25TY6UAbrhikuP1vNFfPdZhCG1pe6vx4D6Ez3zIb0zDa42FPpxWvIpEeXb7YTcfZOahSpSYaWLH/vq0F3U1KO7ZxliZpoMBBYJs91IE0bOkrPNQ/USYY0qKCO3CU+AFbOYxzKWBkIglrX34377BZ18MKQCv1KWfIHEeguSpvrNH5RQOD4LeiH2gdx1MOAKphlL41F4RpxaU4dy8xERFgqoyICQq9XmQ8WJSokwqvhQM0fLtsvyCO2PAkJ3BZg5IqoR5q/GdTLgOWPFR53Nqw9Ma5vBzZcQ4+iZgetmKg5ZIn+/7Jbi+VlViXuD9CaAUtdEmnwWTS7wZWuskVvc/SDaaKV+Jz6HrZTHo3UrAu0IZDBkXWmL+mTTjdTb1A+MdhKkY/hvFNwXj1FzUngsN58u/kTdJ3Xi0hy7efR6faAOi4SKGaiOty8lxDFkiD9wq2GW1EZEsoWGw/WzxXhWDzYY8CC7WuLFHc+x19jhH+FiLXwDIARRtnkJPF2BUPZ9+grZ3tjqAWhhN3h74w5pooRQUNATy05A9HDLnILGSCtfESoSilqtqAIQ/TV2t3KhOc+teDf5t+DqZDdB8Ob9YXyklrSO73pR0QAxPvQj57c6FIR5dOciqeHZ2LRABMROo8Jk8V6JFewCL8TCd/A5MSbXLky1cW7mXobqgeEXdFDoEydKo5oCuyn+2JYI/7pIGFAzErlHZ5hOaiT17HC3zp2HpJwsIAb4/oIoZ8x8ak43Yp83Ermq55Dg8HxKGHXbXs47sh0PzQELTGFsf5eO3lYAuJjMneoYWk8W/3tW2WLntEKBZEW4hOFgo8K58Rj0vk5KLyezu1d8SO/JcuxpOJqFUM2sxBmbQ/9qqwb90R0WulpR/Ju84bQ5/fTh7po/pbBb7AQaYNdK3fatD3K4TLHAaa66MQzp/+ZGyCjzo5OXRzJ8UHyg/YpNHvvlOpwQIOjakpLHwGV4WsLDPjEIqG23ily3LL0dlkYQxj3Xx0ApCo35zYGoGOtIclYS83MnI5TwVdQ+Hg453WFQN694DaqhGaL/dm0KncXYqXLi5polgT4DOrzD4oSVhrkh8GW2PaXjOFDCLPcn4RQj8dRGIJuV81LxMPZ0UL6zpkaebhbFBxcRJe38UiTbUPDjFWk2jBqzrBvXcKmgdDcmRyJhIpuq+3DQY464AlY42z2EM0yIK0I6b+VgpanMfpdWo7OxKY8RM5tSJv340/qD8SxrYsybMuUkF8fHj7HcvxEPC5YYrH4LW1YKg6QaeFZLvPbrHZHvi4OXLKkN8cGQO8019OKqcv6QnBlj01e7qS5evoGm53rv+VmDxxCXDiOrDg+IaPeMPrn8TJ1oReXYI3yb+4HQbikxP5TQXHk4YXPUv95+KmkxGsRgTwP71YiMpqNXp0loHZeXRp9i3euKrVtxMM0e6XAoACwNtcc6sOuhZVb1htBLudzahrDFt5GkdlwHjZl5y0LbvSHwII+qYeDwRKTTzyXaInHIM+8rc5TrjUlPRVwB5LKFpQnV8e7vLv7T7V/iJTW9h9TnRtNCSGcofBWYm5P7wZcAq3AFamEW/GMbo27ldz0plt5HI53ddWkn9IuCZY+Iy0MATUh3YenRTbVgdLYtu893SuN6EL4e9V4NhlzUjI8nOS6B99ecyC1Ot8sDahQpWHbmt2YvWGyL3S9tEVLKYs+LnghBmmSl2uPWfqPobPwBHNLW21LUjfZb7jfLMTsMp3icGO1npK/rCsUgdBVKVg0Ys+/WKuTmVJoC8Oe5h3PK1TQhbpZ2ytP9nlutQPtLAEt+CVT90DfVkn7lHLOX8AfS6HLzfHeAhu1alnl19RHKV1LI0G7RPzYgVaSpX7th9f06uo2WpxjL86i/2uzK2qj/ClHbGDyQr3F9/axmq4kJ7zZFVXVVwfiFr5bhUGVZeQJHKFAcsnqPKsb8vHyB9SpFpT9U1U7D4aS9vYgqajxhC+hOkolJV2dKAxysCkWBo3SPiPUrSQYZxOWwWCoQzbV0oeaDEcgUtqI3nq9TSmpQ688/+wb26P2CHLY1H7q5lypXSrnwnnztq/jN1o9lyvLmLyGguV0VJnDCREkiUNrZqGG06MsyA+Phd9CuFoM5M1Pyk7S6TJaHdTw0ni3n5ysAup0kyxr65lFc81NcH8xSmpp+iOEtQZrH/y01k1rGMRJAGFhi+nDecpUlnrh+qBOCMZCcSCovOPJrxjZnZJDMLdpMVu+tBSVS1nKxsYjY9Dtq1/++riVfLUVhzofIcIgQQPOqHioELxU3EpCcZMoL9laa5YlOZAMEp5apx7CphrkL+fyKbBAf8ctwVd93FTo7F5Oc/alNsCgK6lHruPROtN2RybiLqx8P5LTUZXU+Aoyz08zYHasR3U8hPDKj+6arWXR9yWdJoMn45prCSURKKy3+JHgvs2Ot6v6GbEtdCumgCttv2VNoU3KOqUwqNIWHqYm4eMijTM9VWB7umEyp7UPOI8fduHJY0W9xSCZdvc2xMjo3Zdu2o/WZKDMOSh9UmLvo45IBppD2dG++HJu8kbfFdlwuIxk2KHhgHQeNKcHhFkYGRzL2VJVMOAb0Co64wvds5CaYl9ZmBm4zuGDeaO2eI1XM4+rD/HmZyRF62SabgAe8TF43VuMutigJJMfbW2UK0azGLFbOfujnHD+GGBYmSmOQbUCOY99HYvswBQA6r9hrc2jtsUUxLVjxnZ4JnIrTwIVdWCTPtpJpvlA7m01/4tbUMyz9mv1jdN1jkiHQCJXXKg8bJ+aqW6rbwbn5yDSHBTcFXIegrhHGAjJOZI1pyP83Z3vMYTAJoo8V9IwyS+U6OVg78+IhSYHDYjRs8FrF8smHQ9h4qAYxp49rRP2d5uxLAuP72GvZaYvfeLOkMrcg0PkPuq7NsXhMFmiZa6PKBH1l+oKHI5DBLdZCvCwTPdXqmnz8gLzVRb/ixLTSdit2nrzt0x+5rDeZT+ac31NKNskQs6noKlQccyD3UxzfVZFmcbpmrfPsZD0Ve34xpKWk/E9Khn4A5yVPVq+dwnv0EyYecPqXGU7R8suTW0A6NJWweLI3iSGDlQXzMYsSWkSMhFTfyA2vTDt/3wXk+mVU6bRNkZvNnyVHYiA4tmnNwdh/RVsk/EgSerfTIf5VBmuAc2IKSeL5Nbrg3acgFj80mI8SWsc3dNAGCBLLMP89gH5UnLTKq78d9SxQH/g7DVnBh/qnBdw5CDrw/uMzcdXSxWqGIFcnQZt/1aOHxUg88MN2w+FPx/V75gy2wzEVe6G51PQIR2tZsxbv62HhgjwtlzrVREw/yzlaAiuXC26cnpvQzWXp2mOgihyPCWqq38nEadX2T7f1Y5zGxEGBaT//IcL/BsquAJX5EDbX8X1p8nLWR2yyjFRvqC/jssoCJBCDJOsZvoBfXqQSEKhNARH1YfueeKBslAwLi24/wAO1BHptlf1kQFNsOPlDvlYednrEp3a4SAz/G7LIVEsZBu0EKWZu/euB/XKdkGonP6t6lgEcCOw8mceuzvEVzyoPnMyzrqoNQXJb9C8ZCXSiedKiCgNwfNkpVlHbUgE2Rb9WFScOeEad+T+jT8XlSc8rcvkIuhAv/gxRu2eb2GonLTyokjcGF1EBpCJbhy2H3lhL0rdZIw1okA5pBg2oRfQceXTPzhuNKorTEF7t1UIgDqIo7/loxyTgbtKu29o9K9KujvCqUGyPY7upcfiZLNBVKh5uXAAZjQjhlhBp0ukmO4Avxu4xAVhCtnsOIA/tAm94U3HEuSr3wq+ZLo8pyoC9EB/q3pOzQRyCTkozmJwo1Ln/2xEbtNnS2S0NUIS3yz3/mBIdxONHxqP9FW+uoGI1F415lI1nZwK0SoPA0+flaokBGEoXgZnO4GOExU7VOjdPns59ekmDxqNhEHeAF5i5N/3W2NC1XGFjTpqLrnCECiwVkOTrLtp2ehUIaejOG6+1336YQSKMSsL4zhUjw6SQKryVRz5Ldn3R5/r8AOi02RJkQXPdvPsl/FMg96E/cJmIFLmEDzr1Gkh9G3zisG4pqM/MV6XIz+CtDUh6hmJB97VzN8jaPSS90vgDjvnaNlKky2/zIhE9ObugwrftI+Oi2a4VVaB/Mwn3VmaWjsU9NOf2usbcN/GLQMjvfeU/YvyEERPKw1leXZWWk1HXzY3P9MUq6MZq1hkEgFzds51mv8mnp1i4pQprPwY0TId1szXwe5TG+R5mMD76nGPQr7/EhQWksjsgGs7Zy5QYvMcGV5tcXJR+6hlHFIAc/M6XjkKYtwm673Bi+K1tNO9i1YBePTur4I+gMsOK7f7980mcJXhgdWdhNzUN2JvFsvXq3zZRG2V30sJtJYxj0aUv1u4/ppVHi1iHnTY3gDHsrQS8YwMX5XwZ2gcFYYe2wd7ZO9swr0gb8zf/fXx8QWKPXcK1UdJk3760B/TMlpWLCbhkqVoSTsOqzgkmFmFteCCTGhNyvFhw1RrTIWzRxq8Tj5FirvKvtkp2GAVhnZ7vnr71pyI0rKwQbVxKZuqM7GAvn2mRBj5p8djlHUsh/r/eBECptpbbjP5nFyuN4mvQLZCaxeTkDUzd/kNGLIzBFv1CElQO+xmf7Dzt1f7GM1Bh+wLDCJZlhcVDXbtPuGssdEie3lZNiWcXMTjZtWAT5MCmpq6JCRuFSHZYGKcSFZ9kOYJfEqLIcWdzpTA+Hmu+ktgSUwXVSwkaa/aHdZXh7IOyrudCBalCZpgXGRNbhN2XpEY60DXXO1Ci5ayZSoxtG0WRCC50+XtgWz7qgX5MRA5S+jzXCYy7O7Nn0ljVxiBxQNCZKZMTqi6mPfy2LZx76uyRUXHjnpJJEimflHDUxyX7fFg7iJvSrsZMH6Uv2xbfQNx5eCbx3oKycUrBY22KPmgfg/w07CDVsw6tb5VxPg5/X38cQtXI47U7MAGGjO28II12T+PjaXHlstPtkUQNn0DKkCYis+kVAkA1wyAJgYKLGnKD3nlVCarYqCkNIZbiVwO2Ydjl7N6iOtvvbAfuq7VKZLo0jEdw1YdsRaHcuJQulgb51JyELzYBkP1hd03IDcZfPg5XmNvYQSOINsCSn3BuLtkCPZRalK7+S97zxvJHiJCZJM9XP785NZ8B8fqDe/Ot0BS3PH1ptErwxBtpgfOj4d/41nrSjJQf9bV1kfdBHJxYbHILxOsWkZvoP/Z4Sl0Yx3bDjTF96xf96+6uIoQ351Ce6DeTwTnkPr20YwATlnhskWIddUohklNITCq/07zkiEc3B58uiBG6d9YAc4h/7s44FN2RG1UuZWeojrOZIhElvDP4KqHcOYbqqS95o7ilQH5ONJfy+aYiB+sPpn35HfHG3duLpNvBjXc+Klf4IKrFHjeVty02xPTNnbdL4gtkqPqMLhSgR/fDXzxJbSScqewiF1wdVoJ/fGL/nGWZfVlDHOQKD+/i/mqwXqvNqxtZeRHwoe/bodk66B9soOnZp36gdzVMRRQsQiBFf+HXjRcrRf9FsGghw3+qoN0JeeMvDJrkSBPsESDai/uVOzn2Ohge+UVdi050fdWpsjP0D/QuTdYs6QyI9xnhU8WT2+KBKzoZ7Bq8fOdKPeLulUhJjT34/EOnUloqus8+pzqNh/UdUOhgTlrbkuTfsaIYDm87u/GNIl3N53uaU8bgaBjpz0jdu1f59K4KFDtwUUeEUoeYx6DEkWKHdi7dtHhQF44lbysk7PqERrsuAQu2D5tDMl7kFoGdI8r/s8rMytJzYBU40wqeFvTl0ZVLdOB6Ya9E/f8VPbGx5MdpYqYMLMyB0QxVdnoJ+tgAQVWfH+jtOHD3PsjuT8dOTSrupuvHWRHQoGI1Qj1Hc6k+Mg84FAZ/gzl3SEzuGWZKFwuo2D3EiG95D2Z1szTqAuFRmT1nEh20tkC4ysmXx6JtN0taK1iRR62s2uNW5rSAvMEJ8yotr3UhJe22brlQn8Gvcq1I0aODaHJucQKVe6SXyfcDWODMw8xf+2C7Zx5a4Qlh7pJs550DictL4OxcDXKvVmLgVWRwb3moxv4kcxzm89EERJXCl7X/BziBkGQWOHPGF+6K5NFJYOFVv4+NyFq+OPMaSWZKoydplufY+CYyL63T8MCMmwqLTmAE8h0prhi174wnx7DHZWYuRJSYZ63uz97AGOzyI3aebclnud77znbZetbWUripe+AadLQeZPtWsF+FNiaXCy/98km137lWewyc7Gamai1Hd3Ls+KMMVh0R3NKTQ08TIClDfMKwUGKy/7YZlJHU3uW60X0r74Afh02v5MJgVOYkjmors6GAaDU7yKHydfkXYd6nEjYc76xws1LDLWCNNKBtUHNyLseOyNDgmHiJ41lXvq638RzDGis8WIniOb/pbTs+HsQVGPi6mxG+CU+oflMR6/qx3pVP+GPgqa0U0lo8MVmI1cBgSnPGgrh+J+m9TVg8nivua0EQP7xai44ruC5gsAVOp9bLsDXfHQujo6IpBmpfbbU8PDavZpTuJtmflVQuOImnRQ5kKoQz2NBFjdiHH3cF9QLgDP5vz/W5trCy22Uk+TCjXjdbCCHB3rJhKYTwiyQUf8xu6yTKtIwrbw4tzFgXDODmWYEnnpDupk3b4AP3qz4AZ2En5wi6aZV287AgCF4vH8TlWLni1E5Hd93vLxSYLBWSuj3eXGFtWyWpBkIeKu+YsBh19VeakA8OePM0ILu6dYYl9DNIK3kU1ybH+A5xYhFI/EqSX3vtNs6V5eQgxYLvu0hYFjiG+n8JzqLQVROiVa8XNQDYJtDAetPFSuEtGI3B8rnbbrNo9TJn/z3lRYq0ecBIe7a03vLESwhKOm1bGTk2kPMv/Sh9wyCOmIore7JhSFT9HIjonBfi+gcdDLfFt7dpShJmW1gkcXmitWwm1cC480CraHm/or2MHphB9Q1bmt/SBXFqXJdcv5GTt3IS2fRgqThhInCjRkh7Dk1iS2vMBLSGtRPppb4FEu762JehUMQxxLQre365CKoJGvJwVde91XQ+bDp5ZsMu/QHmLgITmwGXSpQFQlQBajqquxlwIOe2cyfezaSHIoRNLcwjW+epnmAtmmWA9KU29v/cA2iuWbj9ZV7HR4anhHkjbxnzKPHnIZ7Mm5wAf2o/3xUhnfH++quS20TdhalHgNhusidPKWyKWV8ZjFLgb1fX2r7ifLyUtxuKHHIfCWXQJ/DKeU61vxmPT34MTi2Q9r7/sK1CYuHVqMBsgtfenn31bUzCoyPN89KiO5wHveqnk3uyHnJSUBVTQQ3NyRPmeRKTQvWEBZ4QWcSgMyZF0RQgvUXRcp6KflF056fwahSioP622TdcTVYi4cAwSZLWDvfjoKFLMowPQpzn6ogXHc93fFA5NZmnwslSuesOyNI1EE3RM8kzat6thkmpOiGmm69Yn8yNuxz1YuuPWekoybkee106T9WTPXo44ea9E5QH2Ig6FZn716DBa2FyXHG1B+YfnmhbEpANlOi61BoGO4+G3WMJDokJXj9GhNsFqdaLjA1pkhLP+/mGCZoYsxNI+A+sMvWyoj+PMWeR8koRz+r9pNVEWT70WhiAkNTrojdr0sBLwxIM7D4zT+cVy96ZE+ABi9CqkM9VK7iOfkJVp7AqCqQ9EZ9emn8rB8zfoQZUBrVd6YS2AqiTFt0nJ8HfPGmnBWf3Xi5CgyWoLAmHJp/AfTdHB0+Ns5DlhL6UJ+O/6xys+CWVKtL9S8fVHkpwZZMJn6jVtiUTtXjywmiVXw9a6f/G7Qd4tZtcoS3aytxXYA9aGGmEeBobjiammhUaMDicH3nlOkDvvz19NqWOvHC2SMv7OQHtDIykYerPuoLz6SQNOBtw6oX2Sj3ZLITBDcWNx9CuZYYVaE+vleXnATrwn+PnuQ34jL52tp85aIOk684SUlQ8uyO2t+eIOHndZ3oxD+BcMAba/JVxRYUAUZoEw3D80WWOz0/ul+fYbhFnffx3PgOy2LLiu82D5FMSpi+Pd4EkIFTgfv7p/0vnX1wp0VpNzyXs/5S/4z0RFS21vIF67k1ERTfFuhLM/8fdbKognohMqTNF/+oqvXXLuJB7IHeDdn1X2eParLBEpz8y9CAN2g5VdE7EimekAOhkw+tTzqeEsgyQL4iVDnWrP/RcBd6CDm16/5t+I1SAxCn9wo8knzmpg8DYP8V/vHw8Stu7cliAt+G/VR4XPNZXWF2rZBeQO75os2jFJrbtkfhN9BzHT4HGgXTjyTy8NGsiQdeOw12GjYKCyxP+34kRHZqYsn0pFvVubB0+/emKRgiGXNRWQwMSvAB1xvTprD0Zyt08BjP/4W9HGNfNBcA0Qb9qF5hdQ4dDqpKAFLoIW2gFEVKOganw3M9/4WP9ckP0/g6kaJDRurtxNgT+PjvWYEWlFa80wKYCkd/0ZChV94njjGyg0t98Pz3AL2AFAhvRRiJwdfRcQqqhWkv/o6X45d5w1YLJOye3v7rgta7Ya0jAl/an42ng5Wz4S5we7n2+1W94JnpoGyV8WW2HYjKLkKmp4hBKlNtb5y4W1MrsG/wfq2N5Xrz2kqhdPQL/YoxgCQd6Y2KNkADVu7TxugQRWVuNL0BUj3JRFyWNeCmB74Wsz54OPnbq0GFFxzSkoiJ3Rtq8yEJMKvOMMalFKH7YFHKjb2nwrKVfuUUuRtTfJDiBuaEHHoX+MUrM2bBaAsSdnY5PjqcMBn/wwojQxzt2MoOCC3OEArr09ghhsj2M0mue5ntQcmcC1R/sK3zfShGJuazS+mJUeKxk5u36CYj8+SJCq8ZEv7bNf1+BywGeDQoTDGq6Yh1xW3Suwo2O/ykazTPK/TdVOICyiwK8MuQpK+FX3mqSPzxfLwFJ/iYDjs0WgW2kqXYgm+gkNToB5+jYH83Xlt0cbtEmkkBaVGlHz61rVuWzrK1yjn5nYHKvKCrBPPRth3AKDQQB83fdrbgIeIfB3iHya5NPpEyxbzmtN5Dnk7GqrQ4uu4h3QSoHU+74zs31cWqIx4SZ2bwWLvIxUtR6gufZhNZoMcmSB5z1O9TKvHMORD+VmuiqzsyJKA1OaApB+b9x6u9FTvUkalgl0r7raV+wRqimc2D7B1z/OiSagdd5UME2igLGUcgPlMSX1VsKQp/9yDiYei87KTBA2NPCUmgaLwVdvQFFFxWp2vGCY/KCUvxt3FOu6xIgwS4Vybvbj6feUCkrQPpO/wPHJPhAobSj/aa5YrUvjHMcQkDZwfc9mvghrk/PIPvcJa5InhVBfjh3Xr9vIvA4ac+m+pywS/EqkSX55xgiyj0TB1EE0NT3W2CPFdVD88P72SpdFzHS/6XsmbGtM8JE/m8eojzd4PM1bNADliZ+XG/9hbcKg6PftVKyKKt/8Bz4lGsHyT0VKj2vDGp/qDGBajSHrqzmpEjW5LXsb5kTV6HgbMcnPW2dzQju9N1sI/gPVlgGmk0bHKOX2Ws1q4aPizhcM/XiJ5EZNUK6bZNUeFaUJVTvGxglRUY7vdnoVOe0Raho3huh1XDeTlHpk/2gBjjhUQXe8FN5A4zcRqkNtKpSVq0xyw9j3yQlQxq/Lnqklpz8lXmzHkz8sX9HJjHwyn8UAjblvN0ZFIk4liejx0lVACoKvpsT9+pQoLY4weMHRzcuVC60DUFkaqLfclS4UJti5WK4FE3dYcc0OilX50uscLJomlR6pXriD6ELNNBWOSMt50CJjPkyt3Zn/xj1dlPVP1t6XExK+b3jMoULLPOrEGvjELfAMM1qcuBb0AijkIuFca8f8xapUlkvLjmmJW7RK94r8HaPzvmHHSqX9MXdivNI4A+JHy0VCe79UZZJvzMGzpnsj+Q6k3EItDBiA12fTMlSbEOMAWCdQq9TtyUiAaAqJozMzryEg0k+yVHqCc/DyJcCE2V4WXIhEnsOc5c8f4ChWfUaONhPPWogpDs/lyVCvp3m0NSfrAJKNiVy5aNC9gZ6c9BqwYgj/cDO3kdam6gCjhR+akALFYmt4ixHkWxKhDTGs5K+CwRiKJnvxP9dbxRPCBHbiVa8gsd2GuiNHZD98MNwXMdMC0MubVodd7dnyk3UQFfCIIL1osPxY0ZJ6DvZXwtZ2I0th6aqlTMULVo+lhSIU/5qO63lTSa3MgPRJEOi0AJ8/UlZuvgqLw9dyEDQoHTKWOsq+6fzoAyvIpv14fLaY+braPd6NkSaq0RClMenK1QLH87NZriUaeuCo6SZ7/CfUt2K6VOt0AjIK2jR0vorf6R8+TVzxZb+QdLimH9pU5tQc73xW93QRPMGy/gCK+R+YzmV4fHK52GWBEBL05EEoTY6OYG1WWji66dWnVTg0uPNw839p/yjLxkCfdTaH+v6hVUCd6HlROj6W8Mil6AYGC7NI2+qkZvJh/dAw/iQspXQNwwWHr6slLIp0hBHYTDh/J7Ba7ZR6cp3iU4bSXdmzhTahYDev4yKiIHyN64EANhI5OHYv1G4KXfIOvQizYWchPhzQg5eVGNMxsqrvWVxjtIbkKuHzE+IcA2NZ83GKz0D8z5zmgRnoJGKigseP9TmMS7BgAqtqyixA/SLc1KEUWrhXOQ6kA5ZQRazp3wwSa404cppBnfsS8EsEpbr/gXyW36cZ9pt1RhzyxGxDUmnZeBz/Uf1AP+gyLIg9x04u1fThm2w/H1ZXGvVqsO1VqutV5gUhFkdkwoCjzz3F3FUr1v0njGYT2mSZYvoF/fSd1W11c5VIhkEO06US5wYRmHVPYXmZnbK5YHQ8pkIDJ0yqssqFK34CuHE8RWb+Dr4omk779QOOcYomAMYQ9ILt2KUk2uNlahW/IjGtenuGLxb/t3aFoVz4oNwMZ7iyp4td8mdzgJAfnCcYtklubGAUB9k6bGC5DSkf5VFarnGEBWz600VGR8QywZ+jIYFZbtKT2QdDOYP6k7D8qVgEZByGmRedZRWaQDTggLyNgDD6pQwEeSs82+hTxWypqwU3zuAWqfwil+mytzVnKztyvMFJyJwPFaPr4Z3mTjyxCR2Jv674JVGGMUSWb0l+GtcYtd+NBGChwr8mB2hlyccget9liJhQEb0XgXfgVRlHlbO+jlZ9CcAew0Nw+tRcWgNnz/GL9Kur7RohRhaYZBBmQA6JhvzkazHRcdZDn0zDkfBmYP1PfQjP3d6qqx6gE7vrb3lBKEfK3Y/nCe4COdpr23oZCoIpssGXmqE8CGpO2bEwkSN6uqeqR4UtWR+xsgOzNeR49PTLJpFEAkXha5YaecJ8t/KR+eG7/HKV23zPZAMvHDC1rdxQ0l+6wlIgZbUybjBe6yusL7isRuuYYwg4+8+4lia2ox8RCdvmXlt00ZshBnAIfLkSwIqUzCcsD/d1ZG6Az728L4FCIqBKpbA6bzkJ87lYQpbaHpwPpqu3S0UqNDCwgg3q9MEn02X16E4xibz/rLx7NMDtHcwMOt9r1dVU6Hws9TvJVH7THrnSFESgN5eBy53Nq2Fdb8mySTxz5CitvVE+ZjHaYS3hq9Bax+uS7TxMIT4qJE7HGdsHM1/9uPNBylhP04Lck39JMe8v2dPOSJzyQoy8m/8Fc6h+X+5/mBVA9jAsG4vmx/KdUW+NXxgRt//SS2Ib7aGILsjOz+ZZQu/NMeuAsP1pFRTN90rqIVULbJ20ZJlrjoZD1VxHEoDFFGVWCVOT3jGK+vFD06gc3yDUSnZ7ZHjGmw4ZiAglY2nm78aUpXxI4BfUHqL6YQKFDCazUIryLi53RczlaTh0ry7WN4WpWK9sPJ0J49fu6RGUMYZd3+NrRvEdOrS5n+EJOTkr4lNzo8vawcYnR/n1Dq0rCHu5o2BGBEHABJbsFLi/mlWFO1MjpvUu6UPJjXlXse6MtBROT/mQfyegWGmFRQ7Q/O+rJp471+tQF10+bvkExfBoTQrewd5UwhAUODpyeW+aK6vx2AroUo2bGBZ/ZjcsJFfMYEMsm47LdQSq7T7peI2Ex+4/9oIAJGfhidbXA9UYPNhxigFTg83CETNYfYVkoambj3vv4MZNtE/wrIfTguBNqkQk9ebLPTmY2U4UCzbYqPKO5vjaZXeVksobDAJzhVjoU7p9TdFmNMyLyCQJryBSOcm0hFk/pcwcV15KZ/+IIqeQGPkTbiY1haWSnuQYBeyW5uSPHGtYw28cQS/v3rToNAUGVBSQ6zpBt4CHvaOfEJhuDJYZCcxvPeOStdCzaoSQn9nDe8wDc1MXrJ0+9N9TAKcS6u8ANLCLY4UfHLGf884/LFIn4OLOlRcNl7FS1IJgu1/vLm4INkgHt5ISp2vC3MFJHz1zJnopnKS1AgJtCmhJRZDaW6wis8CJ0KAJW0Yy0+kWI3lJ9N8yqJht68FMNVgkgaAGi5LuKmkZWm+ztKvf9gT8hJrXZkM/QdHI6wy9BqVeWa7g7ZM1YLbUv37YSnLmGsCrl/UVi/tG+fZbzY4bGye0zH08VQpGmyd/v++fS9EtasmbkQEIYnmLZLxO+tNHp3myIGwYBZVXjlWvrCiQcsP/Fu9l0HWmLBu3gvuJ4phtJsXXllJdM8iZIQR8Z6zEMs+cqVL7+TYhxDd0c0l4sbyIEw6N+V0v3ZbUlidyekdcz/aIomGdZtmdI+1QUrrHw7eDXT+G3zbTZMXxpEgJc4zY5bH5az8eHzwoo8QUleUKpVRrsErGmSF6GPJ2OltKYL6/C4zx4rHdcfsrQTcWBmrBWMMiFiU4NGtpYeACqYafRyu8j8x7ltp3nxVbsPO0MSoaR8tv61/q+YCqHX3h4vy4HzjCYEl+4ZDtj2+mawuj4J0rBpcDw+spzuCQ2khFbks09lPGxK8HYJl0Y/lNLUxGLZ+2h6+EFSaD22bYzF7dk/EhCWh6u/v1HUVKC/r/Wl6JHtd1V68J9zdOTgbvJuQug4r4vUV3JJolQQ5tecHKqcNoYjOIs6BZTlfB+yHGfGdxTKsGxbU/4taKuH8Qpd/M7fIG5zebrpiDHV97T4jiUNt7K64/u1e/+erXV34aOjfddcKNO76EzIf1pfD+KivBsRlzlsjj17aDPq/lnKHQCLsD+3TK021HNzhZyuwpLRKS3KE0XH/0TqUOr3VqLMcsSZM6349QJDznPG+sUqeS6wwMWp28TAoDKdmjzW6f+2au71HsOzLIeWencRa5JapKkVTYpvwMIC8u2L+/hYGJmk0588rq6Nnqe041NMzU6lj1K5KmSj0ZRiVpzu2FSTl4PBYHAuhe5dtwnRQwvvNqIELVxKMFWedxxB7UO4zpYRe2x0zH4X6pI2m4g6YdCs08vR9B7omy/goQUYbUZA+wJamq7/c0FhkNm74Mp05NSCK1Dcy1+9qp82p8XVkUB4+SsVRJ/Tqtn8v2esmemr7zjCfjLicMb05JqNoL6zzz0KaYkXeStBrF9+T7EbZTo2Fa/wS5NhJvRoZc8QUfS46HX8HIZ8A6LK8zKtROnakAnEEFoonVlvYR71xYuBAXbjtxfu/bteN8WkArB3//qp+3btpi2SIMyK6rX03iCLnzOd2OrPnD6xqgVT35e6NUMpN7EJSz0DRRzyze1J+Dx3cfx0M577W84qifD51mZG8VNbBf+5PxmGGrGOmkO+Q41YnCkx51D+X3CXsNAjaz/XfcPJUXJ00vaQyfYDtmFq4kU1ZHdnep48T4IskzPsYT9or3rd/ubiYLqeBqjnGbuNWb9ZdPDxkeBmJwYTjsTU+VugQmtz5+C3QBX0piVh3d7BK+Hk4mO3q8qJVQXeIqs4hKuRvBfIwwUyKg9W1x8dv+EwESuk2Bgs1+Zc3wzx4eGasynWs3V360wH3fKXZFTckeHZdgtzTqcQPC2hCHhSXyFMyljvrneLE+c+b/YQ0XcDBam1oAPzvKmmcgER6AqnyC32Ic4HMP4FQN2rh4Y2ntrawByV+9oq/Z8hdwQEPYRYiELBCnuGGXDQbl3ZLuUo0vfKU/AuMwYfNXmNM2vkn/GRrpc5WDP+MEL80tbJDZfDNBRfpfcvVpf75u0LrkIIjnU4adaolZWzB2yjIVwNrF7zF//n4N5xHeaGc7Vh1EYRdc0h2l23qFvLBNQ5kHbmX8Yta2Vj4DU6eBN3XyJBvJf9iL4x+hw1hx/7Ej5U8EZr/Qhgoni5r9PxBfU3fdvXICGW9DzST7GV141bvyMDXblFG5PizNjJUVAWNSxIAStz6+eDAbkYeAKTj6DIR6ysFvZAloBLCgSdMFd3ol/WXDQh3BbBtLqO9hp08BfumZjLpTJGRAIHzDizXZfhbgqejNSS27BIXQLV0muwzgXGqYt9McSvtLWo1Fos3k6Nu2qGyFftqQyDz0/bmgvtZyiFce/SLYnjt2Q9BnlmUVBWOtbDPvUgOSizvJDhdiSkbLLP96MJ7dKO3eUK2nZnpb4s4b2XGF4T6gC4qo9TDv9z2SY4Rffb/RjPs76P0YiWADpPB/nQjC2tDRlxt4sdNCIjmMsLgU+cr8cpyaMSYI9maP4HHww2jTPkGKvF6H6+DFAF+jAZKT9oi23gpZ2zavE0xXPkF7a2FTNJ3bwxvsJV+o0fXZAkmouYq6B2+6ccHhnUIeL10QtZaPoZPJB7/Xry/2Nv+JJFmQ/p2NSiO5bYGA8ej1vh5QlWhaX3JMs5gMBnyyIfXIMf4im0WEUnCPAJzq9q04Tmxzy7nGKKEf31kAp6IFk95aj0AogL7iljLVJlOXNvV7BwZn4dKfuZweSEZBqy+Mvual0TVDHiwHuIuXbvaw+OkU7aeAfck0Hc6H0jgt9g6Rxb6dAuaiKEN1cUYtD88y0b9Arq1q6ML9B20/FunTnZNF+IHgsg641FfllDFpQ+dqrIPKQ8IkLx/2ppx0ivQSrehNaf5dwtBjnPHroRGzG/RWOdiW0COPzepxIqcsWjhfmBXSUD7YCvPm/qTGcSnhcriFKew6a5s0AgK03I1gEifX6y90cJBY9REbQ7yW/XB+zAXN1XZQVEs7r+0ajtx8KvVBKJksKj5YFGdhEennMbwgCJJIMdt/pJD6FIcNVegt2LiQS70DAJeiNNG86dQVNYNZmYEfo8oa002xKLh1+rHlBX40iY8Wlv7FqswQFktpyLn5oSdo1jBRz8V3aRIOmhSnrs2wxGwGBEVEXvRm8RZVvSQ0xlKMVWs9Y7nnmJ9jEVuDL08D2ES3plzvCNP3FpKQeSknFeVBXv5T1Yk0/X5vdj1J1LYa6Ffxxrv90ObLHARkCI+tz6+0i5cZTinvgIYLMVnV/OL+m4RCsTy/+9VQPsYv6X2qSSlVdQ3KM1SOntMNUBpb4C0MsDh10xHQ0cbJK0gsR6X93ru63BDYbRZmPISt1casVwVVE7+u3l55XJGJ0Ev6S+2zpNqOAH66RuzpVskXE6X8x6wHOfp5PAI/7YG3Zozh1U27IXGEEKIm13Rt/nTE3pKWA7i1NFdVQKQ0CNdqEsBkjiuM41dd5rIbR4DMnoDva07v1esxYBGU4JWJUJQyejYbI9p7pqjrpHZUNlz2exX1lTAks+WxY6CExoPlSlNNv6AIsE0VdPmHOj4m0a8bigDelTpIL1WoePLhblmhRlkPDKiZvkzz6eG8vLeJjCGJL1+VFa4QREBVyuhcpZm1ygJm9kuQ+8v4yEMw0VO+TKee6sMFRVc/kS4IirJupnw48LoR2aRk+GuDBZ25xnKFxdSYqZqvWlEcemsbzl7wvQg5z2xKxEUsquyGziyzd/X+XFl/ct9KRLzyyb6ComIL8Wam9x6LPNZXvhO0QQZmQ8T2MFjmRJ42WyRzfyLGkJKft94uO0Yy6Fflo3AoIEon3XBygpi3Je932ToU5EKoikvqkeLFACpsBN5dseemiMdHxOJKrVJDdTS0qCcTzPCyz506oyENFdelskwdghmUnWyXK2WeJX2CBXudNUBON/i8kMdtJm52REvmGqVmxe5aricuTCGLbgZtYvigT++E7xltEh/ZgUoMP+d8vaPU/HdhZaUjsgQ8OoqZeezvNR2JFm2on+IliVyYQ/58LmZ2stgKoBbs4SllwiTpNRw7ecL2WR8bbg05aTN00C8aGWtReWSsYsirJ0K0I97flI2gJRRN717wESryWahXUAFZAdyD08j9SIZQm+wq5GkoUkK5cQ3wk1x01x4fKLPgPIj6D6lZiylqvWGtl6KxCfoSQXlNZIHeDsrIRqhINxdrCinM0iMMkveNxhqrEzhnBn8F6nXVY5zUDLzOXpp338I2HycFa2pueObEof3HQgFEMnHS3/CDKwJAyYl3HyA4X5vXUE8MMa79gYELseTf0IEUJRsfSa873vl6n29lFq+GCqF1I+mB5PSyLFvgHv6hG5Hd14PAHTKhY+xzCgOwwRZxygPwNET0UiO9ynH0p3j7GAFEs+VSjl4ArhHJbySohRLfm6B7FxxYJLJxJlQr5UdD+5Vs0nM6CehSZZNYw4FzcpYoL6nS+wGGSNKLVLXgbgvzAbT4B1J4GMS16IKMlo5S/dzM/NM4NI+a1Fuk4qwaewoHqGp78vgp+SkuhLyAVhI2Or50Id4LlHwRon9o7JT3D2pibchFvFi2VTEx6cLX/qorW2YGSSmnu9+M8teW9DIRH1TfabuDIuLk16NFz3kNr5QLPGAd0JzN2IYFA140yqfi9LfBcZI3aUK/Gt2bfMMk8eqttN8c92OmUYKUaHbB9C9cpEwaOYs49MztuGtI0VMqDDHN8HiRP55BpRIJtIWbSyi0/LOC94XhzqGVyuzaVaBfg0f++sV8wy7ytxlQYA9w1ejE0XaCkpM9zbOrymf4OrEaIyQX84Z9e6wQ1czIvOihnSaq/fcFdkxJcMzE2kWcARwWT1U80dW6B+v6HdclWMyMWLYr49iKWrhm7o1yumJKxVGiv1Rx3Tw61jrh+vuNjikpFRxa0F9G7ZWs57nuhaIeT8ZRjYzuyq4WZBEXs4CyfvmZxGcS4/G2aWon2O/UkjqrfdbBUF0yavSPdNJacaaZxFQNejGDPK7SCF82XxiahbNpwFs/t07gbCJkDUvvKjqaYv1SNJBa21RKsOuGJNKO/F6HTjc1Q5t8lqLL4e83gWTT4aubYGtE+D4e9zdPPo2R3dvG7bDrCQosp62YhTaV3B/kEQGqtzvu59fbgA6lFyGe7urhYr3TWCBFYBmrEpB78fWnXUEd1z0LSzMcWL6vuh4CJYR0tg1jX4H0wkw9mkbM07MXopLJ2Rt7/aL3Hl3MjO8h/1lqNlK74QTbgkurmgd23XflEcMhjO52Y/Wsz+CqwkBCDN8SUcd0hvJ6srikURdDKw75ZZMyms8NdzvzfsXreeCzpVaPKbkgWo0BlD+qWqaXziVa7YTSezNkCD1UBphMwE3IFwG3+Oja0AILbwR+VMjirrIkRPt+DMtp+OKLpkiE15AVv3jn19brZGZkhhAsuT2sTiWSjLvxJkMICAGdQY6CcJ1bmQsycrXCCxoxrME8B5k7aYQkl31h4kmnvmUA1Uo5bGEJkzebQNuMeVIRwKr7shM3Y3iowzuO8Jm833ALhjeDbR9i+ajGdiv5nuQcBDW0PZ0CB/GHvnmE702e3iEmWKin/StmkbfvsVh9mXnjLzZCRfht3g5Fu6OpDSsq1DSVUie4hNThGTSTWkOhTKbARv54Bxp1m/BqW0CfvfUJMQYci+HzQBrAw7lHJI8klNzq1wbwtxf0zzTFIpYQcsU3ddDWDMuciKmN+BHJ47B6FkgX4uR5QSWzLqgN2wQK1aLp2hgMJGqMII4rLK56VcDk89QQhw6cy8PCM19olNpuDwdrQFvP+77wiyyKx8Z4MVJNxV5vJWOwvF+aDouZMW5HNno5d960qcPPO89qYm6Zh6UO7MyFx272aWYtu/0+UZ6eThOP3s/uMGRarrYNGVN2bkl0VbM7ZArP2AnCQLuPoIbkry4nTS/RsIdFmPg98zeYI4R0RY41FQsBym1OXnJcHtmKPjfEXuujVQGfCPrCZsaT+vFbMFWIvUy7OxquIvdi2DVp3+q3E3NGG06d/cz77wgHGWrfcy5LJIzCMZHkk6m2QnZCXYVXwMsVhJI9nJcgG/CrU5lgDb/DlVEsXG06BHIuqVfnTyLdAQZYmJlEEk43pdgF69V12XC+sB9W5Tfm3jPwiHn/VmGszkYx+Er49CLbyk3hDBSKuzDj+nzCo77ZO40EIP4ZROdSwWlf5S8wfYcAzjNdj/aZ8uknw3tur126RfCzMA+cUo5mPaZL9cVp33X0mRTUIS2vgtwDRgsSSX5xcJUWR8gZbdeqyqQEEAeDu3+BMlrgYP2SH/le2u1yfVFn5JX9VQ04X9mmABR/KOd3rAYqR+OQwLWao9MXVS1y+0OKo0FlXuirKuPaY1BQbY3Vo05Gf/+N+u4rDcFBQqiCrYhgRAEjvVW9eNCaOsukcJWEaDuo/pWCYGJLadm4ssTCPvVVEJNBfVXAcTIxH4EFtWFMJUy5of50QNXNZBl+oRuFIkdbt04DeU6j2A3vzzP+IkMahLD6zBVJv+xRBIc5fODvnJMmJRMI8kcyMFqxpeWZAHxC68tGFNyl6yyGN95SwNYXwDSIQCPlL9bzjZaWNWvs5puiP2lbEBlDw5vCHtVmb/sD8QBgOhRassChwM5o5g4lhlD4u86wmdmVmhmEXnCyLeQJ0rRtqYIWRhg72ieDnqmPvOkDTWtKR38TeJwrK/7IRYfbNspygrU6yV9YtJyw3I3uEkDgbPrpcNUpISYvzv3beFg3ZN+swedqf3IVKkcdiAezu/KpHGHPyvX9oT6qzTS342/DenW9ctM197UfFl4rk21KxSma1KnLIWlGGasMF4+G3dxTnqBscul4CqNda6Qy8ita7HCzKlYa86yljm+HQA2B5ArJoZy4LNxeT9izFuQhEoEhUTNJQj2pCc/O44h8GpQX6XgpaAvAQJLVNq0yXGFbzb3O54XQ6sm557+lT3A+VWPyCJn1MLbsssHIdFhJcMtBFQYi0bS+exQ4Rq74xNE2CIRSzi3nj5TNy2AoO0gdyBC0/2iH67UB581jmM92OHqgD4EzAzyxDauPnlIdZu0nWwB4dtxWN+meq/faIuQpK2hoRP/ULwIJ9r3xyxtXxfFwJ3YquXldSEnxoPiYD85u0OAHvKOG6+3eBraUiOgvdfp1EjiroeSLLFutuPPV9XqhAReYPaRy87OAkV5tzSqvyfufCvOMTtkpxApWsJ9n+cNM2uBWu4lj1oDjGasCfCt6cfgCzh6UbZanbL/qCgf/iHjKYaavIiRLJrU2BuzdsP97XHkXLYbbfsHVTlXSohKOXOJ+3LiR6ix9UFLo9qieejYk+P4e5wC64jGQLSxJzYt3cErx1Rtc2+xlJaEBynLN4hLl/qOrgBM7a+yswC0Mh2OieA4SR6MfM9WK/FOWbVyoUBIUAKOhhIZp2LOgukk0/DInn7sF7dRP6Nw77MaAcYg6k0gdjQN9/1wtGVSBm+6LwkI+xfcK9l+JiWepXul+/EEdV7XXp/9lUsW4RQmIkda9H38FJj3EYJTrG4hEU9YWtNd2lKI1683cXFVzSMkh+2nuu9K0JUBoAnrYkKVZpAKF9G7y5n/KMZrP2xPuUFSOaruqriffSEX9Euj/k5dgewEyQCFTif83LhkIjt5qJ1LyI4ynIznWl1SoAdecEp+I5WmKBB2fr5yw33NX94q6HIP0jW3Np2E0r1f7fUjqdxV+iCRULU+yAwPXFvTL7HqfFLj+wCfIbOg+nsW03rGTf1haLvAZA/nC52pSDnC4f0qOiA6WtK20BldZUaA6GO3m5ZOCGyemGK4a12hM3BXnbladA/yTRV+pH7IiT/9WOijGGNXzV+K4wmdmRjU3It+QwUCRat2mGkEHhOcQY06pWeQqBGjHkWcceX8/drkk+tYysHMXVk8hLhLGjUVgivK1Ra4K+RtUcZO5fkVkWQ4W8fyo2tafhGEDSsflUH7yj8wsATBE9YpskR+r7Ac8xqdxtEAfRioGXSprjbLI2DAZZz9HAYR7rUHzvh/UPpFvrLbd/hFf7sF3RimWNpiGsQRZ11RqfZkck9IJu/FPU2DYr/HWUdskJHuLufXCvDbKn0F9sM31Hn3zIuAMTUc+tQsO9ll6jnNnW9Ulo7d32jEQMqJIrWQL5+Se0a8lKRp+XhYp4IfyUaTRC58vFEjKupeFEpU4EOp1AjeALc7vZV0ovza8QSl3ru6xFpY0/ckElMOChkhLWSDHLCKaFK/qC/SIfT50GJZnkCr5SgXZRddXq8Gc6XNjIzSdCF+9YlUFKMiri/sn1Gp/dEMhARah97GidLqitLNBlF+H8XoQmdrM3GXBSCN6izNn2ON0OzpCxOuM917OZCw2ZC0DSvNuTOFCGGYf1TYgUbgK2KKc4zm/25dz3GhVpFqs6x4yhZBbiy/6FD1vXW/aIcDiSUoIhwrUtxuGGZijb47Jz8JfUTblzx4eNPbXeYpygkQo1xXonjeouTuJvAH/zH+FK50zOLAtbN9AO6xjfX09CsjKitMVlHWmmQybLoBHBPkC5IbAZxvs3cH1VAcy2X90WL6y/0SXNsGeLBdr1OWVuYg+/wUNiR7QnP2ec7jNrZZOosT6Olwn02Dh6zSwKoDnMFLfk7lBO0p9mWjex7gEFXNfxFO19qmaoISUZEgdTuy7sHgrD/36o3XeFdzLFoFnOJa4yaENBXdTSmVZacz+5IGdVkEgjQt/TxuhNGHGtQuzNDfM4iNZ28Ly9S9WkUGMNAfDRLr4ipZkJxUA6HnlOi4Yb04/Ze8rB+HEXpDGC5Jpr4fN62LQh8o6kxknE1P5/rNmz43jehFlRUvCyNi3Y5St7lC7a2ogCt3Za6M7AshQdbVV2+R2DuuiLEJz0MLhnn/1/F2Z2U3h560PrnhR0Gc/5GW5DwO/DGrR/4PvL046BKjUp1lfrtKfE4osRTS9/oB0GrNW3cYgvhU8ld61sHhKOf4P94t4n7h9zdRXDaFv4ORPHokkY+NA9QA49RmsGMfJLu1/RXuluq0J4fsUUBoa9dL9T0yDJXvGtuoln8aYrNzoapa7E8cR73/wX6KwBPpwCUUlxsBtOj0rnca7zu5FqJC5W0U8Yt529SAI0S6nmWnS8zguQLRzf/gRLaqSQ6E9T6Q84u1cs56dzBMv2eBG+zAKw2V0x1NJX1gC8M2MYZpScdXEKPG1442UFWTEUlkM9OjbR4FurtJNV4IqEu1htlgltESO0SeZMHZ1JM7bNtYegevwPSCmW+S8uEGj7FTSSV0HbDg1rOnt4Ws8DxqN2T/HOXNd5NGboZ8VTSD6g6rLWcoWOwsyeG08GPG6KHPiLRunEdTPNmY74ObRGT1VCHP7nmBYmjnH+kqK6rDyrEoNjdqc8uG8yZrHWBXU9weqD5rpQ6S/annq7P/GiYepA2ZDdJA/GbdxpHYatPgkXt5sop564gVHZamW6cq/cdADaLCXWt1WgK7y11WaQR90YOen8BECQ56pmJbLvzzfWBhUUJP+dAEEK4o4wZv2+IBAFEdNkNF3mKntsLE5PDLA/IEiV0rziyORzLJsoxRMCQV/HlpCkXsaizcHT/vxU9iadf2hOkKehGum3973fFs7uRlqxz/oDerFL0617PqG+VYIxjeRb2IRLZJGH8vp8ITzF7U7HUg8Crs3WpVY5r8wxn8tzGvUUwY5csVu15Vmm1xcs0UL/lUCkrOXdLtlaa4pHLeQgpd/vu1ZzjMOcgzfQaIwiZK+fMZjRLAHUf83TSCOkovb3xPkD0jElmb4TBqFrwn8G4KWr+RM58qhCnlVimQ390m8YLz+fNHbBRDs7GJgHSK+v5Z9cwZq4glnR2eTjnqTy8Wo7BEg24CL/RT1AKzOIE7muo8oegzn8R6qab08LzTcbb0ippsScfjQoJhsr4jKG2pMVczpCYqptZcGD5rxTHFbL3+NDnEUptRMyARhF2FMiM7pgaB/IpAna1AHa5EPt7oBdzMGg7kOdSOpxrPXbdP3l/+QCfCLMpCsxFd3VAxA/IPVvK8JaenCYCadhyZ6rJeGxTUh11+OOAjrXIJxb/EbIy8rv6h7hywPp9ZhPCcgt9BN808JhGIaKwtL85jO5nipQyAF690xJ9A2DMuCx55TSG88fN6rqBMYDI+I+DtFmoAqJB27B/xxN9xMLnQwLcLCHOx4GIFCq3/6i7gwJePjoG/HKNb0XjhuEQmYFzTgtt/uIo1bBX4C+y1jrb+R0mRj+RyaDkRus8W4WW73qbcjpjIh2tGUY6KJyhEaKiK+LHG5euQeYZO4zXoKbZOWiJTvJNNVrWugpXkIIIE4zK/g4JKATQjtaC1qbJ6khaJHxOTS2goU5zGyjmaPKvVPrBh27E7E2iZ/6omwpBARV/9EKeU1m4Msz8Q7y3MzEF0C8VIIqAxB+Fk8qG970lhV/ZIX6CsxiHqybemqil3Qv/cWKm96fPoMJWSA1dcF03dSwSyNMdvKKBCYVYLuqr2pISKPaNRJJw2R43RNE6avh/TNA1tGJ/ilW/e4LbOvIh7cS2OsbjyXcD6WS0DYaDa+og0lSxehZQiDSt2fVdtF+DO7/cEUAM3uju47Fl17rUPkRPaheA+6/jpSYK5Nh6rSwO8Pbi1y4/L0L5SStva0NcscpH0pw/3Y9+Eqw1SDVvRn2r2d8vRC6YhQywdhKWraKGBMILqjiU2l5d3jb1tnQIwi95QiTJW7MAjJD4Plr9FGRGlM4NQyAiG8wSAKUbRCpmxE+zk9YhXjiC/Rbt983pV0VzovJW+90dH65IOb2VS+Wk+MpsRgZ86uEuxeGPyB++07HlAwqFjq0sm5Lvom/rcHSaLduJrDdabujYJRWbbY2QZptvGwTHAiaqsAafE9NQa2oq6hV8+E2YRbdEcrirxyx9JVWpti7CsFfA/egMevH0MR40/X1jQzMYbw6mr01MI833RiE3EuU79cpspC8tuN6QxFB7ExHF8yrFQ4vRniEkTgKc8kT2tC2HgNJJ+l/FwYXky6qbHj1cMtBGVOw3SFMHn5l5odYVrLqhL6R4DujKq/CEsEj742QjUogvrSb9DOh1Mm5Z7n6MI+YHii3bWp2abi25FJIiX3GM/137MQVr4wwQ5IQETnYx0CoXX1nLeqLjQ2VlOulhy58iVxN5d0Q2TEV6MPr+wA6lluGEC5890db42elDUvTbbMcjHGrT7WA4eEhNLqVT35NhLruSPkwg1UCAUz94Dj23i6dqS1MPh40Oyi0W+wfoWYXIw+siweU3qKdQM/IWLUwDjgMQuiK+CTyRgR/Cg+XmfazCLiF1JChK7C2x+ROCl4t2WjYngGRxBWRQqqrNqx1EesLx8Z8GOimBJK3Ip3O0TWp1z6fhibUBvCtBpCBH7Wz0MrsYEtW/6gd/rLbB2IcMxOrxgW5u+/ZBOjd+9Zg9SRf7ln5tqXgM7wZE2rj4u7BOezWvuyca2TpJkQOR8U/bR+LRjmN6RAS7MCfYSPtJWSbZYnQL8vGmJb39SyiYiER2Via1nlShjJEe3JgCwTOTiIQJ5h+NQeEs7qWkpIDJiQHb7VwcR7T1gLGhKAqUT5DPO5zvGPny/DOh+Lo+Xhxf5wTkF5p5yY0vM1gw2UZQ2nhCedQ+PBxACaAeuBYTyBs9aNWvYATPBLUtXJ3H/+rMIUQ3Xz5MJKdV6OhLEEK73rb9hfjPlA0gKO4j120U6VHh4AJvL3WqjaY/KCbwpCzUCADZmnJdpD4p4U5ry6/YuhcWXcVV4dFm5J8qADBWw9jPITjUtkf0lhIJkzhXLTcXQBZaaunvCCxyWh6ifYzNTTCGJcUD6DyfGam2zj4qdBy7DwBaL2S2IxicF7F2ubPDvx0+DEQVydAIF4Utn+/niyxDQpGlaaG5eRQcfYEHaZeHBOfZ8x6KnSsZnB8YZbLVBcEF3Mv/87cj4r/BYDYAaUWrrm/rWPImSVpvPlB3xQvVG305B+bCj4kIW4ZWzFnX7/nApDibPZxncAV04laDsD872g54z55DZylkUKHXF7Y5iFwsc0HDovYpJ1P+XIAb4pKZnw/e2BrTZn6jCeAAvAt6Z8EdXqS/KoRwK37xhZL7w17n2PYpqnoCtRAvnU/CocUq+el+PFEwM2GkhLBAJXvVbqxBMfPWlA8XMNY1+dfsV9Uy0C+WgSzcXw/ylN23DlELK9DPZ1nzFCvyDWygh1ABv0LXhuVuDEraYOrX0J/NpbYoxjl/mfncXN1DorfumMjOo/dWEk/OvdZ8w/66CtISpGM2htGRpT929qEz+kRM+2XpAqcSS9GOrLWVVUVIm3Ez/yIqAWm019Td/ytbE6eeYJaY+mJpelcp0h+4Y1hmcF9J6cZQEJi7foY8n1psVTCzE0QYMX+ScYxKxb/bU9eproUaSNTxHeNhomtba4y/CfLAZYXndn5ndeIjFIsRWRpwX3HwrIsKxRgd52tRs/iun5uy44w8u2wZgayiPbOTWGXUn/BDqak5EZebXbdQHyE0yEhUO5HcDnE6xlAuZFDSKLDTTZz9bWcfe1wy8KhSOwh15cBRibt+faUQgl7/5na6Nl5d1o7iUWTjOhjQa4z2Pha1PNGSn0hZFeICMKGtHJ6EGQbB+HF6+M2e8YSQjJ2cnG2SVpdzXlnkzxYqwXv0s0WM8nggSh7Viq5joXNiF3RJ0A9637p1HFJd2I7GrQ4ZTOWRi8jcZaL/25Pox9feMT7VDPV6TT++0Ri3a1aLS8IABZh2dWfxnBmXDWPdvrxmBiF3eePVqd2ZM5bI9YAN23/3qVLElDeD61xvgRdjkXkl2tqif3zsX1gGp9mzEm6suh1kWL75XC2kXlrCreiNi2pfI+iWVFJDXPd3MBNp7VSAZRp1jpt3ug1pQEM470lZXwotpDljklvGxuNeKwTuKNJw0EK74nc0d851QXL9P4pxZdM7pkmbA7IU2S2Xa/AJRP2VOz3Kyp9oW6FgoQi4noNkoHeNnprbQod8n+dQSSbMzNRZIuL/riHaxoOHkaGYwROCZwqcbK1tUnU2Qt1J+3UTvklj6wOD/d8lrZG7ucjZiCyHxK5XVtzq9lDJ4N1FvARCTUfnLeOLc5bmrtGvb8mmsr0lDDyR5607k41wzglZH1fExfmsXrEjiNLSzSKGb7FVusl07/BgeCclDsQkds2G654GVeUpX7UHaqQBEmJsIyvfxvz85+WyRaoYuQfSH9WpJLeUoXpUt7+Crnl1Jqz+eARyCmzL59OUUBwBuoQAl5VddIrfG6xvDA/RZBOV5AfwjOrJ2xRo4N42rCSFCcnOY7xfewl6tVLetiM2tGLqRLc9k/owyHriX1A9BnluzfDc5xdEUKyuwzWPG+tZGNDV0WLl1JyHPflzcBpj92G0AR0lGaMSZuKui5/LUMn69X9wPKc6FVkNEHEjHjQKPQjuFCokjN+N/6DlMscpE48IhHIa0Ghrc36GwGEiPRymXWKD/di92yfjZjDM3fdHBdwSxJRSBVKHSwh6Ey1/zWZRZ4kk+KMS8HuroIw1UPa+PDVpsSIKvmqZnZisbfHFWNW/dl9n5+wM4VIzhmrETz3k9WU3s+z84SHh2f7dGT/G5WvoisBYAgwm+pqFS0A8xyhy4PiKfgS+6TgnQD5hDEerpzgFSaMcw3yvDZ0+xfL0yznf0uY8N6APiqHdoJZOWqTPnTIbeBLc5dvFdh+mvD+sDtl8BAWzYR7QkSgnx30Ru7TH5a/g4byacurCNvG0lTgpkj9w42uqBp1zMsKr2riOCQwfCRKkuSX9CGADOYGqCHh1JUsk6RwvI9OvM9fCJoL7Sap8NUQ7mAvdB2ougA01NdqxVo8NeGta0R9C7QybiN4uAtDxw2zLTG9+0we68JkqZrj9tJilUV/f4wOLc83GfstXOVF2bAJ6zf56YworQQEDj6QnC+lqyMkGAr0QuAikm0jqS7fy9bYSBz5hekPILc94b8aUau3Kt69QI1kFEmcb19aFQA4bSegA9/hFi61RDIVQ7iOBqViYdGaK8d3zH5qWIjed0hR9e6o4zELdXWhOVOcPCmZIYYXvgUsAyGUoCszsCiTdwOaPEL2kRnYh0mNSZGb6/kr8XfbyUdbEZ7mDBYy0yTDxhkrpIoJmVutN6FHk/E4cTEolaGnv7x+QxQIKZus8IEygpdtBDxj+lC5M6HaJ313pLDYbjpCA+oYl11ISRJ/fB2oIdDBHFLefQmF1uHk7vtSmIyI7Q9HG0qxu8QRWecP8ipKR1o4bGrAhR2KcGEDE6k8r2F7N9lNUZCswXi/EXaOlPb9fdsaw1Sspku1xrmyADIImEs//XiPqI3Jl8BlrsHf1mAVCBmlqE7usMbDEpilt45ia5CXzVqlIZ95Fesu48LEATS3dyXVEjwQAqVbFBttbLfXvX4LhaGKv6P3XBsKWvqEFfq1rPYdohHtQH03ehlVMpZ/BRCBFV6dffGCrIa7OngRAbORd6wsIcR/gQSxhfrfHFmb9Ws3Pk/SikwIvAIYljNbXbvIpKTROSiPcmBDp4hxLkrjR+MfBFZLV5I4usLY6WYmjhT2kzW9XAxxLYCELLIf6lg6p/GFgpoRTm+yQ6PYtmKVvdTHyBxv28y3vTiy+reYBZqmC7x0TDasiMCcA+TxdKgDY4s61MpZyI1+RUzeMfx1qh9MBXg1tI/HSKpcUj7+qTrwp35J3ezefo6UZiEWMPBtx0/tJyaej7NUmUHVRBJfB1q0bsw4yHfui2ZOPNh/6R2/I0j09t9QGeRxpuJzB6DNbaPTOmER6WTXYEGXq7DhzkvCP247uSz6r7MfaasDs419fVF4RAt4XoxkFRmk3sjrhpNSeuDoG5RpjE4pI3rH/ESPaF6RIIJBiAbVU/ct/nKrDmBQPBYlNob0WmW07GhOvvz0m/BXTsPB8qA8Iesm6PsDuOLEEm5+jbniDFyXfndwIXHgWBB1GCyGV52MU+5iXguncQS8T+WyxaPDqCCXMjwPJxGObdF8mBkG2+SpqaBQkeN+1IL8Cbb72d3ySQUR/uO+N9v36KAiKVEPx8EERU0vfKi53JWN50+LSYqgHmF0UrnnHCNpcwfX8ezokGL4sK/rgFZlXnIqg6a8EJh7DfMOwMgTwRjjZ+TrXsj7SA6EaMRroFgxXRIOGDPYZgkadllrCosfuVZqNQwAY1cDJzuD4ocR7PgZYXbCA3g9Jd1PRx7PyRTNad56qFMVIv/9AYYd32opL/KQOuEa2LIoyMUHWsHVeJEgDnTAizkdfigKSmZVUDrztoGXA+B+9B+MYT2q5BETXJUKRLiEw3upTpXnlh7hkEk8/0D3rV1lUxxSlnDzLfFArxdnXRhBNu085RxiTwTISjItGPuj0MQknBfLTi9AeLTT9QUKRG7bxHm7P2Kei6fVAeNBP31q/OVsTuBJZfKaxLodsCxObxFdyJNLV2tAt+2SCAO5/VWcDOd7Or0wzbVGwbXJr73+/PYn3VfNQ4CSxdqgXNPWDqh9ZFVRQbSeb+bFmOpdkO7C70y6dTSHVuHlIY33/KV1QHDJ226atG4ltS4fk0ZNDrmPZ2Lps6qyMYO+Wkmsyw/ECuxfXcZ0zM7vmLjkk/LsX/XG0vaL3KZb2C51I5TVf8fBJmMxHHzKvaXDwSTGiya0f8ZZ3olqbqcd2cjXM0jicXlX0cJsaB81POyuItwEiYZwsHn4gymrnlD0mfAro2YoSC7KxDdL1DQVO+0a7fN1fLkv8ElaXx46Z8EGJ/W6akIr6uEuiFIQB9fHujgNzIzAgaDEYVITJJO5XQkyimdgaTBvra1hUbw4jb8imqVpd7G9dSoQVNPatqBlbm7NLsdI/einfpw6HdFlo9bpLb/wBxf2BGK/YWhn6LhzEvBuRuBZJTDv7HV9WfnA2SyT3HV/F6f+23aOYC8rxO7QQ1FI4/0m/OAHdCwYedzx6F6TIlSh668B+Id3ZxNP3V+Z82Tt/AHYSzDsxyYC8mxyk+Za4Q6u8y70AKpUm1NPP2WMeSHfqCc5mUcG67RR+sJWZg7P5iG4FPnFmWKv1nwwk+fM0IIA5p7xmHnj1zbj89sN0hc81tzI6enBjIyPd6P5GXzsmp9IRHKS506SAEK7IxfjQLxkNK1x+M8YAYLrD1qWXqo03kTvXgYllmtbguZX1FQGpXYjbZzgqSLxcXTKqQ/GhYqBJzZtvPaYGODBTozt0Rw6/vP+hTUJGOAYcEWWr5Mqy4792lLWmElkf2k2HiF5268DSkEL2oQl+VXl2NXgbfa8xxQoI7lpuNkURcA/pNz/go3LD+w41q4eQy20ecjCwekr0XfODump0XPUm2vvNfk4P/tAVA2PLhl21zoFOrSKjd6D1AiMtz/f41uWlBWCDDY4tDRMhyGsls4GW7P8b0/dGx6VTgC6oCCWxMyJyOgl5RPaFDE/EzGGGL9XUm5X9L3crn0DvEELm/Vx6HwlGWtnfZK7dA8/zJkr9b7PBgLeFlmXyfUBxZHF8kxgW5tcxvkEz0roS70jNLvk3QNCTUIwCHnqk5NRDEaewDCzjTR5lKzNzx1RHHJNiZZJ0lXrAsSM03iKPyYNdJfMwUAvRlKP49yIx7XS9cvseBWVvGNAc2I0PmR6Xc9KjqauqjgG/Q8i16OIPtQ2Ll3qDkunTNq2O65AEFG5qycHaB2/159N4n67iMEpyNowNdkq/ZlDxsX4dRKNvBUJaYqhID70qa2Rgq8+AzqTaJhuYrqrDDO1n/0rWggrBcFsYwo7ujJZblKGamFf+3B5MTAXNUOKn5PW91Gx56gtqTqz1dYMML1dFR/KZUZom7Wky7v9EfKnYbBseAvDuBFBFFCuXnhvWc/JS4ipUIe59Ls/kL+W5lteo1xt5bkJYfug17vGw6cqrOjTG4nQXZ+RbEDCMTf5JZ4DBcuVv+tGPyucc3B6R9NMF/lc4ubulrqcBPhRUjGBILbQ+4uBJ9eUHMAj2ijfMskRMLcV5FdgqIWhiEvxNVlZSRrzTzySfBUjZHCJQtbgDZ8nRWLwk6rQKWD5aSHuJh0vBgvlNTP+a4P7p59l0FYBPtoNpiFl/dOo05KHesQCueTxj7IB6io9sqTWxTu2PK2C3ACiXWNyxs52441hxg3eco87pSRV1NUvQeac35o3tgUpXtmtl2yHh3QO1mQ55wSqIri3PtVxJ57l0nOuyav/0ixzLEq3QlLZmLb8Y2JVlrdQMjhpcC1j0DS+VHrYIB4JgyXacVu9PCRoC5Y2+p8qfeJA3OFreaabxWxz5omyn/l55+ufQkO5e9iODCdLWl2crwLrUpaMCi8EUcVXGb3Z8oBCUdwuuohn1sivwQp1O+DaRFYXIbHQibdPfq4dU8WeiYJ4WKMlNEuQr/BRIGwOrAIM3Ppjmzvh27Lyx6xK14sUHgNy2ggNG57CBbXznFP/0NVrUQef5mMdso3AJ33SJxInqYebzcZ2pEVYHYczXE/+mcptBHb4ANtGohwQabL1xmFHav/wFH/al8TKjzGnYiFLEifJHL7OJD0x/rtzWuCrDToEWPBNtRKXFZqz/kBH6gsxzy/TUzP6R+C/A456FbGm8soK/uYyafgNmX0re6fgXeehUvtDCXdAUJElJt7AMv+VMdIrrOK7TAaHo6E8Khx1rq48yOqMqtC08so9cQh/AV760CiEtSm6PBL7JKCZBV4m7t8Gbbc4TQRawpuwTFyS/vt1JBnAQUBDPdEddlJlVAfbGy+OKkohOw9BB/JY9rDZQK1o/kpfl82umHijUnj0gVqhJCsrzUxYl+ygkRPDEPZqUIo/+AtsGplmBSxL8bUE1iBc8lCtShF2iqMC1DdHIH1DcucbSNtxOF9LY4IMng4T9eTYzDr+gnOPVxWBYMambJUexTzxyvFOneFg3r4FBEHqG3QZRgnKISYUQKv9B23A8vhFRe8uNZpBtiMtXqOQlVEbO/HzkRbqVaGj4s2XRVlhO+ewkvEaTp4pNLXG1OVF6ncxf3Fq94KmGuG29LLsFI1fuX35J0TsRNGo+TCioyTrXLVEjPztNVQL1/q5tGSrMPhfJEaQxHcrnqhVVqN1gfF+JK9Pgcud/lGa+Ig7eKQpJuUN+PYhBYQ/b6ahi4nLNe5+d8rQlfK/gl3OQ3WDGWuUMOt1YlBKoX+99JWlZr6tTAVgDF0NSHs5fqbU0euO7cXKnvVB3taBFHP6/KKZCBfGqzNo6DgZgiAELh1EYOni64dmOWUuwAQCKu+L8tnTFLlL6uKkaNtO8YGlOBVU9mQFYx4aGPgGEI/HTycxYXBClfKbmSErtcsuhalOh73FnzRz/thPjvRJcRwPtZmCHs1nYjivLMWWGprl4fRUOlrCDiwNU+9TZuaVsuCxj/4DzKfcla139igH7Z+0uskWkEq/c0mrsRLlVpl8ln0G77hwK9rLKc+RLeI6KLKy3Um5C6Of3qiKNoY/7ad3EFvdP4VICsuTMTii/bee9efmKAiym0A+l3hS7SofuEJ46In7BEO+Kf597wnd6s5mL1d5zNRBdOEmfNKyPdUuCW3u/SfFQes7nYlfV/B1DOE9p/pmgK+bx+eZdZUMu44uBGlaPvej5wxU9aumiyt/uCCZ4PyO0OYfFAMMqTaYcI8GxYeHO/3tDJsJisLleLpS/gvPLbEksIm3R4OCJ21S4P//uyzQ4EJZyYmWZjtknKJbz0vFEi0zDWnZHl4kvpMSPlVI8cEAG5r0JoNN59joEsMhUcPZ1YtIDYX9cnR711x6SQEnBGgTz6d3b1iebIdotlgqE03w87xlD0+qEykcVizaOB3Z+ocaMGWybZTIdpR4niV9mDm65EzKK8VQq59iMlABk54A7zAlMdkYNmaRuWJN+bLJ7RqEZf8vrpM0+3cwD0NctuwJJA13JIJVFlPStNIXzAW4pp1OnTx3rMZQfF+o4p92WDkF2tx1MUdC14Er9l1RlYsEYnOubj2IotL4tkgKwnE219ZsjXb8PJFkzakaWhRBJAkgbR6myiYFsJgC/lellsN9g1ML0j4HX4rwIzHbq20FDkBdfqN9SUnIbJf0QQr+QxHx4f0kRekXaqKZYUXYMbRKa6OObLPOaKGft7xFAgT2pHuSw7kdfloER91zsJPWQJbkAzyDFkkgUg80kW7n7n+WBN3CMXA3lU6QR23Ipx/98577h2OGkpcp5YiTX/TikBkcza+iwBGNBi/j+GwW8tGbKxpiSNEQqUDdqfscbVMQ+OSYGoeQKSLwREfUGDjR/emc+ZAJsy3sraTZkpHFZAI69dwO1dvsOw/Q+O/2lgghmEsk6NKzmfI+OYuOG2UoagP9Le/y9UABk4VHk54+6fW891qe1yVDT2KUc5hNeePBaQwVb5BQYPt/+2xEpqsHC4GY37hXyRSGvfwYa7DGUDbMKd8vud28h67mpOl7fe4uFRe/HOKf3TFs+9RX+QpL0+C2b4R/8VfkUQOABt4tcaDV34nU/UFXBUDvPYMYe0F24AZPIWphY9bLwt+tWvmuWwhvAgPN1rxvo3hpXvQNSPsVKgFUKENrmSCjWPYCUoQfJFpepI6oqpsVwJt6IlBFGO4soABNOS2KtnF9P7E9sSLK1WWOdGvYNhxKO5/D5ACMSM3oLy6XvjzPe57hP26DKKsIbhLZqcz8tJOcm1zlVKV87cVqDh5iOgGkNIKp7JU8eBp4VRPvv6peu3DR+ROhro3GOnpo6Cdltkq395hUi+pDXzwcONA2YjC4BKvX3JGZi77wJboSzwwPelRCe5297Gau3hHdjkNfDMaoCdfo4BX1IthlFNEHUm2nTsuiPe/rOux7FSlxIwT09NqnvyBmWQYcleqlPEreuoCZRFvXL07v84AxlxNdJM/atDmCjpmzumIoYOf4uVqV/8ZnSwV78WW0S0R7AwI0EDq4B6IaI6AUBwPrNLY0eeSw24zQ6qVAgBGW5aK79Mg+Skj4XxdPl8axMl4x6nwmnAfEBIju1ssp4yr/gdi9kl+ScGW3r5NVqJ1fXRkW9O0A6JBottvWGypQioSH2C46bepNpt5dXRK28XY0hseEnW9fDBaUMHziavWy8Q7jttulrsjOd5WunqGz20rPiwX/3fdKuQgv0g4CDqGBMamo9htCyKqN0qTOxWP5MmZG0lur+eIMwtcrfYqJujT19J3dps8mrCySt1MRdmlNIykG8cIMszw/nMlRV1DmpxNn2zf3gflXm1sXSH00EqrICj29dnyNSbIteQOqjPLqBf2QDDVVCAgcCz7vER9m5X4XkTIeB4ppqaFa2UHE05QSkAhs7FkyPf40UFGlKG8GnrdKq0ZLUk9m5jleTBwhdDsYP8HCDKRE6LS48qLHD4pvSl3XFvmH8KBEmyeyNwwJzAJQd8MqhmKsdandB6Ec1bHOw8agmVGP/vvY2C60X8AnR2r2HhdkUbclW9+ozjmxmipA1AJIZnqxg4aa1Le0RHfU2vkpf68y/rFMYgCXue7eNqxoS0NkOw9a9/WcDFJOh0Grb8zYjPgaSDENIFMCM0H5OlIqq2r2FKGkaQSMzVm87r9L7fysa4xxVMD0h7CIExLBVbCe1/r/WavK3yPhHVe3XBjyVTDOqI4/90N/Cm5KnqxFrVYOHbwMIXa3GwNwVME+38OpXvNwD6l+jN8BDCRDEjGDFC+WObTdm+5/tfm0QeEfVUYFtA7gTobiCnl8rywroMyBHNClofz+W7OhssrGuos+fRhh8kBA+Ni0fYdhKK+qCZaY0LUDpn17UUKCX6dOZccCYzSsD2iSQP74pFnhlkOzACsapdT20zbjF6ZqLgELUPT8IglaX38zP6zfdyBF+NjNf247XNtmIz4QCO5iRy/GcS8jjaWMfTxI3EbUvzrprtgRQDOz/eMnyVQVbbFiTMZfhfQLeu+j6iY0Qs/QYGFdHefwzAYuVpPhVZK/tXsy6DAioLlmNDzAu1eQ5ihCnobO+MOZtSD0+uTpiOAvPwGWf52xDUHj4zbdFtZULPV4c1TmWflDGMkg/Ia6kPHprHErwFTGoBg+1D6oX8lSPdz5srAF0RbktUTmq44+USAYYowZQOVbM3BWMc603Oy9SQD3buNTgzJ7yaMBbo/pjkzVrpW5xYH0Ra11ykiz32vo4nBg9Zvm92KHWhJm7uQJV5DMPA1JHBWBMcjz/uZupwXqjoTffeHZ17N3waXUaR7cZDs94ewlhsbQrmI7/A4zJDUZj0qKiVQhn3f3AneEhDwl6GUdCBdKY14q9n6ay58twW2PRXXPJ6UE6TUs6oqH/0xgDpP3bx/mfcCUy5oo91agCPtpTfowGZ0tyw5mIOsUqvdURDhjuWLX/WIqaPlYx3zmJ3ahTcxtC5xQgKWrQskF57LaOvwYN0lzIwz/joNYkiZwLyB7Joi0CsWWRC6SapEN5TClIisNQtNPmfwKaKYb+Hguo76RtcQMXdRZWjEJNHq8KZKeg/uWWDOW6aygLP9JDrNNW7JfWDyHPR8GL+29zBAD5FY1WZXsmYfdKU1VTLLzAHERJJGTpwKZH5k0uZrDYM8zG9WX+RVDM8bsmN8cI2wKz0Td8GEq9T4DvY6FuhMsqPGHC1tkLdxuwBYP0Lu2RvjXaxodrZhKfkkIwGcfm+lFS4WMFPCz3FwWwuvNLNqv7c85xnk3aXWl49yCW0YTzTqwyKuKWSIFJum5G8BBjvxx2yDOZMh18M2WhRGX5VA0p3eAilBsGa54P+iEat2c0lLnTrXg7fzDLJrjO/213hRmT/92zHwHShntUiR+9KUWKWRcx9OrMWfefEo/p2FR7dbNWoP/P/se7JJUfBzJixcPvTzMvSTQrccDAmpwoLnh6pnsAF37U9Cakvwb0EZzywhYhfUyAZ4oAu4R1X55yrbJifKRbLIC6NaYqZxbpzV9ec4/SFSjJKEvmVGa9tHfUJayAvrPPbVHNaxlbdJOOn7f43GTTdGGufXu/daAhuYtol2y5rFVUxlDpyKCfYRz3fOyJZEjhxizetlF5kpK8kUuEpKNWnSG9VEdmcn7Tu0/U9Pho+IZiTincXepD9zQXGusmr6j19TKRCe4dmbGmRl1cDDNABYeOKT51fHc6+d1Q9T2n1UMmkd+aiSUgNIrogqtnInezaEs7HmtmpjKttWg7ulLhPvEEnGE5TqPY3iCItPzYojGET4V755b+cNmqdG6OBTlbYjDs4AAp+ho1Iq8R/eWa0/FOyB4K5JLQ/WqwpaNPuaoufHcJMEld4peiw/7uIRZ9U4otV2lACBY2PfSUUu7vJ/iZUtvPoJmd8K/BmbnNo2iumTtQxEeARnjsHdzf1JrE1L6NGFsI7t81c5GCgmWILKM5pWDA5HO53I6aju6916JkUl1YcYyk9Hwwf/waKzGbNaeXD2d1jBd+rriDyPgR5p32kxAb41vjMM5QjUrVztISMmbVDBnx2qArnLJ6ECRGZcfK4U6LCAMxRtE+Y32MobWIYqbeJLCsaF4pCXyZjPABVmN36NRAavX8RXO80JuF2m/Snmg2NL0dSW67EVH9I4fcFSjpL73r6ohLh/V+uK3786Tpz4u9p1byZEEFVjn4eK4wBNeQ7DGhdbFbRTt6/9b55EBMfJGakrqZ4U+Fgnh2uIpidUcG+iBjHE5HMRX2ZKkKLyYQElkw/Kbj2w8OvDaxd8rzWoSUnwkiP9DB4L1FBdrrf9anTqNfPehHTBlyG9cgcQLrR8tQEZN9zuxs8BV1Zf+cIk9kSStcCODphQCbZP7NYhgTuqPh967gyo6DhJVEeM/gq2arEo3NkVtX7D7mzM4zzsjwEazeZbygY6xwP5F5NLqPJ0Hxncni2XMn/GdHQmTbQF1zee4LOhZaDlBzMZLsKXcJ3sJsBmPODcSW/FKYiVgzz7wLdz0C3bFpTwedWpIZzG+H0kpS6hOFF5yNj/xUGHEQK75qxYUFuXq2vFITPVf7aaAWUF+eBV5VbBqFcUccHNaTmGaDdRTdXTurKJ8ATxX0DHWz2qNhGP4nrYJRCKI12hvvahdfR6RlR+zca42mjybVuHEEGrU2KvnHy9+mmlQDH4jYHZKC6knkne5Q28ldgrISAF0p2u8YVTy2bGLZqUkIV6zWDXi0DuZMiQhOJwUgZQNnrjzpboxif7CaCAFdxHukA5fPTubF6aLOTWCnS/EP8ZSOIyNGpkn86BVLEgxNoCo5XDdJHdnSB0Zy+5O4NQSsoKdZzikwg0eSvXAE6j6WW27irlXjNHHxiuOY/LaFsSgXv62JfK2/O09r1DMjpxv32Y457Wd8wFBf9V6i6CdLP2Z9qNFsxcP88S7N6b5FAkZAkO78T3f4mpUVnXed/QQC1AAudBr+gg118i202+jHf4m1tBvD2iwt/8PqoAWQSajReU2kDJ91lZ9cqfgKVbzge5mUlKDSh7aeClFOoVz9UEdTQyNyjj+u7JaX9DWyqtt6955fcvBJF1aKEjjPQjYV4+FQr9Fnd8NqWavBRL91OUcILzXVselzvLQtPmmvtdhkUNi8G+O+b/qcVyHvls9lJjRGbe0YWtuq9zXA02yIjtBjoQd1vY0EmEFvb3u3xiPt9Wix6NZ7ljWQVbw229SAPrh/hsIECHTLmxKxWD3/K6TUieQeqJIfpcIoOQcgmvHDyyRUevzKImeikRzg+ly1+qSicz7hh/DCm/39Fyk6M86XNkhcEgJKANNt1matUHBPuMmqkqR0Irsee0uIofjg8efSzC4Ml6OzAV1PuydANODV+SaVqKrg8qTvT2ROpiQHqoOAq3EdFRo1QW+1ak/AYmGEVA4cF99A82GRm5mLHhLHqOSqBVNF5d+tjFko2morW+bAtWqE3Mhi2uYPJEeL+puWOoJaLV9uHtQIj2GvjqEnPiF3gSNk2kq1rb+v31DDwcalu1nsmfE1n7J39uQgliDyyoBoudkZrUtnIUrDsC6iGs/DA1YU+EpC8VYQ4iw91D0O8kJIRK0Zo3YzUzYnm6vxq+9EDAP5SWf+Eyupwlhcyq7rgfu0UcsS/cyy18bZBvpooyg1q0GNkTJ+MwtXBtDoaChHEqMdF/a7GjUgboSb8jHDJrfqRhQ/bbI62r8nHoOa6UgOaJLxxg1EhXpXmkd3Rch7uNxgpPzxP/mBdrGsygnoth1z7Q/YLYJb7LwpuGREdhP+ef4imi3CBmJrq9pWR8/s43S4uxqNYHUv9ha9RBACBhuz+S4xTQTZaCKSoDHnxC8CxGhiHczvJUTlt4rrWQpu9+AvsrR2wMvwqpTTd2ETTsO/P3JJiLBUvcs0TXCPCRY2h9Nx8ZqMz8XSEqa9ByDLoNM8PxxK/62v/Wkztb9dlxfHsl4u4UjIZo5lD7knNDevOZvFRYHhwFE22lXrX+Sffrt3y9R1DKaG/GlAPLQQX/Hetzpmce0TT69U3cFZSUWj1hcJa25OoCXx3O5jXSizjPu68eF6JRu4ly0GPmihJAcdY54LAu+PeTtHdGWaRfb6RVp9zxwP+2PoTSQm+qFhD5LkhsYuT1IwWLIAUjU9P0z7IOUj2QP4sYABt2vX5hJCVUnjOBPVGQTmwyR8LSRc2WvhlmD4DMitovW8AmruHvsuxxMnY/ybXB0f6jgvY+7tMu0sJN5r4DBEBXa37SH5PepbiAlY5L6+09qF9dbg57qZdXr+Lkj+9ODwIdoY9Ogs9QXAMPBK9sNLNDM1mFaODMVpqeBBx3+/X8BkyPofOmxl+kYJsG1PP50FDBXj0A4uVUwSXOnyDvjHd5pupMiy5DyOMVDjPDi22YVTeKKPxtGz5/wLm/x/DzHO4PBKlriUyR2fdazZ8MZwZO2yzm40RwLqezNhsNT7aqhOqWBMfTbYcyVtVzrROKLQ/cw8h9MBYgLQZ5m7RtajLhjAmwWRubbOysVY9+MbTxulvSqQymjxTj0/yGmowXOk8LorLHbyciHZbi5Wipq5e028xOnXPq0SO1Ei/BmXFCr+iw4toQwld1d5KXZJaq1eDPduqLEuVRpKA9CzB7KJsTTpdrYpMaOsIFM7Wgr9Oh/caoRAohQN6A6HSrmbUuxffYlS4ymc4W40QYfauuqpQ/JTXe2l3gW1vBU3Q0CQWi+YnGMAlM7QCe806vIrrgQmejgYb3z21bFn0KNZj8qMbtk0fubcrDYYwmBhjZezZtAK7N3MQKKCODWwtmN/WYEGctudKJzRB3xrBGIXPbh2oyOsQ4psvw2packPl36ulG2AlW5rvS3xsDrZG0jPgcLNOBZVquBKudvtx5EyYnivmLREWPn30cbkfL4RsfTwuJVSFZZJFh6UkofGq/bkz/WqbPwyDk8xppCVNz7JQstijvxEWrb40THMQJebLnzyY2q2jx2SLecaR7/0b676f5ddR3aDQqQxzS6YlPvFcYbw+8vic5SAk75H9CSsEorQCVlJSk7DU5HBRkzDnV2QtTJe9fsfqy1sQNBXqUXzv+3HDVDSjlHNPKEmNGm5+zlEP/Pa0mLR8hxOG5PeuHfsO4YAaC+btxGwKVWC9Se7tv8fBJBx1n+Kox6GyPB1SVukkNQkjh9dl8s6dR8uwRo6Ep3zrpyoDHwNvpGU0zV5/27gpveUjCyrt2ZF4TOPsS/WygLkfE2dbNXsNDXjU0kggbh+REnbrOGVNbeYAoc4ZX0aRdyTYOFzlRKaGo4MoHLkMH9FMwYlY+jItBYVbIzsByLIUmu7xM7N3q4VtOAzdBtYpwYx/5yTIIJ9yh2VZWg/uPZimDRgASUeaIeF/TU+n3NBLOkQvsf4CKuJi9s4FqpE2p0HLaw6yIcFU8mcl8Jx6XPWv+eL9Uv+Eyr1QVYQfaJcVwJ6kjFn9GSZ3uvbIxaZMwi7x+nNLp60sgdzogotqc5oVT+LDsygUDk+S361me7L2BWYFkcDER/Rx+J0tgDZ6wwKRu7kFtxCpqtt19WgsF6LzpqmDlLORvOsY68JnuZgBdo7ozFmFR6uGXxbySNeCvPKl92vkVsYEYjZ70nSsNQz9WiIy0pcd4Cjnd16gHVj3X+IIr+ZH/gTnYy0JQvVtpoQKA3yqTH8ZK5WAWFLSXjNeHCwtYmaan6uJoOWW3ktmR0n9j0uxSEniCHfobcaa4adhh6U65iKCHer9DsvpoFJxkj5jhGLhPSjJ+hLddzatV/1Ocn1CE5uZoZAMtgkhUYN5zk9+VUjJxOTjDsX8kQFan+fCSw0rK8IhXNp3dynfHXSYCNq076Pn60lpsgbLC41pl75UNjAtdkXJ0OFBP9SOFxYd/qxoACmCf2c4BNjgll3P8P77ikGQPLbKe6Bprf5RR7SLTcoLj+WEriYD+XvlnCQ6gwN09MIkc6PH+xS8JfJD7iyBoSsLx/L/1AzaxG7e0eIP2dxroERhpC6jg8arrg7XQBksDHIJZIPRhy16WjWaucMUOLtxrgBU9rezETjoCtMnBYdaOAagkVHdueRkp+p0+SRoZ4ejQaCwhOiYRYYJC7NsV73oO8dwYLioC3qILoo9B/eMud5uERJdTB+L3gaZcXObntZ43fegezhpmSwHyw4dM10xfsXF1MY5XAR1XmGR9Qz8Yrc2BSBiUUf1wSye1tGQLKtmsheBI0zWEKzJu8/tdWQ84lcWgnXo9INPwDU5XiJi0OyBQbwRH1ahR14L10g9kAYWlDK/0N3VzcgYYursjTtw/2wSHmfTGJsx5NOXmMmVliBLLHGu6G0jFBLZtUkH7EzFzorhlKhKRrLqXXlXpO8crQ3CHEcZLu9XzwCc9SvkPe94gxwonijdizLHtGfLLKLF1cdtXMFa7Mf4P/JQHiBZIRXBzCKoqPaIuvh7X4/SQdEJnxbsIECUF90ZnrLUpBjTXiX4XAc3Mse7eTXKyZp8Q3Sf1S3esZyDQl+BBER4PmbGOeQ+K1112FbEeyqQZg56WiQ0jRCUmP+Kew9A1ZxSjutLVOfkpuBwoSkP4RGNoe7WrmyTXKI6nk1Tnz0oe2Vm3PjBDf8Gwhe+fwAYSAjlPra1TtCj1uu1GcdIAm6ViQn9Srqf1ym9fPIxInLxt48mCIl6DSTi4ZJ+XkJrz2dXWQqhpSF4nNWapdIjJH+p1Opedufkw0xHlr4vORb9BCJ3W8vAPdZSqI7VxbNaaOfqhI/8w7L9horVKv7MLnEr2l2XgUM6+i5Ix58xgRlYVxa+ltEdaupD5yktPEOlldMIatEHTM9j7h7hxVvQPEbtQP6BmDdVaPz2u/o7+Aiy4lsXGE+Km2ss6828uqY4y28croxcwQBaemP2+4hEA88WmmXnQTmIMFje/i5qVzP/dynhApy5GEB55hU7+jPdveexxyrULupZB1hjyqISvKscuKXOXZUnp8dPLlTkOIlOhMu9t4Vx5PLPIDK0SdUiZ95AlS0+/1macnq6hXYYejgXigt9NePxN2PY9CC0HftH0q8httvBeLZ48ootbmSIZgK7/Wm1zqq/lUDZBL6CYC5KDyLg/WfRKIQMNyN2X432uLr/f/9AoV132hvDNWvIbdgJKmzFwnqjd8+MjwrCINW480Y/0ve7EpvtXHg4WzJv5MuILg89gjdMk86QRO9Q/YKdmb+HV6eMqRTq/oudO/E6zvH3NzGgHNz/zI4Clc1kXUMDTrnDpBI2KbWe//7iI6d1A8nhX4F+4tGki7hfsA4VOK83fdLmcdAGqQRjtItVXa3J7vhE+x0h3K+fVJpM2FZDdY7gVF9ME1rtQmyQOE+F7b6vQAUregqMnIegpxtIKRhyTvfx+DFWZLf+VUZHUO+CicH8sE+9LpldACFUpG+WMfE56X+8xIB5l+Eu4ij2kBUNYythq4o1kyIEuD1kt9XQ97gS9+waaIHokWae6jm/Y8Govgmk31Z2M0SBZAIeudbA/y6RkBys3zsWVHoPxD73jIs92cougppJ3Uxf/pQcoOw/qt20epdVJgHhT5/Rg5mNf+bvQ4LJnwSxs7VE9Qc/myZF4IFBUAom49bMTIghVW6RJ2gfXkP6ovc0THTEpxZWx4zTkARVTfH75vftaIkZptS+h3ERciwL+zFBfxojqrdRqqdkYWAVmXpf+ueckOfXPrN5b9eEwl8OJWgoXwyPM73RDn5ix09+qYTUbhIRquBAIHnO03H3q5TFdSXzP+sPDF+FV61ALiJwLttts7/NF2qhFJI57p4sixeZfoEtm0Dg5wGwPCH6tc6aqO8oe5R+IkDR8TuyFEN2w2kBdTxxvejaSoap3bQlCW4svakUIjVrpe7zCbbcGL0xSe/T3hysCfb20Xj0oFitmmY1Q+1QAbHJj3MfeeZfxuvYYoF7mLnb9sF2SPQEFrRwt08qapY0ODw4ReEM3TamVg4j3BvgKWWLIeWrMXPSM+I3hBzjUn6TbqMNWIPDWj5FBYrWBwXYB71BOpmX+5iYomjHoQ7LUcQ867QRS3qZXYnBbLy/FO2tEGfzE/rGyNxED2nvMySIIs4Fx3fZIsIZn/tCkocG9krZ5TWha4eDI3zmyCQeBMYsXlRDNsMfjEEBFh6/Qhq12c9IUp606kEY5bwbG/QnU+IAyJhlftn2f8iRL5A7v4R9oAJGU2GYjNHqZUGg2z6az4YMtQyXcV9X9WBRlaYnfVIRsmuVGDhDBIoG6C8AkCK6LdXd0NgeShgVCNpx7iacd6L5r4rVi1Gco6rCBwBfwyIJs4Fhnq8IZrURn9zhkJ2FenUPijnbIom4cDNJT3zqMfvySGt4ko2KqwoGDH25QLfuWMbcuRhuQwYKgCX9VgClxETR6DM5DNjTv7F3ysG0kI8NKZ5AZDzjJnJD4VVPwVR/fNKHpzgM8QQGSapVEbQCuiSw0xjHphp0eDxZeames1Mp9WwQ2puhmhj5ql1Lv0eYJEpN8RFa01yfNY0KZkTpYzcO/Ckhbb36k9esVXSMPl1G/K7/sR9Mcqvz7tEmdFwGaO02c6azfLxlRg6byx5y5aqHXBgH+N8X+0pGSjHsaENs0tEcJU4XtLrRLBJGIFVEe3TvIYkvc3siaU1d3xi9t7TPq1L/+hMRqojqmp8jBLyo7KEuYZeOKHFM3mUkV+XkyhiFhmwxtLgSsGMbh8fE6hCR2rTOIinlmsF74yj7IpViQkLbyCbrvDt5/yX6I7Y1abrFs7QBI3D9QnlxlwbgZHvFTKeaFKcI3NvUQFQURMimQ5M+eF6vwSlYff+7/cWpYmvPrIh9BVONzVYOe2tQdAWWT5fJSYL5Upt0L6Dl/pZObBEdo+FPC4b2+iU09eJ6vb/kc2/uq9CvCUV9KB+C/CPAJdOu7vq8wf/Yxy8081PEnm7VGsIzzoFYnDvfYTUyPhdXV2yICWljxWqkyEe4e1n+SZCRACDyiLTdzj5Dq5ThMdA+CNJhV09iM2iW1Pgf2XiLDkIpNo8ugDtNdVTMEBsO+uHzrqEI+EwMOFr2gevD8TkmyjvrYH9Bw6rkARUFwc7DRpOCIaACn2Edjv7bmiS3MFeVgdj1y0Rv+v1DYqY6EwHst3CNlpq6XBW7Q/fu+F1R20aHUR5Z1LIZ7wvY0E/w99bKzAyUjG7671ZUYF6F5+Ynv4Cm0twLZ+GTrBp8VL/LMeq8XYgzYldrklMglyWJS7iWBhdA5GraO3m3rO2AorN4N62bHcpIhG8kbvIkybnRVTEWt5a5f7iIYJN61OO1gLp+lMKa9CuaUR/y9eoF3/jHgqh6iPSadglFYQ/GTsLkzIXMTFtBelXwJHtvmQtoXItuOsLGvL2IK/M295YD8SaNfSND8zTfgUXGYQRyrzsPYC1cxWOto+YkW9R3EinZBFUy/5HWXF6WeqLcPADGeJH3U642mjV9hMqA/GY+7DcN2bpls25VizlGv+FyH0qhDmmd0gUS8y90rDX+Xk6y6McJ6S7gM/DYcoTHv/2NeKg4rjMw8TqrlL9LBcLKWQxtuJxVX7ObKDCs6fNlfUj6iRrGPFdJD+ziFknCJKgixZ5RJQEQZi2MefRmUYi5crYu3Oh50a5Jf+upvNzFAo7KhxO8WRvoqnLO0wvvdcPsaVUOIcvfZoUierdTyFyoxwnJI91KCBroEodybtBGshuLseewOL8RJP+H2Oqsca/SYdeeRtivXY+FFQeTQ33eeX3DdtS0+wgHXVCCQk/CkG/az4aY+ExO9eyJRmpeKAXose57USPZEoRKo6m3uIY0rsGhjw0xAS7X1DuBTFVuo29v3dChgu70cPjpl5/xQmrPdA36PXNZRWOszr9FtTYYxG7dHUooremnYo1QnUGWsN/xygLq9TDGLLhVH/pc4pD+15uGiALFzU4PINmfD25G8LAsJea1dQlpC1s7rkYJUQqIwFNDY4Eh0dawLn8fCol/rhUCEbEHM1dJlCBpXxKfm7zt/ZpsbXgy68nEkEoLjs9rk0E9GFFZoYLZv/4qZR7nl7qBbeALu0FWvdWoNb4hCvlkME+i5nbMafn9uVxxXlpXBlOxHA7IKvKJLMXQanWkuK9A+2VI1JSDoY06+R0/g5TPJIHfO3roljfhM9ncx6Qrk66xY1H0+2UgF+oQgm28A27u9+T4rGo0sT6suA8Jdwthg1T9gojZro33dFb5pubkZ5ZHchLzsKkibaR3DHxf769V4iImNuKKrpgMMK8vcvF4YgFx9Asca63MVyNPtp5+zXPASns3bwdmsxnn1S54GTdkB4DwX4L7JXMnQGqIaS+mPgWxbIZbFcDNIrMilEIEGFczfvcACtmReTyzqnpITyfsh5QK4RKX9ZWtvUy4bWXjsLYbNV7MrrZsT82c9cmf4f8I0sSYqVIlcUYgI782imxBuEKs3OWcogWDmwlr9TGLtVSSTlyzHUW4PU9f7Wv06gLioBSoAf5esTj3FD9kKtTKQZfTKEIOcCYWcfIk4IkcfoFGKSLqsHhBpBOTfEJ6dxkBJXCSlknDrb8XJYO4/96XFd4ThAg4/Heg3u5p1kP3QG2yMuUrty2cFQaT3cWMABIB2diEu/1KfFFSKbfjTp8aUhb99C/ZA5m7h8JWsGwT5Ml9Uhw6CmNHyRA15TyVwIsOH0I1tFeVqQaoqT7wGjyqrJ9bI+WtpjMv5CAGQfj+k2aPOJZ/zLvxAtkd/Bzh9BZPEwVE0I0DI82uWK72P5+mHKig5zbXYrQE5bSNA9/gHvSND2qLV3hLPnoJp5q/NeZX7mhb2aWf7qkF8iM4HEHQ6YiYA+E+kPmfMGabHq62QBi8sSJ3yb68iTcA4YT6f+gJb6G3adGkY9eeu7XQZiQEi2fXRSKUOj/zLkyh4R3hOAX6xhT1yCvCHT2Jb9tAzSMxe0RFbM3g6b/VHgP8nyZkt45j1ZYBTwOpQIaFU7nU5focNbiclNOds9b6I+FOnBXwyAf1ViJPMKBBofmR8wg+77g5o3CiYUzQ+KdNxUo14XQc58/GKrIq3XSIefM9azql5sX7KlTsU8DGT1HlHIYnd10cJYsAEHoN0mLKcHTySHsjTFesKWsmK+siZFXhlavE6F44mweXOrX6FBoELRrvIrsst4OH+O47VaML4CK/cNrjlTodfRr3u2XZsHCcw9kXLGX/15sm10DYmP3G3387x7LDyVoplrs0pzIvfcy41eb2Ob/wM6tQNLxQKnfSbL0eyYL+RWR09qeHT/lWpCFvcISYlmdF/jMaIWDyxE/LA1tguYOSiQtSqHfgqHr1n/k5nFhnUBnU1J1eys/8qySmWwIplgfD3uNcFHlg6trf2B11Om/f7E9onO53sWHhas4nNuhBJsUn2OjOnOAFZi2dcAvexHytVxIdybjHcEdXUcp0jkab19hwZ0RddTUGjtyulBmpbfGD+4d+oynTEjmMlYS/pfoCyhEk9XbgbBf7wtFs5qleFrCmB0NrUYZLxmw+2wFqYEUy2hYP3ZxY8uhRZeFXZfhOD58zGBx7lo4yMjiBc0zvOGqVQm8d4tk1CRpyGJOGJWVU4EpHPxqgMP6hV7f0IxJugziIEJHavrZauRXe0/THYEOKpl/a4jm/fah+oAzHRBqwetjJBSjNp5LaZ3ZUNQElZJBDOF1e4muumSHF6da394Cvppq45QN1B2wYBfbx4Y9fnq5b+heTNTCmP9XhMQGniDhmdhGzfPUY5YPvTUhEcaaA2ucNDUO/xvaUVhXDIodrM/05R31bnFkjUjn34N7Aiuagl9VB9SjYsu83Ws9eoevaZVwZMC4uiZko2GtNzZCyMHRq6GKhvEGBiM1gLyvMZk3eR2dGcn19YX72JnDBY6RWncG7lGAg0YZR9lyoCyQ13gtnyBi05gPlO9yOeIYGqQrhgRpR+pAvx4czdaBMpVI7SgZMAhMSsdPUEQ9stTtwSabBmrln0uHsOMhDvi0bNRUWUmqnu3eiLgzk2XKGyTaHCe59vZZcmDkk8aOO6pTw5H+DWALBPMcCOmfIz4cF9E5zesXbQkQNDFk7vlnAcetbpid+Ce9MnTb3Clhv0lL7lyusJYCpLpalVXmQ67YNR+IIDh9vW7XeWnU3FFfdnO0yqCON1josSLVMTTaH/T3Q7Y+gOUofDwwXaGyGRB+4GRC2kk7zANlgd7PmE5kXda4IpmTbP2OqUJ/O9EXW4aslQR5PtYy3tNMamtk4Lwzb6WIFll7MVBneG5vPfEGslblvK4unzLLIvceI6WxhiZNc/nr10k9nn8ikKPz5jmA9oC+lWIE8QR4XYTcO6WZ7VMORykmWLBbTE1NQc8/TBpYSaYjlsyOK50EEwZC6/hyMiltFDU/OcVfSs/4s0Rk68qJkU5mIFxzQcySQSzLKmqQzkbb2ZlC8MLMP8Tt/ui2UK3r3IoyOWjDNfAV+2/iYAbaU/gcEuC9PqZbBCpHpobrsMSJpIpAbdk+lZArMaQfdQP2kY9Krk6TsjNb/ad7Ghc/HTlJyxRISEoijGyuLhUJB5Ch35PrR1oibmRE3vvhC5cWj/AFFMlliT5ELHoj9ieMLEG0BOkVRUXKuv2bfaF8AdXORnzTtMfXYqB8UVY5TvybX4Mkg9YXaiDDrp7KV8wVHpmx3MIlmRkznG4Q7DbYNTZBEi2yxQfQW37NrAOyCP8AXP/EHi/BLLFg/ip1tleZLojlnpdzKgSmJyi4IRDWNifCtFxTRjzh2z9DNa3KUZLZnixrksQWHwp2gRkmuu7HYPHYIQrdjih0WnNb7CL7hFDLjbfGaVLQh5Fu7SHtZTqDYzgY4QnM/x2PC8v6+qmCAMbOvWxZOIxjgpUF1ud2/e41K1bJAXPTZ0ctJLsigJDqNH6fNsXGGXNx7cwJPgP6INK3Qxc3ylfv0L1e9m37k+CqkJJTN6MvvQuae8WjO1l0JvBh6yHIrZgf/Bt/DNS1QULgHfUCLdwH6GVXxn8JChzrTEJL4dTZGD6nCwPWD+eeU/jxNc/wph/HYngIZcSTOnA7ZoHemc7pUYXx0Nr45Sbce9CyAvFnCzoIYbXxoDXYVwt/7sf509VEfvoLzjbFrRKr4vntb5dgeDiwRX6neO0yQZsOSoVjVvOOSAuP4PT+ezKgOTL5CMeBFh5fTyCTneXHNexLrs1pBpLHH3kmt/Gi6938ByjJyGR1wM7/rvRQQoS1drQjQ0vefqIJKlavxUAyi0PuILAyGGfaeCzz00DKjY1cowpRuwwf7rYPEZOByjttnqj6EUZ84F5gZp+4HJmTpMjNq0q/lyKFhwHKG0wkVp5h+gESx82VKGR+mbao8YOh23JnEy+eNJ45yos7d1gFc6GC67dt+OzE5TpAYicEpe2YtuuIHNt0hQpdLBdS8eqx9D9RSrya3h16jYIp9Ogfv58USTrQa6bOJgC6Fuw3VSohoUOQpQ/XY+PVKw2eV8Q1N6yxzymT6QIiLizm3kcA+jtFVJVj/IlTTGr7Tj6P8fQmh0ag3AJfRbLs8nmEQ1QHGUtaUv9djTgKNG5hVLyiujHLL77tNlHcYLwqquU6Z2V+WMoDwfBiMDqK39/tNhs7dXQhQTHYkold5VgNmV+WJr8ETyoKTHTS8g1RZL+KCbZw1LZoGTgR6eNleq+XGRggG9pbw1+WcW0jzJpvQle+pDWTA3yPaJogeuohg7EijR/48Se6kjwNpGStelAHWNOtzrfgmNxtH9r1eSRWLz79nRNF5th43Vy+rZ9FcwK7PlfJojQmk6yDIgDVpS2IJtFflHkl2pdrA/ZK4Grks9dfURGUNk54HimplKaYEZX5dE2M9W/60vxTLBE6XeIZ01h4YiHBHGMX+eAHZAHpSk2dFZUbQL/ylbq8VdzyOCnwzB532xAsz2XqmJFNJCZ6YuvEpyZtLa07GuhPki8MeZUI63KN4jC30SSX7/bWpsMyfpqrzmMI+cCYlmRUB0Mu4kG/untuIlFzWG2JnuSThOvNB87WuxDF4K9MPLtApA2nPV+2yMqZtQu/5eBgMzg8/6FBhddJz3kV0onK4Jbo71w6dhI4czF3ksh7/wVe0vAH8B/pVGb1v7xscPIhg6KL+hvTtq6g1+kCPpBURUhkj6yrfPgZ3/Xtc22MaQJp0ouI8smF0IW7P8ZfkCNRlxyoz5rOlXJ2YoBYf+hZJACLpIW6Ecg7s2fptIWtvuAgGvGV7dSNLkYv17ghjkJQx6tLucnApd6V56PAKNj/7Yyi6MOC9uwvXC4HnQSolMT49c6/5ZRIfWauOyw+arQBxET3gqjgZPldHDuhPDdYxffuJ1ityuwa75OUwVzCfQ3DhhKAfuieBFYqqN1i5usxjNFwKad4V39gjt2wLjcS1yX59qz0LCyVW9KbSYU9A28hy5DC7hdtdQxRU9PX4vfg8R4KZzpT7OhJe4Rwnuob88KsYJT3Xdb5uQj/iI2b9k+IAL2RazReg2nxwi3ia771jH8mWcStAs1NJu+cMgx6oarFqLe8b1HSRxQ7za0WtQhVKdhOSo+l5MyUbO7l4rtMf8vOidRDYSBoESyiDirZR/lirb7mNwOHR9B00U3KDHjR+/6/p0FjHCVpWNOzJcWfIRQkZ6XmbdXoGNbYi+/6K31kVQSpEiFHlf0XTAzQKDh03BJv6aoldSXInQfAEINY34mN7TGvaILI1iq1F8qQD9LdUyM1y1GkmIcoViAyaqPmTF6srtanuyTM4L1D0wyuj0tEVAfuycGdwEON4fnsCqlt5T6S1obgnUutprS4s5WpzQgzd4U9TRXJErli2+o2bS7A/uISBZhgh/679K/zLda6gWtuZwAvTGNdCbAN9uwZti3Hk9kKWrIq/zDHz00+fSYLcc5sgjgY5sWd/F9nGirgGojICMTxUzGmVVyjsC+0iZ7i++UKuLA2KCekIgylXj+DAZVKUFgBgXYW5+1bwyASMUltB5MhCcaMuivyyhZw3MJ7OjjmJyH+sH7zwWOwFaztw+KQpl6ETunGZ4wgXDkkep9RDpXHKdERy5R1KfOfi61l4kXklOVi+UvIPbGuKxTqSuKxjgg5aUU0X3V/EKdOugbYyeYKlYTyfe6Py6u2Z+A0k4k2giHiUVqkoC8MKxTXxmChSs68WryAMhUxyo84ORdwTONcLdmrVJbnyH+ugmyyx9iKEPADsMijuo2U3uJDa7Wnfr9gcycQq006VxIwrhk0FV/BDjqzquNOsEJXdrimGw0G+JVU4/5BNk+lE5kSCYz9cOOfNBtbtPUoVHnu1jfPwwGlaTc7GUxPcDFnEgwaHh5znVnSwPAAdXz5o6vI34Epz0NKfx11wmUjfW8nTAn60/CwPV4XjHM2yzXbq/EA9hUimpPyH+gMWQc8fiEpaTtk7l1iADxvDO8EMdlaQ0nXdXnhCuCrsoC+Uvlb9IaXpTbhDyzTzYYUPRsJ1khYU6+UMPk1YHn7mE5V3/F28Yia/wrwDdF+R6TmVzsqudzix7NyUGk46wXs0WaHIURcZDicGiV7SEhoVNTU0zgBoaSd49LNnCcmSgWRMUa0JKdpcVnfovdDcIyEcqOXD4VeP1baW1O5XKi8DuZzNuEL/drafxlkHz2RIla0Jp8ILNn7S3fdeg9UhAx9q0+SKtkZq2KsJrdjjyAjr3GfTjVIDAz98414NxYOtS7EWs2ZaFK7+4WBYoC5Hkeq4b/TVXen2W5sxGUXGVbea0PfIOieEzqtacY9iZH8JBwrLvaO9mQx8S8Xs1qoQA5mRuhLUFIcDGMj1wJK/K+vclB5Bl071Plrpq5+L4WJ77f/haemR3QBDVN+DYo/NMMFkqokI7b1nRwuzDmI5dEx4XMlGANd6UtZZVQ12+CHjwiLfAM9yPWaei6wRjGbxBRZUWxyt/lA3BanlqVbrdSdMBG5p3j4Pa9sSfYjUr77zB9h2qpnC6V8u1+XFmGBTP3y97KCCHykGfB6mbCNng2OYcDfFxSp12MaqtqOwry+xB9gUkHlnfW9DENAGqcYOxFOWwZHAJEeIuPuyLr3pc8euQGkJA6K1rmHJDoeAl370hmHY+Wk02WBNr6bOj8owlbEPXZobBQ/xU4JVN9l2GH0nnIedokXyCvBiq+jOf90wECFhhyXgaKiOos+J5t5i72+cySCooSeyr88ULT2mwUuMCLDw9Pty72PByiEtatpiqNeZF8Kladg4jD+8iY+w8ru/PveAVmrABMft/YevFyzmyB1LNidUz8yrnolKmitwK2bPJrQzSfyMg7RCZtnj801QmxB2Hh1RdODJ04NYCR84mkyeVmLrySQsPfWBiZawIPusj3W803YTrCIFZh55a7RhYSAh5uolGsv0TMC+pfZ8CJFMfhrjIkPX4iPlpoVij0m+1EDPaObMhssohxiQLjAb8un88eH/6Z8SnJxoDDY9JjIkM28xe9G9BMqE8CdRizNqXF+yzFoq+i0JXmGCunk6mGwVz7dw0Aht2yZLXL1jgrrUpP84ikBVljLiJmABWcOUt5aq4e2FLPP4IYwNw6/6kBGhUw92jqGvzzSz2IXFoSGkFThCZ6Hdi95k3hbTR+UyOtNXxKf3qOHtoG1+tO5u2H6XvCe4OZ0IsSdV2C22f4X0XRjnoLI9dkAJcmaPzyLbgrWgj/dizWHsrNz5PzGCCZ7zywhZMyk6RrEJ5ucZ5k4Fosm8+U94ZyJFHYaHthMhJSLgoHd9plpggxNFeaBMx2BdSg8d0qM1P9s3xHTr7n+uvFsfU5qJafAkyfAi/gC+OLxCw0uMl/XJ+id3bpdG4VxQwyKvZaxCWrPaRHIy9KcdR43jv9jfykGUTzB9KjyF1G0SkyMHMeY5wgAmcEp9B8ffD92GR4FQExXAD/Rm70xyf9mrg0HowJ+Y5o1trz3gJx6Em+pGPt0PvCVSXsmyA7BLMqIiL8iKyvmFzR0O7FJPoUD5dZJ1eKn4tDUJJ4Umb72XTHqR1qs8KsHPpu1Bas2jM6FoTMyoX5aScTz2RVJH0xso6SkxxuMBg3uUblz4fj83SnK1GADX8ZJtrY6l5lrbF1/ZuSi1BShVAdFnfBB3Sh1SW4KQz2mL+Y4svWwspzeGp4W6pTFKdMDjOxHzkJHkAfLjLjqf+T1Axa9og+Cl7gRTi70bSWjsQM9F19HqH1IdJOoerLMQTLpuVpFU//G6/hsxG6sFsnzMJ7n73SbIizBrcriqJQot6sKe+uP1gONUVuBIPlDJA49atkvafSdkS4NR+zciAFrwoHjdIsVSJKqDxAVrM15uFJb4cUI1Z5j3Wgo4gLqLZDMdNtYKJ1P7oBTGSBKZGTqguAYXj9FtcQ4sSbuwAvEKj0iSHfGzNYpAzMhIVEl+O5tVLe4s/3uEd9Gsrl6bogS5HKQwX3XK8Vnj7lf+5qIQiTSzRnfkEpdxxgU0LAZG7OSxjiHkVD2gFaZ1GjKhIedce7dFUwac8qA8Ut250wwH7O4rKHFECWEhhPfyyNNFFWeFrcIjCB9QkpXuz0U80DXFirexggv6bCvxlzrpYL2A02HykHogeIIum14ATyzZnKSfKNZqYUHkFr6qN2/mPO1WK01C9CpwXcl3fLEficn+qMiFNH5a/JFJBAF2ZZWJ5EP8mGzPCF9CDlr0z0YHruP+6bAUG47CNw5yDdR0WDTjq/DqDE8W+/fc6iTB4r9945YbHjR76ZqoOFAkp3KnRniRLdWK5iKvLCCH/Jf9vzHnX4LfdHlAiEucOADd6aaTJnMDTB0DnLoW9pvA/TvJPoH2GYOwUyBgDkGv7VLqRPzjz9nIWylnnWqIlm7L9YRAuucHIleKaTQCeUrXP0Wnyp2nmBxzeDiVOPsap6l6MYLHO4xg8HBAK3J1dgvBpIjcYDKZexJV5mf8c0hpw5ODKTwdkKCeeTezcPXh/9nI/FlRcIYy8sH3nKCQ0EEucVi+uinLNXGTmZXSuB5jYC2k1R6X8FYDLSs7G3qg+Wa30/SZZVsN+vbIWPDRqs9HMz/V2eXRrxClGwzMRZTnpwuqrD1GTjLUluOf9uPygJGxe+/EB6Ak5UCCsCWe2GLD5iZX8ywqGyaP9CGKOOsQ504tSVjAMPPpKo7Ex8LT3xYdh4QReijfasLvMKd8/bu689y+WY+S8IO9LXV7KYzmOOycnb7imsjeiBPCZgNd2Hd2fLIQOaLorPkKjFZcGRaNO6lp+pBPTMvw9QIbYuQZBlhu48VmV3i/3Y0m71BChUWR3cdNSS4D96YC5J0Y7ZFqMHBW6G9p9pf1EMvsoq2dzX2wSvNYXqdP47zyePLrk+nreb97cBNao7U34lHDXeFQ+HqT8XvcE26g42SyQZmHFRlH2UZ0kohpcgm7Li2wAo0IHMre/0XfRV0HtarB6og11KC3Z7/RUcqKzEPA7ZEJQgZNgBZE02MFT702HN67p516Nvqkm0Gjx83wQdQMeqxlml8LDK0V5SdTdnatEK7C+bhiQ3CLRBupVuTeGYhJY/BbrqiE1SY1vdXZ2SFuvNbcrI6ErGJV8/qH1acDEtu58Cm9IYXlR4R//8FS+sjKjiIPcuzVQ+9bV25MODrRYTzxFJYbLhp2Um/HKOncgLdKHj7tOrMZfxR6CrV1qRAGh+vD5dMMDkqvh3RtFI8M/B+95gOm4879zLjARkfVycAOqjJdoBfgWjWNsJnafTkmc7B3nIQv/Doeol9zaGW/DlpeEHHLSCVAFpPcoRFbXqIB0NIfCnsKcK8GmaNVe1S1WmDjR9kV2WjYdDpu3d+gX3edjZ363f9jQEbUhFXtuRXOQv+gmYCubqBrqUoagUdP7xj0HIFEZg93/KZ2CrZfN9t0A6WcpUJBI5WLyoLnqf11jJxzi7XP7icTGifXh8HPdPwOvmb7A1BFcfY2H1yrgpQ9LL1WPc8f4dqfuE91BNq8DtcEql3/06rGk4gsNyWI77GnH9IKwUsAFlrpUmA3zzUPojorig8/2Cbd3TjsCKM9wxliCLyKPngKsM1KFkqM6bMFtyxYYrU2eewcxYM6RkLIzuCbt2tjjkrWkSVoIS5lGaeH9ACsgsCD8uBJTg2FG+jOXwTTSCvGIWOiSPmrIKKcqEISVvUcMWhHEeUKjXTMdtBmPl8s4WipwTYa2j7rmaa0RNf7IXAOT77NGep/q0h0KdWRo5UPERTufgAqHgtum1dZEPq6OH8ILA+nokd8MXPhCko+zgkNqNlrLQew5ugiVBI+TSaF0+Nh/0lIpsCoBQWlDacVD+Vx3x3aSXTbkp6URafBo7r4W0YMJYL0MnwFM5mzSBvH459mHAZ0yzT09dEXgjVW9/ggg2LxRO6yGo5FTpGQS5EwMSjG3crtd3U4X4CO+KX5W46TC5B/X/DpEipFhWLaE6rpYO0r44KwsS9Ge9H2dfFY3QNvXA1sWHN6WR25HgQ091u/FmxcmTXpvXerH0b5xRi1MwmGmrK4ZAT1TapoD8+smzXuW4xfFWkVDOL7zk9xNtB53A3+dJrIzc5OTB601UXSFtQkX3hWaSnhB0fIWaxp9w7vGQDYtDAeTTDigrLMhVNfLUpJcIxhrMjO0Amicb+Ubauev6gApJbByzVQRTWq047GGRSYgxukHnlk5+xWTYTi31cQQCJ9ILZRJ3tV05M1AIgNeeDW2H8IBJqkzSl9nnKSajGYOD7eMyjHHWbG4SEV8CvAH8Iew6SodPSlX4spOyb4O8XdYQ2bne98jMMolgBIbc8j1VfPhmdPcqVcmf5qMjZcC2VzGSMF9s4863hYPVGq86Huy5cmg6zBz+qDU3yje9vmEr3yJ6kZhF5z8UdlkJdjq/581O9VuCR2B3lyEAfQoUZot9HdVILawreyRxAy11JlpE3UoO/fi5/5omkUs0A7Gvb5+bsteFVIW+9l+qR2dINow47smAidv0bLLEr/yqKcUanjvixyzAQCM5CVzq0r7rDR9M7wjLxBq9eBWRVmyK9TfSJqXHjL8T3l8phqzWGZrkRC5oiPO6C5Wf59fFDP+ituUaiEqytebX0Feyu7U5Leql5gBMTdDPsmK7KUOyA5TuWxjGc7dN7kJKEYpro0VWRhjMArMIGbutu6vN2OSHb6nvd508S4Q34uCRKu96bSAD7YHASNVhzXv8N8jroYf5Y7E9s4wTpkvo3BZkkWqpF0M1vka3jjUC/JuZvw9V8avX+D9bciICl12vr/bQJxDe+TN9MQwDJwOe5HRWZKtCtH/1/2brHVDE381FF3JIILjZf20UTFL4MLwmZtFv3M88Bv1x6hEyoaAlZ5p5QEWzlw8bJBt8orARhiododtduYtJBSF7octT9JzbeKdozaif0LBWL/u9RjbeVNLZ8UV44Ye6Sz56Vn8QlwftWL01WoPryii3ZZ930Zx6Ins/HGvGQmHAD+2qvuKQAs8Y6ublb+Dvhp3Y2NNMjsuzOvb6m4YtkPzbhlctKadex8tBQuo0zhmSxfDIZm5VnEDdG2vZ6kcykYFxgAz3wrkVyXQnwxyQIeYMIHQYT+257jBWD0yJIiC3PqmohMzTC/65XVgSsowG2kgnlR7pYY18nBQ8aVfJ64D79rH2pymM4xMU1Zk/OS14XiDcldhO0c0RhQxiPSY72XYxpiaKVYmzOcEvI1PzQa7+LVZ6pBIwn8ffWvhqa38b3IskTs4RBkYs9i+i9/AqdAQg2IOeWv2fuo5tEcFyefI9nATJXQchbBEQO2Cj3kaBe2X+81o97B22kYSwjOkgZybf53qZFQ6p/N0dL/VnuL1cYTGi8k6rMpkKGx4j+Mc/fcHUVNXTKhyO10FkvHiN+qSbJGepJ/aLXoLZ8RET0Bshv/4hAQgzeS7yl0n74cedqdnmAeHmQ2CyXvMM0MWpEvA2ezZIKU+WvUSaGpTt1kvMloerqnqxHLfT01Yh2n3iD29EWnrQsyjedi1I5SUgvQKBM9G+oAai15cO1con2QFz3UK7w7ZgzM+vPmbk2QqR87fzlbdTSAhrLXzqVfLnWBA/4+5aC+0BRMZ6iX9lH3QXtKU9D01K3HprdilL456y5lsl38VQaMbz9hk0LgquziMY01Znz2WE4ClHG9cF/e7stVmn89oNFUE9NZ1RAc97KzDEWHLoKwlCG6L20/2Gj7/M6PDhsvhY+FMzYRg+v/0jo2gPT0UTCfaLBDRVvKQgUSYPMG1dr6ox7ohepBUS0msHq/V7A6Y9WfKDgSLatqTzwhOXnuXAoFc1LsdlV/Nv7XHqg5TAohZGa1mOn44SyY1fyPMCxL1QmxvhBC7mxDyj9DUnBpbjdAzrBW0mUzZ51brDVW3f0A8oKL6FYBf0mwK6YxDMJogq94OPgpZyKHKBYvJXMfs6u0pYnEn/jPeTVQMK6uY9Egww5setjqwdQmwi1ea0/uoNw7QKPorCWZohFt4VB+HUy/ObjCDdxryIg/y0wXGMwFyftSyf0v/ESOVaUNOHg1aA0SQ0KOwx/oqBneMvSoxZc7SqvQaHcx3ZLg7I0FQgQ9799KuVGTfGNgWvzIMnHqMNnCyCLJMNoNQK9XA4Wkq+6tVuCUREehKj+szE6KlaSwgAPfb6JeGqIyBrjJK/wNw2yPaYB9wHia3A56M5r4OplAvdVjO1vrsc4I8LAy1zqqpo0yM1hfixHeLNDG6ufXaX/4mWxYpqL3hBHpPbnox49P3jj/wGgdZFaJe1JTer036xd0Xak5qCI6SV86xqAdAChv6sj7ESw0SU7w0leCi/08lfYfucRQHdzjO3JkA7lvHw0ouMCSCweP+ms5HlStT1HLlgQ/pkLQ0HiDkuoPtTY6fDW0UPlH3ebKJKJsiIlEwAnWQ1ExfQhfs1IRdbEO6sgyC7u2YqSye9WFoH3s0+d4P2X78UPcUsRitbiSflMds3+5ixk47wEAbwHOouv3l0AUb9zZIP32hh+8n3fJx3LXT4wqErJXRmufydvyJuKW5IkA+rD7B5y3hJGUFrf+je8x2WEZ93MMZZjKF3R4hY4E82J7y0z9znWEXqtnGce0dejOBkrf6CbP1VCh4ixhRvmOXO9yA0A2XQqeWYNfk1eUkRWlybRDBiE5SOOtjudxOpqC6Hv0XRqdL58/dsrEItVoppvb13l9MrZRKzOe/vtw9JP9aAkOa7ra6MbT/3YE4LlEJ5ticKWKe+rOGibg+N20Vx6Vg7J3byZG9+hIpULnZWH4Tq3LmlMA+oUfgAbbzPl3twbDuQozSElI95KSsXaBWevUxIWPQdY+4eolMlTtLwn+51SP6BWFEiioYy+r2Rza4OqKJPMbx7t0CZCtpMKxYQ5JCowbAH7J4Y3Eh3C04j1H/2a7qH3cVo01mg0KjVVR59qENmLLCnQ4LNMS3i2XshEK7QAIvi4D+egZPpMUywog3s+tqRiaGXIEMFp3rd3TuvLXVT9tpJGxjgQLGMKXmGL1MVjoN97by2NaOn0JoIbOQqeBIHTVbBYNON5DD3XP+rStPIfVbuHd+90TJpGh8BlfV0dLneK2wDMnndVGVvQLhvaQxu6sL3XsvtxmQzeFWUSHLeAlmTc9yNQKkXtOJWS9faewS8yotiXdJQ6EI1vpVOHgh46gljSllVDRx9qlH7i2QFU/dKpaQEbpAFUBI/eSUGbpgT2ORGcUGXXDWjQJQo+nCkQVnIMRUCP367os5Iw4Rb3LDvOi+/mwcBozzUa4WkjVcSIURKO3RTFCiY9j3O6C5MBS6Y0WbBooC0nOzhKxL8xMIIaM/tnyEzIdlABrz3f9XlCiQ0hh+C7/bNp14eUvnjcHWjBOSw8E7BjzeXkRQkpIuZSOriwZ8PiOLZxCkXFOQ4hbXa4Tu69lccJ9Hd0F1lxkg5QnAhhfx5WdcTkBH3SibBUMCLPb/cYypz6s4GGDMV5smYibldp//j9gbCEhqanpxLsoexOMik4SOt879z21iz+8V3wgG8CicQsmxcsqCc5QUqOZhnpO4qAFgzHF+noxN835P4xf5EsOcPvYWwtzK3WEYVGy5tuvxE5WZB246SGIDgeC4sMge0B4p70Tse4b6NjlPHW+90GmqnySqY83r0ilaew46qmwi4RzmOcPehbn4YPCoISjQ44RURV++dfU53vcKhkSj6cWuh75tdSSUNMysFwoP+lN2gGTwxOfrha9wWxDPpimhEBVrt6dcBIvdoUbCLTDQDZuUOVVhZP4sATqq8z7Ai0STnGxzKmAHG+3I+/tvrDN/OOTHwR6W5aWSRj+M5wmS5hfdvimlus2z4pE6RV+l6scSEX3XjFUVgbSuuufln4qZfmgBxNvIZmkPtMh4WHAtuqRVdgDOLksqdhjqc9jrNVpRsYL4L5fXaKhNXYNJfTorxbaoSpoqj6ZEp05xsc4y4Qryx7BRs3iYvuHRbCUsiCPmmGdUPXDn6H7woEjiz1YeriH6NPF5au5aVrtcw0DvEgLLKMuVq6QvzE1mu+x9AFhhIEE3jVvzGWs7x+IBGJ2hfG8Kb57q5sDsPmddrc0s2doavGt3j59SpKkbETAVxcSwwHbpAEsYTNPM1KhVl7EPpQp+gNotyPx7hI11xG47CrYE7+4xlCFpaDwvf9FWescjE9qNrcgCXvSeme0GAOo6QjsttWQcRguwWZb6OG1VPN2xZcfyUeEGLHhPkrziDDf4SHNaCcXXJ9CtFdyRMVueZNWqaoSKhpFI91MMLSXju3pGbSzJlM8FPf/oxZbRADvlZZCyb8fbb4mQVBZZ3GWV4hj4PCrLA1qQvEqs9XLsRnoal9WaSQhWRzLJmCurnGGRc6wxyAAejp0pAR70k0M8R+ziXphTbSz5jU2xp2cFe1EhegrqPqjFAtYWbYwsm9X969oYf76RSVpD5DfI8iDfFILBkfvnZaZtHikQ2tfNY1T0QOYafZ+dfiQjWZxqrDxXDWbc/jYZSbOzpgJ0HvC9wodOgTk5d5d9dmNrnM0LH8bvtI4zgktUZdf/DkYM10EF8yMhbFqvpMTi+TaLBUNd9aLSzSGAqu41xsKxsEYHFPhxozYZMPCafc4U5t8Ja7k34czb9pTsN2JFnwl8AmZSpI39KzBoEcD8fz0CAcio2KlaDIhPF8V0HkEbwc2c0mkpBazhOMI1d4cxnKG15nlJ+haP4D9g/H1z7jIEHS7enL9st+r19iJpqLFuJiKD2NT7LXyBzaAcFxIJ/fo4roeZSvHUyfgqUjSVcPiszEAuk4Fgqjxih+ln6TZW8b5sbDIvrB1Ul++c1B63XbFgHdVJTaRPzIXeh5f5u+QYvfa7pHyQV0ZUIv4SnfFMvTC0g0/fdaaBd9rcpxu/CBpbobKZgCIyVRDZGdPlZs8UGyu7+Hxb64E/k0YIIyG0d7ZSIcU1dOwyAQt25Ow5B4W/oUhgU+Gf+qB/Eqf+V11+GylEkiyGag2sSabnAwgaqTr549u7USX8FH6EnKLv1g9jl2zIU7C6GM3aeDn8kP+9aBM0Agrl165RV4/UHaXPnrBjs3YOHlrMK9jziNkwwt6+rC5FPPvSm2uVuOQouD4+Rk/8X2VoT+8bijB9PNpfsOsNhiSOVgntu7dzfzJItraFExs2ylPt0vanTgZJP3SIxPvZsgaDSBNmxIh0KPLS+EZkJ1Xy0gY8WVOZDbYF9v0GJta6+GUy7ek8lisYumJ1nyw90NF5n7L6H1aFMYqA/WI2COJA7pWaf9Ugf5pniETIJNyNXtonwZOLeCG380p2a2m5Fs4WDJIbVCtkJ77ah+h3HMvJJ0fzW8OXfnZDuzbWB935lP5zr2+vOc7CL44LjNt8p2deJJKd+d8n1mwKwxWxUjkxJRVlpIqwq1a+Sfeu1oNGDaOXyS/LVoiWAi4/RFFK77j8sVBWyTeqc13DCYWKdEbHTgEcIdtBewm3fvU99V8J4gYLJijdis2O/D+3FBz8kG/SwAXwjzKgO1TmXuA3syLPxxfnEUxttkUPpzQJgAzcN6o79tpHr3QWX3TVy4USKZJPX/G7/sFv7TB2RKaM9LvG8518UTl/oNK6/mqMpSOqsv0xRVzNjumgamqz/e3LG3e1lkrW5SquqlrDJIrN90AProjO2hsva2vAv1ZNPbHVfvH6K8KnMmDbXcZImS+YAXafdXLVILS/Q0MSKuRaLPQABT6AsH1SpBlkiSLXyhT/gT5IbfD6Z1Jx0n7l33o2uGW4lgd8BRn8WUeEHBHEn2SCXVQwlREQtvN7iSC2y8qSngF4ytc3vgOucrGccauebyUn9sdKmkhMom+XHRGLg4yr7NW/ZAq8UDCTjimw0unj204NYoihtZTNdXwgmCpqzA6Y4a3S/braI7FEXELgpjVSnB+dqkyFq3Tny2G8lAz1OtN0TZdE3wgbqL8XtsE5Ut1NayTqmPNmEhJVC0f6ZfMop0HP5VawTxA+lq1XoeRAoIGH0ojuV+9O13sh2V2zoxj5jVyNGuZDtqZVlEeSIRI05PVi7nZfKw+EuT5YTkdX/qnx/AmQXABJR8mEbt5A8Oab2RqMdG+P0zvDI0gODnGDSO2w4ZOrD1zi5LnYaIljibbOMhpDWcwsd6Ry5eUmiLQ24OpaErO6a3/sYLybm9xOJLqfn7DNg/5SKBxEfKNyyUYP4KtkSMQI5Xo7dHcIhqH4l3CRK/gB7WtFU6bj0mReNJIitL8grYbUyZpqDuMDT5s5WQsWjOEmRSbMiH7HIkEIPvRu0WxMnRCJKjGFWdlKGqK96T7jlsEHCjsPjk/9VEQ4W5qB2tRAFGJ5YGgbmyYxqxGxduvkNdd3IZKcIbvtEtH4X7aHeyV4Dcn4wkEzUNRRhISM51Av5I1mwi2lj3DP8d6K9iFzNVDCSb+eb9pBu+SEqYrvFC8WKSi8OcZDj50KV871120hgz6n6OZy1KOh8OzKNuCKFt9mVlUfJKzD9gcuL53q+oTHGGIKFz4+4/zLC13N3l3y4Fn9dzM02uGyBGoJXmF3jrwW9OguOsh1FVykE1suM6kC/e005VRngkgcn29tixbfGSx7k8JzTId+5wTXE1HgKXCtGlwA7L6FxS+RUGGP2az1Em91D7THACjjqlVdoDOltQ7Yb4S8n4kG/m/CvtFfQB0e/e/JMgICLGKds6v5THENB7WYOdJ0P5s3GQzdbeXjUAG5Y2WCUBs5LZ6xDZzv1L7jfUHqBbmnHW7U4g+UTYB/tW7B0Ya0JAbpzWFSoVQH6CbY6q9fM8ccelwWdxeWdjZm+TcmBAHpje+emw8T5mUgl7Omvks7D2xk04/HjynzVyBN2dI3dBgxTkB1keL9tMN0WgyjY0ddKI8pigHP9lOa8hb7F2bZIa/FqS6JJPPHnlyPbVl+weIG7j4ocmWH/OkvaT4qtcbnafk2ocwOkjSqUob66ehit1UDMwKXreD2R92MZugTHNe/PWAZesANg9eBbm2p+4kqK52j8MW3AhqaffDN+kK195DUM4FLVYm8BQhOF+OWoM5tTD8LImCNRenutbU6qRxpaMDXCBU37/K3Y7eobcg/IaZaBuw44FteI67Hdgufk5VqCDjlK7jDBUtVq07hpPI9ymWW/m3nNLQlusNGDSBNYXOUBDRWNnHira/1eo9GEwVgpXn2tG1PUUxT15p/fbfGXCvpsj0QlzwErC0ge/Oqlsh7E0QhpqDAcvlBJOiXDD/bv01SkM269rmghWHJPUbmpq4trj7H6cCMXMIwWgOLaTXR0w3tamzJpReC8FXDNwkxSCbmg/ag17JdPyptz7mR3k6KvXor6tFCfEv85TW7CDWLEap1AC12Ym+LK9/CxdKPnXz9Qz4xNXGn3sG1wAfthifQfjDyiCnLo2uhuMzI9yKxH4PUTt52mReMLmnHFrrLpDYcPC+cU7ge55guYhGv/ANB92YzoXrI+Hs6gdXnnfE8GGhfydGwvKBKCtpDecGnu41Mz28j9/LTVtSV9WZEoxANMgPGo4BDbY2p69ixYGQWATdyg9TRDAK7f/Lrlubat60yuVZ9wcwqZ7NBP71mX6NEgdvfK1EgMnkZzsDQl/wWDHdAoOYCo4pKwY5I/V26cKTO4aMYcV/YDdgglOtas2KtIXBJAcgotsV4YfF+CDN4T5WdX808VdXh3/UXLrAdcMDF3QIXj1HyUHIOkXBH7DXICbJt9eNiowRXiuB0d1J/FqjPFe2IlNdXnwFwpRusB5PLSv0Lk/AdI1gQmao8wwLmnoh/L9riMbMMsWAOI+5B71d+lGTKlxx4hQn4ixRfedyZUUsRcpGrgAS1XqCKzggl0/LFuyQpe9BsgvZGkEHQ4ELkl6bcLtiHZ+7uFxmRjnV7v8PP1Whug1igIT3OTMnmb/dGJPuGKY5fRdvWoatxfNU3ABi+fY7eHiPqC0gQDpAC19twVfWBtBur+ST+y7fzmSE5Q0C3mcp8/31XIdqm7sEZJHtFnXBgaTyG+fWRGAY70K10IBvKH2TE6IMzm1k92/Cn2payTupKTtojgP3uaWIgFVgV0lD0WGR0PanqiKtrBFwqznvb/rz2PgpSjWd2BESLQpxY+6tmKXZnjvY9xfR12CQ8o/aKz1t+XxCSzy0uE5f/kaFUCrwxjL8gT7SEUJshp//5/yvPFJHgJlgsvXp+gRQCSzz+vS6rl3BhMsbj/HzwJYz8GsWppOQDGVswlOHEaFE/qhImhDrt2DUfNxtt21GW7KwJRn9/mtYIjlnnwgESPEpwoLyTru3SsVGzRxnZG6x+BiseUs57lTdb3H8KG7UPeH1SSjy9wZHELnar9x5cOtOR7lOvyjWm4Ab18Q+qoMxxLCFit0V8SmOu7AU8XGY3eSXb6Ly+kaQmDkRlOstgmcj+rD34KNz7LTvLL0O1Z9J/nCjp+1flOFgtbd7Yg0t5eNrPuppxYxJfSpnJRNL4S3YTffnV+x+zVsuioseET/On2wNi/TnL2rAQIKswi7Er3Sv48D/+PLsa2WJOSk6DqcCLmusILDiz0FwKEhMewrxtNyM2IAE0/6hiopIQoUgC6U8CLirhWbfVibSnCGZlF5uywIcaUlcEaYP/evokbi1NSquO62XNnWR4+fB3M1N7LaI5pwdHYOKEjg9OaSiTtEDypKGOVxZhdQS0jEvZ46foNS4SBpwZfPn60p6pQldNUmimhWeU5LUnEpZYjPJU6hmAsh4AKaLFfJANrZ9ou428yoEIFuiY9UgOYkqtSUocWxyijxK+NTtuDdbh7NJcyLIl6CUBWQjZiL34Bk0Qe3vmT9tpIKus3r5CvEdEu5Va2Wxm8CQJT9bESzuFBeH0QIRybKFAUVqNa9tCXukd1jwLXYKWsuMuFda8R1UjVG2cvAZ+R3lBV+nLksL4Ti6lubX3hKFcSyFsG5rK9pJt5nlSGIkBLP/HFqLL/KX0S96NdOo4CS+GYPBk+lBZxz6Yie12vvUj8l4t1ik/5PmvbLOTPCcaoPeZ7APUQIKIcxcNUDin3R1okbeAUGwt7Ja3G0ntQokBhlajisyXeqbfPLrTTKpTauclKp+DGdyBsbzFHEYtIqZnlLe5wjluF/UID6EgwWPGj0FVKM59Jom3+0Y1QTb+IKqHZv/0FIEEuVItlJHSixdza2w0UN80Hyc/eUGv6SBybC/EEs9cOcLBR1eeQXXe7p7hfIhtxxBrGhk9n7jom/4LXF125WzPmMCUiNyE8iO7sVSmRf/iSNFBveZWGPeCirfJ8a43fk5jCfA3NPEJyMAamu3Q5im0DKo8aonWXtye9iE8vraixlVTAGSXFMjP3+XiOE9jrnXTDzARnt7+9gvHctQpaAI0za6N7bq9R1lb55jILwmx4Ih4OA0K1/Xx7B9jytPFBRhEO8xqXLhxotsIRjnGRvnkMK/KJ1YhE9T2mNmclLYgMSn+7dzik8BzoHt+EcXstV8yNpTspqsnS96ATq3A66NbF449w9JqViBt4gWi7yVzt3kR4XSJ8iEB5anMqG+EsSyrMQVv0sMeEysGx+yYs6G2xPJw3zqTq4RzDQXPhYra/VMlt7E8zzl4D7L3HS3kkWf4ZkmFmnjcENPQdkmohl6p/gqkOg+8McyzNxxb5Fl19DsSr3MTuSMqhSKDn95ibzYCEdrZXJiKaqu7BFBuju+jSObOPchog2IsE/u/3U/UK2mntvSnD0qNkPYoRTskBnLJ3NJamL0V4sEbryX8NMr7MKMJ0+h2+xMKY4KERpvUrd0c6ABXWHqLdY1QTugC/5dhdoLy3+KwgG5FnL0MZw6qvOvHkKQRoQrcKLuwUld15s05QxurH67A9eAr02a/vUWNBIgP6vOa69ZZuZKElWttIerRDGIAkZ54fw7HBctSZtfspPxaliwbOEH/Laxot3ZQonzvXknSVodzZHA1Jw7BcNRsYvl+KJ0Y6pMRPpIbaN/QSuHtnjUoej+vlVhq5021xMUPKxCK/D8rSRbOmduHG85/JrIimgo5wXWP83lLvRaxwCxeTGVt44fTUqsfUARmQcS3f5DbHR9SZ4nJYIEvcCjIqLezJ3I6S7xBop57j3ZyMQX0Xxr5mc6IUmrlOXM9fJG5iDZQQ9rWsGZ0Y26GzTAEsD6pjPuDa1XAT1MRpxyZ8zN53sl1YEV0E0EHvZqcnBnqMTXRh6zC9PwDXEk3OHs2zLLIjBhY5+7lDxp1X0qcm8XtWorat33mUx+kEDDgaDUdpclQq/ZM6mMYoF433nKbCKDxCozugSPVaRjNPosMDy8FujvIJSb763XuBGBIYLS9x+HZhYiUa9xod0xKV9aRt7yczWWlLgfK8qn4fULHMBSP48m/wTWfDBdTH8uDAKt5WM033+2bCpxDhmZtE+d7XP65yBTOf9/EWaCG+Gs9/5kVbWS0JlfoDH6Si2tVCzCRGfV0XZAUWfXOMJ5F9dkMagbwaeqVqqbVONDQGg8zID5MUV7IkazdAz4JLOXsn1RuZnoZNIGV2Na15+dRKYUAmXFmkWBJpPMBwT8N4bd8VZwBnhm3WzH9S0sbpoP0sgf2OmPvQ6smMyfkVK+OLjXYubmtioAhdwDb5/pLRg3PGwfHEz6v9OOe4AK8iw2cma49tV44In8Rc9jGcqSQlFXPdlC8366ke4U/ITFy0/SQBl1vWvGk40KycwWGaLf8cCtEi/4X2W8961i6lYnpfNQhGcQyC8s2oIOW+Pw545Thq3ZBEyNC8YDr/pzCEmBI8U3A4IiQJoHiD9kUMNd8wfzysC2Kqc4OGeWYsJxmDev4Jn4HV+vqpgN6xxSEMABhRMdTteHiJAgnQEX9BR2V1sNqh5EcMvQNYYa5+bblQn7Rli1UFCtQkP6ECmGkxmPNkg2CGS2mmf0/WEuTZSyPMtbbrnftPgleOmJ3jSm0m1EU9fQHQo1NZti+KczpJ8mSYIVtXzXh4rNJcL3Fm7Bbftpjmj5UnuDpPk8HvqKOj2DGJyk4R0Md1x7umiH0DTOXaLwO0EI94k7n6R8nfqiwekgUQZ1rRek0HViM5YN0JLWp4f4NRE8ErcGNSHZd58+9Kx8lmkc9ogfQmX0rX1kB8QQzNbH+eVDee0jOQNUgQcew3y+0QbifXrtLHXDIxsqsej41Kz7vfcQRE1zUnY2phYNILK8a657zyHNMzPiRhxs28s1JX2kiCMEloubOXnc8BzU+n7LM9wztf63eFWN/eWHXVivSdCWg5DfWsk2CF8aFJrOP277QEPdkWlOlewCVEkLjyd5wUn9ZzaKOJKnDQDLfliiRLTKlU8TOeQj8jOU8FfpM9tayJTDpxw6sVlZuJRAILfxn+QAGIB/W1FGDjuuVu62hFDBdvzVSfge95Ebf9pclp0GrpV3S+gwBWn5J7aGiim/fRyIN7YVVXJsnAnVeq90vDdAV0XearTqjT2Ck/AMkBW6T/ls/6VUVnFWs01wxkahKR0tRwyLRKgHefm3RWie/pTVQpUMZw+/7ozQSW+7vuZd8lsvT1iX5rwlpiaFnOnDbHsr1As6vLETd5HVbcBCGbJHcS7ax9Byd50jdYyagUtjAaHYX8ryyuR/bDkw1o4j8+hXMfbzy+CVmgrfRDyl4dn+5LxrqRAXLoDKpQREAHqdLSsVSJh1s8KnZ/SsUVq27cq+O6LMSBmhT4X3E750rmWwCsoCre6bT//oFWYALjp2SbcxnULBaTvnYDHtfEbO1m/3c9nJk8ZO5KHQTV88ivTWN/S2EXwmisTPdcupMrvI8e48QZdkZu9WHyKron7MKhGFJw6Z0KZ3tleVrvvJo89siUwByPY+Hs4gkKPBQbLQOaedcv/xeM+Ih8rl1eHEC/C65xWVciToVqSGp9HfbhVzFSrO6kBnv7mJwnRLvMEwqiNankVdJJMw4icU3lKyw/ecNSWIUddqlbThYMiq8nHjRRufs+28cq0OI9zhpvxFvFgSZE/eAYvm0x+9lZO+EH9NkBngaqU1NMYhdombNuy3awUN9p0mJQ//e9L65YbShgoc+ZUlNy+c6F6gDEHXV0JrzevPIZFAe2RyRa2dNqzLvihAAMCszYueqszzXRkSyobx5+LTLK2V3lfg3wbS9DzP3QW7VHdHbjZcttQRvtjrGveJnNn2DE2ZDIbvkCrT0H8RzbGDdmIq4P1ey+hoY/W6NuZKOz4dv4HUNznxdKV1Wf3MvqUv35r2jTKvpPWBUWNm5fytX/QJwp6qkIOsSx7Y67BSCbCDVLM8/VcMG+T0j+INrgL9sfT1ICtACH8BI0G6ViUZPVzzCmQHW2oVIwZjAoFl6+meO/pD8teO1E+1y03mCpYfW9S8qhtH2GhlFlebPf4NbezVv9xbXKWz0xezRNQWqUqtYRTUbuzK7KTvjG4rQHfzBpVmK4wDLnSIwdSzTSk1fPNeY0WOpPZTLlvQ59xwgfFrb326vT2hS1JAZ9E6sujFtKTiJ7bxI6o4cBhDaX+adXREThhR+MwA4TqD7rga/o9iY7d6TVRe14CS2S3iSQsD0R6ApnhG/2Wa0A0AY2NtWTjmabdKU+KgIRDP9RQYVjXiF1qC+xyNVG03I9vpmEpY/G/zC4nLOKgXAZ/uTikHI9Afbkhfgfgo9arWbix5eH7WUo9RQygDzwCnVSjbXc7MihEufVj6WGbK963pw8VjY3RS8IH1cy2yZbIcKLO5CgAUcXJfF2+McnDLKtXxyZaf7SPA6KJq+zF2NHyfoeTOwHhGqNcnHVr1hT73pcoyXyfvCYBnG1Bp/aR9t8hoI7CXM3UZOisWGA1SHZ2jf7k9GlRnp3mF/c1AV+JjvUsnZrsybEOQJg/dn/9eJkyykQHjbF56zgcPX6DdMG03WKUMlYz+uOZ+5DZy9E9MZOZ9GMoLFdrIPPQQLjv+GlCMpoyHPXkzIODjHAID2PrnaRpqWVHh0rnieDILKq+Emrd5RnjgE9pDUXWTmHaKuqqYlcgEz4zbi46dbWrAAFBjsQq1rLHIiPJEcwFLCOY4JNlXRXQJqCUKXk2d1RSBGzDP6HDSpo863BhVRFFF6uIpjQV7j5ebFe3UkkO/+coIo2BTAcgBqOtQ134s9a4QJvofuqBYMGOBMsWZ+sn/2AOxDx6SfAnDFGw==";Uint8Array.from(atob(hh),(e=>e.charCodeAt(0)));const dh=Uint8Array.from(atob(hh),(e=>e.charCodeAt(0)));function uh(e,t,i){if(t.getQueryParameter(e,t.QUERY_RESULT_AVAILABLE)){const s=t.getQueryParameter(e,t.QUERY_RESULT)/1e6;i.lastTime=s}else setTimeout((()=>{uh(e,t,i)}),1)}class fh extends jc{constructor(e,t,i=512,s=512){super(),this.width=i,this.height=s,this.clear=!0,this.camera=t,this.scene=e,this.configuration=new Proxy({aoSamples:16,aoRadius:5,denoiseSamples:8,denoiseRadius:12,distanceFalloff:1,intensity:5,denoiseIterations:2,renderMode:0,color:new Z(0,0,0),gammaCorrection:!0,logarithmicDepthBuffer:!1,screenSpaceRadius:!1,halfRes:!1,depthAwareUpsampling:!0},{set:(e,t,i)=>{const s=e[t];return e[t]=i,"aoSamples"===t&&s!==i&&this.configureAOPass(this.configuration.logarithmicDepthBuffer),"denoiseSamples"===t&&s!==i&&this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),"halfRes"===t&&s!==i&&(this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureHalfResTargets(),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.setSize(this.width,this.height)),"depthAwareUpsampling"===t&&s!==i&&this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),!0}}),this.samples=[],this.samplesR=[],this.samplesDenoise=[],this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer),this.configureSampleDependentPasses(),this.configureHalfResTargets(),this.beautyRenderTarget=new G(this.width,this.height,{minFilter:j,magFilter:K}),this.beautyRenderTarget.depthTexture=new Q(this.width,this.height,q),this.beautyRenderTarget.depthTexture.format=J,this.writeTargetInternal=new G(this.width,this.height,{minFilter:j,magFilter:j,depthBuffer:!1}),this.readTargetInternal=new G(this.width,this.height,{minFilter:j,magFilter:j,depthBuffer:!1}),this.bluenoise=new $(dh,128,128),this.bluenoise.colorSpace=ee,this.bluenoise.wrapS=te,this.bluenoise.wrapT=te,this.bluenoise.minFilter=K,this.bluenoise.magFilter=K,this.bluenoise.needsUpdate=!0,this.lastTime=0,this._r=new n,this._c=new Z}configureHalfResTargets(){this.configuration.halfRes?(this.depthDownsampleTarget=new ie(this.width/2,this.height/2,2),this.depthDownsampleTarget.texture[0].format=se,this.depthDownsampleTarget.texture[0].type=ne,this.depthDownsampleTarget.texture[0].minFilter=K,this.depthDownsampleTarget.texture[0].magFilter=K,this.depthDownsampleTarget.texture[0].depthBuffer=!1,this.depthDownsampleTarget.texture[1].format=re,this.depthDownsampleTarget.texture[1].type=H,this.depthDownsampleTarget.texture[1].minFilter=K,this.depthDownsampleTarget.texture[1].magFilter=K,this.depthDownsampleTarget.texture[1].depthBuffer=!1,this.depthDownsampleQuad=new rh(new V(ch))):(this.depthDownsampleTarget&&(this.depthDownsampleTarget.dispose(),this.depthDownsampleTarget=null),this.depthDownsampleQuad&&(this.depthDownsampleQuad.dispose(),this.depthDownsampleQuad=null))}configureSampleDependentPasses(){this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer)}configureAOPass(e=!1){this.samples=this.generateHemisphereSamples(this.configuration.aoSamples),this.samplesR=this.generateHemisphereSamplesR(this.configuration.aoSamples);const t={...oh};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.aoSamples).replace("16.0",this.configuration.aoSamples+".0"),e&&(t.fragmentShader="#define LOGDEPTH\n"+t.fragmentShader),this.configuration.halfRes&&(t.fragmentShader="#define HALFRES\n"+t.fragmentShader),this.effectShaderQuad?(this.effectShaderQuad.material.dispose(),this.effectShaderQuad.material=new V(t)):this.effectShaderQuad=new rh(new V(t))}configureDenoisePass(e=!1){this.samplesDenoise=this.generateDenoiseSamples(this.configuration.denoiseSamples,11);const t={...lh};t.fragmentShader=t.fragmentShader.replace("16",this.configuration.denoiseSamples),e&&(t.fragmentShader="#define LOGDEPTH\n"+t.fragmentShader),this.poissonBlurQuad?(this.poissonBlurQuad.material.dispose(),this.poissonBlurQuad.material=new V(t)):this.poissonBlurQuad=new rh(new V(t))}configureEffectCompositer(e=!1){const t={...ah};e&&(t.fragmentShader="#define LOGDEPTH\n"+t.fragmentShader),this.configuration.halfRes&&this.configuration.depthAwareUpsampling&&(t.fragmentShader="#define HALFRES\n"+t.fragmentShader),this.effectCompositerQuad?(this.effectCompositerQuad.material.dispose(),this.effectCompositerQuad.material=new V(t)):this.effectCompositerQuad=new rh(new V(t))}generateHemisphereSamples(e){const t=[];for(let i=0;i<e;i++){const n=2.399963*i,r=Math.sqrt(i+.5)/Math.sqrt(e),o=r*Math.cos(n),a=r*Math.sin(n),l=Math.sqrt(1-(o*o+a*a));t.push(new s(o,a,l))}return t}generateHemisphereSamplesR(e){let t=[];for(let i=0;i<e;i++)t.push((i+1)/e);return t}generateDenoiseSamples(e,t){const i=2*Math.PI*t/e,s=1/e,r=s,o=[];let a=s,l=0;for(let t=0;t<e;t++)o.push(new n(Math.cos(l),Math.sin(l)).multiplyScalar(Math.pow(a,.75))),a+=r,l+=i;return o}setSize(e,t){this.width=e,this.height=t;const i=this.configuration.halfRes?.5:1;this.beautyRenderTarget.setSize(e,t),this.writeTargetInternal.setSize(e*i,t*i),this.readTargetInternal.setSize(e*i,t*i),this.configuration.halfRes&&this.depthDownsampleTarget.setSize(e*i,t*i)}render(e,t,i,s,n){let r,o,a;e.capabilities.logarithmicDepthBuffer!==this.configuration.logarithmicDepthBuffer&&(this.configuration.logarithmicDepthBuffer=e.capabilities.logarithmicDepthBuffer,this.configureAOPass(this.configuration.logarithmicDepthBuffer),this.configureDenoisePass(this.configuration.logarithmicDepthBuffer),this.configureEffectCompositer(this.configuration.logarithmicDepthBuffer)),this.debugMode&&(r=e.getContext(),o=r.getExtension("EXT_disjoint_timer_query_webgl2"),null===o&&(console.error("EXT_disjoint_timer_query_webgl2 not available, disabling debug mode."),this.debugMode=!1)),e.setRenderTarget(this.beautyRenderTarget),e.render(this.scene,this.camera),this.debugMode&&(a=r.createQuery(),r.beginQuery(o.TIME_ELAPSED_EXT,a));const l=e.xr.enabled;e.xr.enabled=!1,this.camera.updateMatrixWorld(),this._r.set(this.width,this.height);let c=this.configuration.aoRadius;this.configuration.halfRes&&this.configuration.screenSpaceRadius&&(c*=.5),this.configuration.halfRes&&(e.setRenderTarget(this.depthDownsampleTarget),this.depthDownsampleQuad.material.uniforms.sceneDepth.value=this.beautyRenderTarget.depthTexture,this.depthDownsampleQuad.material.uniforms.resolution.value=this._r,this.depthDownsampleQuad.material.uniforms.near.value=this.camera.near,this.depthDownsampleQuad.material.uniforms.far.value=this.camera.far,this.depthDownsampleQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.depthDownsampleQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.depthDownsampleQuad.material.uniforms.logDepth.value=this.configuration.logarithmicDepthBuffer,this.depthDownsampleQuad.render(e)),this.effectShaderQuad.material.uniforms.sceneDiffuse.value=this.beautyRenderTarget.texture,this.effectShaderQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.effectShaderQuad.material.uniforms.sceneNormal.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[1]:null,this.effectShaderQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.effectShaderQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.effectShaderQuad.material.uniforms.projViewMat.value=this.camera.projectionMatrix.clone().multiply(this.camera.matrixWorldInverse.clone()),this.effectShaderQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectShaderQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectShaderQuad.material.uniforms.cameraPos.value=this.camera.position,this.effectShaderQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.effectShaderQuad.material.uniforms.time.value=performance.now()/1e3,this.effectShaderQuad.material.uniforms.samples.value=this.samples,this.effectShaderQuad.material.uniforms.samplesR.value=this.samplesR,this.effectShaderQuad.material.uniforms.bluenoise.value=this.bluenoise,this.effectShaderQuad.material.uniforms.radius.value=c,this.effectShaderQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectShaderQuad.material.uniforms.near.value=this.camera.near,this.effectShaderQuad.material.uniforms.far.value=this.camera.far,this.effectShaderQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectShaderQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectShaderQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.effectShaderQuad.render(e);for(let t=0;t<this.configuration.denoiseIterations;t++)[this.writeTargetInternal,this.readTargetInternal]=[this.readTargetInternal,this.writeTargetInternal],this.poissonBlurQuad.material.uniforms.tDiffuse.value=this.readTargetInternal.texture,this.poissonBlurQuad.material.uniforms.sceneDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.poissonBlurQuad.material.uniforms.projMat.value=this.camera.projectionMatrix,this.poissonBlurQuad.material.uniforms.viewMat.value=this.camera.matrixWorldInverse,this.poissonBlurQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.poissonBlurQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.poissonBlurQuad.material.uniforms.cameraPos.value=this.camera.position,this.poissonBlurQuad.material.uniforms.resolution.value=this.configuration.halfRes?this._r.clone().multiplyScalar(.5).floor():this._r,this.poissonBlurQuad.material.uniforms.time.value=performance.now()/1e3,this.poissonBlurQuad.material.uniforms.blueNoise.value=this.bluenoise,this.poissonBlurQuad.material.uniforms.radius.value=this.configuration.denoiseRadius*(this.configuration.halfRes?.5:1),this.poissonBlurQuad.material.uniforms.worldRadius.value=c,this.poissonBlurQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.poissonBlurQuad.material.uniforms.index.value=t,this.poissonBlurQuad.material.uniforms.poissonDisk.value=this.samplesDenoise,this.poissonBlurQuad.material.uniforms.near.value=this.camera.near,this.poissonBlurQuad.material.uniforms.far.value=this.camera.far,this.poissonBlurQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.poissonBlurQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,e.setRenderTarget(this.writeTargetInternal),this.poissonBlurQuad.render(e);this.effectCompositerQuad.material.uniforms.sceneDiffuse.value=this.beautyRenderTarget.texture,this.effectCompositerQuad.material.uniforms.sceneDepth.value=this.beautyRenderTarget.depthTexture,this.effectCompositerQuad.material.uniforms.near.value=this.camera.near,this.effectCompositerQuad.material.uniforms.far.value=this.camera.far,this.effectCompositerQuad.material.uniforms.projectionMatrixInv.value=this.camera.projectionMatrixInverse,this.effectCompositerQuad.material.uniforms.viewMatrixInv.value=this.camera.matrixWorld,this.effectCompositerQuad.material.uniforms.logDepth.value=e.capabilities.logarithmicDepthBuffer,this.effectCompositerQuad.material.uniforms.ortho.value=this.camera.isOrthographicCamera,this.effectCompositerQuad.material.uniforms.downsampledDepth.value=this.configuration.halfRes?this.depthDownsampleTarget.texture[0]:this.beautyRenderTarget.depthTexture,this.effectCompositerQuad.material.uniforms.resolution.value=this._r,this.effectCompositerQuad.material.uniforms.blueNoise.value=this.bluenoise,this.effectCompositerQuad.material.uniforms.intensity.value=this.configuration.intensity,this.effectCompositerQuad.material.uniforms.renderMode.value=this.configuration.renderMode,this.effectCompositerQuad.material.uniforms.screenSpaceRadius.value=this.configuration.screenSpaceRadius,this.effectCompositerQuad.material.uniforms.radius.value=c,this.effectCompositerQuad.material.uniforms.distanceFalloff.value=this.configuration.distanceFalloff,this.effectCompositerQuad.material.uniforms.gammaCorrection.value=this.configuration.gammaCorrection,this.effectCompositerQuad.material.uniforms.tDiffuse.value=this.writeTargetInternal.texture,this.effectCompositerQuad.material.uniforms.color.value=this._c.copy(this.configuration.color).convertSRGBToLinear(),e.setRenderTarget(this.renderToScreen?null:t),this.effectCompositerQuad.render(e),this.debugMode&&(r.endQuery(o.TIME_ELAPSED_EXT),uh(a,r,this)),e.xr.enabled=l}enableDebugMode(){this.debugMode=!0}disableDebugMode(){this.debugMode=!1}setDisplayMode(e){this.configuration.renderMode=["Combined","AO","No AO","Split","Split AO"].indexOf(e)}setQualityMode(e){"Performance"===e?(this.configuration.aoSamples=8,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):"Low"===e?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=4,this.configuration.denoiseRadius=12):"Medium"===e?(this.configuration.aoSamples=16,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=12):"High"===e?(this.configuration.aoSamples=64,this.configuration.denoiseSamples=8,this.configuration.denoiseRadius=6):"Ultra"===e&&(this.configuration.aoSamples=64,this.configuration.denoiseSamples=16,this.configuration.denoiseRadius=6)}}const ph={name:"GammaCorrectionShader",uniforms:{tDiffuse:{value:null}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 tex = texture2D( tDiffuse, vUv );\n\n\t\t\tgl_FragColor = sRGBTransferOETF( tex );\n\n\t\t}"};class mh extends jc{constructor(e,s,n,r,o){if(super(),t(this,"components"),t(this,"resolution"),t(this,"renderScene"),t(this,"renderCamera"),t(this,"fsQuad"),t(this,"normalOverrideMaterial"),t(this,"glossOverrideMaterial"),t(this,"planeBuffer"),t(this,"glossBuffer"),t(this,"outlineBuffer"),t(this,"excludedMeshes",[]),t(this,"outlinedMeshes",{}),t(this,"outlineScene",new i.Scene),t(this,"_outlineEnabled",!1),t(this,"_lineColor",10066329),t(this,"_opacity",.4),t(this,"_tolerance",3),t(this,"_glossEnabled",!0),t(this,"_glossExponent",1.9),t(this,"_minGloss",-.1),t(this,"_maxGloss",.1),!n.renderer)throw new Error("The given world must have a renderer!");this.components=s,this.renderScene=r,this.renderCamera=o,this.resolution=new i.Vector2(e.x,e.y),this.fsQuad=new qc,this.fsQuad.material=this.createOutlinePostProcessMaterial(),this.planeBuffer=this.newRenderTarget(),this.glossBuffer=this.newRenderTarget(),this.outlineBuffer=this.newRenderTarget();const a=new i.ShaderMaterial({side:2,clipping:!0,uniforms:{},vertexShader:"\n    varying vec4 vColor;\n    \n    #include <clipping_planes_pars_vertex>\n  \n    void main() {\n       #include <begin_vertex>\n    \n       vec4 absPosition = vec4(position, 1.0);\n       vec3 trueNormal = normal;\n       \n       #ifdef USE_INSTANCING\n          absPosition = instanceMatrix * absPosition;\n          trueNormal = (instanceMatrix * vec4(normal, 0.)).xyz;\n       #endif\n       \n       absPosition = modelMatrix * absPosition;\n       trueNormal = (normalize(modelMatrix * vec4(trueNormal, 0.))).xyz;\n       \n       vec3 planePosition = absPosition.xyz / 40.;\n       float d = abs(dot(trueNormal, planePosition));\n       vColor = vec4(abs(trueNormal), d);\n       gl_Position = projectionMatrix * viewMatrix * absPosition;\n       \n       #include <project_vertex>\n       #include <clipping_planes_vertex>\n    }\n    ",fragmentShader:"\n    varying vec4 vColor;\n    \n    #include <clipping_planes_pars_fragment>\n  \n    void main() {\n      #include <clipping_planes_fragment>\n      gl_FragColor = vColor;\n    }\n    "});a.clippingPlanes=n.renderer.clippingPlanes,this.normalOverrideMaterial=a;const l=new i.ShaderMaterial({side:2,clipping:!0,uniforms:{},vertexShader:"\n    varying vec3 vCameraPosition;\n    varying vec3 vPosition;\n    varying vec3 vNormal;\n    \n    #include <clipping_planes_pars_vertex>\n  \n    void main() {\n       #include <begin_vertex>\n       \n       vec4 absPosition = vec4(position, 1.0);\n       vNormal = normal;\n       \n       #ifdef USE_INSTANCING\n          absPosition = instanceMatrix * absPosition;\n          vNormal = (instanceMatrix * vec4(normal, 0.)).xyz;\n       #endif\n       \n       absPosition = modelMatrix * absPosition;\n       vNormal = (normalize(modelMatrix * vec4(vNormal, 0.))).xyz;\n       \n       gl_Position = projectionMatrix * viewMatrix * absPosition;\n       \n       vCameraPosition = cameraPosition;\n       vPosition = absPosition.xyz;\n       \n       #include <project_vertex>\n       #include <clipping_planes_vertex>\n    }\n    ",fragmentShader:"\n    varying vec3 vCameraPosition;\n    varying vec3 vPosition;\n    varying vec3 vNormal;\n    \n    #include <clipping_planes_pars_fragment>\n  \n    void main() {\n      #include <clipping_planes_fragment>\n      vec3 cameraPixelVec = normalize(vCameraPosition - vPosition);\n      float difference = abs(dot(vNormal, cameraPixelVec));\n      \n      // This achieves a double gloss effect: when the surface is perpendicular and when it's parallel\n      difference = abs((difference * 2.) - 1.);\n      \n      gl_FragColor = vec4(difference, difference, difference, 1.);\n    }\n    "});l.clippingPlanes=n.renderer.clippingPlanes,this.glossOverrideMaterial=l}get lineColor(){return this._lineColor}set lineColor(e){this._lineColor=e,this.fsQuad.material.uniforms.lineColor.value.set(e)}get tolerance(){return this._tolerance}set tolerance(e){this._tolerance=e;this.fsQuad.material.uniforms.tolerance.value=e}get opacity(){return this._opacity}set opacity(e){this._opacity=e;this.fsQuad.material.uniforms.opacity.value=e}get glossEnabled(){return this._glossEnabled}set glossEnabled(e){if(e===this._glossEnabled)return;this._glossEnabled=e;this.fsQuad.material.uniforms.glossEnabled.value=e?1:0}get glossExponent(){return this._glossExponent}set glossExponent(e){this._glossExponent=e;this.fsQuad.material.uniforms.glossExponent.value=e}get minGloss(){return this._minGloss}set minGloss(e){this._minGloss=e;this.fsQuad.material.uniforms.minGloss.value=e}get maxGloss(){return(new i.MeshBasicMaterial).color.convertLinearToSRGB(),this._maxGloss}set maxGloss(e){this._maxGloss=e;this.fsQuad.material.uniforms.maxGloss.value=e}get outlineEnabled(){return this._outlineEnabled}set outlineEnabled(e){if(e===this._outlineEnabled)return;this._outlineEnabled=e;this.fsQuad.material.uniforms.outlineEnabled.value=e?1:0}async dispose(){this.planeBuffer.dispose(),this.glossBuffer.dispose(),this.outlineBuffer.dispose(),this.normalOverrideMaterial.dispose(),this.glossOverrideMaterial.dispose(),this.fsQuad.material.dispose(),this.fsQuad.dispose(),this.excludedMeshes=[],this.outlineScene.children=[];const e=this.components.get(Xi);for(const t in this.outlinedMeshes){const i=this.outlinedMeshes[t];for(const t of i.meshes){e.destroy(t,!0,!0);const i=t;i.fragment&&i.fragment.dispose(!0)}i.material.dispose()}}setSize(e,t){this.planeBuffer.setSize(e,t),this.glossBuffer.setSize(e,t),this.outlineBuffer.setSize(e,t),this.resolution.set(e,t);const i=this.fsQuad.material;i.uniforms.screenSize.value.set(this.resolution.x,this.resolution.y,1/this.resolution.x,1/this.resolution.y),i.uniformsNeedUpdate=!0}render(e,t,i){const s=t.depthBuffer;t.depthBuffer=!1;const n=this.renderScene.overrideMaterial,r=this.renderScene.background;this.renderScene.background=null;for(const e of this.excludedMeshes)e.visible=!1;e.setRenderTarget(this.planeBuffer),this.renderScene.overrideMaterial=this.normalOverrideMaterial,e.render(this.renderScene,this.renderCamera),this._glossEnabled&&(e.setRenderTarget(this.glossBuffer),this.renderScene.overrideMaterial=this.glossOverrideMaterial,e.render(this.renderScene,this.renderCamera)),this.renderScene.overrideMaterial=n,e.setRenderTarget(this.outlineBuffer),this._outlineEnabled?e.render(this.outlineScene,this.renderCamera):e.clear();for(const e of this.excludedMeshes)e.visible=!0;this.renderScene.background=r;const o=this.fsQuad.material;o.uniforms.planeBuffer.value=this.planeBuffer.texture,o.uniforms.glossBuffer.value=this.glossBuffer.texture,o.uniforms.outlineBuffer.value=this.outlineBuffer.texture,o.uniforms.sceneColorBuffer.value=i.texture,this.renderToScreen?(e.setRenderTarget(null),this.fsQuad.render(e)):(e.setRenderTarget(t),this.fsQuad.render(e)),t.depthBuffer=s}get vertexShader(){return"\n\t  varying vec2 vUv;\n\t  void main() {\n\t  \tvUv = uv;\n\t  \tgl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);\n\t  }\n\t"}get fragmentShader(){return"\n\t  uniform sampler2D sceneColorBuffer;\n\t  uniform sampler2D planeBuffer;\n\t  uniform sampler2D glossBuffer;\n\t  uniform sampler2D outlineBuffer;\n\t  uniform vec4 screenSize;\n\t  uniform vec3 lineColor;\n\t  \n\t  uniform float outlineEnabled;\n\t  \n      uniform int width;\n\t  uniform float opacity;\n      uniform float tolerance;\n      uniform float glossExponent;\n      uniform float minGloss;\n      uniform float maxGloss;\n      uniform float glossEnabled;\n\n\t  varying vec2 vUv;\n\n\t  vec4 getValue(sampler2D buffer, int x, int y) {\n\t  \treturn texture2D(buffer, vUv + screenSize.zw * vec2(x, y));\n\t  }\n\n      float normalDiff(vec3 normal1, vec3 normal2) {\n        return ((dot(normal1, normal2) - 1.) * -1.) / 2.;\n      }\n\n      // Returns 0 if it's background, 1 if it's not\n      float getIsBackground(vec3 normal) {\n        float background = 1.0;\n        background *= step(normal.x, 0.);\n        background *= step(normal.y, 0.);\n        background *= step(normal.z, 0.);\n        background = (background - 1.) * -1.;\n        return background;\n      }\n\n\t  void main() {\n\t  \n\t    vec4 sceneColor = getValue(sceneColorBuffer, 0, 0);\n\t    vec3 normSceneColor = normalize(sceneColor.rgb);\n  \n        vec4 plane = getValue(planeBuffer, 0, 0);\n\t    vec3 normal = plane.xyz;\n        float distance = plane.w;\n  \n        vec3 normalTop = getValue(planeBuffer, 0, width).rgb;\n        vec3 normalBottom = getValue(planeBuffer, 0, -width).rgb;\n        vec3 normalRight = getValue(planeBuffer, width, 0).rgb;\n        vec3 normalLeft = getValue(planeBuffer, -width, 0).rgb;\n        vec3 normalTopRight = getValue(planeBuffer, width, width).rgb;\n        vec3 normalTopLeft = getValue(planeBuffer, -width, width).rgb;\n        vec3 normalBottomRight = getValue(planeBuffer, width, -width).rgb;\n        vec3 normalBottomLeft = getValue(planeBuffer, -width, -width).rgb;\n  \n        float distanceTop = getValue(planeBuffer, 0, width).a;\n        float distanceBottom = getValue(planeBuffer, 0, -width).a;\n        float distanceRight = getValue(planeBuffer, width, 0).a;\n        float distanceLeft = getValue(planeBuffer, -width, 0).a;\n        float distanceTopRight = getValue(planeBuffer, width, width).a;\n        float distanceTopLeft = getValue(planeBuffer, -width, width).a;\n        float distanceBottomRight = getValue(planeBuffer, width, -width).a;\n        float distanceBottomLeft = getValue(planeBuffer, -width, -width).a;\n        \n        vec3 sceneColorTop = normalize(getValue(sceneColorBuffer, 1, 0).rgb);\n        vec3 sceneColorBottom = normalize(getValue(sceneColorBuffer, -1, 0).rgb);\n        vec3 sceneColorLeft = normalize(getValue(sceneColorBuffer, 0, -1).rgb);\n        vec3 sceneColorRight = normalize(getValue(sceneColorBuffer, 0, 1).rgb);\n        vec3 sceneColorTopRight = normalize(getValue(sceneColorBuffer, 1, 1).rgb);\n        vec3 sceneColorBottomRight = normalize(getValue(sceneColorBuffer, -1, 1).rgb);\n        vec3 sceneColorTopLeft = normalize(getValue(sceneColorBuffer, 1, 1).rgb);\n        vec3 sceneColorBottomLeft = normalize(getValue(sceneColorBuffer, -1, 1).rgb);\n\n        // Checks if the planes of this texel and the neighbour texels are different\n\n        float planeDiff = 0.0;\n\n        planeDiff += step(0.001, normalDiff(normal, normalTop));\n        planeDiff += step(0.001, normalDiff(normal, normalBottom));\n        planeDiff += step(0.001, normalDiff(normal, normalLeft));\n        planeDiff += step(0.001, normalDiff(normal, normalRight));\n        planeDiff += step(0.001, normalDiff(normal, normalTopRight));\n        planeDiff += step(0.001, normalDiff(normal, normalTopLeft));\n        planeDiff += step(0.001, normalDiff(normal, normalBottomRight));\n        planeDiff += step(0.001, normalDiff(normal, normalBottomLeft));\n        \n        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTop));\n        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottom));\n        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorLeft));\n        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorRight));\n       \tplaneDiff += step(0.001, normalDiff(normSceneColor, sceneColorTopRight));\n        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorTopLeft));\n        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottomRight));\n        planeDiff += step(0.001, normalDiff(normSceneColor, sceneColorBottomLeft));\n\n        planeDiff += step(0.001, abs(distance - distanceTop));\n        planeDiff += step(0.001, abs(distance - distanceBottom));\n        planeDiff += step(0.001, abs(distance - distanceLeft));\n        planeDiff += step(0.001, abs(distance - distanceRight));\n        planeDiff += step(0.001, abs(distance - distanceTopRight));\n        planeDiff += step(0.001, abs(distance - distanceTopLeft));\n        planeDiff += step(0.001, abs(distance - distanceBottomRight));\n        planeDiff += step(0.001, abs(distance - distanceBottomLeft));\n\n        // Add extra background outline\n\n        int width2 = width + 1;\n        vec3 normalTop2 = getValue(planeBuffer, 0, width2).rgb;\n        vec3 normalBottom2 = getValue(planeBuffer, 0, -width2).rgb;\n        vec3 normalRight2 = getValue(planeBuffer, width2, 0).rgb;\n        vec3 normalLeft2 = getValue(planeBuffer, -width2, 0).rgb;\n        vec3 normalTopRight2 = getValue(planeBuffer, width2, width2).rgb;\n        vec3 normalTopLeft2 = getValue(planeBuffer, -width2, width2).rgb;\n        vec3 normalBottomRight2 = getValue(planeBuffer, width2, -width2).rgb;\n        vec3 normalBottomLeft2 = getValue(planeBuffer, -width2, -width2).rgb;\n\n        planeDiff += -(getIsBackground(normalTop2) - 1.);\n        planeDiff += -(getIsBackground(normalBottom2) - 1.);\n        planeDiff += -(getIsBackground(normalRight2) - 1.);\n        planeDiff += -(getIsBackground(normalLeft2) - 1.);\n        planeDiff += -(getIsBackground(normalTopRight2) - 1.);\n        planeDiff += -(getIsBackground(normalBottomRight2) - 1.);\n        planeDiff += -(getIsBackground(normalBottomRight2) - 1.);\n        planeDiff += -(getIsBackground(normalBottomLeft2) - 1.);\n\n        // Tolerance sets the minimum amount of differences to consider\n        // this texel an edge\n\n        float line = step(tolerance, planeDiff);\n\n        // Exclude background and apply opacity\n\n        float background = getIsBackground(normal);\n        line *= background;\n        line *= opacity;\n        \n        // Add gloss\n        \n        vec3 gloss = getValue(glossBuffer, 0, 0).xyz;\n        float diffGloss = abs(maxGloss - minGloss);\n        vec3 glossExpVector = vec3(glossExponent,glossExponent,glossExponent);\n        gloss = min(pow(gloss, glossExpVector), vec3(1.,1.,1.));\n        gloss *= diffGloss;\n        gloss += minGloss;\n        vec4 glossedColor = sceneColor + vec4(gloss, 1.) * glossEnabled;\n        \n        vec4 corrected = mix(sceneColor, glossedColor, background);\n        \n        // Draw lines\n        \n        corrected = mix(corrected, vec4(lineColor, 1.), line);\n        \n        // Add outline\n        \n        vec4 outlinePreview =getValue(outlineBuffer, 0, 0);\n        float outlineColorCorrection = 1. / max(0.2, outlinePreview.a);\n        vec3 outlineColor = outlinePreview.rgb * outlineColorCorrection;\n        \n        // thickness between 10 and 2, opacity between 1 and 0.2\n\t    int outlineThickness = int(outlinePreview.a * 10.);\n\t    \n\t    float outlineDiff = 0.;\n        \n        outlineDiff += step(0.1, getValue(outlineBuffer, 0, 0).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, 1, 0).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, -1, 0).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, 0, -1).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, 0, 1).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, 0).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, 0).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, 0, -outlineThickness).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, 0, outlineThickness).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, outlineThickness).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, outlineThickness).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, -outlineThickness, -outlineThickness).a);\n        outlineDiff += step(0.1, getValue(outlineBuffer, outlineThickness, -outlineThickness).a);\n        \n        float outLine = step(4., outlineDiff) * step(outlineDiff, 12.) * outlineEnabled;\n        corrected = mix(corrected, vec4(outlineColor, 1.), outLine);\n        \n        gl_FragColor = corrected;\n\t}\n\t\t\t"}createOutlinePostProcessMaterial(){return new i.ShaderMaterial({uniforms:{opacity:{value:this._opacity},debugVisualize:{value:0},sceneColorBuffer:{value:null},tolerance:{value:this._tolerance},planeBuffer:{value:null},glossBuffer:{value:null},outlineBuffer:{value:null},glossEnabled:{value:1},minGloss:{value:this._minGloss},maxGloss:{value:this._maxGloss},outlineEnabled:{value:0},glossExponent:{value:this._glossExponent},width:{value:1},lineColor:{value:new i.Color(this._lineColor)},screenSize:{value:new i.Vector4(this.resolution.x,this.resolution.y,1/this.resolution.x,1/this.resolution.y)}},vertexShader:this.vertexShader,fragmentShader:this.fragmentShader})}newRenderTarget(){const e=new i.WebGLRenderTarget(this.resolution.x,this.resolution.y);return e.texture.colorSpace="srgb-linear",e.texture.format=i.RGBAFormat,e.texture.type=i.HalfFloatType,e.texture.minFilter=i.NearestFilter,e.texture.magFilter=i.NearestFilter,e.texture.generateMipmaps=!1,e.stencilBuffer=!1,e}}class Ih{constructor(e,s,n){if(t(this,"composer"),t(this,"overrideClippingPlanes",!1),t(this,"_components"),t(this,"_world"),t(this,"_renderTarget"),t(this,"_enabled",!1),t(this,"_initialized",!1),t(this,"_n8ao"),t(this,"_customEffects"),t(this,"_basePass"),t(this,"_gammaPass"),t(this,"_depthTexture"),t(this,"_renderer"),t(this,"_settings",{gamma:!0,custom:!0,ao:!1}),!n.renderer)throw new Error("The given world must have a renderer!");this._components=e,this._renderer=s,this._world=n,this._renderTarget=new i.WebGLRenderTarget(window.innerWidth,window.innerHeight),this._renderTarget.texture.colorSpace="srgb-linear",this.composer=new th(s,this._renderTarget),this.composer.setSize(window.innerWidth,window.innerHeight)}get basePass(){if(!this._basePass)throw new Error("Custom effects not initialized!");return this._basePass}get gammaPass(){if(!this._gammaPass)throw new Error("Custom effects not initialized!");return this._gammaPass}get customEffects(){if(!this._customEffects)throw new Error("Custom effects not initialized!");return this._customEffects}get n8ao(){if(!this._n8ao)throw new Error("Custom effects not initialized!");return this._n8ao}get enabled(){return this._enabled}set enabled(e){this._initialized||this.initialize(),this._enabled=e}get settings(){return{...this._settings}}dispose(){var e,t,i,s;this.composer.dispose(),this._renderTarget.dispose(),null==(e=this._depthTexture)||e.dispose(),null==(t=this._customEffects)||t.dispose(),null==(i=this._gammaPass)||i.dispose(),null==(s=this._n8ao)||s.dispose()}setPasses(e){let t=!1;for(const i in e){const s=i;if(this.settings[s]!==e[s]){t=!0;break}}if(t){for(const t in e){const i=t;void 0!==this._settings[i]&&(this._settings[i]=e[i])}this.updatePasses()}}setSize(e,t){if(0!==e&&0!==t&&this._initialized){const i=this._settings.custom;i&&this.setPasses({custom:!1}),this.setPasses({custom:!1}),this.composer.setSize(e,t),this.basePass.setSize(e,t),this.n8ao.setSize(e,t),this.customEffects.setSize(e,t),this.gammaPass.setSize(e,t),i&&this.setPasses({custom:!0})}}update(){this._enabled&&this.composer.render()}updateCamera(){const e=this._world.camera.three;this._n8ao&&(this._n8ao.camera=e),this._customEffects&&(this._customEffects.renderCamera=e),this._basePass&&(this._basePass.camera=e)}updateProjection(e){this.composer.passes.forEach((t=>{t.camera=e})),this.update()}initialize(){if(!this._world.renderer)throw new Error("The given world must have a renderer!");const e=this._world.scene.three,t=this._world.camera.three;if(!(e instanceof i.Scene))throw new Error("The given scene must have a THREE.Scene as core!");const s=this._world.camera;s.projection&&s.projection.onChanged.add((()=>{this.updateCamera()}));const n=this._world.renderer;this.overrideClippingPlanes||(this._renderer.clippingPlanes=n.clippingPlanes),this._renderer.outputColorSpace="srgb",this._renderer.toneMapping=i.NoToneMapping,this.newBasePass(e,t),this.newSaoPass(e,t),this.newGammaPass(),this.newCustomPass(e,t),this._initialized=!0,this.updatePasses()}updatePasses(){for(const e of this.composer.passes)this.composer.removePass(e);this._basePass&&this.composer.addPass(this.basePass),this._settings.gamma&&this.composer.addPass(this.gammaPass),this._settings.ao&&this.composer.addPass(this.n8ao),this._settings.custom&&this.composer.addPass(this.customEffects)}newCustomPass(e,t){this._customEffects=new mh(new i.Vector2(window.innerWidth,window.innerHeight),this._components,this._world,e,t)}newGammaPass(){this._gammaPass=new Jc(ph)}newSaoPass(e,t){if(!this._world.renderer)throw new Error("The given world must have a renderer!");const{width:s,height:n}=this._world.renderer.getSize();this._n8ao=new fh(e,t,s,n);const{configuration:r}=this._n8ao;r.aoSamples=16,r.denoiseSamples=1,r.denoiseRadius=13,r.aoRadius=1,r.distanceFalloff=4,r.aoRadius=1,r.intensity=4,r.halfRes=!0,r.color=(new i.Color).setHex(13421772,"srgb-linear")}newBasePass(e,t){this._basePass=new ih(e,t)}}class Eh extends mc{constructor(e,i,s){super(e,i,s),t(this,"_postproduction"),this.onResize.add((e=>this.resizePostproduction(e))),this.onWorldChanged.add((()=>{this.currentWorld&&(this._postproduction&&this._postproduction.dispose(),this._postproduction=new Ih(e,this.three,this.currentWorld),this.setPostproductionSize())}))}get postproduction(){if(!this._postproduction)throw new Error("Renderer not initialized yet with a world!");return this._postproduction}update(){if(!this.enabled||!this.currentWorld)return;this.onBeforeUpdate.trigger();const e=this.currentWorld.scene.three,t=this.currentWorld.camera.three;this.postproduction.enabled?this.postproduction.composer.render():this.three.render(e,t),e instanceof i.Scene&&this.three2D.render(e,t),this.onAfterUpdate.trigger()}dispose(){super.dispose(),this.postproduction.dispose()}resizePostproduction(e){this.postproduction&&this.setPostproductionSize(e)}setPostproductionSize(e){if(!this.container)return;const t=e?e.x:this.container.clientWidth,i=e?e.y:this.container.clientHeight;this.postproduction.setSize(t,i)}}class gh{constructor(e,s,n,r,o){t(this,"mesh",new i.Mesh(new i.BufferGeometry)),t(this,"components"),t(this,"world"),t(this,"styleName"),t(this,"_precission",1e4),t(this,"_tempVector",new i.Vector3),t(this,"_plane"),t(this,"_geometry"),t(this,"_outlinedMesh"),t(this,"_plane2DCoordinateSystem",new i.Matrix4),t(this,"_planeAxis"),this.components=e,this.world=s,this.mesh.material=o,this.mesh.frustumCulled=!1,this.mesh.userData.indexFragmentMap=new Map,this._plane=n;const{x:a,y:l,z:c}=n.normal;1===Math.abs(a)?this._planeAxis="x":1===Math.abs(l)?this._planeAxis="y":1===Math.abs(c)&&(this._planeAxis="z"),this._geometry=r,this.mesh.geometry.attributes.position=r.attributes.position;const h=n.normal.clone().multiplyScalar(.01);this._outlinedMesh=new i.Mesh(this.mesh.geometry),this.mesh.position.copy(h),this._outlinedMesh.position.copy(h),this.visible=!0}get visible(){return null!==this.mesh.parent}set visible(e){const t=this.getStyleAndScene();if(e){if(this.world.scene.three.add(this.mesh),t){const{style:e,outlineScene:i}=t;this._outlinedMesh.material=e.material,e.meshes.add(this._outlinedMesh),i.add(this._outlinedMesh)}}else if(this.mesh.removeFromParent(),t){const{style:e}=t;e.meshes.delete(this._outlinedMesh),this._outlinedMesh.removeFromParent()}}set geometry(e){this._geometry=e,this.mesh.geometry.attributes.position=e.attributes.position}dispose(){const e=this.getStyleAndScene();if(e){const{style:t}=e;t.meshes.delete(this._outlinedMesh),this._outlinedMesh.removeFromParent()}this.mesh.material=[],this._outlinedMesh.material=[],this.mesh.userData.indexFragmentMap.clear(),this.mesh.userData={},this.mesh.geometry.dispose(),this.mesh.removeFromParent(),this.mesh.geometry=null,this._outlinedMesh.geometry=null,this.mesh=null,this._plane=null,this._geometry=null,this.components=null}update(e,t){const i=this._geometry.attributes.position.array;if(!i)return;this.updatePlane2DCoordinateSystem();const{userData:s}=this.mesh,n=s.indexFragmentMap;n.clear();let r=0;const o=[];let a=0;const l=this.components.get(wo);for(const[e,i]of t)for(const e in i){const t=l.list.get(e);t&&(t.mesh.userData.fills||(t.mesh.userData.fills=new Set),t.mesh.userData.fills.add(this.mesh))}for(let s=0;s<e.length;s++){const l=e[s],c=[];for(let e=a;e<l;e+=2)c.push(3*e);const h=this.computeFill(c,i),d=t.get(l);let u=0;for(const e of h)o.push(e),d&&u%3==0&&n.set(r++,d),u++;a=l}this.mesh.geometry.setIndex(o)}computeFill(e,t){const i=new Map,s={},n=new Map;let r=0;const o=new Map,a=new Map,l=new Set,c=this._precission;for(let h=0;h<e.length;h++){const d=e[h];let u=0,f=0,p=0,m=0;const I=t[d],E=t[d+1],g=t[d+2],C=t[d+3],T=t[d+4],R=t[d+5];if(this._tempVector.set(I,E,g),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),u=Math.trunc(this._tempVector.x*c)/c,f=Math.trunc(this._tempVector.y*c)/c,this._tempVector.set(C,T,R),this._tempVector.applyMatrix4(this._plane2DCoordinateSystem),p=Math.trunc(this._tempVector.x*c)/c,m=Math.trunc(this._tempVector.y*c)/c,u===p&&f===m)continue;const v=`${u}|${f}`,S=`${p}|${m}`;i.has(v)||i.set(v,d/3),i.has(S)||i.set(S,d/3+1);const y=i.get(v),w=i.get(S);s[y]=[u,f],s[w]=[p,m];const A=a.has(y),F=o.has(y),O=a.has(w),N=o.has(w);if(A||F||O||N){if(A&&N){const e=a.get(y),t=o.get(w);if(e!==t){const i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),o.set(s[s.length-1],t),o.delete(i[i.length-1]);for(const e of s)i.push(e)}else l.delete(t);a.delete(y),o.delete(w)}else if(F&&O){const e=a.get(w),t=o.get(y);if(e!==t){const i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),o.set(s[s.length-1],t),o.delete(i[i.length-1]);for(const e of s)i.push(e)}else l.delete(t);a.delete(w),o.delete(y)}else if(A&&O){const e=a.get(w),t=a.get(y),i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),a.delete(i[0]),a.delete(s[0]),o.delete(s[s.length-1]),a.set(s[s.length-1],t),s.reverse(),i.splice(0,0,...s)}else if(F&&N){const e=o.get(w),t=o.get(y),i=n.get(t),s=n.get(e);if(!i||!s)continue;n.delete(e),l.delete(e),o.delete(i[i.length-1]),o.delete(s[s.length-1]),a.delete(s[0]),o.set(s[0],t),s.reverse(),i.push(...s)}else if(A){const e=a.get(y),t=n.get(e);if(!t)continue;t.unshift(w),a.delete(y),a.set(w,e)}else if(F){const e=o.get(y),t=n.get(e);if(!t)continue;t.push(w),o.delete(y),o.set(w,e)}else if(O){const e=a.get(w),t=n.get(e);if(!t)continue;t.unshift(y),a.delete(w),a.set(y,e)}else if(N){const e=o.get(w),t=n.get(e);if(!t)continue;t.push(y),o.delete(w),o.set(y,e)}}else a.set(y,r),o.set(w,r),l.add(r),n.set(r,[y,w]),r++}const h=[];for(const[e,t]of n){if(l.has(e))continue;const i=[],n=new Map;let r=0;for(const e of t){const t=s[e];i.push(t[0],t[1]),n.set(r++,e)}const o=Xc(i);for(const e of o){const t=n.get(e);if(void 0===t)throw new Error("Map error!");h.push(t)}}return h}updatePlane2DCoordinateSystem(){this._plane2DCoordinateSystem=new i.Matrix4;const e=new i.Vector3(1,0,0),t=new i.Vector3(0,1,0),s=this._plane.normal,n=new i.Vector3;this._plane.coplanarPoint(n),"x"===this._planeAxis?e.crossVectors(t,s):"y"===this._planeAxis?t.crossVectors(s,e):"z"===this._planeAxis||(e.crossVectors(t,s).normalize(),t.crossVectors(s,e)),this._plane2DCoordinateSystem.fromArray([e.x,e.y,e.z,0,t.x,t.y,t.z,0,s.x,s.y,s.z,0,n.x,n.y,n.z,1]),this._plane2DCoordinateSystem.invert()}getStyleAndScene(){if(!this.world.renderer)return null;const e=this.world.renderer instanceof Eh;if(this.styleName&&e){const e=this.world.renderer;return{style:e.postproduction.customEffects.outlinedMeshes[this.styleName],outlineScene:e.postproduction.customEffects.outlineScene}}return null}}class Ch{constructor(e,s,n){t(this,"onDisposed",new Bi),t(this,"onAfterUpdate",new Bi),t(this,"onBeforeUpdate",new Bi),t(this,"enabled",!0),t(this,"fillNeedsUpdate",!1),t(this,"components"),t(this,"world"),t(this,"_edges",{}),t(this,"_visible",!0),t(this,"_inverseMatrix",new i.Matrix4),t(this,"_localPlane",new i.Plane),t(this,"_tempLine",new i.Line3),t(this,"_tempVector",new i.Vector3),t(this,"_plane"),this.components=e,this.world=s,this._plane=n}get visible(){return this._visible}set visible(e){this._visible=e;for(const t in this._edges){const i=this._edges[t];e?this.world.scene.three.add(i.mesh):i.mesh.removeFromParent(),i.fill&&(i.fill.visible=e)}}get fillMeshes(){const e=[];for(const t in this._edges){const i=this._edges[t];i.fill&&e.push(i.fill.mesh)}return e}update(){const e=this.components.get(Sh).styles.list;this.updateDeletedEdges(e);for(const t in e)this.drawEdges(t);this.fillNeedsUpdate=!1}get(){return this._edges}dispose(){const e=Object.keys(this._edges);for(const t of e)this.disposeEdge(t);this.onDisposed.trigger(),this.onDisposed.reset()}newEdgesMesh(e){const t=this.components.get(Sh).styles.list[e].lineMaterial,s=new i.BufferGeometry,n=new Float32Array(3e5),r=new i.BufferAttribute(n,3,!1);r.setUsage(i.DynamicDrawUsage),s.setAttribute("position",r);const o=new i.LineSegments(s,t);return o.frustumCulled=!1,o}newFillMesh(e,t){const i=this.components.get(Sh).styles.list[e],s=i.fillMaterial;if(s){const n=new gh(this.components,this.world,this._plane,t,s);return this.newFillOutline(e,n,i),n}}newFillOutline(e,t,i){if(!i.outlineMaterial||!this.world.renderer)return;const s=this.world.renderer;if(s instanceof Eh){const n=s.postproduction.customEffects.outlinedMeshes;n[e]||(n[e]={meshes:new Set,material:i.outlineMaterial}),t.styleName=e}}drawEdges(e){const t=this.components.get(Sh).styles.list[e];this._edges[e]||this.initializeStyle(e);const s=this._edges[e];let n=0;const r=s.mesh.geometry.attributes.position;r.array.fill(0);const o=[];let a=0;const l=new Map;for(const e of t.meshes)if(e.geometry){if(!e.geometry.boundsTree)throw new Error("Bounds tree not found for clipping edges subset.");if(e instanceof i.InstancedMesh){if(0===e.count)continue;const s=e;for(let c=0;c<s.count;c++){const h=s instanceof ce,d=s,u=t.fragments[d.fragment.id];if(h&&u){const e=d.fragment.getItemID(c);if(null===e||!u.has(e))continue}const f=new i.Mesh(e.geometry);f.matrix.copy(e.matrix);const p=new i.Matrix4;if(s.getMatrixAt(c,p),f.applyMatrix4(p),f.applyMatrix4(e.matrixWorld),f.updateMatrix(),f.updateMatrixWorld(),this._inverseMatrix.copy(f.matrixWorld).invert(),this._localPlane.copy(this._plane).applyMatrix4(this._inverseMatrix),n=this.shapecast(f,r,n),n!==a){if(h&&u){const e=d.fragment.getItemID(c);null!==e&&l.set(n,{[d.fragment.id]:new Set([e])})}o.push(n),a=n}}}else this._inverseMatrix.copy(e.matrixWorld).invert(),this._localPlane.copy(this._plane).applyMatrix4(this._inverseMatrix),n=this.shapecast(e,r,n),n!==a&&(o.push(n),a=n)}s.mesh.geometry.setDrawRange(0,n),s.mesh.position.copy(this._plane.normal).multiplyScalar(1e-4),r.needsUpdate=!0;const c=s.mesh.geometry.attributes.position;Number.isNaN(c.array[0])||this.fillNeedsUpdate&&s.fill&&(s.fill.geometry=s.mesh.geometry,s.fill.update(o,l),s.fill.visible=this._visible)}initializeStyle(e){const t=this.newEdgesMesh(e),i=t.geometry,s=this.newFillMesh(e,i);this._edges[e]={mesh:t,name:e,fill:s}}shapecast(e,t,i){return e.geometry.boundsTree.shapecast({intersectsBounds:e=>this._localPlane.intersectsBox(e),intersectsTriangle:s=>{let n=0;if(this._tempLine.start.copy(s.a),this._tempLine.end.copy(s.b),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const s=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,s.x,s.y,s.z),n++,i++}if(this._tempLine.start.copy(s.b),this._tempLine.end.copy(s.c),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const s=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,s.x,s.y,s.z),n++,i++}if(this._tempLine.start.copy(s.c),this._tempLine.end.copy(s.a),this._localPlane.intersectLine(this._tempLine,this._tempVector)){const s=this._tempVector.applyMatrix4(e.matrixWorld);t.setXYZ(i,s.x,s.y,s.z),n++,i++}2!==n&&(i-=n)}}),i}updateDeletedEdges(e){const t=Object.keys(this._edges);for(const i of t)void 0===e[i]&&(this.disposeEdge(i),this.disposeOutline(i))}disposeOutline(e){if(!this.world.renderer)return;const t=this.world.renderer;if(t instanceof Eh){delete t.postproduction.customEffects.outlinedMeshes[e]}}disposeEdge(e){const t=this.components.get(Xi),i=this._edges[e];i.fill&&i.fill.dispose(),t.destroy(i.mesh,!1),delete this._edges[e]}}class Th extends Zr{constructor(e,i,s,n,r,o=5,a=!0){super(e,i,s,n,r,o,a),t(this,"edges"),t(this,"edgesMaxUpdateRate",50),t(this,"_visible",!0),t(this,"_edgesVisible",!0),t(this,"updateFill",(()=>{this.edges.fillNeedsUpdate=!0,this.edges.update()})),this.edges=new Ch(e,i,this.three),this.toggleControls(!0),this.edges.visible=!0,this.onDraggingEnded.add((()=>{this.updateFill(),this.edges.visible=!0})),this.onDraggingStarted.add((()=>this.edges.visible=!1))}get visible(){return this._visible}set visible(e){super.visible=e,this.toggleControls(e)}set enabled(e){this._enabled=e,this.world.renderer&&this.world.renderer.setPlane(e,this.three)}get enabled(){return super.enabled}dispose(){super.dispose(),this.edges.dispose()}}class Rh{constructor(){t(this,"onDisposed",new Bi),t(this,"enabled",!0),t(this,"list",{}),t(this,"_defaultLineMaterial",new E({color:0,linewidth:.001})),t(this,"onAfterUpdate",new Bi),t(this,"onBeforeUpdate",new Bi)}update(e){this.onBeforeUpdate.trigger(this.list),this.onAfterUpdate.trigger(this.list)}create(e,t,i,s,n,r){if(!i.renderer)throw new Error("The given world doesn't have a renderer!");s||(s=this._defaultLineMaterial);for(const e of t)e.geometry.boundsTree||e.geometry.computeBoundsTree();const o=i.renderer;s.clippingPlanes=o.clippingPlanes;const a={name:e,lineMaterial:s,meshes:t,fillMaterial:n,outlineMaterial:r,fragments:{}};return this.list[e]=a,a}dispose(){const e=Object.keys(this.list);for(const t of e)this.deleteStyle(t);this.list={},this.onDisposed.trigger(),this.onDisposed.reset()}deleteStyle(e,t=!0){var i,s;const n=this.list[e];n&&(n.meshes.clear(),t&&(n.lineMaterial.dispose(),null==(i=n.fillMaterial)||i.dispose(),null==(s=n.outlineMaterial)||s.dispose())),delete this.list[e]}}const vh=class e extends ki{constructor(i){super(i),t(this,"onDisposed",new Bi),t(this,"enabled",!0),t(this,"styles"),t(this,"fillsNeedUpdate",!1),t(this,"_visible",!0),this.components.list.set(e.uuid,this),this.styles=new Rh}get visible(){return this._visible}set visible(e){this._visible=e;const t=this.components.get(Qr);for(const i of t.list)i instanceof Th&&(i.edges.visible=e)}dispose(){this.styles.dispose(),this.onDisposed.trigger()}async update(e=!1){if(!this.enabled)return;const t=this.components.get(Qr);for(const i of t.list)i instanceof Th&&(e||this.fillsNeedUpdate?i.updateFill():i.update());this.fillsNeedUpdate=!1}};t(vh,"uuid","24dfc306-a3c4-410f-8071-babc4afa5e4d");let Sh=vh;const yh={name:"HorizontalBlurShader",uniforms:{tDiffuse:{value:null},h:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float h;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 4.0 * h, vUv.y ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x - 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 1.0 * h, vUv.y ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 2.0 * h, vUv.y ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 3.0 * h, vUv.y ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x + 4.0 * h, vUv.y ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"},wh={name:"VerticalBlurShader",uniforms:{tDiffuse:{value:null},v:{value:1/512}},vertexShader:"\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvUv = uv;\n\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\n\t\t}",fragmentShader:"\n\n\t\tuniform sampler2D tDiffuse;\n\t\tuniform float v;\n\n\t\tvarying vec2 vUv;\n\n\t\tvoid main() {\n\n\t\t\tvec4 sum = vec4( 0.0 );\n\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 4.0 * v ) ) * 0.051;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y - 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y ) ) * 0.1633;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 1.0 * v ) ) * 0.1531;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 2.0 * v ) ) * 0.12245;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 3.0 * v ) ) * 0.0918;\n\t\t\tsum += texture2D( tDiffuse, vec2( vUv.x, vUv.y + 4.0 * v ) ) * 0.051;\n\n\t\t\tgl_FragColor = sum;\n\n\t\t}"},Ah=class e extends ki{constructor(s){super(s),t(this,"onDisposed",new Bi),t(this,"enabled",!0),t(this,"cameraHeight",10),t(this,"darkness",1.2),t(this,"opacity",1),t(this,"resolution",512),t(this,"amount",3.5),t(this,"planeColor",16777215),t(this,"shadowOffset",0),t(this,"shadowExtraScaleFactor",1.5),t(this,"list",{}),t(this,"tempMaterial",new i.MeshBasicMaterial({visible:!1})),t(this,"depthMaterial",new i.MeshDepthMaterial),this.components.add(e.uuid,this),this.initializeDepthMaterial()}dispose(){for(const e in this.list)this.deleteShadow(e);this.tempMaterial.dispose(),this.depthMaterial.dispose(),this.components=null,this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}create(e,t,i){if(this.list[t])throw new Error(`There is already a shadow with ID ${t}`);const{size:s,center:n,min:r}=this.getSizeCenterMin(e),o=this.createShadow(t,s,i);return this.initializeShadow(o,n,r),this.createPlanes(o,s),this.bakeShadow(e,o),o.root}deleteShadow(e){const t=this.components.get(Xi),i=this.list[e];if(delete this.list[e],!i)throw new Error(`No shadow with ID ${e} was found.`);t.destroy(i.root),t.destroy(i.blurPlane),i.rt.dispose(),i.rtBlur.dispose()}createPlanes(t,s){const n=new i.PlaneGeometry(s.x,s.z).rotateX(Math.PI/2);this.createBasePlane(t,n),e.createBlurPlane(t,n)}initializeShadow(t,i,s){this.initializeRoot(t,i,s),e.initializeRenderTargets(t),e.initializeCamera(t)}bakeShadow(e,t){const s=t.world.scene.three;if(!(s instanceof i.Scene))throw new Error("The core of the scene of the world must be a scene!");if(!t.world.renderer)throw new Error("The given world must have a renderer!");const n=t.world.renderer.three,r=e.map((e=>!!e.parent));for(let t=0;t<e.length;t++)r[t]||s.add(e[t]);const o=s.children.filter((i=>!e.includes(i)&&i!==t.root));for(let e=o.length-1;e>=0;e--)s.remove(o[e]);const a=s.background;s.background=null,s.overrideMaterial=this.depthMaterial;const l=[];for(const t of e)l.push(t.visible),t.visible=!0;n.setRenderTarget(t.rt),n.render(s,t.camera),s.overrideMaterial=null,this.blurShadow(t,this.amount),this.blurShadow(t,.4*this.amount),n.setRenderTarget(null),s.background=a;for(let t=0;t<e.length;t++)e[t].visible=l[t];for(let e=o.length-1;e>=0;e--)s.add(o[e]);for(let t=0;t<e.length;t++)r[t]||s.remove(e[t])}static initializeCamera(e){e.camera.rotation.x=Math.PI/2,e.root.add(e.camera)}static initializeRenderTargets(e){e.rt.texture.generateMipmaps=!1,e.rtBlur.texture.generateMipmaps=!1}initializeRoot(e,t,i){const s=e.world.scene.three;e.root.position.set(t.x,i.y-this.shadowOffset,t.z),s.add(e.root)}createBasePlane(e,t){const s=this.createPlaneMaterial(e),n=new i.Mesh(t,s);n.renderOrder=2,e.root.add(n),n.scale.y=-1}static createBlurPlane(e,t){e.blurPlane.geometry=t,e.blurPlane.visible=!1,e.root.add(e.blurPlane)}createPlaneMaterial(e){if(!e.world.renderer)throw new Error("The given world must have a renderer!");const t=e.world.renderer.three;return new i.MeshBasicMaterial({map:e.rt.texture,opacity:this.opacity,transparent:!0,depthWrite:!1,clippingPlanes:t.clippingPlanes})}initializeDepthMaterial(){this.depthMaterial.depthTest=!1,this.depthMaterial.depthWrite=!1;this.depthMaterial.userData.darkness={value:this.darkness},this.depthMaterial.onBeforeCompile=e=>{e.uniforms.darkness=this.depthMaterial.userData.darkness,e.fragmentShader=`\n\t\t\t\t\t\tuniform float darkness;\n\t\t\t\t\t\t${e.fragmentShader.replace("gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );","gl_FragColor = vec4( vec3( 0.0 ), ( 1.0 - fragCoordZ ) * darkness );")}\n\t\t\t\t\t`}}createShadow(e,t,s){return this.list[e]={root:new i.Group,world:s,rt:new i.WebGLRenderTarget(this.resolution,this.resolution),rtBlur:new i.WebGLRenderTarget(this.resolution,this.resolution),blurPlane:new i.Mesh,camera:this.createCamera(t)},this.list[e]}createCamera(e){return new i.OrthographicCamera(-e.x/2,e.x/2,e.z/2,-e.z/2,0,this.cameraHeight)}getSizeCenterMin(e){const t=e[0].parent,s=new i.Group;s.children=e;const n=(new i.Box3).setFromObject(s);null==t||t.add(...e);const r=new i.Vector3;n.getSize(r),r.x*=this.shadowExtraScaleFactor,r.z*=this.shadowExtraScaleFactor;const o=new i.Vector3;n.getCenter(o);return{size:r,center:o,min:n.min}}blurShadow(e,t){if(!e.world.renderer)throw new Error("The given world must have a renderer!");const s=new i.ShaderMaterial(yh);s.depthTest=!1;const n=new i.ShaderMaterial(wh);n.depthTest=!1,e.blurPlane.visible=!0,e.blurPlane.material=s,e.blurPlane.material.uniforms.tDiffuse.value=e.rt.texture,s.uniforms.h.value=1*t/256;const r=e.world.renderer.three;r.setRenderTarget(e.rtBlur),r.render(e.blurPlane,e.camera),e.blurPlane.material=n,e.blurPlane.material.uniforms.tDiffuse.value=e.rtBlur.texture,n.uniforms.v.value=1*t/256,r.setRenderTarget(e.rt),r.render(e.blurPlane,e.camera),e.blurPlane.visible=!1}};t(Ah,"uuid","f833a09a-a3ab-4c58-b03e-da5298c7a1b6");let Fh=Ah;const Oh=class e extends ki{constructor(i){super(i),t(this,"enabled",!0),t(this,"inputs",["OBC","BUI"]),t(this,"_requestEventID","thatOpenCompanyComponentRequested"),t(this,"_createEventID","thatOpenCompanyComponentCreated"),i.add(e.uuid,this)}async import(e){return new Promise((t=>{const i=document.createElement("script"),s=`\n        function main() {\n          const { ${this.inputs} } = window.ThatOpenCompany;\n        \n          ${e}\n        \n          const onComponentRequested = () => {\n            window.removeEventListener("${this._requestEventID}", onComponentRequested);\n            const event = new CustomEvent("${this._createEventID}", { detail: main });\n            window.dispatchEvent(event);\n          };\n          \n          window.addEventListener("${this._requestEventID}", onComponentRequested);\n        }\n        \n        main();\n      `,n=e=>{window.removeEventListener(this._createEventID,n);const s=e.detail,r=this.components.get(s);i.remove(),t(r)};i.addEventListener("load",(()=>{window.addEventListener(this._createEventID,n),window.dispatchEvent(new Event(this._requestEventID))})),i.src=URL.createObjectURL(new File([s],"temp.js")),document.head.appendChild(i)}))}};t(Oh,"uuid","74c0c370-1af8-4ca9-900a-4a4196c0f2f5");let Nh=Oh;const Ph=["Station","Radius","Length","InitialKP","FinalKP","KP","Slope","Height","InitialKPV","FinalKPV"],xh=class e extends ki{constructor(i){super(i),t(this,"enabled",!0),t(this,"world",null),t(this,"_markerKey",0),t(this,"_list",new Map),t(this,"type","horizontal"),t(this,"divisionLength",100),i.add(e.uuid,this)}addKPStation(e,t,s){const n=this.components.get(Ec),r=document.createElement("div"),o=document.createElement("div");r.appendChild(o),o.innerHTML=t,o.style.color=n.color,o.style.borderBottom="1px dotted white",o.style.width="160px",o.style.textAlign="left";const a=new pc(e,r),l=new i.Vector3;l.x=s.geometry.attributes.position.getX(s.geometry.attributes.position.count-1),l.y=s.geometry.attributes.position.getY(s.geometry.attributes.position.count-1),l.z=s.geometry.attributes.position.getZ(s.geometry.attributes.position.count-1);const c=new i.Vector3;c.x=s.geometry.attributes.position.getX(s.geometry.attributes.position.count-2),c.y=s.geometry.attributes.position.getY(s.geometry.attributes.position.count-2),c.z=s.geometry.attributes.position.getZ(s.geometry.attributes.position.count-2);const h=new i.Vector3;h.x=(l.x+c.x)/2,h.y=(l.y+c.y)/2,h.z=(l.z+c.z)/2,a.three.position.copy(h);const d=new i.Vector3;d.subVectors(l,c).normalize();const u=new i.Quaternion;u.setFromUnitVectors(new i.Vector3(0,1,0),d);const f=(new i.Euler).setFromQuaternion(u).z,p=i.MathUtils.radToDeg(f);o.style.transform=`rotate(${-p-90}deg) translate(-35%, -50%)`;const m=this._markerKey.toString();n.setupEvents(e,!0),n.getWorldMarkerList(e).set(m,{label:a,key:m,merged:!1,static:!1}),this._markerKey++,this.save(m,"KP")}addVerticalMarker(e,t,s,n,r){const o=this.components.get(Ec),a=document.createElement("span");a.innerHTML=t,a.style.color=o.color;const l=new pc(e,a,r);if("Height"===n){const e=document.createElement("span");e.innerHTML=t,e.style.color=o.color;const{position:i}=s.geometry.attributes,n=3*(i.array.length/3-1),r=i.array.slice(n,n+3);l.three.position.set(r[0],r[1]+10,r[2])}else if("InitialKPV"===n){const{position:e}=s.geometry.attributes,t=e.getX(0),i=e.getY(0),n=e.getZ(0);l.three.position.set(t-20,i,n)}else if("FinalKPV"===n){const{position:e}=s.geometry.attributes,t=e.getX(s.geometry.attributes.position.count-1),i=e.getY(s.geometry.attributes.position.count-1),n=e.getZ(s.geometry.attributes.position.count-1);l.three.position.set(t+20,i,n)}else if("Slope"===n){a.style.color="grey";const{position:e}=s.geometry.attributes,t=new i.Vector3;t.x=e.getX(0),t.y=e.getY(0),t.z=e.getZ(0);const n=new i.Vector3;n.x=e.getX(e.count-1),n.y=e.getY(e.count-1),n.z=e.getZ(e.count-1);const r=new i.Vector3;r.addVectors(t,n).multiplyScalar(.5),l.three.position.set(r.x,r.y-10,r.z)}const c=this._markerKey.toString();return o.setupEvents(e,!0),o.getWorldMarkerList(e).set(c,{label:l,key:c,type:n,merged:!1,static:!1}),this._markerKey++,this.save(c,n),l}addCivilMarker(e,t,s,n){const r=this.components.get(Ec),o=document.createElement("span");o.innerHTML=t,o.style.color=r.color;const a=new pc(e,o);if("InitialKP"===n){const e=s.geometry.attributes.position.getX(0),t=s.geometry.attributes.position.getY(0),i=s.geometry.attributes.position.getZ(0);a.three.position.set(e+2,t+2,i)}else if("FinalKP"===n){const e=s.geometry.attributes.position.getX(s.geometry.attributes.position.count-1),t=s.geometry.attributes.position.getY(s.geometry.attributes.position.count-1),i=s.geometry.attributes.position.getZ(s.geometry.attributes.position.count-1);a.three.position.set(e+2,t-2,i)}else if("Length"===n){const e=new i.Vector3;e.x=s.geometry.attributes.position.getX(0),e.y=s.geometry.attributes.position.getY(0),e.z=s.geometry.attributes.position.getZ(0);const t=new i.Vector3;t.x=s.geometry.attributes.position.getX(s.geometry.attributes.position.count-1),t.y=s.geometry.attributes.position.getY(s.geometry.attributes.position.count-1),t.z=s.geometry.attributes.position.getZ(s.geometry.attributes.position.count-1);const n=e.distanceTo(t);a.three.element.innerText=n.toFixed(2);const r=t.clone().add(e).divideScalar(2);a.three.position.copy(r)}const l=this._markerKey.toString();return r.setupEvents(e,!0),r.getWorldMarkerList(e).set(l,{label:a,key:l,type:n,merged:!1,static:!1}),this._markerKey++,this.save(l,n),a}showKPStations(e){if(!this.world)throw new Error("A world is needed for this component to work!");if("horizontal"===this.type){const t=this.generateStartAndEndKP(e);for(const[,e]of t)this.addKPStation(this.world,e.value,e.normal);const i=this.generateConstantKP(e);for(const[,e]of i)this.addKPStation(this.world,e.value,e.normal)}}showCurveLength(e,t){if(!this.world)throw new Error("A world is needed for this component to work!");const i=this.components.get(Ec),s=e.length,n=`${t.toFixed(2)} m`,r=e[Math.round(s/2)],o=i.create(this.world,n,r,!0);void 0!==o&&this.save(o,"Radius")}showLineLength(e,t){if(!this.world)throw new Error("A world is needed for this component to work!");const s=this.components.get(Ec),n=new i.Vector3;n.x=e.geometry.getAttribute("position").getX(0),n.y=e.geometry.getAttribute("position").getY(0),n.z=e.geometry.getAttribute("position").getZ(0);const r=new i.Vector3;r.x=e.geometry.getAttribute("position").getX(1),r.y=e.geometry.getAttribute("position").getY(1),r.z=e.geometry.getAttribute("position").getZ(1);const o=`${t.toFixed(2)} m`,a=new i.Vector3;a.addVectors(n,r).multiplyScalar(.5);const l=s.create(this.world,o,a,!0);void 0!==l&&this.save(l,"Radius")}showCurveRadius(e,t){if(!this.world)throw new Error("A world is needed for this component to work!");const s=this.components.get(Ec),n=new i.Vector3;n.x=e.geometry.getAttribute("position").getX(0),n.y=e.geometry.getAttribute("position").getY(0),n.z=e.geometry.getAttribute("position").getZ(0);const r=new i.Vector3;r.x=e.geometry.getAttribute("position").getX(1),r.y=e.geometry.getAttribute("position").getY(1),r.z=e.geometry.getAttribute("position").getZ(1);const o=`R = ${t.toFixed(2)} m`,a=new i.Vector3;a.addVectors(n,r).multiplyScalar(.5);const l=s.create(this.world,o,a,!0);void 0!==l&&this.save(l,"Radius")}deleteByType(e=Ph){const t=this.components.get(Ec);for(const i of e){const e=this._list.get(i);if(e){for(const i of e)t.delete(i);this._list.delete(i)}}}generateStartAndEndKP(e){const{alignment:t}=e.curve,s=new Map;for(const e of t.horizontal){const t=e.getLength();if(s.size>0){const n=e.index-1,r=s.get(n).distance+t,o=e.mesh.geometry.getAttribute("position"),a=o.count-1,l=new i.Vector3;l.x=o.getX(a),l.y=o.getY(a),l.z=o.getZ(a);const c=this.createNormalLine(e.mesh);s.set(e.index,{value:this.getShortendKPValue(r),distance:r,point:l,normal:c})}else{const n=e.mesh.geometry.getAttribute("position"),r=n.count-1,o=new i.Vector3;o.x=n.getX(r),o.y=n.getY(r),o.z=n.getZ(r);const a=this.createNormalLine(e.mesh);s.set(e.index,{value:this.getShortendKPValue(t),distance:t,point:o,normal:a})}}return s}createNormalLine(e){const t=e.geometry.attributes.position.count-1,s=t-1,n=new i.Vector3;n.x=e.geometry.attributes.position.getX(t),n.y=e.geometry.attributes.position.getY(t),n.z=e.geometry.attributes.position.getZ(t);const r=new i.Vector3;r.x=e.geometry.attributes.position.getX(s),r.y=e.geometry.attributes.position.getY(s),r.z=e.geometry.attributes.position.getZ(s);const o=(new i.Vector3).subVectors(n,r).clone().applyAxisAngle(new i.Vector3(0,0,1),.5*Math.PI).normalize(),a=(new i.BufferGeometry).setFromPoints([o.clone().setLength(10).add(n),o.clone().setLength(-10).add(n)]);return new i.Line(a)}generateConstantKP(e){const{alignment:t}=e.curve,i=new Map,s=t.getLength("horizontal"),n=Math.floor(s/this.divisionLength);for(let e=0;e<n;e++){const r=e/n,o=t.getPointAt(r,"horizontal"),a=s*r,l=this.getNormal(t,o);i.set(e,{value:this.getShortendKPValue(a),distance:a,point:o,normal:l})}return i}getNormal(e,t){const s=[],n={start:new i.Vector3,end:new i.Vector3};for(let t=0;t<e.horizontal.length;t++){const n=e.horizontal[t].mesh.geometry.attributes.position,r=n.count;for(let e=0;e<r;e++){const t=n.getX(e),r=n.getY(e),o=n.getZ(e);s.push(new i.Vector3(t,r,o))}}for(let e=0;e<s.length-1;e++){const i=s[e],r=s[e+1],o=i.distanceTo(t),a=r.distanceTo(t),l=i.distanceTo(r);Math.abs(o+a-l)<1e-5&&(n.start=i,n.end=r)}const r=(new i.Vector3).subVectors(n.end,n.start).clone().applyAxisAngle(new i.Vector3(0,0,1),.5*Math.PI).normalize(),o=(new i.BufferGeometry).setFromPoints([r.clone().setLength(10).add(t),r.clone().setLength(-10).add(t)]);return new i.Line(o,new i.LineBasicMaterial({color:16711680}))}getShortendKPValue(e){const t=e.toFixed(2),[i,s]=t.toString().split("."),n=s||"00";if(parseInt(i,10)>1e3&&parseInt(i,10)<1e4){const[e,...t]=i;return`${e}+${t.join("")}.${n}`}if(parseInt(i,10)>1e4){const[e,t,...s]=i;return`${e}${t}+${s.join("")}.${n}`}return`0+${i.padStart(3,"0")}.${n}`}save(e,t){this._list.has(t)||this._list.set(t,new Set),this._list.get(t).add(e)}};t(xh,"uuid","0af12c32-81ee-4100-a030-e9ae546f6170");let Lh=xh;class bh extends ki{constructor(e){super(e),t(this,"onHighlight",new Bi),t(this,"onMarkerChange",new Bi),t(this,"onMarkerHidden",new Bi),t(this,"onDisposed",new Bi),t(this,"enabled",!0),t(this,"mouseMarkers"),t(this,"_curves",[]),t(this,"_previousAlignment",null),t(this,"_highlighter"),t(this,"_world",null),t(this,"updateLinesResolution",(e=>{var t;null==(t=this._highlighter)||t.setResolution(e)})),t(this,"onMouseMove",(e=>{var t,i,s;if(!this._world)throw new Error("No world was given for this navigator!");if(!this._world.renderer)return;const n=this._world.renderer.three.domElement.parentElement,r=this._world.camera.three,o=null==(t=this._highlighter)?void 0:t.castRay(e,r,n,this._curves);if(o){const{object:e}=o;return null==(i=this._highlighter)||i.hover(e),void this.updateMarker(o,"hover")}this.mouseMarkers&&(this.mouseMarkers.hover.visible=!1),null==(s=this._highlighter)||s.unHover(),this.onMarkerHidden.trigger({type:"hover"})})),t(this,"onClick",(e=>{var t,i;if(!this._world)throw new Error("No world was given for this navigator!");if(!this._world.renderer)return;const s=this._world.renderer.three.domElement.parentElement,n=this._world.camera.three,r=null==(t=this._highlighter)?void 0:t.castRay(e,n,s,this._curves);if(r){const e=r,t=e.object;if(null==(i=this._highlighter)||i.select(t),this.updateMarker(e,"select"),this._world.camera.hasCameraControls()&&(t.geometry.boundingBox||t.geometry.computeBoundingBox(),t.geometry.boundingBox)){const e=this.getScaledBox(t.geometry.boundingBox,2);this._world.camera.controls.fitToBox(e,!0)}this.onHighlight.trigger({mesh:t,point:e.point}),this._previousAlignment!==t.curve.alignment&&(this.components.get(Lh).showKPStations(t),this._previousAlignment=t.curve.alignment)}})),t(this,"onControlsUpdated",(()=>{if(!this._world)throw new Error("No world was given for this navigator!");if(!(this._world.camera.three instanceof i.OrthographicCamera&&this._highlighter))return;const{zoom:e,left:t,right:s,top:n,bottom:r}=this._world.camera.three,o=t-s,a=n-r,l=Math.max(o,a)/e,{caster:c}=this._highlighter;c.params.Line.threshold=l/40}))}get highlighter(){if(!this._highlighter)throw new Error("Highlighter not initialized. You must set a world first!");return this._highlighter}get world(){return this._world}set world(e){var t,i,s;if(e===this._world||(this._world&&this.setupEvents(!1),this._world=e,null==(t=this._highlighter)||t.dispose(),null==(i=this.mouseMarkers)||i.hover.dispose(),null==(s=this.mouseMarkers)||s.select.dispose(),!e))return;const n=e.scene.three;this._highlighter=new oc(n,this.view),this.mouseMarkers={select:this.newMouseMarker("#ffffff",e),hover:this.newMouseMarker("#575757",e)},this.setupEvents(!0)}async draw(e,t){if(!e.civilData)throw new Error("The provided model doesn't have civil data!");if(!this._world)throw new Error("No world was given for this navigator!");const{alignments:s}=e.civilData,n=t||s.values(),r=this._world.scene.three,o=new i.Box3;o.makeEmpty(),o.min.set(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE),o.max.set(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE);for(const e of n){if(!e)throw new Error("Alignment not found!");for(const t of e[this.view])if(r.add(t.mesh),this._curves.push(t.mesh),o.isEmpty()){t.mesh.geometry.computeBoundingBox();const e=t.mesh.geometry.boundingBox;e instanceof i.Box3&&o.copy(e).applyMatrix4(t.mesh.matrixWorld)}else o.expandByObject(t.mesh)}const a=this.getScaledBox(o,1.2);this._world.camera.hasCameraControls()&&await this._world.camera.controls.fitToBox(a,!1)}async dispose(){var e;null==(e=this._highlighter)||e.dispose(),this.clear(),this.onHighlight.reset(),this._curves=[],this.onDisposed.trigger(),this.onDisposed.reset()}clear(){var e,t;null==(e=this._highlighter)||e.unSelect(),null==(t=this._highlighter)||t.unHover();for(const e of this._curves)e.removeFromParent();this._curves=[]}setMarker(e,t,i){if(!this._curves.length)return;const s=e.getCurveAt(t,this.view),n=e.getPointAt(t,this.view),{index:r}=s.curve.getSegmentAt(s.percentage);this.setMouseMarker(n,s.curve.mesh,r,i)}setDefSegments(e){const t=[],s=[],n=(e,t)=>(t[1]-e[1])/(t[0]-e[0]);for(let t=0;t<e.length;t++){const i=e[t];let r,o,a,l;for(let e=0;e<Object.keys(i).length/3;e++)if(void 0!==i[3*e]&&void 0!==i[3*e+1]){r=i[3*e],o=i[3*e+1];break}for(let e=Object.keys(i).length/3-1;e>=0;e--)if(void 0!==i[3*e]&&void 0!==i[3*e+1]){a=i[3*e],l=i[3*e+1];break}const c=(100*n([r,o],[a,l])).toFixed(2);s.push({slope:c})}for(const s of e)for(let e=0;e<s.length-3;e+=3){const n=s[e],r=s[e+1],o=s[e+2],a=s[e+3],l=s[e+4],c=s[e+5];t.push({start:new i.Vector3(n,r,o),end:new i.Vector3(a,l,c)})}return{defSegments:t,slope:s}}hideMarker(e){this.mouseMarkers&&(this.mouseMarkers[e].visible=!1)}setupEvents(e){var t,i;if(!this._world)throw new Error("No world was given for this navigator!");if(this._world.isDisposing||!this._world.renderer)return;const s=this._world.renderer.three.domElement.parentElement;null==(t=this._world.renderer)||t.onResize.remove(this.updateLinesResolution),s.removeEventListener("pointermove",this.onMouseMove),s.removeEventListener("click",this.onClick),this._world.camera.hasCameraControls()&&this._world.camera.controls.removeEventListener("update",this.onControlsUpdated),e&&(s.addEventListener("pointermove",this.onMouseMove),s.addEventListener("click",this.onClick),null==(i=this._world.renderer)||i.onResize.add(this.updateLinesResolution),this._world.camera.hasCameraControls()&&this._world.camera.controls.addEventListener("update",this.onControlsUpdated))}newMouseMarker(e,t){if(!this._world)throw new Error("No world was given for this navigator!");const i=t.scene.three,s=document.createElement("div"),n=document.createElement("div");s.appendChild(n),n.style.backgroundColor=e,n.style.width="3rem",n.style.height="3px";const r=new pc(this._world,s,i);return r.visible=!1,r}setMouseMarker(e,t,i,s){if(void 0===i||!this.mouseMarkers)return;this.mouseMarkers[s].visible=!0;const n=this.mouseMarkers[s].three;n.position.copy(e);const r=t,{startPoint:o,endPoint:a}=r.curve.getSegment(i),l=Math.atan2(a.y-o.y,a.x-o.x),c=n.element.children[0],h=90-l/Math.PI*180;c.style.transform=`rotate(${h}deg)`}updateMarker(e,t){const{point:i,index:s,object:n}=e,r=n,o=r.curve,a=r.curve.alignment,l=a.getPercentageAt(i,this.view),c=i.clone();this.setMouseMarker(c,r,s,t),null!==l&&this.onMarkerChange.trigger({alignment:a,percentage:l,type:t,curve:o})}getScaledBox(e,t){const s=new i.Box3,n=new i.Vector3,r=new i.Vector3;return e.getCenter(r),e.getSize(n),n.multiplyScalar(t),s.setFromCenterAndSize(r,n),s}}class Mh{constructor(e,s,n){t(this,"components"),t(this,"_scene"),t(this,"_world"),t(this,"offset",10),t(this,"markupLines",[]),t(this,"currentCurveMesh"),t(this,"markupMaterial",new i.LineBasicMaterial({color:6842472})),this.components=e,this._scene=s,this._world=n}showCurveInfo(e){switch(this.disposeMarkups(),this.currentCurveMesh=e,e.curve.data.TYPE){case"LINE":this.showLineInfo(e,this.offset);break;case"CIRCULARARC":this.showCircularArcInfo(e,this.offset);break;case"CLOTHOID":this.showClothoidInfo(e,this.offset);break;default:console.log("Unknown curve type:",e.curve.data.TYPE)}}updateOffset(e,t,i){const s=Math.max(e.height,e.width)/(150*t);s!==this.offset&&(this.offset=s,i&&this.currentCurveMesh&&this.showCurveInfo(this.currentCurveMesh))}dispose(){for(const e of this.markupLines)e.removeFromParent();this.disposeMarkups(),this.markupMaterial.dispose()}disposeMarkups(){for(const e of this.markupLines)e.geometry.dispose(),e.removeFromParent();this.markupLines=[]}unSelect(){this.disposeMarkups()}calculateTangent(e,t){const s=3*t,n=Math.max(0,s-3),r=Math.min(e.length-3,s+3),o=(new i.Vector3).fromArray(e,n);return(new i.Vector3).fromArray(e,r).clone().sub(o).normalize()}calculateParallelCurve(e,t,s){const n=[];for(let r=0;r<t;r++){const t=this.calculateTangent(e,r).clone().applyAxisAngle(new i.Vector3(0,0,1),Math.PI/2);t.normalize();const o=t.clone().multiplyScalar(s),a=3*r,l=(new i.Vector3).fromArray(e,a).add(o);n.push(l)}return n}calculateDimensionLines(e,t){const s=[],n=e.geometry.attributes.position.array,r=t.geometry.attributes.position.array;if(n.length<6&&r.length<6)throw new Error("Line must have at least two vertices");const o=new i.Vector3(n[0],n[1],n[2]),a=new i.Vector3(r[0],r[1],r[2]),l=[],c=n.length-3,h=new i.Vector3(n[c],n[c+1],n[c+2]),d=r.length-3,u=new i.Vector3(r[d],r[d+1],r[d+2]);return s.push(o,a),l.push(h,u),{startDimensionPoints:s,endDimensionPoints:l}}offsetDimensionLine(e,t){const s=(new i.Vector3).copy(e[e.length-1]).sub(e[0]).normalize().clone().multiplyScalar(t);return e.map((e=>e.clone().add(s)))}showLineInfo(e,t){const s=this.components.get(Lh);s.world=this._world,s.deleteByType(["Length","Radius"]);const n=e.geometry.attributes.position.array,r=this.calculateParallelCurve(n,n.length/3,t),o=(new i.BufferGeometry).setFromPoints(r),a=new i.Line(o,this.markupMaterial);s.showLineLength(a,e.curve.getLength()),this._scene.add(a),this.markupLines.push(a);const{startDimensionPoints:l,endDimensionPoints:c}=this.calculateDimensionLines(e,a),h=this.offsetDimensionLine(l,.1*t),d=this.offsetDimensionLine(c,.1*t),u=(new i.BufferGeometry).setFromPoints(h),f=(new i.BufferGeometry).setFromPoints(d),p=new i.Line(u,this.markupMaterial);this._scene.add(p),this.markupLines.push(p);const m=new i.Line(f,this.markupMaterial);this._scene.add(m),this.markupLines.push(m)}showClothoidInfo(e,t){const s=this.components.get(Lh);s.world=this._world,s.deleteByType(["Length","Radius"]);const n=e.geometry.attributes.position.array,r=this.calculateParallelCurve(n,n.length/3,t),o=(new i.BufferGeometry).setFromPoints(r);s.showCurveLength(r,e.curve.getLength());const a=new i.Line(o,this.markupMaterial);this._scene.add(a),this.markupLines.push(a);const{startDimensionPoints:l,endDimensionPoints:c}=this.calculateDimensionLines(e,a),h=this.offsetDimensionLine(l,.1*t),d=this.offsetDimensionLine(c,.1*t),u=(new i.BufferGeometry).setFromPoints(h),f=(new i.BufferGeometry).setFromPoints(d),p=new i.Line(u,this.markupMaterial);this._scene.add(p),this.markupLines.push(p);const m=new i.Line(f,this.markupMaterial);this._scene.add(m),this.markupLines.push(m)}showCircularArcInfo(e,t){const s=this.components.get(Lh);s.world=this._world,s.deleteByType(["Length","Radius"]);const n=e.curve.data.RADIUS,r=e.geometry.attributes.position.array,o=e.geometry.attributes.position.count,a=[],l=new i.Vector3(r[0],r[1],r[2]),c=3*(o-1),h=new i.Vector3(r[c],r[c+1],r[c+2]),d=o/2*3,u=new i.Vector3(r[d],r[d+1],r[d+2]),f=h.clone().sub(l).normalize(),p=new i.Vector3(-f.y,f.x,0);p.multiplyScalar(n);const m=u.clone().add(p);a.push(u),a.push(m);const I=(new i.BufferGeometry).setFromPoints(a),E=new i.Line(I,this.markupMaterial);s.showCurveRadius(E,Math.abs(n)),this._scene.add(E),this.markupLines.push(E);const g=[];for(let s=0;s<o;s++){const n=this.calculateTangent(r,s),o=e.curve.data.RADIUS,a=new i.Vector3(n.y,-n.x,0);a.normalize(),o<0&&a.negate();const l=a.clone().multiplyScalar(t),c=3*s,h=new i.Vector3(r[c]+l.x,r[c+1]+l.y,r[c+2]+l.z);g.push(h)}const C=(new i.BufferGeometry).setFromPoints(g);s.showCurveLength(g,e.curve.getLength());const T=new i.Line(C,this.markupMaterial);this._scene.add(T),this.markupLines.push(T);const{startDimensionPoints:R,endDimensionPoints:v}=this.calculateDimensionLines(e,T),S=this.offsetDimensionLine(R,.1*t),y=this.offsetDimensionLine(v,.1*t),w=(new i.BufferGeometry).setFromPoints(S),A=(new i.BufferGeometry).setFromPoints(y),F=new i.Line(w,this.markupMaterial);this._scene.add(F),this.markupLines.push(F);const O=new i.Line(A,this.markupMaterial);this._scene.add(O),this.markupLines.push(O)}}const Dh=class e extends bh{constructor(i){super(i),t(this,"view","horizontal"),t(this,"planHighlighter"),this.components.add(e.uuid,this),this.onHighlight.add((({mesh:e})=>{!this._highlighter||!this.planHighlighter||this.planHighlighter.showCurveInfo(e)}))}get world(){return super.world}set world(e){var t;super.world=e,e&&(null==(t=this.planHighlighter)||t.dispose(),this.planHighlighter=new Mh(this.components,e.scene.three,e))}};t(Dh,"uuid","3096dea0-5bc2-41c7-abce-9089b6c9431b");let _h=Dh;const Uh=class e extends bh{constructor(i){super(i),t(this,"enabled",!0),t(this,"view","vertical"),this.components.add(e.uuid,this)}get world(){return super.world}set world(e){this.world!==e&&(super.world=e,this._highlighter&&this._highlighter.onSelect.add((e=>{if(!this.world)throw new Error("A world is needed to work with this component!");const t=this.components.get(Lh);t.deleteByType(["Slope","Height","InitialKPV","FinalKPV"]);const{alignment:i}=e.curve,s=[];for(const e of i.vertical){const t=e.mesh.geometry.attributes.position.array;s.push(t)}const{defSegments:n,slope:r}=this.setDefSegments(s),o=this.world.scene.three;for(let e=0;e<i.vertical.length;e++){const s=i.vertical[e];t.addVerticalMarker(this.world,`S: ${r[e].slope}%`,s.mesh,"Slope",o),t.addVerticalMarker(this.world,`H: ${n[e].end.y.toFixed(2)}`,s.mesh,"Height",o)}t.addVerticalMarker(this.world,"KP: 0",i.vertical[0].mesh,"InitialKPV",o),t.addVerticalMarker(this.world,`KP: ${i.vertical.length}`,i.vertical[i.vertical.length-1].mesh,"FinalKPV",o)})))}};t(Uh,"uuid","097eea29-2d5a-431a-a247-204d44670621");let Bh=Uh;const Vh=class e extends ki{constructor(i){super(i),t(this,"onHighlight",new Bi),t(this,"onMarkerChange",new Bi),t(this,"onMarkerHidden",new Bi),t(this,"enabled",!0),t(this,"mouseMarkers"),t(this,"_highlighter"),t(this,"_curves",[]),t(this,"_world",null),t(this,"updateLinesResolution",(e=>{var t;null==(t=this.highlighter)||t.setResolution(e)})),t(this,"onClick",(e=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const t=this.world.renderer.three.domElement,i=this.world.camera.three,s=this._highlighter.castRay(e,i,t,this._curves);if(s){const e=s.object;this._highlighter.select(e),this.updateMarker(s,"select");const{point:t,index:i}=s;void 0!==i&&this.onHighlight.trigger({curve:e,point:t,index:i})}else this._highlighter.unSelect(),this.mouseMarkers&&(this.mouseMarkers.hover.visible=!1),this.onMarkerHidden.trigger({type:"hover"})})),t(this,"onMouseMove",(async e=>{if(!this.enabled||!this._highlighter)return;if(!this.world)throw new Error("No world found!");if(!this.world.renderer)return;const t=this.world.renderer.three.domElement,i=this.world.camera.three,s=this._highlighter.castRay(e,i,t,this._curves);if(s)return this._highlighter.hover(s.object),void this.updateMarker(s,"hover");this._highlighter.unHover()})),this.components.add(e.uuid,this)}get world(){return this._world}set world(e){var t,i,s;if(e===this._world||(this._world&&this.setupEvents(!1),this._world=e,null==(t=this._highlighter)||t.dispose(),null==(i=this.mouseMarkers)||i.hover.dispose(),null==(s=this.mouseMarkers)||s.select.dispose(),!e))return;const n=e.scene.three;this._highlighter=new oc(n,"absolute"),this.mouseMarkers={select:this.newMouseMarker("#ffffff",e),hover:this.newMouseMarker("#575757",e)},this.setupEvents(!0)}get highlighter(){if(!this._highlighter)throw new Error("Navigator not initialized!");return this._highlighter}draw(e){if(!e.civilData)throw new Error("Model must have civil data!");if(!this.world)throw new Error("A world must be given before drawing an alignment!");const t=this.world.scene.three;for(const[i,s]of e.civilData.alignments)for(const{mesh:e}of s.absolute)t.add(e),this._curves.push(e)}setMarker(e,t,i){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");const s=e.getPointAt(t,"absolute");this.mouseMarkers[i].visible=!0,this.mouseMarkers[i].three.position.copy(s)}hideMarker(e){if(!this.mouseMarkers)throw new Error("No mouse markers found! Initialize the world before using this.");this.mouseMarkers[e].three.visible=!1}newMouseMarker(e,t){const i=t.scene.three,s=document.createElement("div");s.style.backgroundColor=e,s.style.width="1rem",s.style.height="1rem",s.style.borderRadius="1rem";const n=new pc(t,s,i);return n.visible=!1,n}setupEvents(e){var t,i;if(!this.world)throw new Error("No world found!");if(this.world.isDisposing||!this.world.renderer)return;const s=this.world.renderer.three.domElement;null==(t=this.world.renderer)||t.onResize.remove(this.updateLinesResolution),s.removeEventListener("click",this.onClick),s.removeEventListener("pointermove",this.onMouseMove),e&&(s.addEventListener("click",this.onClick),s.addEventListener("pointermove",this.onMouseMove),null==(i=this.world.renderer)||i.onResize.add(this.updateLinesResolution))}updateMarker(e,t){if(!this.mouseMarkers)return;const{point:i,object:s}=e,n=s,r=n.curve,o=n.curve.alignment,a=o.getPercentageAt(i,"absolute");this.mouseMarkers[t].visible=!0,this.mouseMarkers[t].three.position.copy(i),null!==a&&this.onMarkerChange.trigger({alignment:o,percentage:a,type:t,curve:r})}};t(Vh,"uuid","0a59c09e-2b49-474a-9320-99f51f40f182");let zh=Vh;const kh=class e extends ki{constructor(i){super(i),t(this,"enabled",!0),t(this,"world",null),t(this,"plane"),t(this,"_world3D",null),this.components.add(e.uuid,this)}get world3D(){return this._world3D}set world3D(e){var t;if(this._world3D=e,null==(t=this.plane)||t.dispose(),!e)return;const s=this.components.get(Qr),n=s.Type;s.Type=Th,this.plane=s.createFromNormalAndCoplanarPoint(e,new i.Vector3(1,0,0),new i.Vector3),s.Type=n,this.plane.visible=!1,this.plane.enabled=!1}async set(e,t){if(!this.world||!this.plane)throw new Error("You must set a world before using this component");this.plane.enabled=!0;const s=e.curve.getPercentageAt(t);if(null===s)return;const{startPoint:n,endPoint:r}=e.curve.getSegmentAt(s);if(null===e.geometry.index)throw new Error("Geometry must be indexed!");const o=new i.Vector3;o.subVectors(r,n),o.normalize(),this.plane.setFromNormalAndCoplanarPoint(o,t),this.plane.edges.update();const a=this.plane.helper.matrix.clone();a.invert();const l=this.world.scene.three,c=this.plane.edges.get();for(const e in c){const{mesh:t}=c[e];t.position.set(0,0,0),t.rotation.set(0,0,0),t.updateMatrix(),t.applyMatrix4(a),t.parent!==l&&l.add(t)}this.plane.enabled=!1}};t(kh,"uuid","96b2c87e-d90b-4639-8257-8f01136fe324");let Yh=kh;function Gh(){const e=document.createElement("div");return e.style.backgroundColor="black",e.style.color="white",e.style.padding="8px",e.style.borderRadius="8px",e.style.fontFamily="sans-serif",e}const Hh=class e{constructor(e,s,n){t(this,"label"),t(this,"boundingBox",new i.Mesh),t(this,"world"),t(this,"components"),t(this,"_length"),t(this,"_visible",!0),t(this,"_start"),t(this,"_end"),t(this,"_root",new i.Group),t(this,"_endpoints",[]),t(this,"_line"),this.components=e,this.world=s,this._start=n.start,this._end=n.end,this._length=this.getLength(),this._line=this.createLine(n),this.newEndpointElement(n.endpointElement),this.newEndpointElement(n.endpointElement.cloneNode(!0)),this.label=this.newText(),this._root.renderOrder=2,this.world.scene.three.add(this._root)}get visible(){return this._visible}set visible(e){this._visible=e,this.label.visible=e,this._endpoints[0].visible=e,this._endpoints[1].visible=e;const[t,i]=this._endpoints,s=t.three,n=i.three,r=this.label.three;e?(this.world.scene.three.add(this._root),this._root.add(r,s,n)):(r.removeFromParent(),s.removeFromParent(),n.removeFromParent(),this._root.removeFromParent())}get endPoint(){return this._end}set endPoint(e){this._end=e;const t=this._line.geometry.attributes.position;t.setXYZ(1,e.x,e.y,e.z),t.needsUpdate=!0,this._endpoints[1].three.position.copy(e),this.updateLabel()}get startPoint(){return this._start}set startPoint(e){this._start=e;const t=this._line.geometry.attributes.position;t.setXYZ(0,e.x,e.y,e.z),t.needsUpdate=!0,this._endpoints[0].three.position.copy(e),this.updateLabel()}get _center(){let e=this._end.clone().sub(this._start);const t=.5*e.length();return e=e.normalize().multiplyScalar(t),this._start.clone().add(e)}dispose(){const e=this.components.get(Xi);this.visible=!1,e.destroy(this._root),e.destroy(this._line);for(const e of this._endpoints)e.dispose();this._endpoints.length=0,this.label.dispose(),this.boundingBox&&e.destroy(this.boundingBox),this.components=null}createBoundingBox(){this.boundingBox.geometry=new i.BoxGeometry(1,1,this._length),this.boundingBox.position.copy(this._center),this.boundingBox.lookAt(this._end),this.boundingBox.visible=!1,this._root.add(this.boundingBox)}toggleLabel(){this.label.toggleVisibility()}newEndpointElement(e){const t=0===this._endpoints.length?this._start:this._end,i=new pc(this.world,e);i.three.position.copy(t),this._endpoints.push(i),this._root.add(i.three)}updateLabel(){this._length=this.getLength(),this.label.three.element.textContent=this.getTextContent(),this.label.three.position.copy(this._center),this._line.computeLineDistances()}createLine(e){const t=new i.BufferGeometry;t.setFromPoints([e.start,e.end]);const s=new i.Line(t,e.lineMaterial);return this._root.add(s),s}newText(){const e=Gh();e.textContent=this.getTextContent();const t=new pc(this.world,e);return t.three.position.copy(this._center),this._root.add(t.three),t}getTextContent(){return`${(this._length/e.scale).toFixed(e.rounding)} ${e.units}`}getLength(){return this._start.distanceTo(this._end)}};t(Hh,"scale",1),t(Hh,"units","m"),t(Hh,"rounding",2);let Wh=Hh;class Xh{constructor(e,s,n){t(this,"enabled",!0),t(this,"points",[]),t(this,"workingPlane",null),t(this,"labelMarker"),t(this,"world"),t(this,"components"),t(this,"onDisposed",new Bi),t(this,"onAreaComputed",new Bi),t(this,"onWorkingPlaneComputed",new Bi),t(this,"onPointAdded",new Bi),t(this,"onPointRemoved",new Bi),t(this,"_visible",!0),t(this,"_rotationMatrix",null),t(this,"_dimensionLines",[]),t(this,"_defaultLineMaterial",new i.LineBasicMaterial({color:"red"})),this.world=s,this.components=e;const r=Gh();this.labelMarker=new pc(s,r),this.labelMarker.visible=!1,this.onPointAdded.add((e=>{3===this.points.length&&!this._dimensionLines[2]&&(this.addDimensionLine(e,this.points[0]),this.labelMarker.visible=!0)})),null==n||n.forEach((e=>this.setPoint(e)))}get visible(){return this._visible}set visible(e){this._visible=e;for(const t of this._dimensionLines)t.visible=e,t.label.visible=!1;this.labelMarker.visible=e}setPoint(e,t){let i;if(i=t||(0===this.points.length?0:this.points.length),0===i)return void(this.points[0]=e);if(i<0||i>this.points.length)return;const s=this.points.length>i;this.points[i]=e,this.onPointAdded.trigger(e),s||this.addDimensionLine(this.points[i-1],e);const{previousLine:n,nextLine:r}=this.getLinesBetweenIndex(i);n&&(n.endPoint=e),r&&(r.startPoint=e)}removePoint(e){if(3===this.points.length)return;this.points.splice(e,1);const{previousLine:t,nextLine:i}=this.getLinesBetweenIndex(e);i&&(t.endPoint=i.endPoint),null==i||i.dispose(),this._dimensionLines.splice(e,1),this.onPointRemoved.trigger()}toggleLabel(){this.labelMarker.toggleVisibility()}addDimensionLine(e,t){const i=new Wh(this.components,this.world,{start:e,end:t,lineMaterial:this._defaultLineMaterial,endpointElement:Gh()});return i.toggleLabel(),this._dimensionLines.length>1?this._dimensionLines.splice(this._dimensionLines.length-1,0,i):this._dimensionLines.push(i),i}getLinesBetweenIndex(e){const t=0===e?this._dimensionLines.length-1:e-1;return{previousLine:this._dimensionLines[t],nextLine:this._dimensionLines[e]}}computeWorkingPlane(){this.workingPlane=(new i.Plane).setFromCoplanarPoints(this.points[0],this.points[1],this.points[2]);const e=new i.Vector3(0,1,0),t=this.workingPlane.normal.angleTo(e),s=(new i.Vector3).crossVectors(this.workingPlane.normal,e).normalize();this._rotationMatrix=(new i.Matrix4).makeRotationAxis(s,t),this.onWorkingPlaneComputed.trigger(this.workingPlane)}computeArea(){if(!this._rotationMatrix||!this.workingPlane)return this.onAreaComputed.trigger(0),0;let e=0,t=0;const s=this._rotationMatrix,n=this.points.map((n=>{const r=n.clone().applyMatrix4(s),o=new i.Vector2(r.x,r.z);return e+=o.x,t+=o.y,o})),r=Math.abs(i.ShapeUtils.area(n));return this.labelMarker.three.element.textContent=`${r.toFixed(2)} m²`,this.labelMarker.three.position.set(e/n.length,-this.workingPlane.constant,t/n.length).applyMatrix4(s.clone().invert()),this.onAreaComputed.trigger(r),r}dispose(){this.onAreaComputed.reset(),this.onWorkingPlaneComputed.reset(),this.onPointAdded.reset(),this.onPointRemoved.reset();for(const e of this._dimensionLines)e.dispose();this.labelMarker.dispose(),this._dimensionLines=[],this.points=[],this._rotationMatrix=null,this.workingPlane=null,this._defaultLineMaterial.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}get(){return{points:this.points,workingPlane:this.workingPlane,area:this.computeArea()}}}class Zh extends Es{constructor(e,i){super(e,i),t(this,"onDisposed",new Bi),t(this,"marker",null),t(this,"_className","default-vertex-picker"),this.onEnabled.add((e=>{this.marker&&(this.marker.visible=e)}))}get className(){return this._className}set className(e){this._className=e,this.marker&&(this.marker.three.element.className=e)}dispose(){this.marker&&this.marker.dispose(),super.dispose()}get(e){const t=super.get(e);return t?(this.marker||(this.marker=new pc(e),this.marker.three.element.className=this._className),this.marker.world!==e&&(this.marker.world=e,this.marker.three.removeFromParent(),e.scene.three.add(this.marker.three)),this.marker.visible=!0,this.marker.three.position.copy(t)):this.marker&&(this.marker.visible=!1),t}}const jh=class e extends ki{constructor(i){super(i),t(this,"onDisposed",new Bi),t(this,"list",[]),t(this,"world"),t(this,"_enabled",!1),t(this,"_visible",!0),t(this,"_vertexPicker"),t(this,"_currentAreaElement",null),t(this,"_clickCount",0),t(this,"create",(()=>{if(!this.enabled)return;if(!this.world)throw new Error("World not defined for the area measurement!");const e=this._vertexPicker.get(this.world);if(e){if(!this._currentAreaElement){const e=new Xh(this.components,this.world);e.onPointAdded.add((()=>{2===this._clickCount&&!e.workingPlane&&(e.computeWorkingPlane(),this._vertexPicker.workingPlane=e.workingPlane)})),e.onPointRemoved.add((()=>this._clickCount--)),this._currentAreaElement=e}this._currentAreaElement.setPoint(e,this._clickCount),this._currentAreaElement.computeArea(),this._clickCount++}})),t(this,"onMouseMove",(()=>{if(!this.world)return void console.log("No world given for the area measurement!");const e=this._vertexPicker.get(this.world);e&&this._currentAreaElement&&(this._currentAreaElement.setPoint(e,this._clickCount),this._currentAreaElement.computeArea())})),t(this,"onKeydown",(e=>{this.enabled&&("z"===e.key&&e.ctrlKey&&this._currentAreaElement&&this._currentAreaElement.removePoint(this._clickCount-1),"Enter"===e.key&&this._currentAreaElement&&this.endCreation(),"Escape"===e.key&&(0!==this._clickCount||this._currentAreaElement?this.cancelCreation():this.enabled=!1))})),this.components.add(e.uuid,this),this._vertexPicker=new Zh(i)}set enabled(e){this._enabled=e,this._vertexPicker.enabled=e,this.setupEvents(e),e||this.cancelCreation()}get enabled(){return this._enabled}set workingPlane(e){this._vertexPicker.workingPlane=e}get workingPlane(){return this._vertexPicker.workingPlane}get visible(){return this._visible}set visible(e){this._visible=e;for(const t of this.list)t.visible=e}dispose(){this.setupEvents(!1),this._vertexPicker.dispose(),this._currentAreaElement&&this._currentAreaElement.dispose();for(const e of this.list)e.dispose();this.components=null,this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}delete(){}deleteAll(){for(const e of this.list)e.dispose();this.list=[]}endCreation(){this._currentAreaElement&&(this._currentAreaElement.points.length<3||(this._currentAreaElement&&(this.list.push(this._currentAreaElement),this._currentAreaElement.removePoint(this._clickCount),this._currentAreaElement.computeWorkingPlane(),this._currentAreaElement.computeArea(),this._currentAreaElement=null),this._vertexPicker.workingPlane=null,this._clickCount=0))}cancelCreation(){this._currentAreaElement&&(this._currentAreaElement.dispose(),this._currentAreaElement=null),this._vertexPicker.workingPlane=null,this._clickCount=0}setupEvents(e){if(!this.world)throw new Error("The area measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the area measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(t.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}};t(jh,"uuid","c453a99e-f054-4781-9060-33df617db4a5");let Kh=jh;class Qh{constructor(e,s){t(this,"enabled",!0),t(this,"visible",!0),t(this,"points",[]),t(this,"world"),t(this,"onDisposed",new Bi),t(this,"_lineMaterial",new zl({color:6629591,linewidth:2})),t(this,"_lineGeometry",new sc),t(this,"_line",new nc(this._lineGeometry,this._lineMaterial)),t(this,"_labelMarker"),t(this,"onAngleComputed",new Bi),t(this,"onPointAdded",new Bi),this.world=e;const n=Gh();this._labelMarker=new pc(e,n),this.labelMarker.visible=!0,this.onPointAdded.add((()=>{1===this.points.length&&e.scene.three.add(this._line),3===this.points.length&&(this.labelMarker.visible=!0)})),this.onAngleComputed.add((e=>{this.labelMarker.three.element.textContent=`${e.toFixed(2)}°`,this.labelMarker.three.position.copy(this.points[1]??new i.Vector3)})),null==s||s.forEach((e=>this.setPoint(e)))}set lineMaterial(e){this._lineMaterial.dispose(),this._lineMaterial=e,this._line.material=e,this._lineMaterial.resolution.set(window.innerWidth,window.innerHeight)}get lineMaterial(){return this._lineMaterial}set labelMarker(e){this._labelMarker.dispose(),this._labelMarker=e}get labelMarker(){return this._labelMarker}get angle(){return{points:this.points,angle:this.computeAngle()}}setPoint(e,t){let i;if(i=t||(0===this.points.length?0:this.points.length),![0,1,2].includes(i))return;this.points[i]=e,this.onPointAdded.trigger(e);const s=this.points.map((e=>[e.x,e.y,e.z]));this._lineGeometry.setPositions(s.flat())}toggleLabel(){this.labelMarker.toggleVisibility()}computeAngle(){const e=this.points[0],t=this.points[1],s=this.points[2];if(!(e&&t&&s))return 0;const n=(new i.Vector3).subVectors(t,e),r=(new i.Vector3).subVectors(t,s),o=i.MathUtils.radToDeg(n.angleTo(r));return this.onAngleComputed.trigger(o),o}dispose(){this.points=[],this.labelMarker.dispose(),this.onAngleComputed.reset(),this.onPointAdded.reset(),this.labelMarker.dispose(),this._line.removeFromParent(),this._lineMaterial.dispose(),this._lineGeometry.dispose(),this.onDisposed.trigger(),this.onDisposed.reset()}}const qh=class e extends ki{constructor(i){super(i),t(this,"onDisposed",new Bi),t(this,"world"),t(this,"list",[]),t(this,"_lineMaterial"),t(this,"_enabled",!1),t(this,"_vertexPicker"),t(this,"_currentAngleElement",null),t(this,"_clickCount",0),t(this,"create",(()=>{if(!this.enabled)return;if(!this.world)return void console.log("No world selected for angle measurement!");const e=this._vertexPicker.get(this.world);if(e){if(!this._currentAngleElement){const e=new Qh(this.world);e.lineMaterial=this.lineMaterial,this._currentAngleElement=e}this._currentAngleElement.setPoint(e,this._clickCount),this._currentAngleElement.setPoint(e,this._clickCount+1),this._currentAngleElement.setPoint(e,this._clickCount+2),this._currentAngleElement.computeAngle(),this._clickCount++,3===this._clickCount&&this.endCreation()}})),t(this,"onMouseMove",(()=>{if(!this.world)return void console.log("No world selected for angle measurement!");const e=this._vertexPicker.get(this.world);e&&this._currentAngleElement&&(this._currentAngleElement.setPoint(e,this._clickCount),this._currentAngleElement.computeAngle())})),t(this,"onKeyDown",(e=>{this.enabled&&"Escape"===e.key&&this.cancelCreation()})),this.components.add(e.uuid,this),this._vertexPicker=new Zh(i),this._lineMaterial=new zl({color:6629591,linewidth:2})}get enabled(){return this._enabled}set enabled(e){this._enabled=e,this.setupEvents(e),this._vertexPicker.enabled=e,e||this.cancelCreation()}get lineMaterial(){return this._lineMaterial}set lineMaterial(e){this._lineMaterial.dispose(),this._lineMaterial=e,this._lineMaterial.resolution.set(window.innerWidth,window.innerHeight)}get workingPlane(){return this._vertexPicker.workingPlane}set workingPlane(e){this._vertexPicker.workingPlane=e}dispose(){this.setupEvents(!1),this._lineMaterial.dispose(),this._vertexPicker.dispose();for(const e of this.list)e.dispose();this._currentAngleElement&&this._currentAngleElement.dispose(),this.components=null,this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}delete(){}deleteAll(){for(const e of this.list)e.dispose();this.list=[]}endCreation(){this._currentAngleElement&&(this.list.push(this._currentAngleElement),this._currentAngleElement.computeAngle(),this._currentAngleElement=null),this._clickCount=0}cancelCreation(){this._currentAngleElement&&(this._currentAngleElement.dispose(),this._currentAngleElement=null),this._clickCount=0}setupEvents(e){if(!this.world)throw new Error("No world selected for angle measurement!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The given world doesn't have a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeyDown)):(t.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeyDown))}};t(qh,"uuid","622fb2c9-528c-4b0a-8a0e-6a1375f0a3aa");let Jh=qh;const $h=class e extends ki{constructor(s){super(s),t(this,"onDisposed",new Bi),t(this,"onBeforeUpdate",new Bi),t(this,"onAfterUpdate",new Bi),t(this,"onCleaned",new Bi),t(this,"snapDistance",.25),t(this,"list",[]),t(this,"world"),t(this,"_vertexPicker"),t(this,"_lineMaterial",new i.LineBasicMaterial({color:"#DC2626",linewidth:2,depthTest:!1})),t(this,"_visible",!0),t(this,"_enabled",!1),t(this,"_temp",{isDragging:!1,start:new i.Vector3,end:new i.Vector3,dimension:void 0}),t(this,"create",(e=>{const t=e instanceof i.Object3D?e:void 0;if(this._enabled){if(!this._temp.isDragging)return void this.drawStart(t);this.endCreation()}})),t(this,"onMouseMove",(()=>{this.world&&this._vertexPicker.get(this.world)})),t(this,"onKeydown",(e=>{this.enabled&&"Escape"===e.key&&this.cancelCreation()})),this.components.add(e.uuid,this),this._vertexPicker=new Zh(s,{previewElement:Gh(),snapDistance:this.snapDistance})}get enabled(){return this._enabled}set enabled(e){e||this.cancelCreation(),this._enabled=e,this._vertexPicker.enabled=e,this.setupEvents(e)}get visible(){return this._visible}set visible(e){this._visible=e;for(const t of this.list)t.visible=e}get color(){return this._lineMaterial.color}set color(e){this._lineMaterial.color=e}dispose(){this.setupEvents(!1),this.enabled=!1;for(const e of this.list)e.dispose();this._lineMaterial.dispose(),this.list=[],this._vertexPicker.dispose(),this.onDisposed.trigger(e.uuid),this.onDisposed.reset()}async update(e){this._enabled&&this._temp.isDragging&&this.drawInProcess()}createOnPoints(e,t){const i=this.drawDimension();return i.startPoint=e,i.endPoint=t,i.createBoundingBox(),this.list.push(i),i}delete(){if(!this.world)throw new Error("World is needed for Length Measurement!");if(!this._enabled||0===this.list.length)return;const e=this.getBoundingBoxes(),t=this.components.get(ur).get(this.world).castRay(e);if(!t)return;const i=this.list.find((e=>e.boundingBox===t.object));if(i){const e=this.list.indexOf(i);this.list.splice(e,1),i.dispose()}}async deleteMeasurement(e){if(e){const t=this.list.indexOf(e);this.list.splice(t,1),e.dispose()}}deleteAll(){for(const e of this.list)e.dispose();this.list=[],this.onCleaned.trigger(null)}cancelCreation(){var e;this._temp.dimension&&(this._temp.isDragging=!1,null==(e=this._temp.dimension)||e.dispose(),this._temp.dimension=void 0)}endCreation(){this._temp.dimension&&(this._temp.dimension.createBoundingBox(),this.list.push(this._temp.dimension),this._temp.dimension=void 0,this._temp.isDragging=!1)}drawStart(e){if(!this.world)throw new Error("The length measurement needs a world to work!");const t=e?[e]:void 0,i=this.components.get(ur).get(this.world).castRay(t),s=this._vertexPicker.get(this.world);i&&s&&(this._temp.isDragging=!0,this._temp.start=e?i.point:s)}drawInProcess(){if(!this.world)throw new Error("The length measurement needs a world to work!");if(!this.components.get(ur).get(this.world).castRay())return;const e=this._vertexPicker.get(this.world);e&&(this._temp.end=e,this._temp.dimension||(this._temp.dimension=this.drawDimension()),this._temp.dimension.endPoint=this._temp.end)}drawDimension(){if(!this.world)throw new Error("The length measurement needs a world to work!");return new Wh(this.components,this.world,{start:this._temp.start,end:this._temp.end,lineMaterial:this._lineMaterial,endpointElement:Gh()})}getBoundingBoxes(){return this.list.map((e=>e.boundingBox)).filter((e=>void 0!==e))}setupEvents(e){if(!this.world)throw new Error("The length measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the length measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;t&&(t.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown),e&&(t.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)))}};t($h,"uuid","2f9bcacf-18a9-4be6-a293-e898eae64ea1");let ed=$h;const td=class e extends ki{constructor(s){super(s),t(this,"onDisposed",new Bi),t(this,"onVolumeFound",new Bi),t(this,"label",null),t(this,"world"),t(this,"_enabled",!1),t(this,"create",(()=>{if(!this.enabled)return;if(!this.world)throw new Error("World is needed for Volume Measurement!");const e=this.components.get(ur).get(this.world).castRay(),t=this.components.get(vl);if(!e||!e.object)return;const{object:s}=e;if(s instanceof i.Mesh){const e=t.getVolumeFromMeshes([s]);this.onVolumeFound.trigger(e)}})),t(this,"onMouseMove",(()=>{})),t(this,"onKeydown",(e=>{})),this.components.add(e.uuid,this)}set enabled(e){this._enabled=e,this.setupEvents(e),e||this.cancelCreation()}get enabled(){return this._enabled}async dispose(){var e;this.setupEvents(!1),null==(e=this.label)||e.dispose(),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){}async deleteAll(){}endCreation(){}cancelCreation(){}getVolumeFromFragments(e){const t=this.components.get(vl).getVolumeFromFragments(e),i=this.components.get(tl);i.reset(),i.addFragmentIdMap(e);const s=i.getSphere();return this.setLabel(s,t),t}getVolumeFromMeshes(e){const t=this.components.get(vl),i=this.components.get(tl);i.reset();for(const t of e)i.addMesh(t);const s=i.getSphere(),n=t.getVolumeFromMeshes(e);return this.setLabel(s,n),n}clear(){this.label&&(this.label.visible=!1)}newLabel(){if(!this.world)throw new Error("World is needed for Volume Measurement!");const e=Gh();return new pc(this.world,e)}setupEvents(e){if(!this.world)throw new Error("The volume measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the volume measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("click",this.create),t.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(t.removeEventListener("click",this.create),t.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}setLabel(e,t){if(!this.world)throw new Error("World is needed for Volume Measurement!");this.label||(this.label=this.newLabel(),this.label.three.removeFromParent()),this.label.visible=!0,this.world.scene.three.add(this.label.three),this.label.three.position.copy(e.center);const i=Math.trunc(100*t)/100;this.label.three.element.textContent=i.toString()}};t(td,"uuid","811da532-7af3-4635-b592-1c06ae494af5");let id=td;const sd=class e extends ki{constructor(s){super(s),t(this,"onDisposed",new Bi),t(this,"selection",[]),t(this,"preview",new i.Mesh(new i.BufferGeometry,new i.MeshBasicMaterial({side:2,depthTest:!1,transparent:!0,opacity:.25,color:"#BCF124"}))),t(this,"selectionMaterial",new i.MeshBasicMaterial({side:2,depthTest:!1,transparent:!0,color:"#BCF124",opacity:.75})),t(this,"world"),t(this,"_enabled",!1),t(this,"_currentSelelection",null),t(this,"create",(()=>{if(!this.world)throw new Error("No world given to the face measurement!");if(!this.enabled||!this._currentSelelection)return;const e=this.world.scene.three,t=new i.BufferGeometry,s=new i.Mesh(t,this.selectionMaterial);t.setAttribute("position",this.preview.geometry.attributes.position),s.position.copy(this.preview.position),e.add(s),t.computeBoundingSphere();const{area:n,perimeter:r}=this._currentSelelection,o=this.newLabel(t,n);s.add(o.three),this.selection.push({area:n,perimeter:r,mesh:s,label:o})})),t(this,"onMouseMove",(()=>{if(!this.world)throw new Error("The face measurement needs a world to work!");if(!this.enabled)return void this.unselect();const e=this.components.get(ur).get(this.world).castRay();if(!e||!e.object||void 0===e.faceIndex)return void this.unselect();const{object:t,faceIndex:s}=e;t instanceof i.Mesh||t instanceof i.InstancedMesh?this.updateSelection(t,s,e.instanceId):this.unselect()})),t(this,"onKeydown",(e=>{})),this.components.add(e.uuid,this),this.preview.frustumCulled=!1}set enabled(e){if(!this.world)throw new Error("No world given for the Face measurement!");this._enabled=e,this.setupEvents(e),e?this.world.scene.three.add(this.preview):(this.preview.removeFromParent(),this.cancelCreation()),this.setVisibility(e)}get enabled(){return this._enabled}dispose(){this.setupEvents(!1),this.deleteAll(),this.preview.removeFromParent(),this.preview.material.dispose(),this.preview.geometry.dispose(),this.selectionMaterial.dispose(),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){if(!this.world)throw new Error("No world given to the face measurement!");const e=this.selection.map((e=>e.mesh)),t=this.components.get(ur).get(this.world).castRay(e);if(!t||!t.object)return;const i=this.selection.find((e=>e.mesh===t.object));if(!i)return;i.mesh.removeFromParent(),i.mesh.geometry.dispose(),i.label.dispose();const s=this.selection.indexOf(i);this.selection.splice(s,1)}deleteAll(){for(const e of this.selection)e.mesh.removeFromParent(),e.mesh.geometry.dispose(),e.label.dispose();this.selection=[]}endCreation(){}cancelCreation(){}get(){const e=[];for(const t of this.selection){const i=t.mesh.geometry,{area:s,perimeter:n}=t,r=i.attributes.position.array;e.push({position:r,area:s,perimeter:n})}return e}set(e){if(!this.world)throw new Error("No world given to the face measurement!");const t=this.world.scene.three;for(const s of e){const e=new i.BufferGeometry,n=new i.Mesh(e,this.selectionMaterial);t.add(n);const r=new i.BufferAttribute(s.position,3);e.setAttribute("position",r),e.computeBoundingSphere();const{area:o,perimeter:a}=s,l=this.newLabel(e,o);n.add(l.three),this.selection.push({area:o,perimeter:a,mesh:n,label:l})}}setupEvents(e){if(!this.world)throw new Error("The face measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the face measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;t.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown),e&&(t.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown))}setVisibility(e){if(!this.world)throw new Error("The face measurement needs a world to work!");if(this.world.isDisposing)return;const t=this.world.scene.three;for(const i of this.selection){const s=i.label.three;e?(t.add(i.mesh),i.mesh.add(s)):(i.mesh.removeFromParent(),s.removeFromParent())}}unselect(){this.preview.removeFromParent(),this._currentSelelection=null}updateSelection(e,t,i){if(!this.world)throw new Error("The face measurement needs a world to work!");this.world.scene.three.add(this.preview);const s=this.components.get(vl).getFace(e,t,i);if(null===s)return;const n=this.regenerateHighlight(e,s.indices,i);let r=0;for(const{distance:e}of s.edges)r+=e;this._currentSelelection={perimeter:r,area:n}}newLabel(e,t){if(!e.boundingSphere)throw new Error("Error computing area geometry");if(!this.world)throw new Error("The face measurement needs a world to work!");const{center:i}=e.boundingSphere,s=Gh(),n=Math.trunc(100*t)/100;s.textContent=n.toString();const r=new pc(this.world,s);return r.three.position.copy(i),r}regenerateHighlight(e,t,s){const n=[],r=[];let o=0,a=0;const l=new i.Triangle,c=this.components.get(vl);for(const i of t){const{p1:t,p2:h,p3:d}=c.getVerticesAndNormal(e,i,s);n.push(t.x,t.y,t.z),n.push(h.x,h.y,h.z),n.push(d.x,d.y,d.z),l.set(t,h,d),a+=l.getArea(),r.push(o,o+1,o+2),o+=3}this.preview.position.set(0,0,0),this.preview.rotation.set(0,0,0),this.preview.scale.set(1,1,1),this.preview.updateMatrix(),this.preview.applyMatrix4(e.matrixWorld);const h=new Float32Array(n),d=new i.BufferAttribute(h,3);return this.preview.geometry.setAttribute("position",d),this.preview.geometry.setIndex(r),a}};t(sd,"uuid","30279548-1309-44f6-aa97-ce26eed73522");let nd=sd;const rd=class e extends ki{constructor(s){super(s),t(this,"onDisposed",new Bi),t(this,"preview"),t(this,"tolerance",.3),t(this,"world"),t(this,"_enabled",!1),t(this,"_lineMaterial",new i.LineBasicMaterial({color:"#DC2626",linewidth:2,depthTest:!1,transparent:!0})),t(this,"create",(async()=>{if(!this.preview||!this.enabled||!this.preview.visible)return;const e=this.components.get(ed);e.world=this.world;const t=this.preview.startPoint.clone(),i=this.preview.endPoint.clone();e.createOnPoints(t,i)})),t(this,"onMouseMove",(()=>{if(!this.preview)return;if(!this.world)throw new Error("The edge measurement needs a world to work!");if(!this.enabled)return void(this.preview.visible=!1);const e=this.components.get(ur).get(this.world).castRay();if(!e||!e.object)return void(this.preview.visible=!1);const{object:t,faceIndex:s,point:n}=e;void 0!==s&&(t instanceof i.Mesh||t instanceof i.InstancedMesh)?this.updateSelection(t,n,s,e.instanceId):this.preview.visible=!1})),t(this,"onKeydown",(e=>{})),this.components.add(e.uuid,this)}set enabled(e){if(this._enabled=e,this.setupEvents(e),e){if(!this.world)throw new Error("The edge measurement needs a world to work!");if(!this.preview){const e=document.createElement("div");e.className="w-2 h-2 bg-red-600 rounded-full",this.preview=new Wh(this.components,this.world,{start:new i.Vector3,end:new i.Vector3,lineMaterial:this._lineMaterial,endpointElement:e}),this.preview.visible=!1}}else this.cancelCreation()}get enabled(){return this._enabled}dispose(){this.preview&&this.preview.dispose(),this._lineMaterial.dispose(),this.setupEvents(!1),this.onDisposed.trigger(),this.onDisposed.reset(),this.components=null}delete(){if(!this.enabled)return;const e=this.components.get(ed),t=e.enabled;e.enabled=!0,e.delete(),e.enabled=t}deleteAll(){this.components.get(ed).deleteAll()}endCreation(){}cancelCreation(){}get(){const e=this.components.get(ed).list,t=[];for(const i of e){const e=i.startPoint,s=i.endPoint,n=[e.x,e.y,e.z,s.x,s.y,s.z];t.push(n)}return t}set(e){const t=this.components.get(ed);t.world=this.world;for(const s of e){const[e,n,r,o,a,l]=s,c=new i.Vector3(e,n,r),h=new i.Vector3(o,a,l);t.createOnPoints(c,h)}}setupEvents(e){if(!this.world)throw new Error("The edge measurement needs a world to work!");if(this.world.isDisposing)return;if(!this.world.renderer)throw new Error("The world of the edge measurement needs a renderer!");const t=this.world.renderer.three.domElement.parentElement;e?(t.addEventListener("pointermove",this.onMouseMove),window.addEventListener("keydown",this.onKeydown)):(t.removeEventListener("pointermove",this.onMouseMove),window.removeEventListener("keydown",this.onKeydown))}updateSelection(e,t,i,s){if(!this.preview||!e.geometry.index)return;const n=this.components.get(vl).getFace(e,i,s);if(!n)return;const{edges:r}=n;let o=Number.MAX_VALUE,a=[];for(const e of r){const[i,s]=e.points,n=vl.distanceFromPointToLine(t,i,s,!0);n<this.tolerance&&n<o&&(o=n,a=e.points)}if(!a.length)return void(this.preview.visible=!1);const[l,c]=a;this.preview.startPoint=l,this.preview.endPoint=c,this.preview.visible=!0}};t(rd,"uuid","e7be5749-89df-4514-8d25-83aa38ce12d8");let od=rd;class ad extends rr{constructor(e,s){super(e,s),t(this,"threshold",50),t(this,"bboxThreshold",200),t(this,"maxLostTime",3e4),t(this,"maxHiddenTime",5e3),t(this,"boxes",new Map),t(this,"_staticGeometries",{culled:{},unculled:{}}),t(this,"_geometry"),t(this,"_material",new i.MeshBasicMaterial({transparent:!0,side:2,opacity:1})),t(this,"onViewUpdated",new Vi),t(this,"_modelIDIndex",new Map),t(this,"_indexModelID",new Map),t(this,"_nextModelID",0),t(this,"_geometries",new Map),t(this,"_geometriesGroups",new Map),t(this,"_geometriesInMemory",new Set),t(this,"_intervalID",null),t(this,"codes",new Map),t(this,"handleWorkerMessage",(async e=>{const t=e.data.colors,i={},s={},n={},r={},o=performance.now();let a=!1;const l=new Set(this._geometriesInMemory);for(const[e,s]of t){const t=this._geometries.get(e);if(!(t&&s>this.threshold))continue;l.delete(e);const{exists:n}=t,c=this._indexModelID.get(t.modelIndex);n?(t.time=o,r[c]||(r[c]=new Set),r[c].add(t.geometryID),this._geometriesInMemory.add(e),a=!0):(i[c]||(i[c]=new Map),t.time=o,t.exists=!0,i[c].has(s)||i[c].set(s,new Set),i[c].get(s).add(t.geometryID),this._geometriesInMemory.add(e),a=!0)}for(const e of l){const t=this._geometries.get(e);t&&(this.handleLostGeometries(o,e,t,s,n),a=!0)}a&&await this.onViewUpdated.trigger({toLoad:i,toRemove:s,toHide:n,toShow:r}),this._isWorkerBusy=!1})),this.config.updateInterval=500,this._geometry=new i.BoxGeometry(1,1,1),this._geometry.groups=[],this._geometry.deleteAttribute("uv");const n=this._geometry.attributes.position.array;for(let e=0;e<n.length;e++)n[e]+=.5;this._geometry.attributes.position.needsUpdate=!0,this.worker.addEventListener("message",this.handleWorkerMessage)}dispose(){super.dispose(),this.onViewUpdated.reset(),null!==this._intervalID&&(window.clearInterval(this._intervalID),this._intervalID=null);for(const[e,t]of this._geometriesGroups){t.removeFromParent();const e=[...t.children];for(const t of e)t.removeFromParent()}this._geometriesGroups.clear();for(const[e,t]of this.boxes)t.dispose(!0);this.boxes.clear();for(const[e,t]of this._geometries)t.fragment&&(t.fragment.dispose(!0),t.fragment=void 0);this._geometries.clear(),this._staticGeometries={culled:{},unculled:{}},this._geometry.dispose(),this._material.dispose(),this._modelIDIndex.clear(),this._indexModelID.clear(),this.codes.clear()}add(e,t,s){const n=this.createModelIndex(e),r=i.ColorManagement.enabled;i.ColorManagement.enabled=!1;const o=new Map,a=new i.Matrix4,l=new oe.Fragment(this._geometry,this._material,10);this.boxes.set(n,l),this.scene.add(l.mesh);const c=new i.Group;this.scene.add(c),this._geometriesGroups.set(n,c);const h=new Map;for(const e of t)for(const t of e.geometries){const{geometryID:r,transformation:l,color:c}=t,d=new i.Color;d.setRGB(c[0],c[1],c[2],"srgb");const u=this.getInstanceID(e.id,r),f=s[r];if(!f){console.log(`Geometry not found: ${r}`);continue}const{boundingBox:p}=f;let m;o.has(r)?m=o.get(r):(m=this.getAvailableColor(),this.increaseColor(),o.set(r,m));const{r:I,g:E,b:g,code:C}=m,T=new i.Color;T.setRGB(I/255,E/255,g/255,"srgb"),this.codes.has(n)||this.codes.set(n,new Map),this.codes.get(n).set(r,C);const R=new i.Matrix4,v=Object.values(p);if(R.fromArray(l),a.fromArray(v),R.multiply(a),h.has(u)){const e=h.get(u);if(void 0===e||!e.colors)throw new Error("Malformed item!");e.colors.push(T),e.geometryColors.push(d),e.transforms.push(R)}else h.set(u,{id:u,colors:[T],geometryColors:[d],transforms:[R]});if(this._geometries.has(C))this._geometries.get(C).assetIDs.add(e.id);else{const t=new Set([e.id]);this._geometries.set(C,{modelIndex:n,geometryID:r,assetIDs:t,exists:!1,hidden:!1,time:0})}}const d=Array.from(h.values());l.add(d),i.ColorManagement.enabled=r}remove(e){const t=this._modelIDIndex.get(e);if(void 0===t)throw new Error("Model doesn't exist!");const i=this._geometriesGroups.get(t);i.removeFromParent();const s=[...i.children];for(const e of s)e.removeFromParent();this._geometriesGroups.delete(t),this.boxes.get(t).dispose(!1),this.boxes.delete(t);const n=this.codes.get(t);this.codes.delete(t);for(const[e,t]of n){const e=this._geometries.get(t);e&&e.fragment&&(e.fragment.dispose(!1),e.fragment=void 0),this._geometries.delete(t)}this._modelIDIndex.delete(e),this._indexModelID.delete(t),this._geometriesInMemory.clear()}addFragment(e,t,s){const n=i.ColorManagement.enabled;i.ColorManagement.enabled=!1;const r=this._modelIDIndex.get(e),o=this.codes.get(r).get(t),a=this._geometries.get(o);if(this.setGeometryVisibility(a,!1,!1),!a.fragment){a.fragment=new oe.Fragment(s.mesh.geometry,this._material,s.capacity);const e=this._geometriesGroups.get(r);if(!e)throw new Error("Group not found!");e.add(a.fragment.mesh)}const[l,c,h]=o.split("-").map((e=>parseInt(e,10))),d=[];for(const e of s.ids){const t=s.get(e);if(!t.colors)throw new Error("Malformed fragments!");for(const e of t.colors)e.setRGB(l/255,c/255,h/255,"srgb");d.push(t)}a.fragment.add(d),i.ColorManagement.enabled=n,this.needsUpdate=!0}removeFragment(e,t){const i=this._modelIDIndex.get(e),s=this.codes.get(i).get(t),n=this._geometries.get(s);if(n.hidden||this.setGeometryVisibility(n,!0,!1),n.fragment){const{fragment:e}=n;e.dispose(!1),n.fragment=void 0}}setModelTransformation(e,t){const i=this._modelIDIndex.get(e);if(void 0===i)throw new Error("Model not found!");const s=this.boxes.get(i);s&&(s.mesh.position.set(0,0,0),s.mesh.rotation.set(0,0,0),s.mesh.scale.set(1,1,1),s.mesh.applyMatrix4(t));const n=this._geometriesGroups.get(i);n&&(n.position.set(0,0,0),n.rotation.set(0,0,0),n.scale.set(1,1,1),n.applyMatrix4(t))}setVisibility(e,t,i){const s=this._modelIDIndex.get(t);if(void 0!==s)for(const[t,n]of i){const i=this.codes.get(s);if(void 0===i)throw new Error("Map not found!");const r=i.get(t),o=this._geometries.get(r);if(void 0===o)throw new Error("Geometry not found!");o.hidden=!e,this.setGeometryVisibility(o,e,!0,n)}}updateTransformations(e){const t=this._modelIDIndex.get(e);if(void 0===t)return;const i=this.components.get(wo).groups.get(e);if(i){i.updateWorldMatrix(!0,!1),i.updateMatrix();const e=this.boxes.get(t);e&&(e.mesh.position.set(0,0,0),e.mesh.rotation.set(0,0,0),e.mesh.scale.set(1,1,1),e.mesh.updateMatrix(),e.mesh.applyMatrix4(i.matrixWorld),e.mesh.updateMatrix());const s=this._geometriesGroups.get(t);s&&(s.position.set(0,0,0),s.rotation.set(0,0,0),s.scale.set(1,1,1),s.updateMatrix(),s.applyMatrix4(i.matrixWorld),s.updateMatrix())}}async addStaticGeometries(e,t=!0){const i={data:{colors:new Map}},s=this.threshold+1e3;for(const n in e){const r=this._modelIDIndex.get(n);if(void 0===r)continue;const o=this.codes.get(r);if(!o)continue;const a=e[n];for(const e of a){const r=o.get(e);if(!r)continue;const a=this._geometries.get(r);if(!a)continue;a.exists=!0,t||(a.hidden=!1,a.time=performance.now(),i.data.colors.set(r,s)),this._geometriesInMemory.add(r);const l=t?this._staticGeometries.culled:this._staticGeometries.unculled;l[n]||(l[n]=new Set),l[n].add(e)}}t||await this.handleWorkerMessage(i)}removeStaticGeometries(e,t){const i=[];void 0===t?i.push("culled","unculled"):!0===t?i.push("culled"):i.push("unculled");for(const t in e){const s=e[t];for(const e of i){const i=this._staticGeometries[e][t];if(i)for(const e of s)i.delete(e)}}}cancel(e){for(const t in e){const i=this._modelIDIndex.get(t);if(void 0===i)throw new Error("Model not found.");const s=this.codes.get(i);if(void 0===s)throw new Error("Codes not found.");for(const i of e[t]){const e=s.get(i);if(void 0===e)throw new Error("Color code not found.");this._geometriesInMemory.delete(e);const t=this._geometries.get(e);if(!t)throw new Error("Geometry not found.");t.exists=!1}}}getBoundingBoxes(e){const t=new oe.FragmentsGroup;for(const i in e){const s=e[i],n=this._modelIDIndex.get(i);if(void 0===n)continue;const r=this.boxes.get(n);if(!r)continue;const o=r.clone(s);t.add(o.mesh),t.items.push(o)}return t}getInstanceID(e,t){return e+t/10**(Math.log(t)*Math.LOG10E+1|0)}setGeometryVisibility(e,t,i,s){const{modelIndex:n,geometryID:r,assetIDs:o}=e,a=this.boxes.get(n);if(void 0===a)throw new Error("Model not found!");const l=s||o;if(i&&e.fragment)e.fragment.setVisibility(t,l);else{const e=new Set;for(const t of l){const i=this.getInstanceID(t,r);e.add(i)}a.setVisibility(t,e)}}handleLostGeometries(e,t,i,s,n){var r,o,a;const l=this._indexModelID.get(i.modelIndex),c=e-i.time,{culled:h,unculled:d}=this._staticGeometries;if(c>this.maxLostTime){if(null!=(r=h[l])&&r.has(i.geometryID)||null!=(o=d[l])&&o.has(i.geometryID))return;s[l]||(s[l]=new Set),i.exists=!1,s[l].add(i.geometryID),this._geometriesInMemory.delete(t)}else if(c>this.maxHiddenTime){if(null!=(a=d[l])&&a.has(i.geometryID))return;n[l]||(n[l]=new Set),n[l].add(i.geometryID)}}createModelIndex(e){if(this._modelIDIndex.has(e))throw new Error("Can't load the same model twice!");const t=this._nextModelID;return this._nextModelID++,this._modelIDIndex.set(e,t),this._indexModelID.set(t,e),t}}const ld=class e extends ki{constructor(s){super(s),t(this,"enabled",!0),t(this,"onFragmentsDeleted",new Bi),t(this,"onFragmentsLoaded",new Bi),t(this,"onDisposed",new Bi),t(this,"models",{}),t(this,"serializer",new oe.StreamSerializer),t(this,"maxRamTime",5e3),t(this,"useCache",!0),t(this,"cancel",!1),t(this,"url",""),t(this,"fetch",(async e=>fetch(this.url+e))),t(this,"fileDB",new oe.StreamerFileDb("that-open-company-streaming")),t(this,"_culler",null),t(this,"_world",null),t(this,"_ramCache",new Map),t(this,"_isDisposing",!1),t(this,"_geometryInstances",{}),t(this,"_loadedFragments",{}),t(this,"fragIDData",new Map),t(this,"_baseMaterial",new i.MeshLambertMaterial),t(this,"_baseMaterialT",new i.MeshLambertMaterial({transparent:!0,opacity:.5})),t(this,"disposeStreamedGroup",(e=>{this._isDisposing=!0;const{groupID:t,fragmentIDs:i}=e;if(this.models[t]){delete this.models[t],delete this._geometryInstances[t],delete this._loadedFragments[t];for(const e of i)this.fragIDData.delete(e);this.culler.remove(t),this._isDisposing=!1}})),this.components.add(e.uuid,this),this.components.get(wo).onFragmentsDisposed.add(this.disposeStreamedGroup),oe.FragmentsGroup.setPropertiesDB(!0)}get world(){if(!this._world)throw new Error("You must set a world before using the streamer!");return this._world}set world(e){var t;this._world=e,null==(t=this._culler)||t.dispose(),this._culler=new ad(this.components,e),this._culler.onViewUpdated.add((async({toLoad:e,toRemove:t,toShow:i,toHide:s})=>{await this.loadFoundGeometries(e),await this.unloadLostGeometries(t),this.setMeshVisibility(i,!0),this.setMeshVisibility(s,!1)}))}get culler(){if(!this._culler)throw new Error("You must set a world before using the streamer!");return this._culler}dispose(){var t;this._isDisposing=!0,this.onFragmentsLoaded.reset(),this.onFragmentsDeleted.reset(),this._ramCache.clear(),this.components.get(wo).onFragmentsDisposed.remove(this.disposeStreamedGroup),this.models={},this._geometryInstances={},this._loadedFragments={},this.fragIDData.clear(),this._baseMaterial.dispose(),this._baseMaterialT.dispose(),null==(t=this._culler)||t.dispose(),this.onDisposed.trigger(e.uuid),this.onDisposed.reset(),this._isDisposing=!1,oe.FragmentsGroup.setPropertiesDB(!1)}async load(e,t,i){const{assets:s,geometries:n,globalDataFileId:r}=e,o=await(await this.fetch(r)).arrayBuffer(),a=new Uint8Array(o),l=this.components.get(wo).load(a,{coordinate:t,isStreamed:!0});l.name=r.replace("-processed-global",""),this.world.scene.three.add(l);const{opaque:c,transparent:h}=l.geometryIDs;for(const[e,t]of c){const i=l.keyFragments.get(t);if(void 0===i)throw new Error("Malformed fragments group!");this.fragIDData.set(i,[l,e,new Set])}for(const[e,t]of h){const i=l.keyFragments.get(t);if(void 0===i)throw new Error("Malformed fragments group!");this.fragIDData.set(i,[l,Math.abs(e),new Set])}this.culler.add(l.uuid,s,n);const d=new Map;for(const e of s)d.set(e.id,e);const u={assetsMap:d,geometries:n};Object.defineProperty(u,"assets",{get:()=>Array.from(u.assetsMap.values())}),this.models[l.uuid]=u;const f=new Map;for(const e of s){const t=e.id;for(const{transformation:i,geometryID:s,color:n}of e.geometries){f.has(s)||f.set(s,[]);const e=f.get(s);if(!e)throw new Error("Malformed instances");e.push({id:t,transformation:i,color:n})}}if(this._geometryInstances[l.uuid]=f,i){const e=new Map,t=new Map;for(const t in i.ids){const s=i.ids[t],n=parseInt(t,10);e.set(n,s)}for(const e in i.types){const s=i.types[e],n=parseInt(e,10);t.set(n,s)}const s=r.replace("-global","-properties");oe.FragmentsGroup.url=this.url,l.streamSettings={baseFileName:s,ids:e,types:t};const{indexesFile:n}=i,o=await(await this.fetch(n)).text(),a=this.components.get(So);a.setRelationMap(l,a.getRelationsMapFromJSON(o))}return this.culler.updateTransformations(l.uuid),this.culler.needsUpdate=!0,l}remove(e){const t=this.components.get(wo),i=t.groups.get(e);i&&t.disposeGroup(i)}setVisibility(e,t){const i=new Map;if(!t){const e=this.components.get(wo),i={};for(const[,t]of e.groups){const e=t.getFragmentMap();for(const t in e)i[t]=e[t]}t=i}for(const s in t){const n=this.fragIDData.get(s);if(void 0===n)throw new Error("Geometry not found!");const[r,o,a]=n,l=r.uuid;i.has(l)||i.set(l,new Map);const c=i.get(l),h=t[s];for(const t of h)e?a.delete(t):a.add(t);c.get(o)||c.set(o,new Set);const d=c.get(o);for(const e of h)d.add(e)}for(const[s,n]of i){this.culler.setVisibility(e,s,n);for(const[i]of n){const n=this._loadedFragments[s];if(!n)continue;const r=n[i];if(r)for(const i of r){const s=t[i.id];s&&i.setVisibility(e,s)}}}this.culler.needsUpdate=!0}async clearCache(){await this.fileDB.clear()}async setStatic(e,t,i){const s={};for(const t of e){const e=this.fragIDData.get(t);if(!e){console.log(`Item not found: ${t}.`);continue}const[i,n]=e,r=i.uuid;s[r]||(s[r]=new Set),s[r].add(n)}if(t){const e={};for(const t in s){const i=new Map;i.set(1,s[t]),e[t]=i}await this.loadFoundGeometries(e,!1),await this.culler.addStaticGeometries(s,i)}else this.culler.removeStaticGeometries(s,i)}getBoundingBoxes(e){const t={},i=this.components.get(wo),s=new Map;for(const[e,t]of i.groups)for(const[,i]of t.keyFragments)s.set(i,e);const n=new Set;for(const i in e){const r=s.get(i);if(void 0===r){console.log("Fragment group not found!");continue}const o=e[i];n.has(r)||(t[r]=new Set,n.add(r));for(const e of o){const i=this.models[r].assetsMap.get(e);if(i)for(const s of i.geometries){const i=s.geometryID,n=this.culler.getInstanceID(e,i);t[r].add(n)}}}return this.culler.getBoundingBoxes(t)}async loadFoundGeometries(e,t=!0){this.cancel=!1;const i={};for(const t in e){const s=new Set;for(const[,i]of e[t])for(const e of i)s.add(e);i[t]=s}for(const s in e){if(this._isDisposing)return;if(this.cancel)return void this.cancelLoading(i);const n=this.components.get(wo).groups.get(s);if(!n)return;const{geometries:r}=this.models[s],o=new Map,a=new Set;for(const[t,n]of e[s])for(const e of n){if(this.cancel)return void this.cancelLoading(i);a.add(e);const s=r[e];if(!s)throw new Error("Geometry not found");if(s.geometryFile){const e=s.geometryFile,i=o.get(e)||0;o.set(e,i+t)}}if(this.useCache){const e=o.entries();for(const[t,i]of e)this.fileDB.isCached(t)&&o.set(t,i+99999)}const l=Array.from(o).sort(((e,t)=>t[1]-e[1])),c=[];for(const[e]of l){const r=this.loadFragmentFile(s,n,t,e,a,i);c.push(r)}await Promise.all(c);const h=new Set,d=performance.now();for(const[e,{time:t}]of this._ramCache)d-t>this.maxRamTime&&h.add(e);for(const e of h)this._ramCache.delete(e)}}async unloadLostGeometries(e){if(this._isDisposing)return;const t=[],i=this.components.get(wo);for(const s in e){const n=i.groups.get(s);if(!n)throw new Error("Fragment group not found!");if(!this._loadedFragments[s])continue;const r=this._loadedFragments[s],o=e[s];for(const e of o){if(this.culler.removeFragment(n.uuid,e),!r[e])continue;const i=r[e];for(const e of i)n.items.splice(n.items.indexOf(e),1),t.push(e);delete r[e]}}t.length&&this.onFragmentsDeleted.trigger(t);for(const e of t)i.list.delete(e.id),this.world.meshes.delete(e.mesh),e.mesh.material=[],e.dispose(!0)}setMeshVisibility(e,t){for(const i in e)for(const s of e[i]){const e=this._loadedFragments[i];if(!e)continue;const n=e[s];if(n)for(const e of n)e.mesh.visible=t}}newFragment(e,t,s,n,r,o,a){if(0===n.length||this._isDisposing)return;const l=e.geometryIDs,c=t*(r?-1:1),h=(r?l.transparent:l.opaque).get(c);if(void 0===h)return;const d=e.keyFragments.get(h);if(void 0===d)return;const u=this.components.get(wo);if(u.list.has(d))return;const f=r?this._baseMaterialT:this._baseMaterial,p=new oe.Fragment(s,f,n.length);p.mesh.visible=a,p.id=d,p.mesh.uuid=d,p.group=e,e.add(p.mesh),e.items.push(p),u.list.set(p.id,p),this.world.meshes.add(p.mesh),this._loadedFragments[e.uuid]||(this._loadedFragments[e.uuid]={});const m=this._loadedFragments[e.uuid];m[t]||(m[t]=[]),m[t].push(p);const I=new Map;for(let e=0;e<n.length;e++){const t=new i.Matrix4,s=new i.Color,{id:r,transformation:o,color:a}=n[e];t.fromArray(o);const[l,c,h]=a;if(s.setRGB(l,c,h,"srgb"),I.has(r)){const e=I.get(r);if(!e)continue;e.transforms.push(t),e.colors&&e.colors.push(s)}else I.set(r,{id:r,colors:[s],transforms:[t]})}const E=Array.from(I.values());p.add(E);const g=this.fragIDData.get(p.id);if(!g)throw new Error("Fragment data not found!");const C=g[2];C.size&&p.setVisibility(!1,C),this.culler.addFragment(e.uuid,t,p),o.push(p)}cancelLoading(e){this.cancel=!1,this.culler.cancel(e)}async loadFragmentFile(e,t,s,n,r,o){if(!this._ramCache.has(n)){let e=new Uint8Array;if(this.useCache){const t=await this.fileDB.get(n);if(t){const i=await t.arrayBuffer();e=new Uint8Array(i)}else{const t=await(await this.fetch(n)).arrayBuffer();e=new Uint8Array(t),await this.fileDB.add(n,e)}}else{const t=await(await this.fetch(n)).arrayBuffer();e=new Uint8Array(t)}const t=this.serializer.import(e);this._ramCache.set(n,{data:t,time:performance.now()})}const a=this._ramCache.get(n);if(!a)return;a.time=performance.now();const l=[];if(a)for(const[n,{position:c,index:h,normal:d}]of a.data){if(this._isDisposing)return;if(this.cancel)return void this.cancelLoading(o);if(o[e].delete(n),!r.has(n)||!this._geometryInstances[e]||!this._geometryInstances[e].has(n))continue;const a=this._geometryInstances[e].get(n);if(!a)throw new Error("Instances not found!");const u=new i.BufferGeometry,f=new i.BufferAttribute(c,3),p=new i.BufferAttribute(d,3);u.setAttribute("position",f),u.setAttribute("normal",p),u.setIndex(Array.from(h));const m=[],I=[];for(const e of a)1===e.color[3]?I.push(e):m.push(e);this.newFragment(t,n,u,m,!0,l,s),this.newFragment(t,n,u,I,!1,l,s)}l.length&&!this._isDisposing&&this.onFragmentsLoaded.trigger(l)}};t(ld,"uuid","22437e8d-9dbc-4b99-a04f-d2da280d50c8");let cd=ld;class hd{constructor(){t(this,"_meshes",new Map)}highlight(e,t,s,n){if(!t.userData.indexFragmentMap||!t.geometry.index)return;const{userData:r}=t,o=r.indexFragmentMap,a=[],l=t.geometry.index.array;for(const[e,t]of o)for(const i in t)if(n[i])for(const s of t[i])if(n[i].has(s)){const t=l[3*e],i=l[3*e+1],s=l[3*e+2];a.push(t,i,s)}this._meshes.has(e)||this._meshes.set(e,new Map);const c=this._meshes.get(e);if(!c.has(t.uuid)){const e=new i.MeshBasicMaterial({depthTest:!1,side:2,color:s}),n=new i.BufferGeometry;n.attributes=t.geometry.attributes;const r=new i.Mesh(n,e);r.frustumCulled=!1,c.set(t.uuid,r)}const h=c.get(t.uuid);h.position.copy(t.position),t.parent&&t.parent!==h.parent&&t.parent.add(h),h.geometry.setIndex(a),h.material.color.copy(s)}clear(e){for(const[t,i]of this._meshes)if(!e||e===t)for(const[e,t]of i)t.removeFromParent()}dispose(){for(const[e,t]of this._meshes)for(const[e,i]of t)i.removeFromParent(),i.geometry.attributes={},i.geometry.dispose(),i.material.dispose();this._meshes.clear()}}const dd=class e extends ki{constructor(s){super(s),t(this,"onDisposed",new Bi),t(this,"onBeforeUpdate",new Bi),t(this,"onAfterUpdate",new Bi),t(this,"onSetup",new Bi),t(this,"isSetup",!1),t(this,"enabled",!0),t(this,"events",{}),t(this,"multiple","ctrlKey"),t(this,"zoomFactor",1.5),t(this,"zoomToSelection",!1),t(this,"backupColor",null),t(this,"selection",{}),t(this,"config",{selectName:"select",hoverName:"hover",selectionColor:new i.Color("#BCF124"),hoverColor:new i.Color("#6528D7"),autoHighlightOnClick:!0,world:null,selectEnabled:!0,hoverEnabled:!0}),t(this,"colors",new Map),t(this,"autoToggle",new Set),t(this,"mouseDownPosition",{x:0,y:0}),t(this,"mouseMoveThreshold",5),t(this,"selectable",{}),t(this,"eventManager",new Qi),t(this,"_fills",new hd),t(this,"_mouseState",{down:!1,moved:!1}),t(this,"_colorsBeforeSelect",{}),t(this,"saveHighlightersBeforeSelect",(e=>{var t;const i=this.components.get(wo);for(const s in e){const e=i.list.get(s);if(!e)continue;const n=null==(t=e.group)?void 0:t.uuid;if(n)for(const e in this.selection){if(e===this.config.selectName||e===this.config.hoverName)continue;const t=this.selection[e][s];if(t){e in this._colorsBeforeSelect||(this._colorsBeforeSelect[e]={}),n in this._colorsBeforeSelect[e]||(this._colorsBeforeSelect[e]={[n]:new Set});for(const i of t)this._colorsBeforeSelect[e][n].add(i)}}}})),t(this,"restoreHighlightersAfterDeselect",(()=>{const e=this.components.get(wo);for(const t in this._colorsBeforeSelect){let i={};const s=this._colorsBeforeSelect[t];for(const t in s){const n=e.groups.get(t);if(!n)continue;const r=n.getFragmentMap(s[t]);i={...i,...r}}this.highlightByID(t,i,!1,!1)}this._colorsBeforeSelect={}})),t(this,"clearHover",(()=>{this.selection[this.config.hoverName]={}})),t(this,"onMouseDown",(e=>{this.enabled&&(this.mouseDownPosition={x:e.clientX,y:e.clientY},this._mouseState.down=!0)})),t(this,"onMouseUp",(async e=>{if(!this.enabled)return;const{world:t,autoHighlightOnClick:i,selectEnabled:s}=this.config;if(!t)throw new Error("No world found!");if(!t.renderer)throw new Error("This world doesn't have a renderer!");if(e.target===t.renderer.three.domElement){if(this._mouseState.down=!1,this._mouseState.moved||0!==e.button)return void(this._mouseState.moved=!1);if(this._mouseState.moved=!1,i&&s){const t="none"===this.multiple||!e[this.multiple];await this.highlight(this.config.selectName,t,this.zoomToSelection)}}})),t(this,"onMouseMove",(async e=>{if(!this.enabled)return;const t=e.clientX-this.mouseDownPosition.x,i=e.clientY-this.mouseDownPosition.y,s=Math.sqrt(t*t+i*i),{hoverName:n,hoverEnabled:r}=this.config;if(this._mouseState.moved)this.clear(n);else if(s>this.mouseMoveThreshold){this._mouseState.moved=this._mouseState.down;const e={};for(const t in this.selection){if(t===n)continue;const i=this.selection[t];for(const t in i){t in e||(e[t]=new Set);const s=i[t];for(const i of s)e[t].add(i)}}r&&await this.highlight(this.config.hoverName,!0,!1,e)}})),this.components.add(e.uuid,this),this.eventManager.list.add(this.onSetup),this.eventManager.list.add(this.onDisposed)}async dispose(){this.setupEvents(!1),this._fills.dispose(),this.onBeforeUpdate.reset(),this.onAfterUpdate.reset(),this.isSetup=!1,this.selection={};for(const e in this.events){const{onClear:t,onHighlight:i}=this.events[e];this.eventManager.list.delete(t),this.eventManager.list.delete(i)}this.onDisposed.trigger(e.uuid),this.eventManager.reset()}add(e,t){if(this.selection[e]||this.colors.has(e))throw new Error("A selection with that name already exists!");this.colors.set(e,t),this.selection[e]={};const i=new Bi,s=new Bi,n=new Bi;this.events[e]={onHighlight:i,onClear:n,onBeforeHighlight:s},this.eventManager.add([n,i,s])}remove(e){if(this.clear(e),delete this.selection[e],this.colors.delete(e),this.selection[e]||this.colors.has(e))throw new Error("A selection with that name already exists!");if(this.events[e]){const{onHighlight:t,onClear:i,onBeforeHighlight:s}=this.events[e];this.eventManager.remove([i,t,s]),delete this.events[e]}}async highlight(e,t=!0,i=this.zoomToSelection,s={}){if(!this.enabled)return null;if(!this.config.world)throw new Error("No world found in config!");const n=this.config.world;if(!this.selection[e])throw new Error(`Selection ${e} does not exist.`);const r=[],o=this.components.get(wo).meshes;for(const e of o)r.push(e);const a=this.components.get(Qr);for(const e of a.list){const t=e;if(t.edges){const e=t.edges.fillMeshes;for(const t of e)r.push(t)}}const l=this.components.get(ur).get(n).castRay(r);if(!l||!l.face)return this.clear(e),null;const c=l.object;if(!c.fragment&&c.userData.indexFragmentMap){if(void 0===l.faceIndex||!c.geometry.index)return null;const{userData:n}=c,r=n.indexFragmentMap.get(l.faceIndex);if(r){await this.highlightByID(e,r,t,i,s,c,!0);const n=Object.keys(r)[0];return{id:Array.from(r[n])[0],fragments:r}}return null}const h=c.geometry,d=l.instanceId;if(!h||void 0===d)return null;const u=c.fragment.getItemID(d);if(null===u)throw new Error("Item ID not found!");const f=c.fragment.group;if(!f)throw new Error("Fragment must belong to a FragmentsGroup!");const p=f.getFragmentMap([u]);return await this.highlightByID(e,p,t,i,s,void 0,!0),{id:u,fragments:p}}async highlightByID(e,t,i=!0,s=this.zoomToSelection,n={},r=void 0,o=!1){if(!this.enabled)return;this.events[e].onBeforeHighlight.trigger(this.selection[e]),i&&this.clear(e);const a=this.components.get(wo),l=this.colors.get(e);if(void 0===l)throw new Error("Color for selection not found!");const c={};for(const i in t){const s=t[i],r=n[i];for(const t of s)if(!r||!r.has(t)){if(this.selectable[e]){const s=this.selectable[e];if(!s[i]||!s[i].has(t))continue}c[i]||(c[i]=new Set),c[i].add(t)}}for(const i in c){this.selection[e][i]||(this.selection[e][i]=new Set);const s=c[i],n=new Set,r=new Set;for(const t of s){const s=this.selection[e][i];o&&this.autoToggle.has(e)&&s.has(t)?(n.add(t),s.delete(t)):(s.add(t),r.add(t))}const h=a.list.get(i);if(h&&(n.size&&(this.backupColor?h.setColor(this.backupColor,n):h.resetColor(n)),r.size&&null!==l&&h.setColor(l,r),h.mesh.userData.fills&&null!==l))for(const i of h.mesh.userData.fills)this._fills.highlight(e,i,l,t)}this.events[e].onHighlight.trigger(this.selection[e]),r&&null!==l&&this._fills.highlight(e,r,l,t),s&&await this.zoomSelection(e)}clear(e,t){const i=e?[e]:Object.keys(this.selection);for(const e of i){this._fills.clear(e);const i=this.components.get(wo),s=this.selection[e];for(const e in s){const n=i.list.get(e);if(!n)continue;let r=s[e];if(r){if(t){const i=t[e];if(!i)continue;const n=new Set,o=new Set;for(const e of r)i.has(e)?n.add(e):o.add(e);r=n,o.size?s[e]=o:delete s[e]}this.backupColor?n.setColor(this.backupColor,r):n.resetColor(r)}}t||(this.selection[e]={}),this.events[e].onClear.trigger(null)}}setup(e){this.config={...this.config,...e},this.add(this.config.selectName,this.config.selectionColor),this.autoToggle.add(this.config.selectName),this.add(this.config.hoverName,this.config.hoverColor),this.setupEvents(!0),this.enabled=!0,this.isSetup=!0,this.onSetup.trigger(this)}updateFragments(e){for(const t of e)for(const e in this.selection){const i=this.selection[e][t.id],s=this.colors.get(e);i&&s&&t.setColor(s,i)}}async zoomSelection(e){if(!this.config.world)throw new Error("No world found in config!");const t=this.config.world;if(!t.camera.hasCameraControls())return;const i=this.components.get(tl),s=this.components.get(wo);i.reset();const n=this.selection[e];if(!Object.keys(n).length)return;for(const e in n){const t=s.list.get(e);if(!t)continue;const r=n[e];i.addMesh(t.mesh,r)}const r=i.getSphere(),o=1/0,a=-1/0,{x:l,y:c,z:h}=r.center,d=r.radius===o||l===o||c===o||h===o,u=r.radius===a||l===a||c===a||h===a,f=0===r.radius;d||u||f||(r.radius*=this.zoomFactor,await t.camera.controls.fitToSphere(r,!0))}setupEvents(e){if(!this.config.world)return void console.log("No world found while setting up events!");if(this.config.world.isDisposing)return;if(!this.config.world.renderer)throw new Error("The given world doesn't have a renderer!");const t=this.config.world.renderer.three.domElement,i=this.events[this.config.selectName].onHighlight;i.remove(this.clearHover),i.remove(this.saveHighlightersBeforeSelect);const s=this.events[this.config.selectName].onClear;s.remove(this.restoreHighlightersAfterDeselect),t.removeEventListener("mousedown",this.onMouseDown),t.removeEventListener("mouseup",this.onMouseUp),t.removeEventListener("pointermove",this.onMouseMove),e&&(i.add(this.clearHover),i.add(this.saveHighlightersBeforeSelect),s.add(this.restoreHighlightersAfterDeselect),t.addEventListener("mousedown",this.onMouseDown),t.addEventListener("mouseup",this.onMouseUp),t.addEventListener("pointermove",this.onMouseMove))}};t(dd,"uuid","cb8a76f2-654a-4b50-80c6-66fd83cafd77");let ud=dd;class fd extends ki{constructor(){super(...arguments),t(this,"onDisposed",new Bi),t(this,"world")}get enabled(){return!(!this.world||this.world.isDisposing)&&this.getRenderer().postproduction.customEffects.outlineEnabled}set enabled(e){if(!this.world||this.world.isDisposing)return;this.getRenderer().postproduction.customEffects.outlineEnabled=e}create(e,t){const i=this.getRenderer();if(void 0!==i.postproduction.customEffects.outlinedMeshes[e])throw new Error(`There's already a style with the name ${e}.`);i.postproduction.customEffects.outlinedMeshes[e]={material:t,meshes:new Set}}add(e,t){const i=this.getRenderer(),s=this.getStyles()[e];if(!s)throw new Error(`The style ${e} does not exist`);const n=i.postproduction.customEffects.outlineScene,r=this.components.get(wo);for(const e in t){const i=r.list.get(e);if(!i)continue;const o=t[e],a=i.clone(o);a.mesh.position.set(0,0,0),a.mesh.rotation.set(0,0,0),a.mesh.applyMatrix4(i.mesh.matrixWorld),a.mesh.instanceColor=null,a.mesh.material=[s.material],s.meshes.add(a.mesh),n.add(a.mesh)}}clear(e){if(e)return void this.clearStyle(e,!1);const t=this.getStyles(),i=Object.keys(t);for(const e of i)this.clearStyle(e,!1);this.world=void 0}dispose(){if(this.world&&!this.world.isDisposing){const e=this.getStyles(),t=Object.keys(e);for(const e of t)this.clearStyle(e,!0)}this.onDisposed.trigger(),this.onDisposed.reset()}clearStyle(e,t){const i=this.getStyles(),s=i[e];if(!s)return;const n=this.components.get(Xi);for(const e of s.meshes){const t=e;t.fragment&&t.fragment.dispose(!1),n.destroy(e)}s.meshes.clear(),t&&(s.material.dispose(),delete i[e])}getStyles(){return this.getRenderer().postproduction.customEffects.outlinedMeshes}getRenderer(){if(!this.world)throw new Error("You must set a world to use the outliner!");const e=this.world.renderer;if(!e.postproduction)throw new Error("The world given to the outliner must use the postproduction renderer.");return e}}t(fd,"uuid","2fd3bcc5-b3b6-4ded-9f64-f47a02854a10");class pd extends ki{constructor(){super(...arguments),t(this,"enabled",!1),t(this,"onDisposed",new Bi),t(this,"onNavigated",new Bi),t(this,"onExited",new Bi),t(this,"planeType","section"),t(this,"offset",100),t(this,"list",new Map),t(this,"world"),t(this,"current",null),t(this,"cached3DCamera",{position:new i.Vector3,target:new i.Vector3,projection:"Perspective",zoom:1,top:10,bottom:-10,right:10,left:-10})}create(e){const t=this.getWorld(),{id:i,point:s,normal:n,type:r}=e;let{name:o,offset:a}=e;const l=this.components.get(Qr),c=l.Type;l.Type=Th;const h=l.createFromNormalAndCoplanarPoint(t,n,s);h.visible=!1,h.edges.visible=!1,h.enabled=!1,o=o||i,a=a||this.offset,h.type=r||this.planeType,h.updateFill();const d={id:i,name:o,plane:h,offset:a,cached:{position:n.clone().multiplyScalar(-a).add(s),target:s.clone(),zoom:1,size:10}};return this.list.set(i,d),l.Type=c,d}delete(e){const t=this.list.get(e);t&&(t.plane.dispose(),this.list.delete(e))}async goTo(e,t=!1){var s;const n=this.getCamera();if((null==(s=this.current)?void 0:s.id)===e)return;const r=this.list.get(e);if(!r)throw new Error(`There's no section with the ID: ${e}.`);this.cacheCameraPosition(),await this.hidePreviousClippingPlane(),await n.projection.set("Orthographic"),this.current=r;const o=new i.Vector3,a=new i.Vector3,{cached:l}=r,{position:c,target:h}=l;o.copy(h),a.copy(c),await n.controls.setLookAt(a.x,a.y,a.z,o.x,o.y,o.z,t);const d=r.cached.size,u=n.threePersp.aspect;n.threeOrtho.top=d,n.threeOrtho.bottom=-d,n.threeOrtho.left=-d*u,n.threeOrtho.right=d*u,n.threeOrtho.updateProjectionMatrix(),await n.controls.zoomTo(l.zoom,!1),n.set("Plan"),this.current.plane&&(this.current.plane.enabled=!0,this.current.plane.edges.fillNeedsUpdate=!0,this.current.plane.edges.visible=!0),this.enabled=!0,this.onNavigated.trigger({id:e})}async exit(e=!1){if(!this.enabled||!this.world)return;this.cacheCameraPosition();const t=this.getCamera();t.set("Orbit");const{position:i,target:s,projection:n}=this.cached3DCamera;await t.projection.set(n),this.current&&(this.current.plane.enabled=!1,this.current.plane.edges.enabled=!1,this.current.plane.edges.visible=!1),this.current=null;const{x:r,y:o,z:a}=i,{x:l,y:c,z:h}=s;await t.controls.setLookAt(r,o,a,l,c,h,e),"Orthographic"===t.projection.current&&(await t.controls.zoomTo(this.cached3DCamera.zoom,!1),t.threeOrtho.left=this.cached3DCamera.left,t.threeOrtho.right=this.cached3DCamera.right,t.threeOrtho.top=this.cached3DCamera.top,t.threeOrtho.bottom=this.cached3DCamera.bottom),this.enabled=!1,this.onExited.trigger()}dispose(){for(const[,{plane:e}]of this.list)e.dispose();this.list.clear(),this.onDisposed.trigger(),this.onDisposed.reset()}getWorld(){if(!this.world)throw new Error("World is needed to create sections!");return this.world}getCamera(){const e=this.getWorld().camera;if(!e.hasCameraControls()||!e.projection)throw new Error("The world given to sections must have an OrthoPerspective camera.");return e}cacheCameraPosition(){if(!this.world)throw new Error("World is needed to create clipping planes!");const e=this.getCamera();if(this.enabled){if(!this.current)throw new Error("Current section not found!");const{cached:t}=this.current,{position:i,target:s}=t;e.controls.getPosition(i),e.controls.getTarget(s),t.zoom=e.threeOrtho.zoom,t.size=e.threeOrtho.top}else{e.three.getWorldPosition(this.cached3DCamera.position),e.controls.getTarget(this.cached3DCamera.target),this.cached3DCamera.projection=e.projection.current,this.cached3DCamera.zoom=e.threeOrtho.zoom;const{top:t,bottom:i,left:s,right:n}=e.threeOrtho;this.cached3DCamera.top=t,this.cached3DCamera.bottom=i,this.cached3DCamera.left=s,this.cached3DCamera.right=n}}async hidePreviousClippingPlane(){if(this.current){const e=this.current.plane;e&&(e.enabled=!1),this.current.plane.edges.visible=!1}}}t(pd,"uuid","45b41ba3-7bb8-4e08-909f-e0fa87973965");const md=class e extends ki{constructor(i){super(i),t(this,"onDisposed",new Bi),t(this,"planeType","floorplan"),t(this,"onNavigated",new Bi),t(this,"onExited",new Bi),t(this,"enabled",!1),t(this,"currentPlan",null),t(this,"offset",1.5),t(this,"list",[]),t(this,"_cachedPlanCamera",null),this.components.add(e.uuid,this)}get world(){return this.components.get(pd).world}set world(e){this.components.get(pd).world=e}get defaultCameraOffset(){return this.components.get(pd).offset}set defaultCameraOffset(e){this.components.get(pd).offset=e}dispose(){this.onExited.reset(),this.onNavigated.reset();const e=this.components.get(pd);for(const t of this.list)e.delete(t.id);this.list=[],this.onDisposed.trigger(),this.onDisposed.reset()}async generate(e){if(!e.hasProperties)throw new Error("Properties are needed to compute plan views!");const t=await e.getAllPropertiesOfType(he.IFCBUILDINGSTOREY);if(!t)throw new Error("Floorplans not found!");const s=e.coordinationMatrix.elements[13],n=await no.getUnits(e);for(const e of Object.values(t)){const t={value:0};this.getAbsoluteFloorHeight(e.ObjectPlacement,t);const r=t.value*n+s+this.offset;this.create({name:e.Name.value,id:e.GlobalId.value,normal:new i.Vector3(0,-1,0),point:new i.Vector3(0,r,0)})}}create(e){const t=this.components.get(pd);e.type=e.type||this.planeType;const i={...t.create(e),planOffset:this.offset};this.list.push(i)}async goTo(e,t=!1){this.enabled&&this.cachePlanCamera(),await this.components.get(pd).goTo(e,t),await this.applyCachedPlanCamera();const i=this.list.find((t=>t.id===e));i&&(this.currentPlan=i),this.enabled=!0}async exitPlanView(e=!1){this.enabled&&(this.cachePlanCamera(),await this.components.get(pd).exit(e),this.currentPlan=null,this.enabled=!1,this.onExited.trigger())}cachePlanCamera(){var e;const t=null==(e=this.world)?void 0:e.camera,s=new i.Vector3,n=new i.Vector3;t.controls.getTarget(s),t.controls.getPosition(n),this._cachedPlanCamera={target:s,position:n,zoom:t.threeOrtho.zoom,top:t.threeOrtho.top,right:t.threeOrtho.right,bottom:t.threeOrtho.bottom,left:t.threeOrtho.left}}async applyCachedPlanCamera(){var e;if(!this._cachedPlanCamera)return;const t=null==(e=this.world)?void 0:e.camera,{position:s,target:n}=this._cachedPlanCamera,r=new i.Vector3,o=new i.Vector3;t.controls.getPosition(r),t.controls.getTarget(o);const a=r.y,l=o.y;await t.controls.setLookAt(s.x,a,s.z,n.x,l,n.z),await t.controls.zoomTo(this._cachedPlanCamera.zoom),t.threeOrtho.top=this._cachedPlanCamera.top,t.threeOrtho.bottom=this._cachedPlanCamera.bottom,t.threeOrtho.left=this._cachedPlanCamera.left,t.threeOrtho.right=this._cachedPlanCamera.right,t.threeOrtho.updateProjectionMatrix()}getAbsoluteFloorHeight(e,t){const i=e.RelativePlacement.Location.Coordinates;t.value+=i[2].value,e.PlacementRelTo&&this.getAbsoluteFloorHeight(e.PlacementRelTo,t)}};t(md,"uuid","a80874aa-1c93-43a4-80f2-df346da086b1");let Id=md;export{Jh as AngleMeasurement,Kh as AreaMeasurement,zh as Civil3DNavigator,Yh as CivilCrossSectionNavigator,Bh as CivilElevationNavigator,bh as CivilNavigator,_h as CivilPlanNavigator,Sh as ClipEdges,Ch as ClippingEdges,gh as ClippingFills,od as EdgeMeasurement,Th as EdgesPlane,Rh as EdgesStyles,nd as FaceMeasurement,ad as GeometryCullerRenderer,Zh as GraphicVertexPicker,ud as Highlighter,cd as IfcStreamer,ed as LengthMeasurement,pc as Mark,Ec as Marker,fd as Outliner,Id as Plans,Nh as PlatformComponents,Ih as Postproduction,Eh as PostproductionRenderer,mc as RendererWith2D,pd as Sections,Fh as ShadowDropper,Wh as SimpleDimensionLine,id as VolumeMeasurement};
